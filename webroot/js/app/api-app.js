/*! For license information please see api-app.js.LICENSE.txt */
(()=>{"use strict";var e,t,a,s={566:(e,t,a)=>{var s=a(6540),n=a(961),i=a(5556),r=a.n(i),o=a(8562);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},l.apply(null,arguments)}const c=s.createContext({feedbacks:[],displaySuccess:()=>{},displayWarning:()=>{},displayError:()=>{},remove:()=>{}});class m extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{feedbacks:[],displaySuccess:this.displaySuccess.bind(this),displayWarning:this.displayWarning.bind(this),displayError:this.displayError.bind(this),remove:this.remove.bind(this)}}displaySuccess(e){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,o.A)(),type:"success",message:e}]})}displayWarning(e){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,o.A)(),type:"warning",message:e}]})}displayError(e){this.setState({feedbacks:[...this.state.feedbacks,{id:(0,o.A)(),type:"error",message:e}]})}remove(e){this.setState({feedbacks:this.state.feedbacks.filter((t=>e.id!==t.id))})}render(){return s.createElement(c.Provider,{value:this.state},this.props.children)}}function d(e){return class extends s.Component{render(){return s.createElement(c.Consumer,null,(t=>s.createElement(e,l({actionFeedbackContext:t},this.props))))}}}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},p.apply(null,arguments)}m.displayName="ActionFeedbackContextProvider",m.propTypes={children:r().any};const u=s.createContext({dialogs:[],open:()=>{},close:()=>{}});class h extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{dialogs:[],open:(e,t)=>{const a=(0,o.A)();return this.setState({dialogs:[...this.state.dialogs,{key:a,Dialog:e,DialogProps:t}]}),a},close:e=>this.setState({dialogs:this.state.dialogs.filter((t=>e!==t.key))}),closeAll:()=>this.setState({dialogs:[]})}}render(){return s.createElement(u.Provider,{value:this.state},this.props.children)}}function g(e){return class extends s.Component{render(){return s.createElement(u.Consumer,null,(t=>s.createElement(e,p({dialogContext:t},this.props))))}}}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},b.apply(null,arguments)}h.displayName="DialogContextProvider",h.propTypes={children:r().any};const y=s.createContext({ContextualMenu:null,show:()=>{},hide:()=>{}});class f extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{contextualMenus:[],show:(e,t)=>this.setState({contextualMenus:[...this.state.contextualMenus,{ContextualMenuComponent:e,componentProps:t}]}),hide:e=>this.setState({contextualMenus:this.state.contextualMenus.filter(((t,a)=>a!==e))})}}render(){return s.createElement(y.Provider,{value:this.state},this.props.children)}}f.displayName="ContextualMenuContextProvider",f.propTypes={children:r().any};var v=a(2389);class E extends s.Component{static get DEFAULT_WAIT_TO_CLOSE_TIME_IN_MS(){return 500}constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{shouldRender:!0,isPersisted:!1,timeoutId:null}}componentDidMount(){this.displayWithTimer(this.props.displayTimeInMs)}componentDidUpdate(e){const t=e&&e.feedback.id!==this.props.feedback.id,a=e&&this.props.displayTimeInMs&&e.displayTimeInMs!==this.props.displayTimeInMs;t?(this.setState({shouldRender:!0}),this.displayWithTimer(this.props.displayTimeInMs)):a&&this.updateTimer(this.props.displayTimeInMs)}componentWillUnmount(){this.state.timeoutId&&clearTimeout(this.state.timeoutId)}bindCallbacks(){this.persist=this.persist.bind(this),this.displayWithTimer=this.displayWithTimer.bind(this),this.close=this.close.bind(this)}displayWithTimer(e){this.state.timeoutId&&clearTimeout(this.state.timeoutId);const t=setTimeout(this.close,e),a=Date.now();this.setState({timeoutId:t,time:a})}updateTimer(e){const t=e-(Date.now()-this.state.time);t>0?this.displayWithTimer(t):(clearTimeout(this.state.timeoutId),this.close())}persist(){this.state.timeoutId&&!this.state.isPersisted&&(clearTimeout(this.state.timeoutId),this.setState({isPersisted:!0}))}close(){this.setState({shouldRender:!1}),setTimeout(this.props.onClose,E.DEFAULT_WAIT_TO_CLOSE_TIME_IN_MS)}render(){return s.createElement("div",{className:"notification",onMouseOver:this.persist,onMouseLeave:this.displayWithTimer,onClick:this.close},s.createElement("div",{className:`message animated ${this.state.shouldRender?"fadeInUp":"fadeOutUp"} ${this.props.feedback.type}`},s.createElement("span",{className:"content"},s.createElement("strong",null,"success"===this.props.feedback.type&&s.createElement(s.Fragment,null,s.createElement(v.x6,null,"Success"),": "),"error"===this.props.feedback.type&&s.createElement(s.Fragment,null,s.createElement(v.x6,null,"Error"),": "),"warning"===this.props.feedback.type&&s.createElement(s.Fragment,null,s.createElement(v.x6,null,"Warning"),": ")),this.props.feedback.message)))}}E.propTypes={feedback:r().object,onClose:r().func,displayTimeInMs:r().number};const w=(0,v.CI)("common")(E);class k extends s.Component{constructor(e){super(e),this.bindCallbacks()}static get DEFAULT_DISPLAY_TIME_IN_MS(){return 5e3}static get DEFAULT_DISPLAY_MIN_TIME_IN_MS(){return 1200}bindCallbacks(){this.close=this.close.bind(this)}get feedbackToDisplay(){return this.props.actionFeedbackContext.feedbacks[0]}get length(){return this.props.actionFeedbackContext.feedbacks.length}get hasFeedbacks(){return this.length>0}async close(e){await this.props.actionFeedbackContext.remove(e)}render(){const e=this.length>1?k.DEFAULT_DISPLAY_MIN_TIME_IN_MS:k.DEFAULT_DISPLAY_TIME_IN_MS;return s.createElement(s.Fragment,null,this.hasFeedbacks&&s.createElement("div",{className:"notification-container"},s.createElement(w,{feedback:this.feedbackToDisplay,onClose:()=>this.close(this.feedbackToDisplay),displayTimeInMs:e})))}}k.propTypes={actionFeedbackContext:r().any};const x=d(k);var C=a(4625),S=a(6347);function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},_.apply(null,arguments)}const N=s.createContext({user:null,users:null,roles:null,rememberMeOptions:{},resources:null,resource:null,shareResources:null,selectedResources:null,selectedUser:null,folders:null,resourceCommentId:null,mustRefreshComments:!1,siteSettings:null,userSettings:null,onCheckIsAuthenticatedRequested:null});function I(e){return class extends s.Component{render(){return s.createElement(N.Consumer,null,(t=>s.createElement(e,_({context:t},this.props))))}}}const P=N;function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},A.apply(null,arguments)}const T=s.createContext({counter:[],add:()=>{},remove:()=>{}});class R extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{counter:0,add:()=>{this.setState({counter:this.state.counter+1})},remove:()=>{this.setState({counter:Math.min(this.state.counter-1,0)})}}}render(){return s.createElement(T.Provider,{value:this.state},this.props.children)}}R.propTypes={children:r().any};class D{}class O extends D{static execute(){return!0}}class U extends D{static execute(){return!1}}const M="Folders.use",F="Users.viewWorkspace",j="Administration.viewWorkspace",z="Allow",L="Deny",q="AllowIfGroupManagerInOneGroup",K={[z]:O,[L]:U,[q]:class extends D{static execute(e){return e.groups_users.some((e=>e.is_admin))}}},W={[M]:K[z]},V={[j]:K[L]};class B{static getByRbac(e){return K[e.controlFunction]||(console.warn(`Could not find control function for the given rbac entity (${e.id})`),U)}static getDefaultForAdminAndUiAction(e){return W[e]||O}static getDefaultForUserAndUiAction(e){return V[e]||O}}class G extends Error{constructor(e="Entity validation error."){super(e),this.name="EntityValidationError",this.details={}}addError(e,t,a){if("string"!=typeof e)throw new TypeError("EntityValidationError addError property should be a string.");if("string"!=typeof t)throw new TypeError("EntityValidationError addError rule should be a string.");if("string"!=typeof a)throw new TypeError("EntityValidationError addError message should be a string.");Object.prototype.hasOwnProperty.call(this.details,e)||(this.details[e]={}),this.details[e][t]=a}addAssociationError(e,t){if("string"!=typeof e)throw new TypeError("EntityValidationError addAssociationError associationName should be a string.");if(!(t instanceof G))throw new TypeError("EntityValidationError addAssociationError errorDetails should be an object.");this.details[e]=t}getError(e,t){if(!this.hasError(e,t))return null;const a=this.details[e];return t?a[t]:a}hasError(e,t){if("string"!=typeof e)throw new TypeError("EntityValidationError hasError property should be a string.");const a=this.details&&Object.prototype.hasOwnProperty.call(this.details,e);if(!a)return!1;if(!t)return a;if("string"!=typeof t)throw new TypeError("EntityValidationError hasError rule should be a string.");return Object.prototype.hasOwnProperty.call(this.details[e],t)}hasErrors(){return Object.keys(this.details).length>0}getFirstRuleErrorByField(e){if(!this.hasError(e))return null;const t=this.details[e];return t[Object.keys(t)[0]]}}const $=G;var H=a(7761),Y=a.n(H);class J extends Error{constructor(e="Collection validation error."){super(e),this.name="CollectionValidationError",this.errors=[]}addItemValidationError(e,t){if(!Number.isInteger(e))throw new TypeError('CollectionValidationError::addEntityValidationError expects "position" to be an integer.');if(!(t instanceof $||t instanceof J))throw new TypeError('CollectionValidationError::addEntityValidationError expects "entityValidationError" to be an instance of EntityValidationError or CollectionValidationError.');this.errors[e]=t}addCollectionValidationError(e,t){if("string"!=typeof e)throw new TypeError('CollectionValidationError::addCollectionValidationError expects "rule" to be a string.');if("string"!=typeof t)throw new TypeError('CollectionValidationError::addCollectionValidationError expects "error" to be a string.');this.errors[e]=t}get details(){const e={};for(const t in this.errors)this.errors[t]instanceof $||this.errors[t]instanceof J?e[t]=this.errors[t].details:e[t]=this.errors[t];return e}}const Z=J;class Q{static validateSchema(e,t){if(!t)throw new TypeError(`Could not validate entity ${e}. No schema for entity ${e}.`);if(!t.type)throw new TypeError(`Could not validate entity ${e}. Type missing.`);if("array"!==t.type){if("object"===t.type){if(!t.required||!Array.isArray(t.required))throw new TypeError(`Could not validate entity ${e}. Schema error: no required properties.`);if(!t.properties||!Object.keys(t).length)throw new TypeError(`Could not validate entity ${e}. Schema error: no properties.`);const a=t.properties;for(const e in a){if(!Object.prototype.hasOwnProperty.call(a,e)||!a[e].type&&!a[e].anyOf)throw TypeError(`Invalid schema. Type missing for ${e}...`);if(a[e].anyOf&&(!Array.isArray(a[e].anyOf)||!a[e].anyOf.length))throw new TypeError(`Invalid schema, prop ${e} anyOf should be an array`)}}}else if(!t.items)throw new TypeError(`Could not validate entity ${e}. Schema error: missing item definition.`)}static validate(e,t,a){if(!e||!t||!a)throw new TypeError(`Could not validate entity ${e}. No data provided.`);switch(a.type){case"object":return Q.validateObject(e,t,a);case"array":return Q.validateArray(e,t,a);default:throw new TypeError(`Could not validate entity ${e}. Unsupported type.`)}}static validateArray(e,t,a){let s;const n=Q.validateProp("items",t,a);if("number"==typeof a.minItems&&(Q.isGreaterThanOrEqual(t.length,a.minItems)||(s=Q.handleCollectionValidationError("minItems",`The items array should contain at least ${a.minItems} item(s).`,s))),s)throw s;return n}static validateObject(e,t,a){const s=a.required,n=a.properties,i={};let r;for(const a in n)if(Object.prototype.hasOwnProperty.call(n,a))if(null!==t?.[a]||!0!==n[a]?.nullable){if(s.includes(a)){if(!Object.prototype.hasOwnProperty.call(t,a)){r=Q.getOrInitEntityValidationError(e,r),r.addError(a,"required",`The ${a} is required.`);continue}}else if(!Object.prototype.hasOwnProperty.call(t,a))continue;try{i[a]=Q.validateProp(a,t[a],n[a])}catch(t){if(!(t instanceof $))throw t;r=Q.getOrInitEntityValidationError(e,r),r.details[a]=t.details[a]}}else i[a]=null;if(r)throw r;return i}static getOrInitEntityValidationError(e,t){return t||new $(`Could not validate entity ${e}.`)}static validateProp(e,t,a){if(a.anyOf)return Q.validateAnyOf(e,t,a.anyOf),t;if(!0===a.nullable&&null===t)return t;if(Q.validatePropType(e,t,a),a.enum)return Q.validatePropEnum(e,t,a),t;switch(a.type){case"string":Q.validatePropTypeString(e,t,a);break;case"integer":case"number":Q.validatePropTypeNumber(e,t,a);break;case"array":Q.validatePropTypeArray(e,t,a);break;case"object":case"boolean":case"blob":case"null":break;case"x-custom":Q.validatePropCustom(e,t,a);break;default:throw new TypeError(`Could not validate property ${e}. Unsupported prop type ${a.type}`)}return t}static validatePropType(e,t,a){if(!Q.isValidPropType(t,a.type))throw Q.handlePropertyValidationError(e,"type",`The ${e} is not a valid ${a.type}.`)}static validatePropCustom(e,t,a){try{a.validationCallback(t)}catch(t){throw Q.handlePropertyValidationError(e,"custom",`The ${e} is not valid: ${t.message}`)}}static validatePropTypeString(e,t,a){let s;if(a.format&&(Q.isValidStringFormat(t,a.format)||(s=Q.handlePropertyValidationError(e,"format",`The ${e} is not a valid ${a.format}.`,s))),a.notEmpty&&(Q.isValidStringNotEmpty(t)||(s=Q.handlePropertyValidationError(e,"notEmpty",`The ${e} should be not empty`,s))),a.length&&(Q.isValidStringLength(t,a.length,a.length)||(s=Q.handlePropertyValidationError(e,"length",`The ${e} should be ${a.length} character in length.`,s))),a.minLength&&(Q.isValidStringLength(t,a.minLength)||(s=Q.handlePropertyValidationError(e,"minLength",`The ${e} should be ${a.minLength} character in length minimum.`,s))),a.maxLength&&(Q.isValidStringLength(t,0,a.maxLength)||(s=Q.handlePropertyValidationError(e,"maxLength",`The ${e} should be ${a.maxLength} character in length maximum.`,s))),a.pattern&&(Y().matches(t,a.pattern)||(s=Q.handlePropertyValidationError(e,"pattern",`The ${e} is not valid.`,s))),a.custom&&(a.custom(t)||(s=Q.handlePropertyValidationError(e,"custom",`The ${e} is not valid.`,s))),s)throw s}static handlePropertyValidationError(e,t,a,s=null){return(s=s||new $(`Could not validate property ${e}.`)).addError(e,t,a),s}static handleCollectionValidationError(e,t,a=null){return(a=a||new Z("Could not validate collection.")).addCollectionValidationError(e,t),a}static validatePropTypeNumber(e,t,a){let s;if("number"==typeof a.minimum&&(Q.isGreaterThanOrEqual(t,a.minimum)||(s=Q.handlePropertyValidationError(e,"minimum",`The ${e} should be greater or equal to ${a.minimum}.`,s))),"number"==typeof a.maximum&&(Q.isLesserThanOrEqual(t,a.maximum)||(s=Q.handlePropertyValidationError(e,"maximum",`The ${e} should be lesser or equal to ${a.maximum}.`,s))),s)throw s}static validatePropTypeArray(e,t,a){let s;if(a?.items&&"object"==typeof a.items){for(let n=0;n<t.length;n++){const i=`${e}.${n}`;try{this.validateProp(i,t[n],a.items)}catch(t){if(!(t instanceof $))throw t;{s=Q.getOrInitEntityValidationError(e,s);const a=t.details[i];s.details[e]={...s.details[e],[n]:a}}}}if(s)throw s}}static validatePropEnum(e,t,a){if(!Q.isPropInEnum(t,a.enum)){const t=new $(`Could not validate property ${e}.`);throw t.addError(e,"enum",`The ${e} value is not included in the supported list.`),t}}static validateAnyOf(e,t,a){for(let s=0;s<a.length;s++)try{return void Q.validateProp(e,t,a[s])}catch(e){}const s=new $(`Could not validate property ${e}.`);throw s.addError(e,"type",`The ${e} does not match any of the supported types.`),s}static isValidPropType(e,t){if(Array.isArray(t))throw new TypeError("EntitySchema isValidPropType multiple types are not supported.");if("string"!=typeof t)throw new TypeError("EntitySchema isValidPropType type is invalid.");switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"string":return"string"==typeof e;case"integer":return Number.isInteger(e);case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"array":return Array.isArray(e);case"blob":return e instanceof Blob;case"x-custom":return!0;default:throw new TypeError("EntitySchema validation type not supported.")}}static isValidStringFormat(e,t){if("string"!=typeof t)throw new TypeError("EntitySchema validPropFormat format is invalid.");switch(t){case"uuid":return Y().isUUID(e);case"email":case"idn-email":return Y().isEmail(e);case"date-time":return Y().isISO8601(e);case"x-url":return Y().isURL(e,{require_tld:!1});case"x-hex-color":return Y().isHexColor(e);case"x-base64":return Y().isBase64(e);default:throw new TypeError(`EntitySchema string validation format ${t} is not supported.`)}}static isValidStringNotEmpty(e){return!Y().isEmpty(e,{ignore_whitespace:!0})}static isValidStringLength(e,t,a){return t=t||0,Y().isLength(e,t,a)}static isPropInEnum(e,t){if(!t||!Array.isArray(t)||!t.length)throw new TypeError("EntitySchema enum schema cannot be empty.");return t.includes(e)}static isGreaterThanOrEqual(e,t){return e>=t}static isLesserThanOrEqual(e,t){return e<=t}}const X=Q;class ee{constructor(e,t={}){(t?.clone??!0)&&(e=JSON.parse(JSON.stringify(e))),this._props=e}toDto(){return JSON.parse(JSON.stringify(this))}toJSON(){return this._props}_hasProp(e){if(!e.includes(".")){const t=ee._normalizePropName(e);return Object.prototype.hasOwnProperty.call(this._props,t)}try{return this._getPropByPath(e),!0}catch(e){return!1}}_getPropByPath(e){return ee._normalizePropName(e).split(".").reduce(((e,t)=>{if(Object.prototype.hasOwnProperty.call(e,t))return e[t];throw new Error}),this._props)}static _normalizePropName(e){return e.replace(/([A-Z])/g,((e,t)=>`_${t.toLowerCase()}`)).replace(/\._/,".").replace(/^_/,"").replace(/^\./,"")}}const te=ee;var ae=a(5648);const se=e=>e?.replace(/_([a-z])/g,((e,t)=>t.toUpperCase())),ne=["string","number","integer","boolean"];class ie extends te{static _cachedSchema={};constructor(e={},t={}){const a=t?.validate??!0;super(e,t),this.marshall(),a&&this.validateSchema({schema:t?.schema,skipSchemaAssociationValidation:t?.skipSchemaAssociationValidation}),this.createAssociations(t),a&&this.validateBuildRules(t?.validateBuildRules)}marshall(){}validate(e={}){try{this.validateSchema({schema:e?.schema,skipSchemaAssociationValidation:e?.skipSchemaAssociationValidation}),this.validateBuildRules(e?.validateBuildRules),this.validateAssociations(e)}catch(e){if(!(e instanceof $))throw e;return e}return null}validateSchema(e=null){let t=e?.schema??this.cachedSchema;if(e?.skipSchemaAssociationValidation){t={...t};const e=Object.keys(this.constructor.associations),a=t.required.filter((t=>!e.includes(t)));t.required=a}this._props=X.validate(this.constructor.name,this._props,t)}get cachedSchema(){return this.constructor._cachedSchema[this.constructor.name]||(this.constructor._cachedSchema[this.constructor.name]=this.constructor.getSchema()),this.constructor._cachedSchema[this.constructor.name]}static getSchema(){throw new Error("The entity class should declare its schema.")}validateBuildRules(e={}){}createAssociations(e={}){if(Object.keys(this.constructor.associations).length>0){const t=new $;for(const[a,s]of Object.entries(this.constructor.associations))try{this._props[a]&&(this[`_${se(a)}`]=new s(this._props[a],{...e,clone:!1}),delete this._props[a])}catch(e){if(!(e instanceof $))throw e;t.addAssociationError(a,e)}if(t.hasErrors())throw t}}static get associations(){return{}}get(e){(0,ae.A)(e);const t=this.constructor.getSchema().properties[e];if(!t)throw new Error(`The property "${e}" has no schema definition.`);if(!ne.includes(t?.type))throw new Error('The property "associated_entity" should reference scalar properties only.');return this._props[e]}set(e,t,a={}){(0,ae.A)(e);const s=a?.validate??!0;if(this.isAssociation(e))this.setAssociation(e,t,a);else{const n=e.split(".")[0],i=this.constructor.getSchema().properties[n];if(!i)throw new Error(`The property "${n}" has no schema definition.`);if("array"===i?.type)this.setArrayProp(e,t,a);else{if(!ne.includes(i?.type))throw new Error('The property "associated_entity" should reference scalar properties only.');s&&X.validateProp(n,t,i),this._props[n]=t}}}setArrayProp(e,t,a){(0,ae.A)(e);const s=e.split("."),n=s[0];let i=null;const r=this.constructor.getSchema().properties[n],o=a?.validate??!0;if(2!==s.length)throw new Error(`The property "${s[0]}" has no index passed.`);{const e=s[1].match(/^(\d+)$/);if(!e)throw new Error(`The property "${s[0]}" has an invalid index format. Expected format: digits.`);i=parseInt(e[1],10)}if(!ne.includes(r.items.type))throw new Error('The property "associated_entity" with array type should reference scalar properties only.');o&&X.validateProp(n,t,r.items),this._props[n]||(this._props[n]=[]),null!=t?this._props[n][i]=t:this._props[n].splice(i,1)}setAssociation(e,t,a={}){if((0,ae.A)(e),this.isAssociation(e)){const s=e.split("."),n=se(s[0]);if(s.length>1){this[`_${n}`]||(this[`_${n}`]=new this.constructor.associations[s[0]]({},{validate:!1}));const e=s.slice(1).join(".");this[`_${n}`].set(e,t,a)}else t instanceof this.constructor.associations[e]?this[`_${n}`]=t:this[`_${n}`]=new this.constructor.associations[e](t,a)}}validateAssociations(e={}){const t=new $;if(Object.keys(this.constructor.associations).length>0&&Object.keys(this.constructor.associations).forEach((a=>{const s=se(a);if(this[`_${s}`]){const n=this[s].validate(e);n&&t.addAssociationError(a,n)}})),t.hasErrors())throw t}diffProps(e){if(!(e instanceof ie))throw new TypeError('The property "compareEntity" should be of "EntityV2" type.');const t={},a=this.constructor.getSchema(),s=Object.keys(a.properties).filter((e=>ne.includes(a.properties[e].type)));for(const a of s){const s=this.get(a),n=e.get(a);s!==n&&(t[a]=n)}return t}hasDiffProps(e){const t=this.diffProps(e);return Object.keys(t).length>0}isAssociation(e){const t=e.split(".")[0];return Boolean(this.constructor.associations?.[t])}}const re=ie;class oe extends re{static getSchema(){return{type:"object",required:["id","name"],properties:{id:{type:"string",format:"uuid"},name:{type:"string",enum:[oe.ROLE_ADMIN,oe.ROLE_USER,oe.ROLE_GUEST,oe.ROLE_ROOT]},description:{type:"string",maxLength:255},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"}}}}get id(){return this._props.id}get name(){return this._props.name}get description(){return this._props.description||null}get created(){return this._props.created||null}get modified(){return this._props.modified||null}isAdmin(){return this.name===oe.ROLE_ADMIN}static get ENTITY_NAME(){return"Role"}static get ROLE_ADMIN(){return"admin"}static get ROLE_USER(){return"user"}static get ROLE_GUEST(){return"guest"}static get ROLE_ROOT(){return"root"}}const le=oe;class ce{static canRoleUseUiAction(e,t,a){if(window.chrome?.webview){const s=t.findRbacByActionName(a);return this.getByRbacOrDefault(s,a,e)}const s=new le(e.role);if(s.isAdmin())return B.getDefaultForAdminAndUiAction(a).execute();const n=t.findRbacByRoleAndUiActionName(s,a);return this.getByRbacOrDefault(n,a,e)}static getByRbacOrDefault(e,t,a){return e?B.getByRbac(e).execute(a):B.getDefaultForUserAndUiAction(t).execute()}}function me(){return me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},me.apply(null,arguments)}const de=s.createContext({canIUseUiAction:()=>{}});class pe extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{canIUseUiAction:this.canIUseUiAction.bind(this)}}canIUseUiAction(e){return ce.canRoleUseUiAction(this.props.context.loggedInUser,this.props.context.rbacs,e)}render(){return s.createElement(de.Provider,{value:this.state},this.props.children)}}pe.propTypes={context:r().any,children:r().any};const ue=I(pe);function he(e){return class extends s.Component{render(){return s.createElement(de.Consumer,null,(t=>s.createElement(e,me({rbacContext:t},this.props))))}}}function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ge.apply(null,arguments)}const be=s.createContext({selectedAdministration:null,can:{save:!1},must:{save:!1,editSubscriptionKey:!1,refreshSubscriptionKey:!1},administrationWorkspaceAction:null,setDisplayAdministrationWorkspaceAction:()=>{},resetDisplayAdministrationWorkspaceAction:()=>{},onUpdateSubscriptionKeyRequested:()=>{},onSaveEnabled:()=>{},onMustSaveSettings:()=>{},onMustEditSubscriptionKey:()=>{},onMustRefreshSubscriptionKey:()=>{},onResetActionsSettings:()=>{}});class ye extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{selectedAdministration:we.NONE,can:{save:!1},must:{save:!1,editSubscriptionKey:!1,refreshSubscriptionKey:!1},administrationWorkspaceAction:()=>s.createElement(s.Fragment,null),setDisplayAdministrationWorkspaceAction:this.setDisplayAdministrationWorkspaceAction.bind(this),resetDisplayAdministrationWorkspaceAction:this.resetDisplayAdministrationWorkspaceAction.bind(this),onUpdateSubscriptionKeyRequested:this.onUpdateSubscriptionKeyRequested.bind(this),onSaveEnabled:this.handleSaveEnabled.bind(this),onMustSaveSettings:this.handleMustSaveSettings.bind(this),onMustEditSubscriptionKey:this.handleMustEditSubscriptionKey.bind(this),onMustRefreshSubscriptionKey:this.handleMustRefreshSubscriptionKey.bind(this),onResetActionsSettings:this.handleResetActionsSettings.bind(this)}}componentDidMount(){this.handleAdministrationMenuRouteChange()}componentDidUpdate(e){this.handleRouteChange(e.location)}handleSaveEnabled(){this.setState({can:{...this.state.can,save:!0}})}handleMustSaveSettings(){this.setState({must:{...this.state.must,save:!0}})}handleMustEditSubscriptionKey(){this.setState({must:{...this.state.must,editSubscriptionKey:!0}})}handleMustRefreshSubscriptionKey(){this.setState({must:{...this.state.must,refreshSubscriptionKey:!0}})}handleResetActionsSettings(){this.setState({must:{save:!1,test:!1,synchronize:!1,editSubscriptionKey:!1,refreshSubscriptionKey:!1}})}handleRouteChange(e){this.props.location.key!==e.key&&this.handleAdministrationMenuRouteChange()}handleAdministrationMenuRouteChange(){const e={can:{save:!1,test:!1,synchronize:!1},must:{save:!1,test:!1,synchronize:!1,editSubscriptionKey:!1,refreshSubscriptionKey:!1}};if(!this.props.rbacContext.canIUseUiAction(j))return e.selectedAdministration=we.HTTP_403_ACCESS_DENIED,void this.setState(e);const t=this.props.location.pathname,a=xe.homePage.test(t),s=xe.mfa.test(t),n=xe.mfaPolicy.test(t),i=xe.passwordPolicies.test(t),r=xe.usersDirectory.test(t),o=xe.emailNotification.test(t),l=xe.subscription.test(t),c=xe.internationalization.test(t),m=xe.accountRecovery.test(t),d=xe.smtpSettings.test(t),p=xe.selfRegistration.test(t),u=xe.sso.test(t),h=xe.rbac.test(t),g=xe.userPassphrasePolicies.test(t),b=xe.passwordExpirySettings.test(t),y=xe.healthcheck.test(t),f=xe.contentTypesEncryptedMetadata.test(t),v=xe.contentTypesMetadataKey.test(t),E=xe.migrateEncryptedMetadata.test(t),w=xe.allowContentTypes.test(t);let k;if(a?k=we.HOME:n?k=we.MFA_POLICY:i?k=we.PASSWORD_POLICIES:s?k=we.MFA:r?k=we.USER_DIRECTORY:o?k=we.EMAIL_NOTIFICATION:l?k=we.SUBSCRIPTION:c?k=we.INTERNATIONALIZATION:m?k=we.ACCOUNT_RECOVERY:d?k=we.SMTP_SETTINGS:p?k=we.SELF_REGISTRATION:u?k=we.SSO:h?k=we.RBAC:g?k=we.USER_PASSPHRASE_POLICIES:b?k=we.PASSWORD_EXPIRY:y?k=we.HEALTHCHECK:f?k=we.CONTENT_TYPES_ENCRYPTED_METADATA:v?k=we.CONTENT_TYPES_METADATA_KEY:E?k=we.MIGRATE_METADATA:w&&(k=we.ALLOW_CONTENT_TYPES),!k)return e.selectedAdministration=we.HTTP_404_NOT_FOUND,void this.setState(e);const x=ke?.[k];e.selectedAdministration=x&&!this.props.context.siteSettings.canIUse(x)?we.HTTP_404_NOT_FOUND:k,this.setState(e)}setDisplayAdministrationWorkspaceAction(e){this.setState({administrationWorkspaceAction:e})}resetDisplayAdministrationWorkspaceAction(){this.setState({administrationWorkspaceAction:()=>s.createElement(s.Fragment,null)})}onUpdateSubscriptionKeyRequested(e){return this.props.context.port.request("passbolt.subscription.update",e)}render(){return s.createElement(be.Provider,{value:this.state},this.props.children)}}ye.displayName="AdministrationWorkspaceContextProvider",ye.propTypes={context:r().object,children:r().any,location:r().object,match:r().object,history:r().object,loadingContext:r().object,rbacContext:r().object};const fe=(0,S.y)(I(he((ve=ye,class extends s.Component{render(){return s.createElement(T.Consumer,null,(e=>s.createElement(ve,A({loadingContext:e},this.props))))}}))));var ve;function Ee(e){return class extends s.Component{render(){return s.createElement(be.Consumer,null,(t=>s.createElement(e,ge({administrationWorkspaceContext:t},this.props))))}}}const we={NONE:"NONE",HOME:"HOME",MFA:"MFA",MFA_POLICY:"MFA-POLICY",PASSWORD_POLICIES:"PASSWORD-POLICIES",USER_DIRECTORY:"USER-DIRECTORY",EMAIL_NOTIFICATION:"EMAIL-NOTIFICATION",SUBSCRIPTION:"SUBSCRIPTION",INTERNATIONALIZATION:"INTERNATIONALIZATION",ACCOUNT_RECOVERY:"ACCOUNT-RECOVERY",SMTP_SETTINGS:"SMTP-SETTINGS",SELF_REGISTRATION:"SELF-REGISTRATION",SSO:"SSO",RBAC:"RBAC",USER_PASSPHRASE_POLICIES:"USER-PASSPHRASE-POLICIES",PASSWORD_EXPIRY:"PASSWORD-EXPIRY",HTTP_403_ACCESS_DENIED:"403-ACCESS-DENIED",HTTP_404_NOT_FOUND:"404-NOT-FOUND",HEALTHCHECK:"HEALTHCHECK",CONTENT_TYPES_ENCRYPTED_METADATA:"CONTENT_TYPES_ENCRYPTED_METADATA",CONTENT_TYPES_METADATA_KEY:"CONTENT_TYPES_METADATA_KEY",MIGRATE_METADATA:"MIGRATE_METADATA",ALLOW_CONTENT_TYPES:"ALLOW_CONTENT_TYPES"},ke={[we.MFA]:"multiFactorAuthentication",[we.MFA_POLICY]:"mfaPolicies",[we.PASSWORD_POLICIES]:"passwordPoliciesUpdate",[we.USER_DIRECTORY]:"directorySync",[we.SUBSCRIPTION]:"ee",[we.INTERNATIONALIZATION]:"locale",[we.ACCOUNT_RECOVERY]:"accountRecovery",[we.SMTP_SETTINGS]:"smtpSettings",[we.SELF_REGISTRATION]:"selfRegistration",[we.SSO]:"sso",[we.RBAC]:"rbacs",[we.USER_PASSPHRASE_POLICIES]:"userPassphrasePolicies",[we.PASSWORD_EXPIRY]:"passwordExpiry",[we.HEALTHCHECK]:"healthcheckUi",[we.CONTENT_TYPES_ENCRYPTED_METADATA]:"metadata",[we.CONTENT_TYPES_METADATA_KEY]:"metadata",[we.MIGRATE_METADATA]:"metadata",[we.ALLOW_CONTENT_TYPES]:"metadata"},xe={homePage:/^\/app\/administration\/?$/,mfa:/^\/app\/administration\/mfa\/?$/,mfaPolicy:/^\/app\/administration\/mfa-policy\/?$/,passwordPolicies:/^\/app\/administration\/password-policies\/?$/,usersDirectory:/^\/app\/administration\/users-directory\/?$/,emailNotification:/^\/app\/administration\/email-notification\/?$/,subscription:/^\/app\/administration\/subscription\/?$/,internationalization:/^\/app\/administration\/internationalization\/?$/,accountRecovery:/^\/app\/administration\/account-recovery\/?$/,smtpSettings:/^\/app\/administration\/smtp-settings\/?$/,selfRegistration:/^\/app\/administration\/self-registration\/?$/,sso:/^\/app\/administration\/sso\/?$/,rbac:/^\/app\/administration\/rbacs\/?$/,userPassphrasePolicies:/^\/app\/administration\/user-passphrase-policies\/?$/,passwordExpirySettings:/^\/app\/administration\/password-expiry\/?$/,healthcheck:/^\/app\/administration\/healthcheck\/?$/,contentTypesEncryptedMetadata:/^\/app\/administration\/content-types\/metadata\/?$/,contentTypesMetadataKey:/^\/app\/administration\/content-types\/metadata-key\/?$/,migrateEncryptedMetadata:/^\/app\/administration\/migrate-metadata\/?$/,allowContentTypes:/^\/app\/administration\/allow-content-types\/?$/};function Ce(){return Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ce.apply(null,arguments)}class Se extends s.Component{constructor(e){super(e),this.bindCallback()}bindCallback(){this.close=this.close.bind(this)}async close(e){const t=this.props.dialogContext.dialogs.find((({key:t})=>t===e));t?.DialogProps?.onClose&&t.DialogProps.onClose(),this.props.dialogContext.close(e)}render(){return s.createElement(s.Fragment,null,this.props.dialogContext.dialogs.map((({key:e,Dialog:t,DialogProps:a})=>s.createElement(t,Ce({key:e},a,{onClose:()=>this.close(e)})))),this.props.children)}}Se.propTypes={dialogContext:r().any,children:r().any};const _e=g(Se);function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ne.apply(null,arguments)}class Ie extends s.Component{constructor(e){super(e),this.createRefs(),this.bindCallback()}bindCallback(){this.handleHide=this.handleHide.bind(this)}createRefs(){this.elementRef=s.createRef()}handleHide(e){this.props.contextualMenuContext.hide(e)}render(){return s.createElement("div",{ref:this.elementRef},this.props.contextualMenuContext.contextualMenus.map(((e,t)=>s.createElement(e.ContextualMenuComponent,Ne({key:t,hide:()=>this.handleHide(t)},e.componentProps)))))}}Ie.propTypes={contextualMenuContext:r().any};const Pe=function(e){return class extends s.Component{render(){return s.createElement(y.Consumer,null,(t=>s.createElement(e,b({contextualMenuContext:t},this.props))))}}}(Ie);function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ae.apply(null,arguments)}const Te=s.createContext({onGoToAdministrationRequested:()=>{},onGoToAdministrationSelfRegistrationRequested:()=>{},onGoToAdministrationMfaRequested:()=>{},onGoToAdministrationUsersDirectoryRequested:()=>{},onGoToAdministrationEmailNotificationsRequested:()=>{},onGoToAdministrationSubscriptionRequested:()=>{},onGoToAdministrationInternationalizationRequested:()=>{},onGoToAdministrationAccountRecoveryRequested:()=>{},onGoToAdministrationSmtpSettingsRequested:()=>{},onGoToAdministrationSsoRequested:()=>{},onGoToAdministrationPasswordPoliciesRequested:()=>{},onGoToAdministrationUserPassphrasePoliciesRequested:()=>{},onGoToAdministrationPasswordExpirySettingsRequested:()=>{},onGoToAdministrationHealthcheckRequested:()=>{},onGoToPasswordsRequested:()=>{},onGoToUsersRequested:()=>{},onGoToHelpRequested:()=>{},onGoToUserSettingsProfileRequested:()=>{},onGoToUserSettingsPassphraseRequested:()=>{},onGoToUserSettingsSecurityTokenRequested:()=>{},onGoToUserSettingsThemeRequested:()=>{},onGoToUserSettingsMfaRequested:()=>{},onGoToUserSettingsKeysRequested:()=>{},onGoToUserSettingsMobileRequested:()=>{},onGoToUserSettingsDesktopRequested:()=>{},onGoToUserSettingsAccountRecoveryRequested:()=>{},onGoToNewTab:()=>{},onGoToAdministrationRbacsRequested:()=>{},onGoToAdministrationMigrateMetadataRequested:()=>{},onGoToAdministrationAllowContentTypesRequested:()=>{}});class Re extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{onGoToNewTab:this.onGoToNewTab.bind(this),onGoToAdministrationRequested:this.onGoToAdministrationRequested.bind(this),onGoToAdministrationMfaRequested:this.onGoToAdministrationMfaRequested.bind(this),onGoToAdministrationUsersDirectoryRequested:this.onGoToAdministrationUsersDirectoryRequested.bind(this),onGoToAdministrationEmailNotificationsRequested:this.onGoToAdministrationEmailNotificationsRequested.bind(this),onGoToAdministrationSubscriptionRequested:this.onGoToAdministrationSubscriptionRequested.bind(this),onGoToAdministrationInternationalizationRequested:this.onGoToAdministrationInternationalizationRequested.bind(this),onGoToAdministrationAccountRecoveryRequested:this.onGoToAdministrationAccountRecoveryRequested.bind(this),onGoToAdministrationSmtpSettingsRequested:this.onGoToAdministrationSmtpSettingsRequested.bind(this),onGoToAdministrationSelfRegistrationRequested:this.onGoToAdministrationSelfRegistrationRequested.bind(this),onGoToAdministrationSsoRequested:this.onGoToAdministrationSsoRequested.bind(this),onGoToAdministrationMfaPolicyRequested:this.onGoToAdministrationMfaPolicyRequested.bind(this),onGoToAdministrationPasswordPoliciesRequested:this.onGoToAdministrationPasswordPoliciesRequested.bind(this),onGoToAdministrationUserPassphrasePoliciesRequested:this.onGoToAdministrationUserPassphrasePoliciesRequested.bind(this),onGoToAdministrationPasswordExpirySettingsRequested:this.onGoToAdministrationPasswordExpirySettingsRequested.bind(this),onGoToAdministrationHealthcheckRequested:this.onGoToAdministrationHealthcheckRequested.bind(this),onGoToAdministrationContentTypesEncryptedMetadataRequested:this.onGoToAdministrationContentTypesEncryptedMetadataRequested.bind(this),onGoToAdministrationContentTypesMetadataKeyRequested:this.onGoToAdministrationContentTypesMetadataKeyRequested.bind(this),onGoToAdministrationMigrateMetadataRequested:this.onGoToAdministrationMigrateMetadataRequested.bind(this),onGoToAdministrationAllowContentTypesRequested:this.onGoToAdministrationAllowContentTypesRequested.bind(this),onGoToPasswordsRequested:this.onGoToPasswordsRequested.bind(this),onGoToUsersRequested:this.onGoToUsersRequested.bind(this),onGoToHelpRequested:this.onGoToHelpRequested.bind(this),onGoToUserSettingsProfileRequested:this.onGoToUserSettingsProfileRequested.bind(this),onGoToUserSettingsPassphraseRequested:this.onGoToUserSettingsPassphraseRequested.bind(this),onGoToUserSettingsSecurityTokenRequested:this.onGoToUserSettingsSecurityTokenRequested.bind(this),onGoToUserSettingsThemeRequested:this.onGoToUserSettingsThemeRequested.bind(this),onGoToUserSettingsMfaRequested:this.onGoToUserSettingsMfaRequested.bind(this),onGoToUserSettingsKeysRequested:this.onGoToUserSettingsKeysRequested.bind(this),onGoToUserSettingsMobileRequested:this.onGoToUserSettingsMobileRequested.bind(this),onGoToUserSettingsDesktopRequested:this.onGoToUserSettingsDesktopRequested.bind(this),onGoToUserSettingsAccountRecoveryRequested:this.onGoToUserSettingsAccountRecoveryRequested.bind(this),onGoToAdministrationRbacsRequested:this.onGoToAdministrationRbacsRequested.bind(this)}}async goTo(e,t){if(e===this.props.context.name)await this.props.history.push({pathname:t});else{const e=`${this.props.context.userSettings?this.props.context.userSettings.getTrustedDomain():this.props.context.trustedDomain}${t}`;window.open(e,"_parent","noopener,noreferrer")}}onGoToNewTab(e){window.open(e,"_blank","noopener,noreferrer")}async onGoToAdministrationRequested(){await this.goTo("browser-extension","/app/administration")}async onGoToAdministrationMfaRequested(){await this.goTo("api","/app/administration/mfa")}async onGoToAdministrationMfaPolicyRequested(){await this.goTo("api","/app/administration/mfa-policy")}async onGoToAdministrationPasswordPoliciesRequested(){await this.goTo("browser-extension","/app/administration/password-policies")}async onGoToAdministrationSelfRegistrationRequested(){await this.goTo("api","/app/administration/self-registration")}async onGoToAdministrationUsersDirectoryRequested(){await this.goTo("api","/app/administration/users-directory")}async onGoToAdministrationHealthcheckRequested(){await this.goTo("api","/app/administration/healthcheck")}async onGoToAdministrationEmailNotificationsRequested(){await this.goTo("api","/app/administration/email-notification")}async onGoToAdministrationSmtpSettingsRequested(){await this.goTo("api","/app/administration/smtp-settings")}async onGoToAdministrationSubscriptionRequested(){await this.goTo("browser-extension","/app/administration/subscription")}async onGoToAdministrationInternationalizationRequested(){await this.goTo("api","/app/administration/internationalization")}async onGoToAdministrationAccountRecoveryRequested(){await this.goTo("browser-extension","/app/administration/account-recovery")}async onGoToAdministrationSsoRequested(){await this.goTo("browser-extension","/app/administration/sso")}async onGoToAdministrationRbacsRequested(){await this.goTo("api","/app/administration/rbacs")}async onGoToAdministrationUserPassphrasePoliciesRequested(){await this.goTo("browser-extension","/app/administration/user-passphrase-policies")}async onGoToAdministrationPasswordExpirySettingsRequested(){await this.goTo("browser-extension","/app/administration/password-expiry")}async onGoToAdministrationContentTypesEncryptedMetadataRequested(){await this.goTo("browser-extension","/app/administration/content-types/metadata")}async onGoToAdministrationContentTypesMetadataKeyRequested(){await this.goTo("browser-extension","/app/administration/content-types/metadata-key")}async onGoToAdministrationMigrateMetadataRequested(){await this.goTo("browser-extension","/app/administration/migrate-metadata")}async onGoToAdministrationAllowContentTypesRequested(){await this.goTo("browser-extension","/app/administration/allow-content-types")}get isMfaEnabled(){const e=this.props.context.siteSettings;return e&&e.canIUse("multiFactorAuthentication")}get isUserDirectoryEnabled(){const e=this.props.context.siteSettings;return e&&e.canIUse("directorySync")}get isSmtpSettingsEnable(){const e=this.props.context.siteSettings;return e&&e.canIUse("smtpSettings")}get isSelfRegistrationEnable(){const e=this.props.context.siteSettings;return e&&e.canIUse("selfRegistration")}get isPasswordPoliciesEnable(){const e=this.props.context.siteSettings;return e&&e.canIUse("passwordPoliciesUpdate")}get isUserPassphrasePoliciesEnable(){const e=this.props.context.siteSettings;return e&&e.canIUse("userPassphrasePolicies")}get isPasswordExpiryEnable(){const e=this.props.context.siteSettings;return e&&e.canIUse("passwordExpiry")}async onGoToPasswordsRequested(){await this.goTo("browser-extension","/app/passwords")}async onGoToUsersRequested(){await this.goTo("browser-extension","/app/users")}async onGoToHelpRequested(){await this.onGoToNewTab("https://www.passbolt.com/docs/")}async onGoToUserSettingsProfileRequested(){await this.goTo("browser-extension","/app/settings/profile")}async onGoToUserSettingsPassphraseRequested(){await this.goTo("browser-extension","/app/settings/passphrase")}async onGoToUserSettingsSecurityTokenRequested(){await this.goTo("browser-extension","/app/settings/security-token")}async onGoToUserSettingsThemeRequested(){await this.goTo("browser-extension","/app/settings/theme")}async onGoToUserSettingsMfaRequested(){await this.goTo("browser-extension","/app/settings/mfa")}async onGoToUserSettingsDuoSetupRequested(){let e="api";window.chrome?.webview&&(e="browser-extension"),await this.goTo(e,"/app/settings/mfa")}async onGoToUserSettingsKeysRequested(){await this.goTo("browser-extension","/app/settings/keys")}async onGoToUserSettingsMobileRequested(){await this.goTo("browser-extension","/app/settings/mobile")}async onGoToUserSettingsDesktopRequested(){await this.goTo("browser-extension","/app/settings/desktop")}async onGoToUserSettingsAccountRecoveryRequested(){await this.goTo("browser-extension","/app/settings/account-recovery")}render(){return s.createElement(Te.Provider,{value:this.state},this.props.children)}}Re.displayName="NavigationContextProvider",Re.propTypes={context:r().object,children:r().any,location:r().object,match:r().object,history:r().object};const De=(0,S.y)(I(Re));function Oe(e){return class extends s.Component{render(){return s.createElement(Te.Consumer,null,(t=>s.createElement(e,Ae({navigationContext:t},this.props))))}}}function Ue(){return Ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ue.apply(null,arguments)}const Me=s.createContext({accountRecoveryOrganizationPolicy:null,status:null,isDataLoaded:!1,findAccountRecoveryPolicy:()=>{},getOrganizationPolicy:()=>{},getRequestor:()=>{},getRequestedDate:()=>{},getPolicy:()=>{},getUserAccountRecoverySubscriptionStatus:()=>{},isAccountRecoveryChoiceRequired:()=>{},isPolicyEnabled:()=>{},loadAccountRecoveryPolicy:()=>{},reloadAccountRecoveryPolicy:()=>{},isReady:()=>{}});class Fe extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{accountRecoveryOrganizationPolicy:null,status:null,isDataLoaded:!1,findAccountRecoveryPolicy:this.findAccountRecoveryPolicy.bind(this),getOrganizationPolicy:this.getOrganizationPolicy.bind(this),getRequestor:this.getRequestor.bind(this),getRequestedDate:this.getRequestedDate.bind(this),getPolicy:this.getPolicy.bind(this),getUserAccountRecoverySubscriptionStatus:this.getUserAccountRecoverySubscriptionStatus.bind(this),setUserAccountRecoveryStatus:this.setUserAccountRecoveryStatus.bind(this),isAccountRecoveryChoiceRequired:this.isAccountRecoveryChoiceRequired.bind(this),isPolicyEnabled:this.isPolicyEnabled.bind(this),loadAccountRecoveryPolicy:this.loadAccountRecoveryPolicy.bind(this),reloadAccountRecoveryPolicy:this.reloadAccountRecoveryPolicy.bind(this),isReady:this.isReady.bind(this)}}async loadAccountRecoveryPolicy(){this.state.isDataLoaded||await this.findAccountRecoveryPolicy()}async reloadAccountRecoveryPolicy(){await this.findAccountRecoveryPolicy()}async findAccountRecoveryPolicy(){if(!this.props.context.siteSettings.canIUse("accountRecovery"))return;const e=this.props.context.loggedInUser;if(!e)return;const t=await this.props.accountRecoveryUserService.getOrganizationAccountRecoverySettings(),a=e.account_recovery_user_setting?.status||Fe.STATUS_PENDING;this.setState({accountRecoveryOrganizationPolicy:t,status:a,isDataLoaded:!0})}isReady(){return this.state.isDataLoaded}getOrganizationPolicy(){return this.state.accountRecoveryOrganizationPolicy}getRequestedDate(){return this.getOrganizationPolicy()?.modified}getRequestor(){return this.getOrganizationPolicy()?.creator}getPolicy(){return this.getOrganizationPolicy()?.policy}getUserAccountRecoverySubscriptionStatus(){return this.state.status}setUserAccountRecoveryStatus(e){this.setState({status:e})}isAccountRecoveryChoiceRequired(){if(null===this.getOrganizationPolicy())return!1;const e=this.getPolicy();return this.state.status===Fe.STATUS_PENDING&&e!==Fe.POLICY_DISABLED}isPolicyEnabled(){const e=this.getPolicy();return e&&e!==Fe.POLICY_DISABLED}static get STATUS_PENDING(){return"pending"}static get POLICY_DISABLED(){return"disabled"}static get POLICY_MANDATORY(){return"mandatory"}static get POLICY_OPT_OUT(){return"opt-out"}static get STATUS_APPROVED(){return"approved"}render(){return s.createElement(Me.Provider,{value:this.state},this.props.children)}}Fe.propTypes={context:r().any.isRequired,children:r().any,accountRecoveryUserService:r().object.isRequired};const je=I(Fe);function ze(e){return class extends s.Component{render(){return s.createElement(Me.Consumer,null,(t=>s.createElement(e,Ue({accountRecoveryContext:t},this.props))))}}}var Le,qe,Ke;function We(){return We=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},We.apply(null,arguments)}const Ve=function(e){return s.createElement("svg",We({xmlns:"http://www.w3.org/2000/svg",width:42,height:42,fill:"none",viewBox:"0 0 42 42"},e),Le||(Le=s.createElement("circle",{id:"background",cx:21,cy:21,r:21,fill:"var(--Avatar-Avatar-background)"})),qe||(qe=s.createElement("path",{fill:"var(--Avatar-Avatar)",d:"M27.184 26.54H14.852a7.36 7.36 0 0 0-5.362 2.2 7.4 7.4 0 0 0-2.216 5.36v1.145a19.66 19.66 0 0 0 13.672 5.522 19.66 19.66 0 0 0 13.673-5.522V34.1a7.38 7.38 0 0 0-2.199-5.362 7.38 7.38 0 0 0-5.236-2.198"})),Ke||(Ke=s.createElement("circle",{cx:21,cy:15.5,r:7.5,fill:"var(--Avatar-Avatar)"})))};var Be;function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ge.apply(null,arguments)}const $e=function(e){return s.createElement("svg",Ge({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Be||(Be=s.createElement("g",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#attention_svg__clip0_2062_453107)"},s.createElement("path",{fill:"var(--icon-exclamation-background-color)",stroke:"var(--icon-exclamation-border-color)",d:"M9 16.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15"}),s.createElement("path",{stroke:"var(--icon-exclamation-color)",d:"M9 6v3M9 12h.008"}))))},He=/img\/avatar\/user(_medium)?\.png$/;class Ye extends s.Component{constructor(e){super(e),this.state=this.getDefaultState(),this.bindCallbacks()}getDefaultState(){return{error:!1,isLoading:!0}}bindCallbacks(){this.handleError=this.handleError.bind(this),this.handleLoaded=this.handleLoaded.bind(this)}get avatarUrl(){return this.props?.user?.profile?.avatar?.url?.medium}propsHasUrl(){return Boolean(this.avatarUrl)}propsUrlHasProtocol(){return this.avatarUrl.startsWith("https://")||this.avatarUrl.startsWith("http://")}formatUrl(e){return`${this.props.baseUrl}/${e}`}isDefaultAvatarUrlFromApi(){return He.test(this.avatarUrl)}getAvatarSrc(){return this.propsHasUrl()?this.propsUrlHasProtocol()?this.avatarUrl:this.formatUrl(this.avatarUrl):null}handleError(){console.error(`Could not load avatar image url: ${this.getAvatarSrc()}`),this.setState({error:!0})}handleLoaded(){this.setState({isLoading:!1})}getAltText(){const e=this.props?.user;return e?.first_name&&e?.last_name?this.props.t("Avatar of user {{first_name}} {{last_name}}.",{firstname:e.first_name,lastname:e.last_name}):"..."}render(){const e=this.getAvatarSrc(),t=this.state.error||this.isDefaultAvatarUrlFromApi()||!e;return s.createElement("div",{className:`${this.props.className}`},s.createElement("div",{className:"default-avatar"},(t||this.state.isLoading)&&s.createElement(Ve,null),!t&&s.createElement("img",{src:e,className:this.state.isLoading?"is-loading":"",onError:this.handleError,onLoad:this.handleLoaded,alt:this.getAltText()})),this.props.attentionRequired&&s.createElement($e,{className:"attention-required"}))}}Ye.defaultProps={className:"avatar user-avatar"},Ye.propTypes={baseUrl:r().string,user:r().object,attentionRequired:r().bool,className:r().string,t:r().func};const Je=(0,v.CI)("common")(Ye);function Ze(){return Ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ze.apply(null,arguments)}const Qe="Overview",Xe=s.createContext({state:null,setup:null,provider:null,getPolicy:()=>{},getMfaOrganisationSettings:()=>{},getMfaUserSettings:()=>{},findPolicy:()=>{},setProcessing:()=>{},isProcessing:()=>{},clearContext:()=>{},isMfaChoiceRequired:()=>{},checkMfaChoiceRequired:()=>{},hasMfaUserSettings:()=>{},navigate:()=>{},setProvider:()=>{},goToProviderList:()=>{},validateTotpCode:()=>{},removeProvider:()=>{},validateYubikeyCode:()=>{}});class et extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{state:Qe,setup:null,policy:null,provider:null,processing:!0,mfaUserSettings:null,mfaOrganisationSettings:null,mfaChoiceRequired:!1,getPolicy:this.getPolicy.bind(this),getMfaOrganisationSettings:this.getMfaOrganisationSettings.bind(this),getMfaUserSettings:this.getMfaUserSettings.bind(this),findPolicy:this.findPolicy.bind(this),findMfaSettings:this.findMfaSettings.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),hasMfaSettings:this.hasMfaSettings.bind(this),hasMfaOrganisationSettings:this.hasMfaOrganisationSettings.bind(this),hasMfaUserSettings:this.hasMfaUserSettings.bind(this),clearContext:this.clearContext.bind(this),checkMfaChoiceRequired:this.checkMfaChoiceRequired.bind(this),isMfaChoiceRequired:this.isMfaChoiceRequired.bind(this),navigate:this.navigate.bind(this),setProvider:this.setProvider.bind(this),goToProviderList:this.goToProviderList.bind(this),validateTotpCode:this.validateTotpCode.bind(this),removeProvider:this.removeProvider.bind(this),validateYubikeyCode:this.validateYubikeyCode.bind(this)}}async findPolicy(){if(this.getPolicy())return;this.setProcessing(!0);let e=null;const t=await this.props.context.port.request("passbolt.mfa-policy.get-policy");e=t?t.policy:null,this.setState({policy:e}),this.setProcessing(!1)}async findMfaSettings(){this.setProcessing(!0);let e=null,t=null;const a=await this.props.context.port.request("passbolt.mfa-policy.get-mfa-settings");e=a.MfaAccountSettings,t=a.MfaOrganizationSettings,this.setState({mfaUserSettings:e}),this.setState({mfaOrganisationSettings:t}),this.setProcessing(!1)}getPolicy(){return this.state.policy}getMfaOrganisationSettings(){return this.state.mfaOrganisationSettings}getMfaUserSettings(){return this.state.mfaUserSettings}hasMfaSettings(){return!this.hasMfaOrganisationSettings()||this.hasMfaUserSettings()}hasMfaOrganisationSettings(){return this.state.mfaOrganisationSettings&&Object.values(this.state.mfaOrganisationSettings).some((e=>e))}hasMfaUserSettings(){return this.state.mfaUserSettings&&Object.values(this.state.mfaUserSettings).some((e=>e))}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}clearContext(){const{policy:e,processing:t}=this.defaultState;this.setState({policy:e,processing:t})}async checkMfaChoiceRequired(){if(await this.findPolicy(),null===this.getPolicy()||"mandatory"!==this.getPolicy())return!1;await this.findMfaSettings(),this.setState({mfaChoiceRequired:!this.hasMfaSettings()})}isMfaChoiceRequired(){return this.state.mfaChoiceRequired}navigate(e){this.setState({state:e})}goToProviderList(){this.setState({state:Qe,provider:null})}setProvider(e){this.setState({provider:e})}async validateTotpCode(e,t){try{this.setProcessing(!0),await this.props.context.port.request("passbolt.mfa-setup.verify-totp-code",{otpProvisioningUri:e,totp:t})}catch(e){throw console.error(e),e}finally{this.setProcessing(!1)}}async validateYubikeyCode(e){try{this.setProcessing(!0),await this.props.context.port.request("passbolt.mfa-setup.verify-yubikey-code",{hotp:e})}catch(e){throw console.error(e),e}finally{this.setProcessing(!1)}}async removeProvider(){try{this.setProcessing(!0),await this.props.context.port.request("passbolt.mfa-setup.remove-provider",{provider:this.state.provider})}catch(e){throw console.error(e),e}finally{this.setProcessing(!1)}}render(){return s.createElement(Xe.Provider,{value:this.state},this.props.children)}}et.propTypes={context:r().any,children:r().any};const tt=I(et);var at,st,nt;function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},it.apply(null,arguments)}const rt=function(e){return s.createElement("svg",it({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),at||(at=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12.75 13.5a1.5 1.5 0 0 0-1.5-1.5h-4.5a1.5 1.5 0 0 0-1.5 1.5"})),st||(st=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M14.25 3H3.75a1.5 1.5 0 0 0-1.5 1.5V15a1.5 1.5 0 0 0 1.5 1.5h10.5a1.5 1.5 0 0 0 1.5-1.5V4.5a1.5 1.5 0 0 0-1.5-1.5"})),nt||(nt=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3M6 1.5V3M12 1.5V3"})))};var ot;function lt(){return lt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},lt.apply(null,arguments)}const ct=function(e){return s.createElement("svg",lt({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),ot||(ot=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.75 15.75h-3a1.5 1.5 0 0 1-1.5-1.5V3.75a1.5 1.5 0 0 1 1.5-1.5h3M12 12.75 15.75 9 12 5.25M15.75 9h-9"})))};var mt;function dt(){return dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},dt.apply(null,arguments)}const pt=function(e){return s.createElement("svg",dt({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),mt||(mt=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m12 4-8 8M4 4l8 8"})))};class ut extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleCloseClick=this.handleCloseClick.bind(this)}handleCloseClick(){this.props.onClose()}render(){return s.createElement("button",{type:"button",disabled:this.props.disabled,className:"dialog-close button button-transparent",onClick:this.handleCloseClick},s.createElement(pt,{className:"svg-icon close"}),s.createElement("span",{className:"visually-hidden"},s.createElement(v.x6,null,"Close")))}}ut.propTypes={onClose:r().func,disabled:r().bool};const ht=(0,v.CI)("common")(ut);class gt extends s.Component{render(){return s.createElement("div",{className:"tooltip",tabIndex:"0"},this.props.children,s.createElement("span",{className:`tooltip-text ${this.props.direction}`},this.props.message))}}gt.defaultProps={direction:"right"},gt.propTypes={children:r().any,message:r().any.isRequired,direction:r().string};const bt=gt;var yt;function ft(){return ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ft.apply(null,arguments)}const vt=function(e){return s.createElement("svg",ft({xmlns:"http://www.w3.org/2000/svg",width:17,height:18,fill:"none",viewBox:"0 0 17 18"},e),yt||(yt=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8.5 16.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15M8.5 12V9M8.5 6h.008"})))};class Et extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleKeyDown=this.handleKeyDown.bind(this),this.handleClose=this.handleClose.bind(this)}handleKeyDown(e){27===e.keyCode&&this.handleClose()}handleClose(){this.props.disabled||this.props.onClose()}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown,{capture:!1})}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown,{capture:!1})}render(){return s.createElement("div",{className:`${this.props.className} dialog-wrapper`},s.createElement("div",{className:"dialog"},s.createElement("div",{className:"dialog-header"},s.createElement("div",{className:"dialog-title-wrapper"},s.createElement("h2",null,s.createElement("span",{className:"dialog-header-title"},this.props.title),this.props.subtitle&&s.createElement("span",{className:"dialog-header-subtitle"},this.props.subtitle)),this.props.tooltip&&""!==this.props.tooltip&&s.createElement(bt,{message:this.props.tooltip},s.createElement(vt,null))),s.createElement(ht,{onClose:this.handleClose,disabled:this.props.disabled})),s.createElement("div",{className:"dialog-content"},this.props.children)))}}Et.propTypes={children:r().node,className:r().string,title:r().oneOfType([r().arrayOf(r().node),r().node,r().string]),subtitle:r().string,tooltip:r().string,disabled:r().bool,onClose:r().func};const wt=Et;var kt;function xt(){return xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},xt.apply(null,arguments)}const Ct=function(e){return s.createElement("svg",xt({xmlns:"http://www.w3.org/2000/svg",width:10,height:8,fill:"none",viewBox:"0 0 10 8"},e),kt||(kt=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m1 2 4 4 4-4"})))};var St;function _t(){return _t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},_t.apply(null,arguments)}const Nt=function(e){return s.createElement("svg",_t({xmlns:"http://www.w3.org/2000/svg",width:8,height:10,fill:"none",viewBox:"0 0 8 10"},e),St||(St=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m2 9 4-4-4-4"})))};class It extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{showErrorDetails:!1}}bindCallbacks(){this.handleKeyDown=this.handleKeyDown.bind(this),this.handleErrorDetailsToggle=this.handleErrorDetailsToggle.bind(this)}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown,{capture:!0})}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown,{capture:!0})}getTitle(){return this.props.title?this.props.title:this.props.t("There was an unexpected error...")}getMessage(){return this.props.error.message}handleKeyDown(e){27!==e.keyCode&&13!==e.keyCode||(e.stopPropagation(),this.props.onClose())}handleErrorDetailsToggle(){this.setState({showErrorDetails:!this.state.showErrorDetails})}get hasErrorDetails(){return Boolean(this.props.error.data?.body)||Boolean(this.props.error.details)}formatErrors(){const e=this.props.error?.details||this.props.error?.data;return JSON.stringify(e,null,4)}render(){return s.createElement(wt,{className:"dialog-wrapper error-dialog",onClose:this.props.onClose,title:this.getTitle()},s.createElement("div",{className:"form-content"},s.createElement("p",null,this.getMessage()),this.hasErrorDetails&&s.createElement("div",{className:"accordion error-details"},s.createElement("div",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleErrorDetailsToggle},s.createElement("span",null,s.createElement(v.x6,null,"Error details")),this.state.showErrorDetails?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),this.state.showErrorDetails&&s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"input text"},s.createElement("label",{htmlFor:"js_field_debug",className:"visuallyhidden"},s.createElement(v.x6,null,"Error details")),s.createElement("textarea",{id:"js_field_debug",defaultValue:this.formatErrors(),readOnly:!0}))))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("button",{type:"button",className:"button primary warning",onClick:this.props.onClose},"Ok")))}}It.propTypes={title:r().string,error:r().object.isRequired,onClose:r().func,t:r().func};const Pt=(0,v.CI)("common")(It);class At extends s.Component{constructor(e){super(e),this.state=this.getDefaultState(),this.bindCallbacks(),this.createRefs()}getDefaultState(){return{open:!1}}bindCallbacks(){this.handleDocumentClickEvent=this.handleDocumentClickEvent.bind(this),this.handleDocumentContextualMenuEvent=this.handleDocumentContextualMenuEvent.bind(this),this.handleDocumentDragStartEvent=this.handleDocumentDragStartEvent.bind(this),this.handleToggleMenuClick=this.handleToggleMenuClick.bind(this),this.handleProfileClick=this.handleProfileClick.bind(this),this.handleSignOutClick=this.handleSignOutClick.bind(this)}componentDidMount(){document.addEventListener("click",this.handleDocumentClickEvent,{capture:!0}),document.addEventListener("contextmenu",this.handleDocumentContextualMenuEvent,{capture:!0}),document.addEventListener("dragstart",this.handleDocumentDragStartEvent,{capture:!0}),this.props.context.siteSettings.canIUse("mfaPolicies")&&this.props.mfaContext.checkMfaChoiceRequired()}componentWillUnmount(){document.removeEventListener("click",this.handleDocumentClickEvent,{capture:!0}),document.removeEventListener("contextmenu",this.handleDocumentContextualMenuEvent,{capture:!0}),document.removeEventListener("dragstart",this.handleDocumentDragStartEvent,{capture:!0})}createRefs(){this.userBadgeMenuRef=s.createRef()}handleDocumentClickEvent(e){this.userBadgeMenuRef.current.contains(e.target)||this.closeUserBadgeMenu()}handleDocumentContextualMenuEvent(e){this.userBadgeMenuRef.current.contains(e.target)||this.closeUserBadgeMenu()}handleDocumentDragStartEvent(){this.closeUserBadgeMenu()}closeUserBadgeMenu(){this.setState({open:!1})}getUserFullName(){return this.props.user&&this.props.user.profile?`${this.props.user.profile.first_name} ${this.props.user.profile.last_name}`:"..."}getUserUsername(){return this.props.user&&this.props.user.username?`${this.props.user.username}`:"..."}handleToggleMenuClick(e){e.preventDefault();const t=!this.state.open;this.setState({open:t})}handleProfileClick(){this.props.navigationContext.onGoToUserSettingsProfileRequested(),this.closeUserBadgeMenu()}async handleSignOutClick(){try{await this.props.context.onLogoutRequested()}catch(e){this.props.dialogContext.open(Pt,{error:e})}finally{this.closeUserBadgeMenu()}}get attentionRequired(){return this.props.accountRecoveryContext.isAccountRecoveryChoiceRequired()||this.props.mfaContext.isMfaChoiceRequired()}render(){return s.createElement("div",{className:"profile-wrapper"},s.createElement("div",{className:"user profile dropdown",ref:this.userBadgeMenuRef},s.createElement("button",{type:"button",className:"avatar-with-name button avatar-button "+(this.state.open?"open":""),onClick:this.handleToggleMenuClick},s.createElement(Je,{user:this.props.user,baseUrl:this.props.baseUrl,attentionRequired:this.attentionRequired})),this.state.open&&s.createElement("div",{className:"dropdown-content left visible"},s.createElement("button",{className:"button button-transparent user-profile-close",role:"button",onClick:this.handleToggleMenuClick},s.createElement(pt,{className:"svg-icon close"}),s.createElement("span",{className:"visually-hidden"},"Close")),s.createElement(Je,{user:this.props.user,baseUrl:this.props.baseUrl}),s.createElement("div",{className:"informations"},s.createElement("div",{className:"name"},this.getUserFullName()),s.createElement("div",{className:"email"},this.getUserUsername())),s.createElement("div",{className:"manage-account"},s.createElement("button",{className:"button primary",onClick:this.handleProfileClick},s.createElement(rt,null)," ",s.createElement(v.x6,null,"Manage account"),this.attentionRequired&&s.createElement($e,{className:"attention-required"}))),s.createElement("button",{type:"button",className:"no-border sign-out",onClick:this.handleSignOutClick},s.createElement(ct,null),s.createElement(v.x6,null,"Sign out")))))}}At.propTypes={context:r().object,navigationContext:r().any,mfaContext:r().object,accountRecoveryContext:r().object,baseUrl:r().string,user:r().object,rbacContext:r().any,dialogContext:r().object};const Tt=I(he(Oe(g(ze(function(e){return class extends s.Component{render(){return s.createElement(Xe.Consumer,null,(t=>s.createElement(e,Ze({mfaContext:t},this.props))))}}}((0,v.CI)("common")(At)))))));class Rt extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isContentTypesOpened:!0,isPasswordConfigurationOpened:!0,isAuthenticationOpened:!0,isUserProvisionningOpened:!0,isEmailsOpened:!0}}canIUse(e){return Boolean(this.props.context.siteSettings?.canIUse(e))}get isMfaEnabled(){return this.canIUse("multiFactorAuthentication")}get isUserDirectoryEnabled(){return this.canIUse("directorySync")}get canIUseEE(){return this.canIUse("ee")}get canIUseLocale(){return this.canIUse("locale")}get canIUseAccountRecovery(){return this.canIUse("accountRecovery")}get canIUseSmtpSettings(){return this.canIUse("smtpSettings")}get canIUseSelfRegistrationSettings(){return this.canIUse("selfRegistration")}get canIUseSso(){return this.canIUse("sso")}get canIUseMfaPolicy(){return this.canIUse("mfaPolicies")}get canIUsePasswordPolicies(){return this.canIUse("passwordPoliciesUpdate")}get canIUseRbacs(){return this.canIUse("rbacs")}get canIUseUserPassphrasePolicies(){return this.canIUse("userPassphrasePolicies")}get canIUsePasswordExpiry(){return this.canIUse("passwordExpiry")}get canIUseHealthcheck(){return this.canIUse("healthcheckUi")}get canIUseMetadata(){return this.canIUse("metadata")}bindCallbacks(){this.handleHomeClick=this.handleHomeClick.bind(this),this.handleMfaClick=this.handleMfaClick.bind(this),this.handleUserDirectoryClick=this.handleUserDirectoryClick.bind(this),this.handleEmailNotificationsClick=this.handleEmailNotificationsClick.bind(this),this.handleSubscriptionClick=this.handleSubscriptionClick.bind(this),this.handleInternationalizationClick=this.handleInternationalizationClick.bind(this),this.handleAccountRecoveryClick=this.handleAccountRecoveryClick.bind(this),this.handleSmtpSettingsClick=this.handleSmtpSettingsClick.bind(this),this.handleSelfRegistrationClick=this.handleSelfRegistrationClick.bind(this),this.handleSsoClick=this.handleSsoClick.bind(this),this.handleMfaPolicyClick=this.handleMfaPolicyClick.bind(this),this.handleRbacsClick=this.handleRbacsClick.bind(this),this.handlePasswordPoliciesClick=this.handlePasswordPoliciesClick.bind(this),this.handleUserPassphrasePoliciesClick=this.handleUserPassphrasePoliciesClick.bind(this),this.handlePasswordExpirySettingsClick=this.handlePasswordExpirySettingsClick.bind(this),this.handleHealthcheckClick=this.handleHealthcheckClick.bind(this),this.handleContentTypesEncryptedMetadataClick=this.handleContentTypesEncryptedMetadataClick.bind(this),this.handleContentTypesMetadataKeyClick=this.handleContentTypesMetadataKeyClick.bind(this),this.handleMigrateMetadataClick=this.handleMigrateMetadataClick.bind(this),this.handleAllowedContentTypesClick=this.handleAllowedContentTypesClick.bind(this),this.handleSubmenuClick=this.handleSubmenuClick.bind(this)}handleSubmenuClick(e){const t={[e]:!this.state[e]};this.setState(t)}handleHomeClick(){this.props.navigationContext.onGoToAdministrationRequested()}handleMfaClick(){this.props.navigationContext.onGoToAdministrationMfaRequested()}handleUserDirectoryClick(){this.props.navigationContext.onGoToAdministrationUsersDirectoryRequested()}handleEmailNotificationsClick(){this.props.navigationContext.onGoToAdministrationEmailNotificationsRequested()}handleSubscriptionClick(){this.props.navigationContext.onGoToAdministrationSubscriptionRequested()}handleInternationalizationClick(){this.props.navigationContext.onGoToAdministrationInternationalizationRequested()}handleAccountRecoveryClick(){this.props.navigationContext.onGoToAdministrationAccountRecoveryRequested()}handleSmtpSettingsClick(){this.props.navigationContext.onGoToAdministrationSmtpSettingsRequested()}handleSelfRegistrationClick(){this.props.navigationContext.onGoToAdministrationSelfRegistrationRequested()}handleSsoClick(){this.props.navigationContext.onGoToAdministrationSsoRequested()}handleRbacsClick(){this.props.navigationContext.onGoToAdministrationRbacsRequested()}handleMfaPolicyClick(){this.props.navigationContext.onGoToAdministrationMfaPolicyRequested()}handlePasswordPoliciesClick(){this.props.navigationContext.onGoToAdministrationPasswordPoliciesRequested()}handleUserPassphrasePoliciesClick(){this.props.navigationContext.onGoToAdministrationUserPassphrasePoliciesRequested()}handlePasswordExpirySettingsClick(){this.props.navigationContext.onGoToAdministrationPasswordExpirySettingsRequested()}handleHealthcheckClick(){this.props.navigationContext.onGoToAdministrationHealthcheckRequested()}handleContentTypesEncryptedMetadataClick(){this.props.navigationContext.onGoToAdministrationContentTypesEncryptedMetadataRequested()}handleContentTypesMetadataKeyClick(){this.props.navigationContext.onGoToAdministrationContentTypesMetadataKeyRequested()}handleMigrateMetadataClick(){this.props.navigationContext.onGoToAdministrationMigrateMetadataRequested()}handleAllowedContentTypesClick(){this.props.navigationContext.onGoToAdministrationAllowContentTypesRequested()}isHomeSelected(){return we.NONE===this.props.administrationWorkspaceContext.selectedAdministration||we.HOME===this.props.administrationWorkspaceContext.selectedAdministration}isMfaSelected(){return we.MFA===this.props.administrationWorkspaceContext.selectedAdministration}isMfaPolicySelected(){return we.MFA_POLICY===this.props.administrationWorkspaceContext.selectedAdministration}isPasswordPoliciesSelected(){return we.PASSWORD_POLICIES===this.props.administrationWorkspaceContext.selectedAdministration}isUserDirectorySelected(){return we.USER_DIRECTORY===this.props.administrationWorkspaceContext.selectedAdministration}isEmailNotificationsSelected(){return we.EMAIL_NOTIFICATION===this.props.administrationWorkspaceContext.selectedAdministration}isSubscriptionSelected(){return we.SUBSCRIPTION===this.props.administrationWorkspaceContext.selectedAdministration}isInternationalizationSelected(){return we.INTERNATIONALIZATION===this.props.administrationWorkspaceContext.selectedAdministration}isAccountRecoverySelected(){return we.ACCOUNT_RECOVERY===this.props.administrationWorkspaceContext.selectedAdministration}isSsoSelected(){return we.SSO===this.props.administrationWorkspaceContext.selectedAdministration}isRbacSelected(){return we.RBAC===this.props.administrationWorkspaceContext.selectedAdministration}isSmtpSettingsSelected(){return we.SMTP_SETTINGS===this.props.administrationWorkspaceContext.selectedAdministration}isSelfRegistrationSettingsSelected(){return we.SELF_REGISTRATION===this.props.administrationWorkspaceContext.selectedAdministration}isUserPassphrasePoliciesSelected(){return we.USER_PASSPHRASE_POLICIES===this.props.administrationWorkspaceContext.selectedAdministration}isPasswordExpirySettingsSelected(){return we.PASSWORD_EXPIRY===this.props.administrationWorkspaceContext.selectedAdministration}isHealthcheckSelected(){return we.HEALTHCHECK===this.props.administrationWorkspaceContext.selectedAdministration}isContentTypesEncryptedMetadataSelected(){return we.CONTENT_TYPES_ENCRYPTED_METADATA===this.props.administrationWorkspaceContext.selectedAdministration}isContentTypesMetadataKeySelected(){return we.CONTENT_TYPES_METADATA_KEY===this.props.administrationWorkspaceContext.selectedAdministration}isMigrateMetadataSelected(){return we.MIGRATE_METADATA===this.props.administrationWorkspaceContext.selectedAdministration}isAllowedContentTypesSelected(){return we.ALLOW_CONTENT_TYPES===this.props.administrationWorkspaceContext.selectedAdministration}canSeePasswordConfiguration(){return this.canIUsePasswordExpiry||this.canIUsePasswordPolicies}canSeeAuthentication(){return this.canIUseUserPassphrasePolicies||this.canIUseAccountRecovery||this.canIUseSso||this.canIUseMfaPolicy||this.isMfaEnabled}canSeeUserProvisionning(){return this.isUserDirectoryEnabled||this.canIUseSelfRegistrationSettings}render(){return s.createElement("div",{className:"navigation-secondary navigation-administration"},s.createElement("ul",{id:"administration_menu",className:"clearfix menu ready"},s.createElement("li",{id:"home"},s.createElement("div",{className:"row "+(this.isHomeSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleHomeClick},s.createElement("span",null,s.createElement(v.x6,null,"Home"))))))),this.canIUseEE&&s.createElement("li",{id:"subscription_menu"},s.createElement("div",{className:"row "+(this.isSubscriptionSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleSubscriptionClick},s.createElement("span",null,s.createElement(v.x6,null,"Subscription"))))))),this.canIUseMetadata&&s.createElement("li",{id:"content-types",className:"accordion-header"},s.createElement("div",{className:"row"},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:()=>this.handleSubmenuClick("isContentTypesOpened")},this.state.isContentTypesOpened?s.createElement(Ct,null):s.createElement(Nt,null),s.createElement("span",null,s.createElement(v.x6,null,"Content types")))))),this.state.isContentTypesOpened&&s.createElement("ul",{id:"administration-sub-menu-content-type",className:"menu ready"},s.createElement("li",{id:"encrypted_metadata_menu"},s.createElement("div",{className:"row  "+(this.isContentTypesEncryptedMetadataSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleContentTypesEncryptedMetadataClick},s.createElement("span",null,s.createElement(v.x6,null,"Encrypted metadata")),s.createElement("span",{className:"chips beta"},"beta")))))),s.createElement("li",{id:"metadata_key_menu"},s.createElement("div",{className:"row  "+(this.isContentTypesMetadataKeySelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleContentTypesMetadataKeyClick},s.createElement("span",null,s.createElement(v.x6,null,"Metadata key")),s.createElement("span",{className:"chips beta"},"beta")))))),s.createElement("li",{id:"migrate_metadata_menu"},s.createElement("div",{className:"row  "+(this.isMigrateMetadataSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleMigrateMetadataClick},s.createElement("span",null,s.createElement(v.x6,null,"Migrate metadata")),s.createElement("span",{className:"chips beta"},"beta")))))),s.createElement("li",{id:"allowed_content_type_menu"},s.createElement("div",{className:"row  "+(this.isAllowedContentTypesSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleAllowedContentTypesClick},s.createElement("span",null,s.createElement(v.x6,null,"Allow content types")),s.createElement("span",{className:"chips beta"},"beta")))))))),this.canSeePasswordConfiguration()&&s.createElement("li",{id:"password-configuration",className:"accordion-header"},s.createElement("div",{className:"row"},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:()=>this.handleSubmenuClick("isPasswordConfigurationOpened")},this.state.isPasswordConfigurationOpened?s.createElement(Ct,null):s.createElement(Nt,null),s.createElement("span",null,s.createElement(v.x6,null,"Password configuration")))))),this.state.isPasswordConfigurationOpened&&s.createElement("ul",null,this.canIUsePasswordExpiry&&s.createElement("li",{id:"password_expiry_menu"},s.createElement("div",{className:"row "+(this.isPasswordExpirySettingsSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handlePasswordExpirySettingsClick},s.createElement("span",null,s.createElement(v.x6,null,"Password Expiry"))))))),this.canIUsePasswordPolicies&&s.createElement("li",{id:"password_policy_menu"},s.createElement("div",{className:"row "+(this.isPasswordPoliciesSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handlePasswordPoliciesClick},s.createElement("span",null,s.createElement(v.x6,null,"Password Policy"))))))))),this.canSeeAuthentication()&&s.createElement("li",{id:"authentication",className:"accordion-header"},s.createElement("div",{className:"row"},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:()=>this.handleSubmenuClick("isAuthenticationOpened")},this.state.isAuthenticationOpened?s.createElement(Ct,null):s.createElement(Nt,null),s.createElement("span",null,s.createElement(v.x6,null,"Authentication")))))),this.state.isAuthenticationOpened&&s.createElement("ul",null,this.canIUseUserPassphrasePolicies&&s.createElement("li",{id:"user_passphrase_policies_menu"},s.createElement("div",{className:"row "+(this.isUserPassphrasePoliciesSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleUserPassphrasePoliciesClick},s.createElement("span",null,s.createElement(v.x6,null,"User Passphrase Policies"))))))),this.canIUseAccountRecovery&&s.createElement("li",{id:"account_recovery_menu"},s.createElement("div",{className:"row "+(this.isAccountRecoverySelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleAccountRecoveryClick},s.createElement("span",null,s.createElement(v.x6,null,"Account Recovery"))))))),this.canIUseSso&&s.createElement("li",{id:"sso_menu"},s.createElement("div",{className:"row "+(this.isSsoSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleSsoClick},s.createElement("span",null,s.createElement(v.x6,null,"Single Sign-On"))))))),this.canIUseMfaPolicy&&s.createElement("li",{id:"mfa_policy_menu"},s.createElement("div",{className:"row "+(this.isMfaPolicySelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleMfaPolicyClick},s.createElement("span",null,s.createElement(v.x6,null,"MFA Policy"))))))),this.isMfaEnabled&&s.createElement("li",{id:"mfa_menu"},s.createElement("div",{className:"row "+(this.isMfaSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleMfaClick},s.createElement("span",null,s.createElement(v.x6,null,"Multi Factor Authentication"))))))))),this.canSeeUserProvisionning()&&s.createElement("li",{id:"user-provisionning",className:"accordion-header"},s.createElement("div",{className:"row"},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:()=>this.handleSubmenuClick("isUserProvisionningOpened")},this.state.isUserProvisionningOpened?s.createElement(Ct,null):s.createElement(Nt,null),s.createElement("span",null,s.createElement(v.x6,null,"User provisionning")))))),this.state.isUserProvisionningOpened&&s.createElement("ul",null,this.isUserDirectoryEnabled&&s.createElement("li",{id:"user_directory_menu"},s.createElement("div",{className:"row "+(this.isUserDirectorySelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleUserDirectoryClick},s.createElement("span",null,s.createElement(v.x6,null,"Users Directory"))))))),this.canIUseSelfRegistrationSettings&&s.createElement("li",{id:"self_registration_menu"},s.createElement("div",{className:"row "+(this.isSelfRegistrationSettingsSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleSelfRegistrationClick},s.createElement("span",null,s.createElement(v.x6,null,"Self Registration"))))))))),s.createElement("li",{id:"emails",className:"accordion-header"},s.createElement("div",{className:"row"},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:()=>this.handleSubmenuClick("isEmailsOpened")},this.state.isEmailsOpened?s.createElement(Ct,null):s.createElement(Nt,null),s.createElement("span",null,s.createElement(v.x6,null,"Emails")))))),this.state.isEmailsOpened&&s.createElement("ul",null,this.canIUseSmtpSettings&&s.createElement("li",{id:"smtp_settings_menu"},s.createElement("div",{className:"row "+(this.isSmtpSettingsSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleSmtpSettingsClick},s.createElement("span",null,s.createElement(v.x6,null,"Email server"))))))),s.createElement("li",{id:"email_notification_menu"},s.createElement("div",{className:"row "+(this.isEmailNotificationsSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleEmailNotificationsClick},s.createElement("span",null,s.createElement(v.x6,null,"Email Notifications"))))))))),this.canIUseRbacs&&s.createElement("li",{id:"rbacs_menu"},s.createElement("div",{className:"row "+(this.isRbacSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleRbacsClick},s.createElement("span",null,s.createElement(v.x6,null,"Role-Based Access Control"))))))),this.canIUseLocale&&s.createElement("li",{id:"internationalization_menu"},s.createElement("div",{className:"row "+(this.isInternationalizationSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleInternationalizationClick},s.createElement("span",null,s.createElement(v.x6,null,"Internationalisation"))))))),this.canIUseHealthcheck&&s.createElement("li",{id:"healthcheck_menu"},s.createElement("div",{className:"row "+(this.isHealthcheckSelected()?"selected":"")},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},s.createElement("button",{className:"link no-border",type:"button",onClick:this.handleHealthcheckClick},s.createElement("span",null,s.createElement(v.x6,null,"Passbolt API Status")))))))))}}Rt.propTypes={context:r().object,administrationWorkspaceContext:r().object,history:r().object,navigationContext:r().any};const Dt=(0,S.y)(I(Oe(Ee((0,v.CI)("common")(Rt)))));var Ot,Ut;function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Mt.apply(null,arguments)}const Ft=function(e){return s.createElement("svg",Mt({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Ot||(Ot=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11.25 1.5H4.5A1.5 1.5 0 0 0 3 3v12a1.5 1.5 0 0 0 1.5 1.5h9A1.5 1.5 0 0 0 15 15V5.25z"})),Ut||(Ut=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10.5 1.5v3A1.5 1.5 0 0 0 12 6h3"})))},jt="totp",zt="yubikey",Lt="duo",qt=class{constructor(e={}){this.totpProviderToggle="providers"in e&&e.providers.includes(jt),this.yubikeyToggle="providers"in e&&e.providers.includes(zt),this.yubikeyClientIdentifier="yubikey"in e?e.yubikey.clientId:"",this.yubikeySecretKey="yubikey"in e?e.yubikey.secretKey:"",this.duoToggle="providers"in e&&e.providers.includes(Lt),this.duoHostname="duo"in e?e.duo.hostName:"",this.duoClientId="duo"in e?e.duo.integrationKey:"",this.duoClientSecret="duo"in e?e.duo.secretKey:""}},Kt=class{constructor(e={}){this.clientId="yubikeyClientIdentifier"in e?e.yubikeyClientIdentifier:e.clientId,this.secretKey="yubikeySecretKey"in e?e.yubikeySecretKey:e.secretKey}},Wt=class{constructor(e={}){this.apiHostName=e.duoHostname,this.clientId=e.duoClientId,this.clientSecret=e.duoClientSecret}},Vt=class{constructor(e={}){this.providers=[],this.setProviders(e),this.yubikey=this.providers.includes(zt)?new Kt(e):{},this.duo=this.providers.includes(Lt)?new Wt(e):{}}setProviders(e){e.totpProviderToggle&&this.providers.push(jt),e.yubikeyToggle&&this.providers.push(zt),e.duoToggle&&this.providers.push(Lt)}};class Bt extends Error{constructor(e,t){super(e),this.name="PassboltApiFetchError",this.data=t||{}}}const Gt=Bt;class $t extends Error{constructor(){super("An internal error occurred. The server response could not be parsed. Please contact your administrator."),this.name="PassboltBadResponseError"}}const Ht=$t;class Yt extends Error{constructor(e){super(e=e||"The service is unavailable"),this.name="PassboltServiceUnavailableError"}}const Jt=Yt,Zt=["GET","POST","PUT","DELETE"];class Qt{constructor(e){if(this.options=e,!this.options.getBaseUrl())throw new TypeError("ApiClient constructor error: baseUrl is required.");if(!this.options.getResourceName())throw new TypeError("ApiClient constructor error: resourceName is required.");try{let e=this.options.getBaseUrl().toString();e.endsWith("/")&&(e=e.slice(0,-1));let t=this.options.getResourceName();t.startsWith("/")&&(t=t.slice(1)),t.endsWith("/")&&(t=t.slice(0,-1)),this.baseUrl=`${e}/${t}`,this.baseUrl=new URL(this.baseUrl)}catch(e){throw new TypeError("ApiClient constructor error: b.")}this.apiVersion="api-version=v2"}getDefaultHeaders(){return{Accept:"application/json","content-type":"application/json"}}async buildFetchOptions(){const e=await this.options.getHeaders();return{credentials:"include",headers:{...this.getDefaultHeaders(),...e}}}async get(e,t){this.assertValidId(e);const a=this.buildUrl(`${this.baseUrl}/${e}`,t||{});return this.fetchAndHandleResponse("GET",a)}async delete(e,t,a,s){let n;this.assertValidId(e),void 0===s&&(s=!1),n=s?this.buildUrl(`${this.baseUrl}/${e}/dry-run`,a||{}):this.buildUrl(`${this.baseUrl}/${e}`,a||{});let i=null;return t&&(i=this.buildBody(t)),this.fetchAndHandleResponse("DELETE",n,i)}async findAll(e){const t=this.buildUrl(this.baseUrl.toString(),e||{});return this.fetchAndHandleResponse("GET",t)}async create(e,t){const a=this.buildUrl(this.baseUrl.toString(),t||{}),s=this.buildBody(e);return this.fetchAndHandleResponse("POST",a,s)}async update(e,t,a,s){let n;this.assertValidId(e),void 0===s&&(s=!1),n=s?this.buildUrl(`${this.baseUrl}/${e}/dry-run`,a||{}):this.buildUrl(`${this.baseUrl}/${e}`,a||{});let i=null;return t&&(i=this.buildBody(t)),this.fetchAndHandleResponse("PUT",n,i)}async updateAll(e,t={}){const a=this.buildUrl(this.baseUrl.toString(),t),s=e?this.buildBody(e):null;return this.fetchAndHandleResponse("PUT",a,s)}assertValidId(e){if(!e)throw new TypeError("ApiClient.assertValidId error: id cannot be empty");if("string"!=typeof e)throw new TypeError("ApiClient.assertValidId error: id should be a string")}assertMethod(e){if("string"!=typeof e)throw new TypeError("ApiClient.assertValidMethod method should be a string.");if(Zt.indexOf(e.toUpperCase())<0)throw new TypeError(`ApiClient.assertValidMethod error: method ${e} is not supported.`)}assertUrl(e){if(!e)throw new TypeError("ApliClient.assertUrl error: url is required.");if(!(e instanceof URL))throw new TypeError("ApliClient.assertUrl error: url should be a valid URL object.");if("https:"!==e.protocol&&"http:"!==e.protocol)throw new TypeError("ApliClient.assertUrl error: url protocol should only be https or http.")}assertBody(e){if(!(e instanceof FormData)&&"string"!=typeof e)throw new TypeError("ApiClient.assertBody error: body should be a string or a FormData.")}buildBody(e){return JSON.stringify(e)}buildUrl(e,t){if("string"!=typeof e)throw new TypeError("ApiClient.buildUrl error: url should be a string.");const a=new URL(`${e}.json?${this.apiVersion}`);t=t||{};for(const[e,s]of Object.entries(t)){if("string"!=typeof e)throw new TypeError("ApiClient.buildUrl error: urlOptions key should be a string.");if("string"==typeof s)a.searchParams.append(e,s);else{if(!Array.isArray(s))throw new TypeError("ApiClient.buildUrl error: urlOptions value should be a string or array.");s.forEach((t=>{a.searchParams.append(e,t)}))}}return a}async sendRequest(e,t,a,s){this.assertUrl(t),this.assertMethod(e),a&&this.assertBody(a);const n="undefined"!=typeof customApiClientFetch?customApiClientFetch:fetch,i={...await this.buildFetchOptions(),...s};i.method=e,a&&(i.body=a);try{return await n(t.toString(),i)}catch(e){throw console.error(e),navigator.onLine?new Jt("Unable to reach the server, an unexpected error occurred"):new Jt("Unable to reach the server, you are not connected to the network")}}async fetchAndHandleResponse(e,t,a,s){const n=await this.sendRequest(e,t,a,s);return this.parseResponseJson(n)}async parseResponseJson(e){let t;try{t=await e.json()}catch(t){throw console.debug(e.url.toString(),t),new Ht(t,e)}if(!e.ok){const a=t.header.message;throw new Gt(a,{code:e.status,body:t.body})}return t}}const Xt=class{constructor(e){this.apiClientOptions=e}async findAllSettings(){return this.initClient(),(await this.apiClient.findAll()).body}async save(e){return this.initClient(),(await this.apiClient.create(e)).body}async getUserSettings(){return this.initClient("setup/select"),(await this.apiClient.findAll()).body}initClient(e="settings"){this.apiClientOptions.setResourceName(`mfa/${e}`),this.apiClient=new Qt(this.apiClientOptions)}};function ea(){return ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ea.apply(null,arguments)}const ta=s.createContext({getCurrentSettings:()=>{},getSettings:()=>{},setSettings:()=>{},hasSettingsChanges:()=>{},findMfaSettings:()=>{},save:()=>{},setProcessing:()=>{},isProcessing:()=>{},getErrors:()=>{},setError:()=>{},isSubmitted:()=>{},setSubmitted:()=>{},setErrors:()=>{},clearContext:()=>{}});class aa extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.mfaService=new Xt(t)}get defaultState(){return{errors:this.initErrors(),currentSettings:null,settings:new qt,submitted:!1,processing:!0,getCurrentSettings:this.getCurrentSettings.bind(this),getSettings:this.getSettings.bind(this),setSettings:this.setSettings.bind(this),findMfaSettings:this.findMfaSettings.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isProcessing:this.isProcessing.bind(this),isSubmitted:this.isSubmitted.bind(this),setSubmitted:this.setSubmitted.bind(this),setProcessing:this.setProcessing.bind(this),save:this.save.bind(this),getErrors:this.getErrors.bind(this),setError:this.setError.bind(this),setErrors:this.setErrors.bind(this),clearContext:this.clearContext.bind(this)}}initErrors(){return{yubikeyClientIdentifierError:null,yubikeySecretKeyError:null,duoHostnameError:null,duoClientIdError:null,duoClientSecretError:null}}async findMfaSettings(){this.setProcessing(!0);const e=await this.mfaService.findAllSettings(),t=new qt(e);this.setState({currentSettings:t}),this.setState({settings:Object.assign({},t)}),this.setProcessing(!1)}getCurrentSettings(){return this.state.currentSettings}getSettings(){return this.state.settings}async setSettings(e,t){const a=Object.assign({},this.state.settings,{[e]:t});await this.setState({settings:a})}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasSettingsChanges(){return JSON.stringify(this.state.currentSettings)!==JSON.stringify(this.state.settings)}isSubmitted(){return this.state.submitted}setSubmitted(e){this.setState({submitted:e})}clearContext(){const{currentSettings:e,settings:t,processing:a}=this.defaultState;this.setState({currentSettings:e,settings:t,processing:a})}async save(){this.setProcessing(!0);const e=new Vt(this.state.settings);await this.mfaService.save(e),await this.findMfaSettings()}getErrors(){return this.state.errors}setError(e,t){const a=Object.assign({},this.state.errors,{[e]:t});this.setState({errors:a})}setErrors(e,t=()=>{}){const a=Object.assign({},this.state.errors,e);return this.setState({errors:a},t)}render(){return s.createElement(ta.Provider,{value:this.state},this.props.children)}}aa.propTypes={context:r().any,children:r().any};const sa=I(aa);function na(e){return class extends s.Component{render(){return s.createElement(ta.Consumer,null,(t=>s.createElement(e,ea({adminMfaContext:t},this.props))))}}}var ia=a(3050),ra=a.n(ia);class oa{constructor(e,t){this.context=e,this.translation=t}static getInstance(e,t){return this.instance||(this.instance=new oa(e,t)),this.instance}static killInstance(){this.instance=null}validateInput(e,t,a){const s=e.trim();return s.length?ra()(t).test(s)?null:this.translation(a.regex):this.translation(a.required)}validateYubikeyClientIdentifier(e){const t=this.validateInput(e,"^[0-9]{1,64}$",{required:"A client identifier is required.",regex:"The client identifier should be an integer."});return this.context.setError("yubikeyClientIdentifierError",t),t}validateYubikeySecretKey(e){const t=this.validateInput(e,"^[a-zA-Z0-9\\/=+]{10,128}$",{required:"A secret key is required.",regex:"This secret key is not valid."});return this.context.setError("yubikeySecretKeyError",t),t}validateDuoHostname(e){const t=this.validateInput(e,"^api-[a-fA-F0-9]{8,16}\\.duosecurity\\.com$",{required:"A hostname is required.",regex:"This is not a valid hostname."});return this.context.setError("duoHostnameError",t),t}validateDuoClientId(e){const t=this.validateInput(e,"^[a-zA-Z0-9]{16,32}$",{required:"A client id is required.",regex:"This is not a valid client id."});return this.context.setError("duoClientIdError",t),t}validateDuoClientSecret(e){const t=this.validateInput(e,"^[a-zA-Z0-9]{32,128}$",{required:"A client secret is required.",regex:"This is not a valid client secret."});return this.context.setError("duoClientSecretError",t),t}validateYubikeyInputs(){let e=null,t=null;const a=this.context.getSettings();let s={};return a.yubikeyToggle&&(e=this.validateYubikeyClientIdentifier(a.yubikeyClientIdentifier),t=this.validateYubikeySecretKey(a.yubikeySecretKey),s={yubikeyClientIdentifierError:e,yubikeySecretKeyError:t}),s}validateDuoInputs(){let e=null,t=null,a=null,s={};const n=this.context.getSettings();return n.duoToggle&&(e=this.validateDuoHostname(n.duoHostname),t=this.validateDuoClientId(n.duoClientId),a=this.validateDuoClientSecret(n.duoClientSecret),s={duoHostnameError:e,duoClientIdError:t,duoClientSecretError:a}),s}async validate(){const e=Object.assign(this.validateYubikeyInputs(),this.validateDuoInputs());return await this.context.setErrors(e),0===Object.values(e).filter((e=>e)).length}}const la=oa;class ca extends s.Component{constructor(e){super(e),this.bindCallbacks(),this.mfaFormService=la.getInstance(this.props.adminMfaContext,this.props.t)}async handleSaveClick(){try{await this.mfaFormService.validate()&&(await this.props.adminMfaContext.save(),this.handleSaveSuccess())}catch(e){this.handleSaveError(e)}finally{this.props.adminMfaContext.setSubmitted(!0),this.props.adminMfaContext.setProcessing(!1)}}isSaveEnabled(){return!this.props.adminMfaContext.isProcessing()&&this.props.adminMfaContext.hasSettingsChanges()}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this)}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The multi factor authentication settings for the organization were updated."))}async handleSaveError(e){"UserAbortsOperationError"!==e.name&&(console.error(e),await this.handleError(e))}async handleError(e){await this.props.actionFeedbackContext.displayError(e.message)}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{id:"save-settings",className:"button primary form",type:"button",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}ca.propTypes={adminMfaContext:r().object,actionFeedbackContext:r().object,t:r().func};const ma=na(d((0,v.CI)("common")(ca)));var da,pa;function ua(){return ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ua.apply(null,arguments)}const ha=function(e){return s.createElement("svg",ua({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),da||(da=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M1.333 8s2-4.667 6.667-4.667S14.667 8 14.667 8s-2 4.666-6.667 4.666S1.333 8 1.333 8"})),pa||(pa=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4"})))};var ga;function ba(){return ba=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ba.apply(null,arguments)}const ya=function(e){return s.createElement("svg",ba({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),ga||(ga=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#eye_close_svg__clip0_27_140048)"},s.createElement("path",{d:"M6.587 6.587a2 2 0 1 0 2.826 2.827M7.153 3.386q.422-.052.847-.053C12.667 3.333 14.667 8 14.667 8a8.8 8.8 0 0 1-1.114 1.786"}),s.createElement("path",{d:"M4.407 4.406A9 9 0 0 0 1.333 8s2 4.666 6.667 4.666a6.5 6.5 0 0 0 3.593-1.073M1.333 1.333l13.334 13.333"}))))};class fa extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{viewPassword:!1,hasPassphraseFocus:!1,isPassphraseActive:!1}}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this),this.handlePasswordInputFocus=this.handlePasswordInputFocus.bind(this),this.handlePasswordInputBlur=this.handlePasswordInputBlur.bind(this),this.handleViewPasswordButtonClick=this.handleViewPasswordButtonClick.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this)}handleInputChange(e){this.props.onChange&&this.props.onChange(e)}handlePasswordInputFocus(){this.setState({hasPassphraseFocus:!0})}handlePasswordInputBlur(){this.setState({hasPassphraseFocus:!1})}handleViewPasswordButtonClick(){this.props.disabled||this.setState({viewPassword:!this.state.viewPassword})}get securityTokenStyle(){const e={background:this.props.securityToken.textColor,color:this.props.securityToken.backgroundColor},t={background:this.props.securityToken.backgroundColor,color:this.props.securityToken.textColor};return this.state.hasPassphraseFocus?e:t}get passphraseInputStyle(){if(!this.state.hasPassphraseFocus)return;const{backgroundColor:e}=this.props.securityToken,t=this.getContrastTextColor(e);return{background:e,color:t,"--passphrase-placeholder-color":t}}get previewStyle(){if(!this.state.hasPassphraseFocus)return;const{backgroundColor:e}=this.props.securityToken;return{"--icon-color":this.getContrastTextColor(e),"--icon-background-color":e}}getContrastTextColor(e){const t=e.replace("#",""),a=parseInt(t,16);return(.299*(a>>16&255)+.587*(a>>8&255)+.114*(255&a))/255>.5?"var(--Token-Token-text-and-icon)":"var(--Token-Token-text-and-icon-reversed)"}handleMouseDown(){this.setState({isPassphraseActive:!0})}handleMouseUp(){this.setState({isPassphraseActive:!1})}render(){return s.createElement("div",{className:`input password ${this.props.disabled?"disabled":""} ${this.state.hasPassphraseFocus?"":"no-focus"} ${this.state.isPassphraseActive?"active":""} ${this.props.securityToken?"security":""}`,style:this.props.securityToken?this.passphraseInputStyle:void 0},s.createElement("input",{id:this.props.id,name:this.props.name,maxLength:"4096",placeholder:this.props.placeholder,type:this.state.viewPassword&&!this.props.disabled?"text":"password",onKeyUp:this.props.onKeyUp,value:this.props.value,onFocus:this.handlePasswordInputFocus,onBlur:this.handlePasswordInputBlur,onChange:this.handleInputChange,disabled:this.props.disabled,readOnly:this.props.readOnly,autoComplete:this.props.autoComplete,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,"aria-required":!0,ref:this.props.inputRef}),this.props.preview&&s.createElement("div",{className:"password-view-wrapper"},s.createElement("button",{type:"button",onClick:this.handleViewPasswordButtonClick,style:this.props.securityToken?this.previewStyle:void 0,className:"password-view infield button-transparent "+(this.props.disabled?"disabled":"")},!this.state.viewPassword&&s.createElement(ha,{className:"svg-icon eye-open"}),this.state.viewPassword&&s.createElement(ya,{className:"svg-icon eye-close"}),s.createElement("span",{className:"visually-hidden"},s.createElement(v.x6,null,"View")))),this.props.securityToken&&s.createElement("div",{className:"security-token-wrapper"},s.createElement("span",{className:"security-token",style:this.securityTokenStyle},this.props.securityToken.code)))}}fa.defaultProps={id:"",name:"",autoComplete:"off"},fa.propTypes={context:r().any,id:r().string,name:r().string,value:r().string,placeholder:r().string,autoComplete:r().string,inputRef:r().object,disabled:r().bool,readOnly:r().bool,preview:r().bool,onChange:r().func,onKeyUp:r().func,securityToken:r().shape({code:r().string,backgroundColor:r().string,textColor:r().string})};const va=(0,v.CI)("common")(fa);function Ea(e,t,a){return s.createElement(s.Fragment,null,t&&(0,n.createPortal)(e,t,a))}class wa extends s.Component{constructor(e){super(e),this.mfaFormService=la.getInstance(this.props.adminMfaContext,this.props.t),this.bindCallbacks()}async componentDidMount(){this.props.administrationWorkspaceContext.setDisplayAdministrationWorkspaceAction(ma),this.isRunningUnderHttps&&this.props.adminMfaContext.findMfaSettings()}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminMfaContext.clearContext(),la.killInstance(),this.mfaFormService=null}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this)}handleInputChange(e){const t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;this.props.adminMfaContext.setSettings(s,a),this.validateInput(s,a)}validateInput(e,t){switch(e){case"yubikeyClientIdentifier":this.mfaFormService.validateYubikeyClientIdentifier(t);break;case"yubikeySecretKey":this.mfaFormService.validateYubikeySecretKey(t);break;case"duoHostname":this.mfaFormService.validateDuoHostname(t);break;case"duoClientId":this.mfaFormService.validateDuoClientId(t);break;case"duoClientSecret":this.mfaFormService.validateDuoClientSecret(t)}}get isRunningUnderHttps(){const e=this.props.context.trustedDomain;return"https:"===new URL(e).protocol}hasAllInputDisabled(){return this.props.adminMfaContext.isProcessing()}render(){const e=this.props.adminMfaContext.isSubmitted(),t=this.props.adminMfaContext.getSettings(),a=this.props.adminMfaContext.getErrors(),n=null!==this.props.adminMfaContext.getCurrentSettings()&&this.props.adminMfaContext.hasSettingsChanges();return s.createElement("div",{className:"row"},s.createElement("div",{className:"mfa-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},"Multi Factor Authentication"),!this.isRunningUnderHttps&&s.createElement("p",null,s.createElement(v.x6,null,"Sorry the multi factor authentication feature is only available in a secure context (HTTPS).")),this.isRunningUnderHttps&&s.createElement(s.Fragment,null,s.createElement("p",null,s.createElement(v.x6,null,"In this section you can choose which multi factor authentication will be available.")),s.createElement("div",{className:"provider-section"},s.createElement("h4",{className:"no-border"},s.createElement("span",{className:"input toggle-switch form-element ready"},s.createElement("input",{id:"totp-provider-toggle-button",type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"totpProviderToggle",onChange:this.handleInputChange,checked:t.totpProviderToggle,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"totp-provider-toggle-button"},s.createElement(v.x6,null,"Time-based One Time Password")))),!t.totpProviderToggle&&s.createElement("p",{className:"description"},s.createElement(v.x6,null,"The Time-based One Time Password provider is disabled for all users.")),t.totpProviderToggle&&s.createElement("p",{className:"description"},s.createElement(v.x6,null,"The Time-based One Time Password provider is enabled for all users. They can setup this provider in their profile and use it as second factor authentication."))),s.createElement("div",{className:"provider-section"},s.createElement("h4",null,s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{id:"yubikey-provider-toggle-button",type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"yubikeyToggle",onChange:this.handleInputChange,checked:t.yubikeyToggle,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"yubikey-provider-toggle-button"},"Yubikey"))),!t.yubikeyToggle&&s.createElement("p",{className:"description"},s.createElement(v.x6,null,"The Yubikey provider is disabled for all users.")),t.yubikeyToggle&&s.createElement(s.Fragment,null,s.createElement("p",{className:"description"},s.createElement(v.x6,null,"The Yubikey provider is enabled for all users. They can setup this provider in their profile and use it as second factor authentication.")),s.createElement("div",{className:`input text required ${a.yubikeyClientIdentifierError&&e?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",null,s.createElement(v.x6,null,"Client identifier")),s.createElement("input",{id:"yubikeyClientIdentifier",name:"yubikeyClientIdentifier",className:"required fluid form-element ready",type:"text","aria-required":!0,onChange:this.handleInputChange,value:t.yubikeyClientIdentifier,placeholder:"123456789",disabled:this.hasAllInputDisabled()}),a.yubikeyClientIdentifierError&&e&&s.createElement("div",{className:"yubikey_client_identifier error-message"},a.yubikeyClientIdentifierError)),s.createElement("div",{className:`input required input-secret ${a.yubikeySecretKeyError&&e?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",null,s.createElement(v.x6,null,"Secret key")),s.createElement(va,{id:"yubikeySecretKey",onChange:this.handleInputChange,autoComplete:"off",name:"yubikeySecretKey",placeholder:"**********",disabled:this.hasAllInputDisabled(),value:t.yubikeySecretKey,preview:!0}),a.yubikeySecretKeyError&&e&&s.createElement("div",{className:"yubikey_secret_key error-message"},a.yubikeySecretKeyError)))),s.createElement("div",{className:"provider-section"},s.createElement("h4",null,s.createElement("span",{className:"input toggle-switch form-element ready"},s.createElement("input",{id:"duo-provider-toggle-button",type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"duoToggle",onChange:this.handleInputChange,checked:t.duoToggle,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"duo-provider-toggle-button"},"Duo"))),!t.duoToggle&&s.createElement("p",{className:"description"},s.createElement(v.x6,null,"The Duo provider is disabled for all users.")),t.duoToggle&&s.createElement(s.Fragment,null,s.createElement("p",{className:"description enabled"},s.createElement(v.x6,null,"The Duo provider is enabled for all users. They can setup this provider in their profile and use it as second factor authentication.")),s.createElement("div",{className:`input text required ${a.duoHostnameError&&e?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",null,s.createElement(v.x6,null,"Hostname")),s.createElement("input",{id:"duoHostname",type:"text",name:"duoHostname","aria-required":!0,className:"required fluid form-element ready",placeholder:"api-24zlkn4.duosecurity.com",value:t.duoHostname,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()}),a.duoHostnameError&&e&&s.createElement("div",{className:"duo_hostname error-message"},a.duoHostnameError)),s.createElement("div",{className:`input text required ${a.duoClientIdError&&e?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",null,s.createElement(v.x6,null,"Client id")),s.createElement("input",{id:"duoClientId",type:"text",name:"duoClientId","aria-required":!0,className:"required fluid form-element ready",placeholder:"HASJKDSQJO213123KQSLDF",value:t.duoClientId,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()}),a.duoClientIdError&&e&&s.createElement("div",{className:"duo_client_id error-message"},a.duoClientIdError)),s.createElement("div",{className:`input text required ${a.duoClientSecretError&&e?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",null,s.createElement(v.x6,null,"Client secret")),s.createElement(va,{id:"duoClientSecret",onChange:this.handleInputChange,autoComplete:"off",name:"duoClientSecret",placeholder:"**********",disabled:this.hasAllInputDisabled(),value:t.duoClientSecret,preview:!0}),a.duoClientSecretError&&e&&s.createElement("div",{className:"duo_client_secret error-message"},a.duoClientSecretError)))))),n&&s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(ma,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need some help?")),s.createElement("p",null,s.createElement(v.x6,null,"Check out our Multi Factor Authentication configuration guide.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/authentication/mfa/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ft,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}wa.propTypes={context:r().object,adminMfaContext:r().object,createPortal:r().func,administrationWorkspaceContext:r().object,t:r().func};const ka=I(na(Ee((0,v.CI)("common")(wa))));class xa extends s.Component{render(){let e=0;return s.createElement("div",{className:"breadcrumbs"},s.createElement("ul",{className:"menu"},this.props.items&&this.props.items.map((t=>(e++,s.createElement("li",{key:e},t))))),this.props.children)}}xa.propTypes={items:r().array,children:r().any};const Ca=xa;class Sa extends s.Component{render(){return s.createElement("button",{type:"button",className:"link no-border inline ellipsis",onClick:this.props.onClick},this.props.name)}}Sa.propTypes={name:r().string,onClick:r().func};const _a=Sa;class Na extends s.Component{get items(){switch(this.props.administrationWorkspaceContext.selectedAdministration){case we.NONE:return[];case we.HOME:return[s.createElement(_a,{key:"bread-2",name:this.translate("Home"),onClick:this.onLastBreadcrumbClick.bind(this)})];default:return[s.createElement(_a,{key:"bread-3",name:this.translate("Home"),onClick:this.props.navigationContext.onGoToAdministrationRequested}),s.createElement(_a,{key:"bread-2",name:this.getLastBreadcrumbItemName(),onClick:this.onLastBreadcrumbClick.bind(this)})]}}getLastBreadcrumbItemName(){switch(this.props.administrationWorkspaceContext.selectedAdministration){case we.MFA:return this.translate("Multi Factor Authentication");case we.USER_DIRECTORY:return this.translate("Users Directory");case we.EMAIL_NOTIFICATION:return this.translate("Email Notification");case we.SUBSCRIPTION:return this.translate("Subscription");case we.INTERNATIONALIZATION:return this.translate("Internationalisation");case we.ACCOUNT_RECOVERY:return this.translate("Account Recovery");case we.SMTP_SETTINGS:return this.translate("Email server");case we.SELF_REGISTRATION:return this.translate("Self Registration");case we.SSO:return this.translate("Single Sign-On");case we.MFA_POLICY:return this.translate("MFA Policy");case we.RBAC:return this.translate("Role-Based Access Control");case we.PASSWORD_POLICIES:return this.translate("Password Policy");case we.USER_PASSPHRASE_POLICIES:return this.translate("User Passphrase Policies");case we.PASSWORD_EXPIRY:return this.translate("Password Expiry");case we.HEALTHCHECK:return this.translate("Passbolt API Status");case we.CONTENT_TYPES_ENCRYPTED_METADATA:return this.translate("Encrypted metadata");case we.CONTENT_TYPES_METADATA_KEY:return this.translate("Metadata key");case we.MIGRATE_METADATA:return this.translate("Migrate metadata");case we.ALLOW_CONTENT_TYPES:return this.translate("Allow content types");default:return""}}async onLastBreadcrumbClick(){const e=this.props.location.pathname;this.props.history.push({pathname:e})}get translate(){return this.props.t}render(){return s.createElement(Ca,{items:this.items})}}Na.propTypes={administrationWorkspaceContext:r().object,location:r().object,history:r().object,navigationContext:r().any,t:r().func};const Ia=(0,S.y)(Oe(Ee((0,v.CI)("common")(Na)))),Pa=new class{allPropTypes=(...e)=>(...t)=>{const a=e.map((e=>e(...t))).filter(Boolean);if(0===a.length)return;const s=a.map((e=>e.message)).join("\n");return new Error(s)}};var Aa;function Ta(){return Ta=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ta.apply(null,arguments)}const Ra=function(e){return s.createElement("svg",Ta({width:25,height:24,fill:"none",viewBox:"0 0 25 24"},e),Aa||(Aa=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11.597 19a8 8 0 1 0 0-16 8 8 0 0 0 0 16M21.597 21l-4.35-4.35"})))};class Da extends s.Component{constructor(e){super(e),this.state=this.getDefaultState(e),this.bindCallback(),this.createRefs()}getDefaultState(e){return{selectedValue:e.value,search:"",open:!1,style:void 0}}get listItemsFiltered(){const e=this.props.items.filter((e=>e.value!==this.state.selectedValue));return this.props.search&&""!==this.state.search?this.getItemsMatch(e,this.state.search):e}get selectedItemLabel(){const e=this.props.items&&this.props.items.find((e=>e.value===this.state.selectedValue));return e&&e.label||s.createElement(s.Fragment,null," ")}static getDerivedStateFromProps(e,t){return void 0!==e.value&&e.value!==t.selectedValue?{selectedValue:e.value}:null}bindCallback(){this.handleDocumentClickEvent=this.handleDocumentClickEvent.bind(this),this.handleDocumentContextualMenuEvent=this.handleDocumentContextualMenuEvent.bind(this),this.handleDocumentDragStartEvent=this.handleDocumentDragStartEvent.bind(this),this.handleDocumentScrollEvent=this.handleDocumentScrollEvent.bind(this),this.handleSelectClick=this.handleSelectClick.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleItemClick=this.handleItemClick.bind(this),this.handleSelectKeyDown=this.handleSelectKeyDown.bind(this),this.handleItemKeyDown=this.handleItemKeyDown.bind(this),this.handleBlur=this.handleBlur.bind(this)}createRefs(){this.selectedItemRef=s.createRef(),this.selectItemsRef=s.createRef(),this.itemsRef=s.createRef()}componentDidMount(){document.addEventListener("click",this.handleDocumentClickEvent,{capture:!0}),document.addEventListener("contextmenu",this.handleDocumentContextualMenuEvent,{capture:!0}),document.addEventListener("dragstart",this.handleDocumentDragStartEvent,{capture:!0}),document.addEventListener("scroll",this.handleDocumentScrollEvent,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleDocumentClickEvent,{capture:!0}),document.removeEventListener("contextmenu",this.handleDocumentContextualMenuEvent,{capture:!0}),document.removeEventListener("dragstart",this.handleDocumentDragStartEvent,{capture:!0}),document.removeEventListener("scroll",this.handleDocumentScrollEvent,{capture:!0})}handleDocumentClickEvent(e){this.selectedItemRef.current.contains(e.target)||this.selectItemsRef.current.contains(e.target)||this.closeSelect()}handleDocumentContextualMenuEvent(e){this.selectedItemRef.current.contains(e.target)||this.selectItemsRef.current.contains(e.target)||this.closeSelect()}handleDocumentDragStartEvent(){this.closeSelect()}handleDocumentScrollEvent(e){this.itemsRef.current.contains(e.target)||this.selectItemsRef.current.contains(e.target)||this.closeSelect()}handleSelectClick(){if(this.props.disabled)this.closeSelect();else{const e=!this.state.open;e?this.forceVisibilitySelect():this.resetStyleSelect(),this.setState({open:e})}}getFirstParentWithTransform(){let e=this.selectedItemRef.current.parentElement;for(;null!==e&&""===e.style.getPropertyValue("transform");)e=e.parentElement;return e}forceVisibilitySelect(){const e=this.selectedItemRef.current.getBoundingClientRect(),{width:t,height:a}=e;let{top:s,left:n}=e;const i=this.getFirstParentWithTransform();if(i){const e=i.getBoundingClientRect();s-=e.top,n-=e.left}const r={position:"fixed",zIndex:1,width:t,height:a,top:s,left:n};this.setState({style:r})}handleBlur(e){e.currentTarget.contains(e.relatedTarget)||this.closeSelect()}closeSelect(){this.resetStyleSelect(),this.setState({open:!1})}resetStyleSelect(){this.setState({style:void 0})}handleInputChange(e){const t=e.target,a=t.value,s=t.name;this.setState({[s]:a})}handleItemClick(e){if(this.setState({selectedValue:e.value,open:!1}),"function"==typeof this.props.onChange){const t={target:{value:e.value,name:this.props.name}};this.props.onChange(t)}this.closeSelect()}getItemsMatch(e,t){const a=t&&t.split(/\s+/)||[""];return e.filter((e=>a.every((t=>((e,t)=>(e=>new RegExp((e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))(e),"i"))(e).test(t))(t,e.label)))))}handleSelectKeyDown(e){switch(e.keyCode){case 13:return e.stopPropagation(),void this.handleSelectClick();case 40:return e.preventDefault(),e.stopPropagation(),void(this.state.open?this.focusItem(0):this.handleSelectClick());case 38:return e.preventDefault(),e.stopPropagation(),void(this.state.open?this.focusItem(this.listItemsFiltered.length-1):this.handleSelectClick());case 27:return e.stopPropagation(),void this.closeSelect();default:return}}focusItem(e){this.itemsRef.current.childNodes[e]?.focus()}handleItemKeyDown(e,t){switch(e.keyCode){case 13:return e.stopPropagation(),void this.handleItemClick(t);case 40:return e.stopPropagation(),e.preventDefault(),void(e.target.nextSibling?e.target.nextSibling.focus():this.focusItem(0));case 38:return e.stopPropagation(),e.preventDefault(),void(e.target.previousSibling?e.target.previousSibling.focus():this.focusItem(this.listItemsFiltered.length-1));default:return}}hasFilteredItems(){return this.listItemsFiltered.length>0}render(){return s.createElement("div",{className:`select-container ${this.props.className}`,style:{width:this.state.style?.width,height:this.state.style?.height}},s.createElement("div",{onKeyDown:this.handleSelectKeyDown,onBlur:this.handleBlur,id:this.props.id,className:`select ${this.props.direction} ${this.state.open?"open":""}`,style:this.state.style},s.createElement("div",{ref:this.selectedItemRef,className:"selected-value "+(this.props.disabled?"disabled":""),tabIndex:this.props.disabled?-1:0,onClick:this.handleSelectClick},s.createElement("span",{className:"value"},this.selectedItemLabel),s.createElement(Ct,null)),s.createElement("div",{ref:this.selectItemsRef,className:"select-items "+(this.state.open?"visible":"")},this.props.search&&s.createElement(s.Fragment,null,s.createElement("input",{className:"search-input",name:"search",value:this.state.search,onChange:this.handleInputChange,type:"text"}),s.createElement(Ra,{className:"search"})),s.createElement("ul",{ref:this.itemsRef,className:"items"},this.hasFilteredItems()&&this.listItemsFiltered.map((e=>s.createElement("li",{tabIndex:e.disabled?-1:0,key:e.value,className:`option ${e.value}`,onKeyDown:t=>this.handleItemKeyDown(t,e),onClick:()=>this.handleItemClick(e)},e.label))),!this.hasFilteredItems()&&this.props.search&&s.createElement("li",{className:"option no-results"},s.createElement(v.x6,null,"No results match")," ",s.createElement("span",null,this.state.search))))))}}Da.defaultProps={id:"",name:"select",className:"",direction:"bottom"},Da.propTypes={id:r().string,name:r().string,className:r().string,direction:r().oneOf(Object.values({top:"top",bottom:"bottom",left:"left",right:"right"})),search:r().bool,items:r().array,value:Pa.allPropTypes(r().oneOfType([r().string,r().number,r().bool]),((e,t,a)=>{const s=e[t],n=e.items;if(null!==s&&n.length>0&&n.every((e=>e.value!==s)))return new Error(`Invalid prop ${t} passed to ${a}. Expected the value ${s} in items.`)})),disabled:r().bool,onChange:r().func};const Oa=(0,v.CI)("common")(Da);class Ua extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.disabled||this.props.onClick()}render(){return s.createElement("button",{type:"button",disabled:this.props.disabled,className:"link cancel",onClick:this.handleClick},this.props.value)}}Ua.defaultProps={value:s.createElement(v.x6,null,"Cancel")},Ua.propTypes={disabled:r().bool,onClick:r().func,value:r().oneOfType([r().arrayOf(r().node),r().node,r().string])};const Ma=(0,v.CI)("common")(Ua);var Fa,ja;function za(){return za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},za.apply(null,arguments)}const La=function(e){return s.createElement("svg",za({width:18,height:18,fill:"none",className:"svg-icon spinner",viewBox:"0 0 18 18"},e),Fa||(Fa=s.createElement("circle",{id:"background",cx:8,cy:8,r:8,fill:"none",stroke:"var(--spinner-background)",strokeWidth:"var(--spinner-stroke-width)",transform:"translate(1 1)"})),ja||(ja=s.createElement("circle",{id:"loading",r:8,fill:"none",stroke:"var(--spinner-color)",strokeLinecap:"round",strokeWidth:"var(--spinner-stroke-width)",transform:"translate(9 9)"})))};class qa extends s.Component{constructor(e){super(e),this.infiniteTimerUpdateIntervalId=null,this.state=this.defaultState}get defaultState(){return{infiniteTimer:0}}componentDidMount(){this.startInfiniteTimerUpdateProgress()}componentWillUnmount(){this.resetInterval()}resetInterval(){this.infiniteTimerUpdateIntervalId&&(clearInterval(this.infiniteTimerUpdateIntervalId),this.infiniteTimerUpdateIntervalId=null)}startInfiniteTimerUpdateProgress(){this.infiniteTimerUpdateIntervalId=setInterval((()=>{const e=this.state.infiniteTimer+2;this.setState({infiniteTimer:e})}),500)}calculateInfiniteProgress(){return 100-100/Math.pow(1.1,this.state.infiniteTimer)}handleClose(){this.props.onClose()}render(){const e=this.calculateInfiniteProgress(),t={width:`${e}%`};return s.createElement(wt,{className:"loading-dialog",title:this.props.title,onClose:this.handleClose,disabled:!0},s.createElement("div",{className:"form-content"},s.createElement("label",null,s.createElement(v.x6,null,"Take a deep breath and enjoy being in the present moment...")),s.createElement("div",{className:"progress-bar-wrapper"},s.createElement("span",{className:"progress-bar"},s.createElement("span",{className:"progress "+(100===e?"completed":""),style:t})))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("button",{type:"submit",disabled:!0,className:"processing"},"Submit",s.createElement(La,null))))}}qa.propTypes={onClose:r().func,title:r().string};const Ka=(0,v.CI)("common")(qa),Wa="directorysync",Va=class{constructor(e){this.apiClientOptions=e,e.setResourceName(`${Wa}`)}async findAll(){this.apiClientOptions.setResourceName(`${Wa}/settings`);const e=new Qt(this.apiClientOptions);return(await e.findAll()).body}async update(e){this.apiClientOptions.setResourceName(`${Wa}`);const t=new Qt(this.apiClientOptions);return(await t.update("settings",e)).body}async delete(){return this.apiClientOptions.setResourceName(`${Wa}`),new Qt(this.apiClientOptions).delete("settings")}async test(e){return this.apiClientOptions.setResourceName(`${Wa}/settings/test`),new Qt(this.apiClientOptions).create(e)}async simulate(){this.apiClientOptions.setResourceName(`${Wa}`);const e=new Qt(this.apiClientOptions);return(await e.get("synchronize/dry-run")).body}async synchronize(){this.apiClientOptions.setResourceName(`${Wa}/synchronize`);const e=new Qt(this.apiClientOptions);return(await e.create({})).body}},Ba=class{constructor(e){this.apiClientOptions=e,e.setResourceName("users")}async findAll(){const e=new Qt(this.apiClientOptions);return(await e.findAll()).body}},Ga="mail",$a="uniqueMember";class Ha{constructor(e=[],t=""){if(!e||0===e?.length)return void this.setDefaut(t);const a=e.domains?.org_domain;this.openCredentials=!0,this.openDirectoryConfiguration=!1,this.openSynchronizationOptions=!1,this.source=e.source,this.authenticationType=a?.authentication_type||"basic",this.directoryType=a?.directory_type||"ad",this.connectionType=a?.connection_type||"plain",this.host=a?.hosts?.length>0?a?.hosts[0]:"",this.hostError=null,this.port=a?.port?.toString()||"389",this.portError=null,this.username=a?.username||"",this.password=a?.password||"",this.domain=a?.domain_name||"",this.domainError=null,this.baseDn=a?.base_dn||"",this.groupPath=e.group_path||"",this.userPath=e.user_path||"",this.groupCustomFilters=e.group_custom_filters||"",this.userCustomFilters=e.user_custom_filters||"",this.groupObjectClass=e.group_object_class||"",this.userObjectClass=e.user_object_class||"",this.useEmailPrefix=e.use_email_prefix_suffix||!1,this.emailPrefix=e.email_prefix||"",this.emailSuffix=e.email_suffix||"",this.fieldsMapping=Ha.defaultFieldsMapping(e.fields_mapping),this.fallbackFields=Ha.defaultFallbackFields(e.field_fallbacks),this.defaultAdmin=e.default_user||t,this.defaultGroupAdmin=e.default_group_admin_user||t,this.groupsParentGroup=e.groups_parent_group||"",this.usersParentGroup=e.users_parent_group||"",this.enabledUsersOnly=Boolean(e.enabled_users_only),this.createUsers=Boolean(e.sync_users_create),this.deleteUsers=Boolean(e.sync_users_delete),this.updateUsers=Boolean(e.sync_users_update),this.createGroups=Boolean(e.sync_groups_create),this.deleteGroups=Boolean(e.sync_groups_delete),this.updateGroups=Boolean(e.sync_groups_update),this.deleteUserBehavior=e.delete_user_behavior||"delete",this.userDirectoryToggle=Boolean(this.port)&&Boolean(this.host)&&e?.enabled}setDefaut(e){this.openCredentials=!0,this.openDirectoryConfiguration=!1,this.openSynchronizationOptions=!1,this.source="default",this.authenticationType="basic",this.directoryType="ad",this.connectionType="plain",this.host="",this.hostError=null,this.port="389",this.portError=null,this.username="",this.password="",this.domain="",this.domainError=null,this.baseDn="",this.groupPath="",this.userPath="",this.groupCustomFilters="",this.userCustomFilters="",this.groupObjectClass="",this.userObjectClass="",this.useEmailPrefix=!1,this.emailPrefix="",this.emailSuffix="",this.fieldsMapping=Ha.defaultFieldsMapping(),this.fallbackFields=Ha.defaultFallbackFields(),this.defaultAdmin=e,this.defaultGroupAdmin=e,this.groupsParentGroup="",this.usersParentGroup="",this.enabledUsersOnly=!1,this.createUsers=!0,this.deleteUsers=!0,this.updateUsers=!0,this.createGroups=!0,this.deleteGroups=!0,this.updateGroups=!0,this.deleteUserBehavior="delete",this.userDirectoryToggle=!1}static defaultFieldsMapping(e={}){return{ad:{user:Object.assign({id:"objectGuid",firstname:"givenName",lastname:"sn",username:Ga,created:"whenCreated",modified:"whenChanged",groups:"memberOf",enabled:"userAccountControl"},e?.ad?.user),group:Object.assign({id:"objectGuid",name:"cn",created:"whenCreated",modified:"whenChanged",users:"member"},e?.ad?.group)},openldap:{user:Object.assign({id:"entryUuid",firstname:"givenname",lastname:"sn",username:"mail",created:"createtimestamp",modified:"modifytimestamp"},e?.openldap?.user),group:Object.assign({id:"entryUuid",name:"cn",created:"createtimestamp",modified:"modifytimestamp",users:$a},e?.openldap?.group)}}}static defaultFallbackFields(e={}){return{ad:Object.assign({username:""},e?.ad)}}static get DEFAULT_AD_FIELDS_MAPPING_USER_USERNAME_VALUE(){return Ga}static get DEFAULT_OPENLDAP_FIELDS_MAPPING_GROUP_USERS_VALUE(){return $a}}const Ya=Ha,Ja=class{constructor(e){const t=e.directoryType,a=!e.authenticationType||"basic"===e.authenticationType;this.enabled=e.userDirectoryToggle,this.group_path=e.groupPath,this.user_path=e.userPath,this.group_custom_filters=e.groupCustomFilters,this.user_custom_filters=e.userCustomFilters,this.group_object_class="openldap"===t?e.groupObjectClass:"",this.user_object_class="openldap"===t?e.userObjectClass:"",this.use_email_prefix_suffix="openldap"===t&&e.useEmailPrefix,this.email_prefix="openldap"===t&&this.useEmailPrefix?e.emailPrefix:"",this.email_suffix="openldap"===t&&this.useEmailPrefix?e.emailSuffix:"",this.default_user=e.defaultAdmin,this.default_group_admin_user=e.defaultGroupAdmin,this.groups_parent_group=e.groupsParentGroup,this.users_parent_group=e.usersParentGroup,this.enabled_users_only=e.enabledUsersOnly,this.sync_users_create=e.createUsers,this.sync_users_delete=e.deleteUsers,this.sync_users_update=e.updateUsers,this.sync_groups_create=e.createGroups,this.sync_groups_delete=e.deleteGroups,this.sync_groups_update=e.updateGroups,this.fields_mapping=e.fieldsMapping,this.field_fallbacks=e.fallbackFields,this.delete_user_behavior=e.deleteUserBehavior,this.domains={org_domain:{connection_type:e.connectionType,authentication_type:e.authenticationType,directory_type:t,domain_name:e.domain,username:a?e.username:void 0,password:a?e.password:void 0,base_dn:e.baseDn,hosts:[e.host],port:parseInt(e.port,10)}}}};function Za(){return Za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Za.apply(null,arguments)}const Qa="directoryType",Xa=s.createContext({getCurrentSettings:()=>{},getSettings:()=>{},setSettings:()=>{},setAdUserFieldsMappingSettings:()=>{},setOpenLdapGroupFieldsMappingSettings:()=>{},setAdFallbackFieldsSettings:()=>{},hadDisabledSettings:()=>{},getUsers:()=>{},hasSettingsChanges:()=>{},findUserDirectorySettings:()=>{},save:()=>{},delete:()=>{},test:()=>{},setProcessing:()=>{},isProcessing:()=>{},getErrors:()=>{},setError:()=>{},simulateUsers:()=>{},requestSynchronization:()=>{},mustOpenSynchronizePopUp:()=>{},synchronizeUsers:()=>{},isSubmitted:()=>{},setSubmitted:()=>{},setErrors:()=>{},clearContext:()=>{}});class es extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.userDirectoryService=new Va(e.context.getApiClientOptions()),this.userService=new Ba(e.context.getApiClientOptions())}get defaultState(){return{users:[],errors:this.initErrors(),mustSynchronize:!1,currentSettings:null,settings:new Ya,submitted:!1,processing:!0,getCurrentSettings:this.getCurrentSettings.bind(this),getSettings:this.getSettings.bind(this),setSettings:this.setSettings.bind(this),setAdUserFieldsMappingSettings:this.setAdUserFieldsMappingSettings.bind(this),setOpenLdapGroupFieldsMappingSettings:this.setOpenLdapGroupFieldsMappingSettings.bind(this),setAdFallbackFieldsSettings:this.setAdFallbackFieldsSettings.bind(this),hadDisabledSettings:this.hadDisabledSettings.bind(this),findUserDirectorySettings:this.findUserDirectorySettings.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isProcessing:this.isProcessing.bind(this),isSubmitted:this.isSubmitted.bind(this),setSubmitted:this.setSubmitted.bind(this),setProcessing:this.setProcessing.bind(this),simulateUsers:this.simulateUsers.bind(this),synchronizeUsers:this.synchronizeUsers.bind(this),save:this.save.bind(this),delete:this.delete.bind(this),test:this.test.bind(this),getErrors:this.getErrors.bind(this),setError:this.setError.bind(this),setErrors:this.setErrors.bind(this),getUsers:this.getUsers.bind(this),requestSynchronization:this.requestSynchronization.bind(this),mustOpenSynchronizePopUp:this.mustOpenSynchronizePopUp.bind(this),clearContext:this.clearContext.bind(this)}}initErrors(){return{hostError:null,portError:null,domainError:null}}async findUserDirectorySettings(){this.setProcessing(!0);let e=[];try{e=await this.userDirectoryService.findAll()}catch(e){this.handleError(e)}const t=await this.userService.findAll(),a=t.find((e=>this.props.context.loggedInUser.id===e.id)),s=new Ya(e,a.id);this.setState({users:this.sortUsers(t),currentSettings:s,settings:Object.assign({},s),processing:!1})}sortUsers(e){const t=e=>`${e.profile.first_name} ${e.profile.last_name}`;return e.sort(((e,a)=>t(e).localeCompare(t(a))))}getCurrentSettings(){return this.state.currentSettings}getSettings(){return this.state.settings}requestSynchronization(e){this.setState({mustSynchronize:e})}mustOpenSynchronizePopUp(){return this.state.mustSynchronize}setSettings(e,t){const a=Object.assign({},this.state.settings,{[e]:t});this.isAdFieldsMappingUserUsernameResetNeeded(e,t)&&(a.fieldsMapping.ad.user.username=Ya.DEFAULT_AD_FIELDS_MAPPING_USER_USERNAME_VALUE,this.setError("fieldsMappingAdUserUsernameError",null),this.setError("fieldsMappingAdUserUsernameFallbackeError",null)),this.isOpenLdapFieldsMappingGroupUsersResetNeeded(e,t)&&(a.fieldsMapping.openldap.group.users=Ya.DEFAULT_OPENLDAP_FIELDS_MAPPING_GROUP_USERS_VALUE,this.setError("fieldsMappingOpenLdapGroupUsersError",null)),this.setState({settings:a})}isAdFieldsMappingUserUsernameResetNeeded(e,t){return e===Qa&&"openldap"===t}isOpenLdapFieldsMappingGroupUsersResetNeeded(e,t){return e===Qa&&"ad"===t}setAdUserFieldsMappingSettings(e,t){const a=Object.assign({},this.state.settings);a.fieldsMapping.ad.user[e]=t,this.setState({settings:a})}setOpenLdapGroupFieldsMappingSettings(e,t){const a=Object.assign({},this.state.settings);a.fieldsMapping.openldap.group[e]=t,this.setState({settings:a})}setAdFallbackFieldsSettings(e,t){const a=Object.assign({},this.state.settings);a.fallbackFields.ad[e]=t,this.setState({settings:a})}hadDisabledSettings(){const e=this.getCurrentSettings();return Boolean(e?.port)&&Boolean(e?.host)&&!e?.userDirectoryToggle}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasSettingsChanges(){return JSON.stringify(this.state.currentSettings)!==JSON.stringify(this.state.settings)}isSubmitted(){return this.state.submitted}setSubmitted(e){this.setState({submitted:e})}clearContext(){const{currentSettings:e,settings:t,processing:a}=this.defaultState;this.setState({currentSettings:e,settings:t,processing:a})}async save(){this.setProcessing(!0);const e=new Ja(this.state.settings);await this.userDirectoryService.update(e),await this.findUserDirectorySettings()}async delete(){this.setProcessing(!0),await this.userDirectoryService.delete(),await this.findUserDirectorySettings()}async test(){this.setProcessing(!0);const e=new Ja(this.state.settings),t=await this.userDirectoryService.test(e);return this.setProcessing(!1),t}async simulateUsers(){return this.userDirectoryService.simulate()}async synchronizeUsers(){return this.userDirectoryService.synchronize()}getErrors(){return this.state.errors}setError(e,t){const a=Object.assign({},this.state.errors,{[e]:t});this.setState({errors:a})}getUsers(){return this.state.users}setErrors(e,t=()=>{}){const a=Object.assign({},this.state.errors,e);return this.setState({errors:a},t)}handleError(e){const t={error:e};this.props.dialogContext.open(Pt,t)}render(){return s.createElement(Xa.Provider,{value:this.state},this.props.children)}}es.propTypes={context:r().any,children:r().any,dialogContext:r().object};const ts=I(g(es));function as(e){return class extends s.Component{render(){return s.createElement(Xa.Consumer,null,(t=>s.createElement(e,Za({adminUserDirectoryContext:t},this.props))))}}}class ss extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindEventHandlers()}get defaultState(){return{loading:!0,openFullReport:!1,userDirectorySimulateSynchronizeResult:null}}bindEventHandlers(){this.handleFullReportClicked=this.handleFullReportClicked.bind(this),this.handleClose=this.handleClose.bind(this),this.handleSynchronize=this.handleSynchronize.bind(this)}async componentDidMount(){try{const e=await this.props.adminUserDirectoryContext.simulateUsers();this.setState({loading:!1,userDirectorySimulateSynchronizeResult:e})}catch(e){await this.handleError(e)}}async handleError(e){console.error(e),await this.props.actionFeedbackContext.displayError(e.message),this.handleClose()}handleFullReportClicked(){this.setState({openFullReport:!this.state.openFullReport})}handleClose(){this.props.onClose()}handleSynchronize(){this.props.adminUserDirectoryContext.requestSynchronization(!0),this.handleClose()}isLoading(){return this.state.loading}get users(){return this.state.userDirectorySimulateSynchronizeResult.users}get groups(){return this.state.userDirectorySimulateSynchronizeResult.groups}get usersSuccess(){return this.users.filter((e=>"success"===e.status))}get groupsSuccess(){return this.groups.filter((e=>"success"===e.status))}get usersWarning(){return this.users.filter((e=>"warning"===e.status))}get groupsWarning(){return this.groups.filter((e=>"warning"===e.status))}get usersError(){return this.users.filter((e=>"error"===e.status))}get groupsError(){return this.groups.filter((e=>"error"===e.status))}get usersIgnored(){return this.users.filter((e=>"ignore"===e.status))}get groupsIgnored(){return this.groups.filter((e=>"ignore"===e.status))}hasSuccessResource(){return this.usersSuccess.length>0||this.groupsSuccess.length>0}hasSuccessUserResource(){return this.usersSuccess.length>0}hasSuccessGroupResource(){return this.groupsSuccess.length>0}hasErrorOrIgnoreResource(){return this.usersError.length>0||this.groupsError.length>0||this.usersWarning.length>0||this.groupsWarning.length>0||this.usersIgnored.length>0||this.groupsIgnored.length>0}getFullReport(){let e="";return e=e.concat(this.getUsersFullReport()),e=e.concat(this.getGroupsFullReport()),e}getUsersFullReport(){if(!(this.usersSuccess.length>0||this.usersWarning.length>0||this.usersError.length>0||this.usersIgnored.length>0))return"";let e="";const t=`-----------------------------------------------\n${this.props.t("Users")}\n-----------------------------------------------\n`;e=e.concat(t);const a=t=>e=e.concat(`- ${t.message}\n`);return this.usersSuccess.length>0&&(e=e.concat(`\n${this.props.t("Success:")}\n`),this.usersSuccess.map(a)),this.usersWarning.length>0&&(e=e.concat(`\n${this.props.t("Warning:")}\n`),this.usersWarning.map(a)),this.usersError.length>0&&(e=e.concat(`\n${this.props.t("Errors:")}\n`),this.usersError.map(a)),this.usersIgnored.length>0&&(e=e.concat(`\n${this.props.t("Ignored:")}\n`),this.usersIgnored.map(a)),e.concat("\n")}getGroupsFullReport(){if(!(this.groupsSuccess.length>0||this.groupsWarning.length>0||this.groupsError.length>0||this.groupsIgnored.length>0))return"";let e="";const t=`-----------------------------------------------\n${this.props.t("Groups")}\n-----------------------------------------------\n`;e=e.concat(t);const a=t=>e=e.concat(`- ${t.message}\n`);return this.groupsSuccess.length>0&&(e=e.concat(`\n${this.props.t("Success:")}\n`),this.groupsSuccess.map(a)),this.groupsWarning.length>0&&(e=e.concat(`\n${this.props.t("Warning:")}\n`),this.groupsWarning.map(a)),this.groupsError.length>0&&(e=e.concat(`\n${this.props.t("Errors:")}\n`),this.groupsError.map(a)),this.groupsIgnored.length>0&&(e=e.concat(`\n${this.props.t("Ignored:")}\n`),this.groupsIgnored.map(a)),e}get translate(){return this.props.t}render(){return s.createElement("div",null,this.isLoading()&&s.createElement(Ka,{onClose:this.handleClose,title:this.props.t("Synchronize simulation")}),!this.isLoading()&&s.createElement(wt,{className:"ldap-simulate-synchronize-dialog",title:this.props.t("Synchronize simulation report"),onClose:this.handleClose,disabled:this.isLoading()},s.createElement("div",{className:"form-content",onSubmit:this.handleFormSubmit},s.createElement("p",null,s.createElement("strong",null,s.createElement(v.x6,null,"The operation was successful."))),this.hasSuccessResource()&&s.createElement("p",{id:"resources-synchronize"},this.hasSuccessUserResource()&&s.createElement(s.Fragment,null,this.props.t("{{count}} user will be synchronized.",{count:this.usersSuccess.length})),this.hasSuccessUserResource()&&this.hasSuccessGroupResource()&&s.createElement("br",null),this.hasSuccessGroupResource()&&s.createElement(s.Fragment,null,this.props.t("{{count}} group will be synchronized.",{count:this.groupsSuccess.length}))),!this.hasSuccessResource()&&s.createElement("p",{id:"no-resources"}," ",s.createElement(v.x6,null,"No resources will be synchronized.")," "),s.createElement("div",{className:"accordion operation-details "+(this.state.openFullReport?"":"closed")},s.createElement("div",{className:"accordion-header",onClick:this.handleFullReportClicked},s.createElement("button",{type:"button",className:"link no-border"},s.createElement("span",null,s.createElement(v.x6,null,"Full report")),this.state.openFullReport?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"input text"},s.createElement("textarea",{className:"full_report",readOnly:!0,value:this.getFullReport()})))),this.hasErrorOrIgnoreResource()&&s.createElement("div",{className:"warning message no-margin"},s.createElement("p",null,s.createElement(v.x6,null,"Some resources will not be synchronized and will require your attention, see the full report.")))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.isLoading(),onClick:this.handleClose}),s.createElement("button",{type:"submit",disabled:this.isLoading(),className:"primary button form",onClick:this.handleSynchronize},s.createElement(v.x6,null,"Synchronize")))))}}ss.propTypes={onClose:r().func,dialogContext:r().object,actionFeedbackContext:r().any,adminUserDirectoryContext:r().object,t:r().func};const ns=d(as((0,v.CI)("common")(ss)));class is extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindEventHandlers()}get defaultState(){return{loading:!0,openFullReport:!1,userDirectorySynchronizeResult:null}}bindEventHandlers(){this.handleFullReportClicked=this.handleFullReportClicked.bind(this),this.handleClose=this.handleClose.bind(this),this.handleSynchronize=this.handleSynchronize.bind(this)}async componentDidMount(){try{const e=await this.props.adminUserDirectoryContext.synchronizeUsers();this.setState({loading:!1,userDirectorySynchronizeResult:e})}catch(e){await this.handleError(e)}}async handleError(e){console.error(e),await this.props.actionFeedbackContext.displayError(e.message),this.handleClose()}handleFullReportClicked(){this.setState({openFullReport:!this.state.openFullReport})}handleClose(){this.props.onClose()}handleSynchronize(){this.handleClose()}isLoading(){return this.state.loading}get users(){return this.state.userDirectorySynchronizeResult.users}get groups(){return this.state.userDirectorySynchronizeResult.groups}get usersSuccess(){return this.users.filter((e=>"success"===e.status))}get groupsSuccess(){return this.groups.filter((e=>"success"===e.status))}get usersWarning(){return this.users.filter((e=>"warning"===e.status))}get groupsWarning(){return this.groups.filter((e=>"warning"===e.status))}get usersError(){return this.users.filter((e=>"error"===e.status))}get groupsError(){return this.groups.filter((e=>"error"===e.status))}get usersIgnored(){return this.users.filter((e=>"ignore"===e.status))}get groupsIgnored(){return this.groups.filter((e=>"ignore"===e.status))}hasSuccessResource(){return this.usersSuccess.length>0||this.groupsSuccess.length>0}hasSuccessUserResource(){return this.usersSuccess.length>0}hasSuccessGroupResource(){return this.groupsSuccess.length>0}hasErrorOrIgnoreResource(){return this.usersError.length>0||this.groupsError.length>0||this.usersWarning.length>0||this.groupsWarning.length>0||this.usersIgnored.length>0||this.groupsIgnored.length>0}getFullReport(){let e="";return e=e.concat(this.getUsersFullReport()),e=e.concat(this.getGroupsFullReport()),e}getUsersFullReport(){if(!(this.usersSuccess.length>0||this.usersWarning.length>0||this.usersError.length>0||this.usersIgnored.length>0))return"";let e="";const t=`-----------------------------------------------\n${this.translate("Users")}\n-----------------------------------------------\n`;e=e.concat(t);const a=t=>e=e.concat(`- ${t.message}\n`);return this.usersSuccess.length>0&&(e=e.concat(`\n${this.translate("Success:")}\n`),this.usersSuccess.map(a)),this.usersWarning.length>0&&(e=e.concat(`\n${this.translate("Warning:")}\n`),this.usersWarning.map(a)),this.usersError.length>0&&(e=e.concat(`\n${this.translate("Errors:")}\n`),this.usersError.map(a)),this.usersIgnored.length>0&&(e=e.concat(`\n${this.translate("Ignored:")}\n`),this.usersIgnored.map(a)),e.concat("\n")}getGroupsFullReport(){if(!(this.groupsSuccess.length>0||this.groupsWarning.length>0||this.groupsError.length>0||this.groupsIgnored.length>0))return"";let e="";const t=`-----------------------------------------------\n${this.translate("Groups")}\n-----------------------------------------------\n`;e=e.concat(t);const a=t=>e=e.concat(`- ${t.message}\n`);return this.groupsSuccess.length>0&&(e=e.concat(`\n${this.translate("Success:")}\n`),this.groupsSuccess.map(a)),this.groupsWarning.length>0&&(e=e.concat(`\n${this.translate("Warning:")}\n`),this.groupsWarning.map(a)),this.groupsError.length>0&&(e=e.concat(`\n${this.translate("Errors:")}\n`),this.groupsError.map(a)),this.groupsIgnored.length>0&&(e=e.concat(`\n${this.translate("Ignored:")}\n`),this.groupsIgnored.map(a)),e}get translate(){return this.props.t}render(){return s.createElement("div",null,this.isLoading()&&s.createElement(Ka,{onClose:this.handleClose,title:this.translate("Synchronize")}),!this.isLoading()&&s.createElement(wt,{className:"ldap-simulate-synchronize-dialog",title:this.translate("Synchronize report"),onClose:this.handleClose,disabled:this.isLoading()},s.createElement("div",{className:"form-content",onSubmit:this.handleFormSubmit},s.createElement("p",null,s.createElement("strong",null,s.createElement(v.x6,null,"The operation was successful."))),this.hasSuccessResource()&&s.createElement("p",{id:"resources-synchronize"},this.hasSuccessUserResource()&&s.createElement(s.Fragment,null,this.translate("{{count}} user has been synchronized.",{count:this.usersSuccess.length})),this.hasSuccessUserResource()&&this.hasSuccessGroupResource()&&s.createElement("br",null),this.hasSuccessGroupResource()&&s.createElement(s.Fragment,null,this.translate("{{count}} group has been synchronized.",{count:this.groupsSuccess.length}))),!this.hasSuccessResource()&&s.createElement("p",{id:"no-resources"}," ",s.createElement(v.x6,null,"No resources have been synchronized.")," "),s.createElement("div",{className:"accordion operation-details "+(this.state.openFullReport?"":"closed")},s.createElement("div",{className:"accordion-header",onClick:this.handleFullReportClicked},s.createElement("button",{type:"button",className:"link no-border"},s.createElement("span",null,s.createElement(v.x6,null,"Full report")),this.state.openFullReport?s.createElement(Ct,{className:"baeline svg-icon"}):s.createElement(Nt,{className:"baeline svg-icon"}))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"input text"},s.createElement("textarea",{className:"full_report",readOnly:!0,value:this.getFullReport()})))),this.hasErrorOrIgnoreResource()&&s.createElement("div",{className:"warning message no-margin"},s.createElement("p",null,s.createElement(v.x6,null,"Some resources will not be synchronized and will require your attention, see the full report.")))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("button",{disabled:this.isLoading(),className:"primary button form",type:"button",onClick:this.handleClose},s.createElement(v.x6,null,"Ok")))))}}is.propTypes={onClose:r().func,actionFeedbackContext:r().any,adminUserDirectoryContext:r().object,t:r().func};const rs=d(as((0,v.CI)("common")(is)));class os{constructor(e,t){this.context=e,this.translate=t}static getInstance(e,t){return this.instance||(this.instance=new os(e,t)),this.instance}static killInstance(){this.instance=null}validate(){const e={hostError:this.validateHostInput(),portError:this.validatePortInput(),domainError:this.validateDomainInput(),fieldsMappingAdUserUsernameError:this.validateFieldsMappingAdUserUsernameInput(),fieldsMappingOpenLdapGroupUsersError:this.validateOpenLdapFieldsMappingGroupUsersInput()};return this.context.setErrors(e),0===Object.values(e).filter((e=>null!==e)).length}validateHostInput(){const e=this.context.getSettings(),t=e.host?.trim();return t.length?null:this.translate("A host is required.")}validatePortInput(){let e=null;const t=this.context.getSettings().port.trim();return t.length?ra()("^[0-9]+").test(t)||(e=this.translate("Only numeric characters allowed.")):e=this.translate("A port is required."),e}validateFieldsMappingAdUserUsernameInput(){const e=this.context.getSettings().fieldsMapping.ad.user.username;let t=null;return e&&""!==e.trim()?e.length>128&&(t=this.translate("The user username field mapping cannot exceed 128 characters.")):t=this.translate("The user username field mapping cannot be empty"),t}validateOpenLdapFieldsMappingGroupUsersInput(){const e=this.context.getSettings().fieldsMapping.openldap.group.users;let t=null;return e&&""!==e.trim()?e.length>128&&(t=this.translate("The group users field mapping cannot exceed 128 characters.")):t=this.translate("The group users field mapping cannot be empty"),t}validateDomainInput(){let e=null;return this.context.getSettings().domain.trim().length||(e=this.translate("A domain name is required.")),e}}const ls=os;class cs extends s.Component{hasChildren(){return this.props.node.group.groups.length>0}displayUserName(e){return`${e.profile.first_name} ${e.profile.last_name}`}get node(){return this.props.node}render(){return s.createElement("ul",{key:this.node.id},"group"===this.node.type&&s.createElement("li",{className:"group"},this.node.group.name,s.createElement("ul",null,Object.values(this.node.group.users).map((e=>s.createElement("li",{className:"user",key:e.id},e.errors&&s.createElement("span",{className:"error"},e.directory_name),!e.errors&&s.createElement("span",null,this.displayUserName(e.user)," ",s.createElement("em",null,"(",e.user.username,")"))))),Object.values(this.node.group.groups).map((e=>s.createElement(cs,{key:`tree-${e.id}`,node:e}))))),"user"===this.node.type&&s.createElement("li",{className:"user"},this.node.errors&&s.createElement("span",{className:"error"},this.node.directory_name),!this.node.errors&&s.createElement("span",null,this.displayUserName(this.node.user)," ",s.createElement("em",null,"(",this.node.user.username,")"))))}}cs.propTypes={node:r().object};const ms=cs;class ds extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindEventHandlers()}get defaultState(){return{loading:!0,openListGroupsUsers:!1,openStructureGroupsUsers:!1,openErrors:!1}}bindEventHandlers(){this.handleListGroupsUsersClicked=this.handleListGroupsUsersClicked.bind(this),this.handleStructureGroupsUsersClicked=this.handleStructureGroupsUsersClicked.bind(this),this.handleErrorsClicked=this.handleErrorsClicked.bind(this),this.handleClose=this.handleClose.bind(this)}componentDidMount(){this.setState({loading:!1})}handleListGroupsUsersClicked(){this.setState({openListGroupsUsers:!this.state.openListGroupsUsers})}handleStructureGroupsUsersClicked(){this.setState({openStructureGroupsUsers:!this.state.openStructureGroupsUsers})}handleErrorsClicked(){this.setState({openErrors:!this.state.openErrors})}handleClose(){this.props.onClose(),this.props.context.setContext({displayTestUserDirectoryDialogProps:null})}hasAllInputDisabled(){return this.state.loading}displayUserName(e){return`${e.profile.first_name} ${e.profile.last_name}`}get users(){return this.props.context.displayTestUserDirectoryDialogProps.userDirectoryTestResult.users}get groups(){return this.props.context.displayTestUserDirectoryDialogProps.userDirectoryTestResult.groups}get tree(){return this.props.context.displayTestUserDirectoryDialogProps.userDirectoryTestResult.tree}get errors(){return this.props.context.displayTestUserDirectoryDialogProps.userDirectoryTestResult.errors}get translate(){return this.props.t}render(){return s.createElement(wt,{className:"ldap-test-settings-dialog",title:this.translate("Test settings report"),onClose:this.handleClose,disabled:this.hasAllInputDisabled()},s.createElement("div",{className:"form-content"},s.createElement("p",null,s.createElement("strong",null,s.createElement(v.x6,null,"A connection could be established. Well done!"))),s.createElement("div",{className:"ldap-test-settings-report"},s.createElement("p",null,this.users.length>0&&s.createElement(s.Fragment,null,this.translate("{{count}} user has been found.",{count:this.users.length})),this.users.length>0&&this.groups.length>0&&s.createElement("br",null),this.groups.length>0&&s.createElement(s.Fragment,null,this.translate("{{count}} group has been found.",{count:this.groups.length}))),s.createElement("div",{className:"accordion directory-list "+(this.state.openListGroupsUsers?"":"closed")},s.createElement("div",{className:"accordion-header",onClick:this.handleListGroupsUsersClicked},s.createElement("button",{type:"button",className:"link no-border"},s.createElement("span",null,s.createElement(v.x6,null,"See list")),this.state.openListGroupsUsers?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"directory-list-content"},s.createElement("table",null,s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",null,s.createElement(v.x6,null,"Groups")),s.createElement("td",null,s.createElement(v.x6,null,"Users"))),s.createElement("tr",null,s.createElement("td",null,this.groups.map((e=>e.errors&&s.createElement("div",{key:e.id},s.createElement("span",{className:"error"},e.directory_name))||s.createElement("div",{key:e.id},e.group.name)))),s.createElement("td",null,this.users.map((e=>e.errors&&s.createElement("div",{key:e.id},s.createElement("span",{className:"error"},e.directory_name))||s.createElement("div",{key:e.id},this.displayUserName(e.user)," ",s.createElement("em",null,"(",e.user.username,")"))))))))))),s.createElement("div",{className:"accordion accordion-directory-structure "+(this.state.openStructureGroupsUsers?"":"closed")},s.createElement("div",{className:"accordion-header",onClick:this.handleStructureGroupsUsersClicked},s.createElement("button",{type:"button",className:"link no-border"},s.createElement("span",null,s.createElement(v.x6,null,"See structure")),this.state.openStructureGroupsUsers?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"directory-structure"},s.createElement("ul",null,s.createElement("li",{className:"group"},"Root",Object.values(this.tree).map((e=>s.createElement(ms,{key:`tree-${e.id}`,node:e})))))))),this.errors.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"accordion accordion-directory-errors "+(this.state.openErrors?"":"closed")},s.createElement("div",{className:"accordion-header",onClick:this.handleErrorsClicked},s.createElement("button",{type:"button",className:"link no-border"},s.createElement("span",null,s.createElement(v.x6,null,"See error details")),this.state.openErrors?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"directory-errors"},s.createElement("textarea",{value:JSON.stringify(this.errors,null," "),readOnly:!0})))),s.createElement("div",{className:"warning message no-margin"},s.createElement("p",{className:""},this.translate("{{count}} entry had errors and will be ignored during synchronization.",{count:this.errors.length})))))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("button",{type:"button",disabled:this.hasAllInputDisabled(),className:"primary button form",onClick:this.handleClose},s.createElement(v.x6,null,"Ok"))))}}ds.propTypes={context:r().any,onClose:r().func,t:r().func};const ps=I((0,v.CI)("common")(ds));var us;function hs(){return hs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},hs.apply(null,arguments)}const gs=function(e){return s.createElement("svg",hs({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),us||(us=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#test_svg__clip0_2120_505066)"},s.createElement("path",{d:"M15.75 5.25 5.115 15.885a2.122 2.122 0 0 1-2.993-3.008L12.75 2.25M12 1.5 16.5 6M9 12H3"}))))};var bs,ys,fs,vs;function Es(){return Es=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Es.apply(null,arguments)}const ws=function(e){return s.createElement("svg",Es({width:19,height:18,fill:"none",viewBox:"0 0 19 18"},e),bs||(bs=s.createElement("path",{stroke:"var(--icon-color)",strokeDasharray:"3 3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.847 9a6.75 6.75 0 0 1 6.75-6.75 7.3 7.3 0 0 1 5.055 2.055L16.347 6"})),ys||(ys=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16.347 2.25V6h-3.75"})),fs||(fs=s.createElement("path",{stroke:"var(--icon-color)",strokeDasharray:"3 3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16.347 9a6.75 6.75 0 0 1-6.75 6.75 7.3 7.3 0 0 1-5.055-2.055L2.847 12"})),vs||(vs=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.597 12h-3.75v3.75"})))};var ks,xs;function Cs(){return Cs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Cs.apply(null,arguments)}const Ss=function(e){return s.createElement("svg",Cs({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),ks||(ks=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 9A6.75 6.75 0 1 0 9 2.25a7.31 7.31 0 0 0-5.055 2.055L2.25 6"})),xs||(xs=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 2.25V6H6"})))};class _s extends s.Component{constructor(e){super(e),this.bindCallbacks(),this.state=this.defaultState,this.userDirectoryFormService=ls.getInstance(this.props.adminUserDirectoryContext,this.props.t)}componentDidUpdate(){this.props.adminUserDirectoryContext.mustOpenSynchronizePopUp()&&(this.props.adminUserDirectoryContext.requestSynchronization(!1),this.handleSynchronizeClick())}async handleSaveClick(){this.props.adminUserDirectoryContext.getSettings().userDirectoryToggle?await this.props.adminUserDirectoryContext.save():await this.props.adminUserDirectoryContext.delete(),this.handleSaveSuccess()}async handleFormSubmit(e){try{if(this.userDirectoryFormService.validate())switch(e){case"save":await this.handleSaveClick();break;case"test":await this.handleTestClick()}}catch(e){this.handleSubmitError(e)}finally{this.props.adminUserDirectoryContext.setSubmitted(!0),this.props.adminUserDirectoryContext.setProcessing(!1)}}async handleTestClick(){const e={userDirectoryTestResult:(await this.props.adminUserDirectoryContext.test()).body};this.props.context.setContext({displayTestUserDirectoryDialogProps:e}),this.props.dialogContext.open(ps)}isSaveEnabled(){return!this.props.adminUserDirectoryContext.isProcessing()&&this.props.adminUserDirectoryContext.hasSettingsChanges()}isTestEnabled(){return!this.props.adminUserDirectoryContext.isProcessing()&&this.props.adminUserDirectoryContext.getSettings().userDirectoryToggle}isSynchronizeEnabled(){return!this.props.adminUserDirectoryContext.isProcessing()&&this.props.adminUserDirectoryContext.getSettings().userDirectoryToggle&&this.props.adminUserDirectoryContext.getCurrentSettings().userDirectoryToggle}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this),this.handleTestClick=this.handleTestClick.bind(this),this.handleSimulateSynchronizeClick=this.handleSimulateSynchronizeClick.bind(this),this.handleSynchronizeClick=this.handleSynchronizeClick.bind(this)}handleSimulateSynchronizeClick(){this.props.dialogContext.open(ns)}handleSynchronizeClick(){this.props.dialogContext.open(rs)}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The user directory settings for the organization were updated."))}async handleSubmitError(e){"UserAbortsOperationError"!==e.name&&(console.error(e),await this.handleError(e))}async handleError(e){await this.props.actionFeedbackContext.displayError(e.message)}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("div",{className:"left-actions-wrapper"},s.createElement("button",{type:"button",className:"button secondary",disabled:!this.isTestEnabled(),onClick:()=>this.handleFormSubmit("test")},s.createElement(gs,null),s.createElement("span",null,s.createElement(v.x6,null,"Test settings"))),s.createElement("button",{type:"button",className:"button secondary ",disabled:!this.isSynchronizeEnabled(),onClick:this.handleSimulateSynchronizeClick},s.createElement(ws,null),s.createElement("span",null,s.createElement(v.x6,null,"Simulate synchronize"))),s.createElement("button",{type:"button",className:"button secondary",disabled:!this.isSynchronizeEnabled(),onClick:this.handleSynchronizeClick},s.createElement(Ss,null),s.createElement("span",null,s.createElement(v.x6,null,"Synchronize")))),s.createElement("button",{type:"button",className:"button primary form",disabled:!this.isSaveEnabled(),onClick:()=>this.handleFormSubmit("save")},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}_s.propTypes={context:r().object,dialogContext:r().object,adminUserDirectoryContext:r().object,actionFeedbackContext:r().object,t:r().func};const Ns=I(d(g(as((0,v.CI)("common")(_s)))));var Is,Ps;function As(){return As=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},As.apply(null,arguments)}const Ts=function(e){return s.createElement("svg",As({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},e),Is||(Is=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z"})),Ps||(Ps=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M14 2v4a2 2 0 0 0 2 2h4M10 9H8M16 13H8M16 17H8"})))};class Rs extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.userDirectoryFormService=ls.getInstance(this.props.adminUserDirectoryContext,this.props.t),this.bindCallbacks()}get defaultState(){return{hasFieldFocus:!1}}componentDidMount(){this.props.adminUserDirectoryContext.findUserDirectorySettings()}componentWillUnmount(){this.props.adminUserDirectoryContext.clearContext(),ls.killInstance(),this.userDirectoryFormService=null}bindCallbacks(){this.handleCredentialTitleClicked=this.handleCredentialTitleClicked.bind(this),this.handleDirectoryConfigurationTitleClicked=this.handleDirectoryConfigurationTitleClicked.bind(this),this.handleSynchronizationOptionsTitleClicked=this.handleSynchronizationOptionsTitleClicked.bind(this),this.handleFieldFocus=this.handleFieldFocus.bind(this),this.handleFieldBlur=this.handleFieldBlur.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleAdUserFieldsMappingInputChange=this.handleAdUserFieldsMappingInputChange.bind(this),this.handleOpenLdapGroupFieldsMappingInputChange=this.handleOpenLdapGroupFieldsMappingInputChange.bind(this),this.handleAdFallbackFieldInputChange=this.handleAdFallbackFieldInputChange.bind(this)}handleCredentialTitleClicked(){const e=this.props.adminUserDirectoryContext.getSettings();this.props.adminUserDirectoryContext.setSettings("openCredentials",!e.openCredentials)}handleDirectoryConfigurationTitleClicked(){const e=this.props.adminUserDirectoryContext.getSettings();this.props.adminUserDirectoryContext.setSettings("openDirectoryConfiguration",!e.openDirectoryConfiguration)}handleSynchronizationOptionsTitleClicked(){const e=this.props.adminUserDirectoryContext.getSettings();this.props.adminUserDirectoryContext.setSettings("openSynchronizationOptions",!e.openSynchronizationOptions)}handleInputChange(e){const t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;this.props.adminUserDirectoryContext.setSettings(s,a)}handleAdUserFieldsMappingInputChange(e){const{value:t,name:a}=e.target;this.props.adminUserDirectoryContext.setAdUserFieldsMappingSettings(a,t)}handleAdFallbackFieldInputChange(e){const{value:t,name:a}=e.target;this.props.adminUserDirectoryContext.setAdFallbackFieldsSettings(a,t)}handleOpenLdapGroupFieldsMappingInputChange(e){const t=e.target,a=t.value,s=t.name;this.props.adminUserDirectoryContext.setOpenLdapGroupFieldsMappingSettings(s,a)}handleFieldFocus(){this.setState({hasFieldFocus:!0})}handleFieldBlur(){this.setState({hasFieldFocus:!1})}hasAllInputDisabled(){const e=this.props.adminUserDirectoryContext.getSettings();return e.processing||e.loading}isUserDirectoryChecked(){return this.props.adminUserDirectoryContext.getSettings().userDirectoryToggle}isActiveDirectoryChecked(){return"ad"===this.props.adminUserDirectoryContext.getSettings().directoryType}isOpenLdapChecked(){return"openldap"===this.props.adminUserDirectoryContext.getSettings().directoryType}isUseEmailPrefixChecked(){return this.props.adminUserDirectoryContext.getSettings().useEmailPrefix}getUsersAllowedToBeDefaultAdmin(){const e=this.props.adminUserDirectoryContext.getUsers();if(null!==e){const t=e.filter((e=>!0===e.active&&"admin"===e.role.name));return t&&t.map((e=>({value:e.id,label:this.displayUser(e)})))}return[]}getUsersAllowedToBeDefaultGroupAdmin(){const e=this.props.adminUserDirectoryContext.getUsers();if(null!==e){const t=e.filter((e=>!0===e.active));return t&&t.map((e=>({value:e.id,label:this.displayUser(e)})))}return[]}displayUser(e){return`${e.profile.first_name} ${e.profile.last_name} (${e.username})`}shouldShowSourceWarningMessage(){const e=this.props.adminUserDirectoryContext;return"file"===e?.getCurrentSettings()?.source&&e?.hasSettingsChanges()}get settingsSource(){return this.props.adminUserDirectoryContext?.getCurrentSettings()?.source}get configurationSource(){return{env:this.props.t("environment variables"),file:this.props.t("file"),db:this.props.t("database"),default:this.props.t("default")}[this.settingsSource]||this.props.t("unknown")}get connectionType(){return[{value:"plain",label:"ldap://"},{value:"ssl",label:"ldaps:// (ssl)"},{value:"tls",label:"ldaps:// (tls)"}]}get supportedAuthenticationMethod(){return[{value:"basic",label:this.props.t("Basic")},{value:"sasl",label:"SASL (EE)"}]}render(){const e=this.props.adminUserDirectoryContext.getSettings(),t=this.props.adminUserDirectoryContext.getErrors(),a=this.props.adminUserDirectoryContext.isSubmitted(),n=this.props.adminUserDirectoryContext.hadDisabledSettings(),i=null!==this.props.adminUserDirectoryContext.getCurrentSettings()&&this.props.adminUserDirectoryContext.hasSettingsChanges(),r=this.shouldShowSourceWarningMessage()||!this.isUserDirectoryChecked()||i;return s.createElement("div",{className:"row"},s.createElement("div",{className:"ldap-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userDirectoryToggle",onChange:this.handleInputChange,checked:e.userDirectoryToggle,disabled:this.hasAllInputDisabled(),id:"userDirectoryToggle"}),s.createElement("label",{htmlFor:"userDirectoryToggle"},s.createElement(v.x6,null,"Users Directory")))),this.isUserDirectoryChecked()&&s.createElement(s.Fragment,null,s.createElement("p",{className:"description"},s.createElement(v.x6,null,"A Users Directory is configured. The users and groups of passbolt will synchronize with it.")),s.createElement("div",{className:"accordion section-general "+(e.openCredentials?"":"closed")},s.createElement("h4",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleCredentialTitleClicked},e.openCredentials?s.createElement(Ct,{className:"caret-down"}):s.createElement(Nt,{className:"caret-right"}),s.createElement(v.x6,null,"Credentials"))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"radiolist required"},s.createElement("label",null,s.createElement(v.x6,null,"Directory type")),s.createElement("div",{className:"input radio ad openldap form-element "},s.createElement("div",{className:"input radio"},s.createElement("input",{type:"radio",value:"ad",onChange:this.handleInputChange,name:"directoryType",checked:this.isActiveDirectoryChecked(),id:"directoryTypeAd",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"directoryTypeAd"},s.createElement(v.x6,null,"Active Directory"))),s.createElement("div",{className:"input radio"},s.createElement("input",{type:"radio",value:"openldap",onChange:this.handleInputChange,name:"directoryType",checked:this.isOpenLdapChecked(),id:"directoryTypeOpenLdap",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"directoryTypeOpenLdap"},s.createElement(v.x6,null,"Open Ldap"))))),s.createElement("div",{className:"input text required ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Server url")),s.createElement("div",{className:`input text singleline connection_info ad openldap ${this.hasAllInputDisabled()?"disabled":""} ${this.state.hasFieldFocus?"no-focus":""}`},s.createElement("input",{id:"server-input",type:"text","aria-required":!0,className:"required host ad openldap form-element",name:"host",value:e.host,onChange:this.handleInputChange,placeholder:this.props.t("host"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"protocol",onBlur:this.handleFieldBlur,onFocus:this.handleFieldFocus},s.createElement(Oa,{className:"inline",name:"connectionType",items:this.connectionType,value:e.connectionType,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()})),s.createElement("div",{className:"port ad openldap"},s.createElement("input",{id:"port-input",type:"number","aria-required":!0,className:"required in-field form-element",name:"port",value:e.port,onChange:this.handleInputChange,onBlur:this.handleFieldBlur,onFocus:this.handleFieldFocus,disabled:this.hasAllInputDisabled()}))),t.hostError&&a&&s.createElement("div",{id:"server-input-feedback",className:"error-message"},t.hostError),t.portError&&a&&s.createElement("div",{id:"port-input-feedback",className:"error-message"},t.portError)),s.createElement("div",{className:"select-wrapper input required ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Authentication method")),s.createElement(Oa,{items:this.supportedAuthenticationMethod,id:"authentication-type-select",name:"authenticationType",value:e.authenticationType,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()})),"basic"===e.authenticationType&&s.createElement("div",{className:"singleline clearfix"},s.createElement("div",{className:"input text first-field ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Username")),s.createElement("input",{id:"username-input",type:"text",className:"fluid form-element",name:"username",value:e.username,onChange:this.handleInputChange,placeholder:this.props.t("Username"),disabled:this.hasAllInputDisabled()})),s.createElement("div",{className:"input text last-field ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Password")),s.createElement("input",{id:"password-input",className:"fluid form-element",name:"password",value:e.password,onChange:this.handleInputChange,placeholder:this.props.t("Password"),type:"password",disabled:this.hasAllInputDisabled()}))),s.createElement("div",{className:"input text required ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Domain")),s.createElement("input",{id:"domain-name-input","aria-required":!0,type:"text",name:"domain",value:e.domain,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:"domain.ext",disabled:this.hasAllInputDisabled()}),t.domainError&&a&&s.createElement("div",{id:"domain-name-input-feedback",className:"error-message"},t.domainError)),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Base DN")),s.createElement("input",{id:"base-dn-input",type:"text",name:"baseDn",value:e.baseDn,onChange:this.handleInputChange,className:"fluid form-element",placeholder:"OU=OrgUsers,DC=mydomain,DC=local",disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"The base DN (default naming context) for the domain.")," ",s.createElement(v.x6,null,"If this is empty then it will be queried from the RootDSE."))))),s.createElement("div",{className:"accordion section-directory-configuration "+(e.openDirectoryConfiguration?"":"closed")},s.createElement("h4",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleDirectoryConfigurationTitleClicked},e.openDirectoryConfiguration?s.createElement(Ct,{className:"caret-down"}):s.createElement(Nt,{className:"caret-right"}),s.createElement(v.x6,null,"Directory configuration"))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Group path")),s.createElement("input",{id:"group-path-input",type:"text","aria-required":!0,name:"groupPath",value:e.groupPath,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:this.props.t("Group path"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Group path is used in addition to the base DN while searching groups.")," ",s.createElement(v.x6,null,"Leave empty if users and groups are in the same DN."))),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"User path")),s.createElement("input",{id:"user-path-input",type:"text","aria-required":!0,name:"userPath",value:e.userPath,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:this.props.t("User path"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"User path is used in addition to base DN while searching users."))),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Group custom filters")),s.createElement("input",{id:"group-custom-filters-input",type:"text",name:"groupCustomFilters",value:e.groupCustomFilters,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:this.props.t("Group custom filters"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Group custom filters are used in addition to the base DN and group path while searching groups.")," ",s.createElement(v.x6,null,"Leave empty if no additional filter is required."))),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"User custom filters")),s.createElement("input",{id:"user-custom-filters-input",type:"text",name:"userCustomFilters",value:e.userCustomFilters,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:this.props.t("User custom filters"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"User custom filters are used in addition to the base DN and user path while searching users.")," ",s.createElement(v.x6,null,"Leave empty if no additional filter is required."))),this.isOpenLdapChecked()&&s.createElement("div",null,s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Group object class")),s.createElement("input",{id:"group-object-class-input",type:"text","aria-required":!0,name:"groupObjectClass",value:e.groupObjectClass,onChange:this.handleInputChange,className:"required fluid",placeholder:"GroupObjectClass",disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"For Openldap only. Defines which group object to use.")," (",s.createElement(v.x6,null,"Default"),": groupOfUniqueNames)")),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"User object class")),s.createElement("input",{id:"user-object-class-input",type:"text","aria-required":!0,name:"userObjectClass",value:e.userObjectClass,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:"UserObjectClass",disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"For Openldap only. Defines which user object to use.")," (",s.createElement(v.x6,null,"Default"),": inetOrgPerson)")),s.createElement("div",{className:"input text openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Use email prefix / suffix?")),s.createElement("div",{className:"input toggle-switch openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"useEmailPrefix",value:e.useEmailPrefix,onChange:this.handleInputChange,id:"use-email-prefix-suffix-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"use-email-prefix-suffix-toggle-button"},s.createElement(v.x6,null,"Build email based on a prefix and suffix?"))),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Use this option when user entries do not include an email address by default"))),this.isUseEmailPrefixChecked()&&s.createElement("div",{className:"singleline clearfix",id:"use-email-prefix-suffix-options"},s.createElement("div",{className:"input text first-field openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Email prefix")),s.createElement("input",{id:"email-prefix-input",type:"text","aria-required":!0,name:"emailPrefix",checked:e.emailPrefix,onChange:this.handleInputChange,className:"required fluid form-element",placeholder:this.props.t("Username"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"The attribute you would like to use for the first part of the email (usually username)."))),s.createElement("div",{className:"input text last-field openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Email suffix")),s.createElement("input",{id:"email-suffix-input",type:"text","aria-required":!0,name:"emailSuffix",value:e.emailSuffix,onChange:this.handleInputChange,className:"required form-element",placeholder:this.props.t("@your-domain.com"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"The domain name part of the email (@your-domain-name).")))),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Group users field mapping")),s.createElement("input",{id:"field-mapping-openldap-group-users-input",type:"text","aria-required":!0,name:"users",value:e.fieldsMapping.openldap.group.users,onChange:this.handleOpenLdapGroupFieldsMappingInputChange,className:"fluid form-element",placeholder:this.props.t("Group users field mapping"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Directory group's users field to map to Passbolt group's field.")),t.fieldsMappingOpenLdapGroupUsersError&&a&&s.createElement("div",{id:"field-mapping-openldap-group-users-input-feedback",className:"error-message"},t.fieldsMappingOpenLdapGroupUsersError))),this.isActiveDirectoryChecked()&&s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"User username field mapping")),s.createElement("input",{id:"field-mapping-ad-user-username-input",type:"text","aria-required":!0,name:"username",value:e.fieldsMapping.ad.user.username,onChange:this.handleAdUserFieldsMappingInputChange,className:"fluid form-element",placeholder:this.props.t("User username field mapping"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Directory user's username field to map to Passbolt user's username field.")),t.fieldsMappingAdUserUsernameError&&a&&s.createElement("div",{id:"field-mapping-ad-user-username-input-feedback",className:"error-message"},t.fieldsMappingAdUserUsernameError)))),s.createElement("div",{className:"accordion section-sync-options "+(e.openSynchronizationOptions?"":"closed")},s.createElement("h4",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleSynchronizationOptionsTitleClicked},e.openSynchronizationOptions?s.createElement(Ct,{className:"caret-down"}):s.createElement(Nt,{className:"caret-right"}),s.createElement(v.x6,null,"Synchronization options"))),s.createElement("div",{className:"accordion-content"},s.createElement("div",{className:"select-wrapper input required ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Default admin")),s.createElement(Oa,{items:this.getUsersAllowedToBeDefaultAdmin(),id:"default-user-select",name:"defaultAdmin",value:e.defaultAdmin,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),search:!0}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"The default admin user is the user that will perform the operations for the the directory."))),s.createElement("div",{className:"select-wrapper input required ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Default group admin")),s.createElement(Oa,{items:this.getUsersAllowedToBeDefaultGroupAdmin(),id:"default-group-admin-user-select",name:"defaultGroupAdmin",value:e.defaultGroupAdmin,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),search:!0}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"The default group manager is the user that will be the group manager of newly created groups."))),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Groups parent group")),s.createElement("input",{id:"groups-parent-group-input",type:"text",name:"groupsParentGroup",value:e.groupsParentGroup,onChange:this.handleInputChange,className:"fluid form-element",placeholder:this.props.t("Groups parent group"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Synchronize only the groups which are members of this group."))),s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Users parent group")),s.createElement("input",{id:"users-parent-group-input",type:"text",name:"usersParentGroup",value:e.usersParentGroup,onChange:this.handleInputChange,className:"fluid form-element",placeholder:this.props.t("Users parent group"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Synchronize only the users which are members of this group."))),this.isActiveDirectoryChecked&&s.createElement("div",{className:"input text ad openldap "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"User username fallback field")),s.createElement("input",{id:"fallback-fields-ad-username-fallback-input",type:"text","aria-required":!0,name:"username",value:e.fallbackFields.ad.username,onChange:this.handleAdFallbackFieldInputChange,className:"fluid form-element",placeholder:this.props.t("User username fallback field"),disabled:this.hasAllInputDisabled()}),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Directory user's username fallback field to use when user username field cannot be found.")),t.fallbackFieldsAdUsernameError&&a&&s.createElement("div",{id:"fallback-fields-ad-username-fallback-input-feedback",className:"error-message"},t.fallbackFieldsAdUsernameError)),this.isActiveDirectoryChecked()&&s.createElement("div",{className:"input text clearfix ad "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Enabled users only")),s.createElement("div",{className:"input toggle-switch ad form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"enabledUsersOnly",checked:e.enabledUsersOnly,onChange:this.handleInputChange,id:"enabled-users-only-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"enabled-users-only-toggle-button"},s.createElement(v.x6,null,"Only synchronize enabled users (AD)")))),s.createElement("div",{className:"input text clearfix ad openldap"},s.createElement("label",null,s.createElement(v.x6,null,"Sync operations")),s.createElement("div",{className:"col6"},s.createElement("div",{className:"input toggle-switch ad openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"createUsers",checked:e.createUsers,onChange:this.handleInputChange,id:"sync-users-create-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"sync-users-create-toggle-button"},s.createElement(v.x6,null,"Create users"))),s.createElement("div",{className:"input toggle-switch ad openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"deleteUsers",checked:e.deleteUsers,onChange:this.handleInputChange,id:"sync-users-delete-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"sync-users-delete-toggle-button"},s.createElement(v.x6,null,"Delete users"))),s.createElement("div",{className:"input toggle-switch ad openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"updateUsers",checked:e.updateUsers,onChange:this.handleInputChange,id:"sync-users-update-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"sync-users-update-toggle-button"},s.createElement(v.x6,null,"Update users")))),s.createElement("div",{className:"col6 last"},s.createElement("div",{className:"input toggle-switch ad openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"createGroups",checked:e.createGroups,onChange:this.handleInputChange,id:"sync-groups-create-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"sync-groups-create-toggle-button"},s.createElement(v.x6,null,"Create groups"))),s.createElement("div",{className:"input toggle-switch ad openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"deleteGroups",checked:e.deleteGroups,onChange:this.handleInputChange,id:"sync-groups-delete-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"sync-groups-delete-toggle-button"},s.createElement(v.x6,null,"Delete groups"))),s.createElement("div",{className:"input toggle-switch ad openldap form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"updateGroups",checked:e.updateGroups,onChange:this.handleInputChange,id:"sync-groups-update-toggle-button",disabled:this.hasAllInputDisabled()}),s.createElement("label",{className:"text",htmlFor:"sync-groups-update-toggle-button"},s.createElement(v.x6,null,"Update groups"))))),s.createElement("div",{className:"input text clearfix ad openldap"},s.createElement("label",null,s.createElement(v.x6,null,"Delete or suspend users")),s.createElement("div",{className:"help-message"},s.createElement(v.x6,null,"Define the behaviour when existing synchronized users are removed from the users directory"),":"),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio "+("delete"===e.deleteUserBehavior?"checked":"")},s.createElement("input",{type:"radio",value:"delete",onChange:this.handleInputChange,name:"deleteUserBehavior",checked:"delete"===e.deleteUserBehavior,id:"deleteUserBehaviorDelete",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"deleteUserBehaviorDelete"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Delete users")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Delete the users and all the data associated with them.")," ",s.createElement(v.x6,null,"The data will be permanently deleted, this action cannot be undone.")))),s.createElement("div",{className:"input radio "+("disable"===e.deleteUserBehavior?"checked":"")},s.createElement("input",{type:"radio",value:"disable",onChange:this.handleInputChange,name:"deleteUserBehavior",checked:"disable"===e.deleteUserBehavior,id:"deleteUserBehaviorSuspended",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"deleteUserBehaviorSuspended"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Suspend users")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Suspend the users, preventing them from signing in to Passbolt and from receiving email notifications.")," ",s.createElement(v.x6,null,"Other users can still share resources with them and add them to groups.")))))))))),r&&s.createElement("div",{className:"warning message"},this.shouldShowSourceWarningMessage()&&s.createElement("div",null,s.createElement(v.x6,null,"These are the settings provided by a configuration file. If you save it, will ignore the settings on file and use the ones from the database.")),i&&s.createElement("div",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification.")),!this.isUserDirectoryChecked()&&s.createElement(s.Fragment,null,n&&s.createElement("div",null,s.createElement(v.x6,null,"The configuration has been disabled as it needs to be checked to make it correct before using it.")),!n&&s.createElement("div",null,s.createElement("p",{className:"description"},s.createElement(v.x6,null,"No Users Directory is configured. Enable it to synchronise your users and groups with passbolt.")))))),s.createElement(Ns,null),Ea(s.createElement(s.Fragment,null,s.createElement("div",{className:"sidebar-help-section",id:"user-directory-settings-source"},s.createElement("h3",null,s.createElement(v.x6,null,"Configuration source")),s.createElement("p",null,s.createElement(v.x6,null,"This current configuration source is: "),this.configurationSource,".")),s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"Check out our ldap configuration guide.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/user-provisioning/users-directory/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation"))))),document.getElementById("administration-help-panel")))}}Rs.propTypes={adminUserDirectoryContext:r().object,administrationWorkspaceContext:r().object,t:r().func};const Ds=as(Ee((0,v.CI)("common")(Rs))),Os=class{constructor(e){e.setResourceName("settings/emails/notifications"),this.apiClient=new Qt(e)}async find(){return(await this.apiClient.findAll()).body}async save(e){return(await this.apiClient.create(e)).body}},Us=class{constructor(e={}){this.hasDatabaseSetting="sources_database"in e&&e.sources_database,this.hasFileConfigSetting="sources_file"in e&&e.sources_file,this.passwordCreate=!("send_password_create"in e)||e.send_password_create,this.passwordShare=!("send_password_share"in e)||e.send_password_share,this.passwordUpdate=!("send_password_update"in e)||e.send_password_update,this.passwordDelete=!("send_password_delete"in e)||e.send_password_delete,this.folderCreate=!("send_folder_create"in e)||e.send_folder_create,this.folderUpdate=!("send_folder_update"in e)||e.send_folder_update,this.folderDelete=!("send_folder_delete"in e)||e.send_folder_delete,this.folderShare=!("send_folder_share"in e)||e.send_folder_share,this.commentAdd=!("send_comment_add"in e)||e.send_comment_add,this.groupDelete=!("send_group_delete"in e)||e.send_group_delete,this.groupUserAdd=!("send_group_user_add"in e)||e.send_group_user_add,this.groupUserDelete=!("send_group_user_delete"in e)||e.send_group_user_delete,this.groupUserUpdate=!("send_group_user_update"in e)||e.send_group_user_update,this.groupManagerUpdate=!("send_group_manager_update"in e)||e.send_group_manager_update,this.groupManagerRequestAddUser=!("send_group_manager_requestAddUser"in e)||e.send_group_manager_requestAddUser,this.userCreate=!("send_user_create"in e)||e.send_user_create,this.userRecover=!("send_user_recover"in e)||e.send_user_recover,this.userRecoverComplete=!("send_user_recoverComplete"in e)||e.send_user_recoverComplete,this.userRecoverAbortAdmin=!("send_admin_user_recover_abort"in e)||e.send_admin_user_recover_abort,this.userRecoverCompleteAdmin=!("send_admin_user_recover_complete"in e)||e.send_admin_user_recover_complete,this.userSetupCompleteAdmin=!("send_admin_user_setup_completed"in e)||e.send_admin_user_setup_completed,this.showDescription=!("show_description"in e)||e.show_description,this.showSecret=!("show_secret"in e)||e.show_secret,this.showUri=!("show_uri"in e)||e.show_uri,this.showUsername=!("show_username"in e)||e.show_username,this.showComment=!("show_comment"in e)||e.show_comment,this.accountRecoveryRequestUser=!("send_accountRecovery_request_user"in e)||e.send_accountRecovery_request_user,this.accountRecoveryRequestAdmin=!("send_accountRecovery_request_admin"in e)||e.send_accountRecovery_request_admin,this.accountRecoveryRequestGuessing=!("send_accountRecovery_request_guessing"in e)||e.send_accountRecovery_request_guessing,this.accountRecoveryRequestUserApproved=!("send_accountRecovery_response_user_approved"in e)||e.send_accountRecovery_response_user_approved,this.accountRecoveryRequestUserRejected=!("send_accountRecovery_response_user_rejected"in e)||e.send_accountRecovery_response_user_rejected,this.accountRecoveryRequestCreatedAmin=!("send_accountRecovery_response_created_admin"in e)||e.send_accountRecovery_response_created_admin,this.accountRecoveryRequestCreatedAllAdmins=!("send_accountRecovery_response_created_allAdmins"in e)||e.send_accountRecovery_response_created_allAdmins,this.accountRecoveryRequestPolicyUpdate=!("send_accountRecovery_policy_update"in e)||e.send_accountRecovery_policy_update,this.passwordExpiryExpiredUser=!("send_password_expire"in e)||e.send_password_expire}},Ms=class{constructor(e={}){this.sources_database="hasDatabaseSetting"in e&&e.hasDatabaseSetting,this.sources_file="hasFileConfigSetting"in e&&e.hasFileConfigSetting,this.send_password_create=!("passwordCreate"in e)||e.passwordCreate,this.send_password_share=!("passwordShare"in e)||e.passwordShare,this.send_password_update=!("passwordUpdate"in e)||e.passwordUpdate,this.send_password_delete=!("passwordDelete"in e)||e.passwordDelete,this.send_folder_create=!("folderCreate"in e)||e.folderCreate,this.send_folder_update=!("folderUpdate"in e)||e.folderUpdate,this.send_folder_delete=!("folderDelete"in e)||e.folderDelete,this.send_folder_share=!("folderShare"in e)||e.folderShare,this.send_comment_add=!("commentAdd"in e)||e.commentAdd,this.send_group_delete=!("groupDelete"in e)||e.groupDelete,this.send_group_user_add=!("groupUserAdd"in e)||e.groupUserAdd,this.send_group_user_delete=!("groupUserDelete"in e)||e.groupUserDelete,this.send_group_user_update=!("groupUserUpdate"in e)||e.groupUserUpdate,this.send_group_manager_update=!("groupManagerUpdate"in e)||e.groupManagerUpdate,this.send_group_manager_requestAddUser=!("groupManagerRequestAddUser"in e)||e.groupManagerRequestAddUser,this.send_user_create=!("userCreate"in e)||e.userCreate,this.send_user_recover=!("userRecover"in e)||e.userRecover,this.send_user_recoverComplete=!("userRecoverComplete"in e)||e.userRecoverComplete,this.send_admin_user_setup_completed=!("userSetupCompleteAdmin"in e)||e.userSetupCompleteAdmin,this.send_admin_user_recover_abort=!("userRecoverAbortAdmin"in e)||e.userRecoverAbortAdmin,this.send_admin_user_recover_complete=!("userRecoverCompleteAdmin"in e)||e.userRecoverCompleteAdmin,this.send_accountRecovery_request_user=!("accountRecoveryRequestUser"in e)||e.accountRecoveryRequestUser,this.send_accountRecovery_request_admin=!("accountRecoveryRequestAdmin"in e)||e.accountRecoveryRequestAdmin,this.send_accountRecovery_request_guessing=!("accountRecoveryRequestGuessing"in e)||e.accountRecoveryRequestGuessing,this.send_accountRecovery_response_user_approved=!("accountRecoveryRequestUserApproved"in e)||e.accountRecoveryRequestUserApproved,this.send_accountRecovery_response_user_rejected=!("accountRecoveryRequestUserRejected"in e)||e.accountRecoveryRequestUserRejected,this.send_accountRecovery_response_created_admin=!("accountRecoveryRequestCreatedAmin"in e)||e.accountRecoveryRequestCreatedAmin,this.send_accountRecovery_response_created_allAdmins=!("accountRecoveryRequestCreatedAllAdmins"in e)||e.accountRecoveryRequestCreatedAllAdmins,this.send_accountRecovery_policy_update=!("accountRecoveryRequestPolicyUpdate"in e)||e.accountRecoveryRequestPolicyUpdate,this.show_description=!("showDescription"in e)||e.showDescription,this.show_secret=!("showSecret"in e)||e.showSecret,this.show_uri=!("showUri"in e)||e.showUri,this.show_username=!("showUsername"in e)||e.showUsername,this.show_comment=!("showComment"in e)||e.showComment,this.send_password_expire=!("passwordExpiryExpiredUser"in e)||e.passwordExpiryExpiredUser}};function Fs(){return Fs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Fs.apply(null,arguments)}const js=s.createContext({getCurrentSettings:()=>{},getSettings:()=>{},setSettings:()=>{},hasSettingsChanges:()=>{},findEmailNotificationSettings:()=>{},save:()=>{},setProcessing:()=>{},isProcessing:()=>{},clearContext:()=>{}});class zs extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.emailNotificationService=new Os(t)}get defaultState(){return{currentSettings:null,settings:new Us,processing:!0,getCurrentSettings:this.getCurrentSettings.bind(this),getSettings:this.getSettings.bind(this),setSettings:this.setSettings.bind(this),findEmailNotificationSettings:this.findEmailNotificationSettings.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),save:this.save.bind(this),clearContext:this.clearContext.bind(this)}}async findEmailNotificationSettings(){this.setProcessing(!0);const e=await this.emailNotificationService.find(),t=new Us(e);this.setState({currentSettings:t}),this.setState({settings:Object.assign({},t)}),this.setProcessing(!1)}getCurrentSettings(){return this.state.currentSettings}getSettings(){return this.state.settings}setSettings(e,t){const a=Object.assign({},this.state.settings,{[e]:t});this.setState({settings:a})}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasSettingsChanges(){return this.state.currentSettings&&JSON.stringify(this.state.currentSettings)!==JSON.stringify(this.state.settings)}clearContext(){const{currentSettings:e,settings:t,processing:a}=this.defaultState;this.setState({currentSettings:e,settings:t,processing:a})}async save(){this.setProcessing(!0);const e=new Ms(this.state.settings);await this.emailNotificationService.save(e),await this.findEmailNotificationSettings()}render(){return s.createElement(js.Provider,{value:this.state},this.props.children)}}zs.propTypes={context:r().any,children:r().any};const Ls=I(zs);function qs(e){return class extends s.Component{render(){return s.createElement(js.Consumer,null,(t=>s.createElement(e,Fs({adminEmailNotificationContext:t},this.props))))}}}class Ks extends s.Component{constructor(e){super(e),this.bindCallbacks()}async handleSaveClick(){try{await this.props.adminEmailNotificationContext.save(),this.handleSaveSuccess()}catch(e){this.handleSaveError(e)}finally{this.props.adminEmailNotificationContext.setProcessing(!1)}}isSaveEnabled(){return!this.props.adminEmailNotificationContext.isProcessing()&&this.props.adminEmailNotificationContext.hasSettingsChanges()}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this)}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The email notification settings were updated."))}async handleSaveError(e){"UserAbortsOperationError"!==e.name&&(console.error(e),await this.handleError(e))}async handleError(e){await this.props.actionFeedbackContext.displayError(e.message)}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{className:"button primary form",type:"button",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick,id:"save-settings"},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Ks.propTypes={adminEmailNotificationContext:r().object,actionFeedbackContext:r().object,t:r().func};const Ws=qs(d((0,v.CI)("common")(Ks)));class Vs extends s.Component{constructor(e){super(e),this.bindCallbacks()}async componentDidMount(){this.props.adminEmailNotificationContext.findEmailNotificationSettings()}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminEmailNotificationContext.clearContext()}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this)}handleInputChange(e){const t=e.target.checked,a=e.target.name;this.props.adminEmailNotificationContext.setSettings(a,t)}hasAllInputDisabled(){return this.props.adminEmailNotificationContext.isProcessing()}hasDatabaseSetting(){return this.props.adminEmailNotificationContext.getSettings().hasDatabaseSetting}hasFileConfigSetting(){return this.props.adminEmailNotificationContext.getSettings().hasFileConfigSetting}canUseFolders(){return this.props.context.siteSettings.canIUse("folders")}canUseAccountRecovery(){return this.props.context.siteSettings.canIUse("accountRecovery")}canUsePasswordExpiry(){return this.props.context.siteSettings.canIUse("passwordExpiry")||this.props.context.siteSettings.canIUse("passwordExpiryPolicies")}canUsePasswordExpiryAdvancedSettings(){return this.props.context.siteSettings.canIUse("passwordExpiryPolicies")}get settingsSource(){return this.hasDatabaseSetting()?"db":this.hasFileConfigSetting()?"file":"env"}get configurationSource(){return{env:this.props.t("environment variables"),file:this.props.t("file"),db:this.props.t("database")}[this.settingsSource]||this.props.t("unknown")}render(){const e=this.props.adminEmailNotificationContext.getSettings(),t=e&&this.props.adminEmailNotificationContext.hasSettingsChanges(),a=e&&this.hasFileConfigSetting(),n=e&&this.hasDatabaseSetting(),i=a||t;return s.createElement("div",{className:"row"},s.createElement("div",{className:"email-notification-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Email delivery")),s.createElement("div",{className:"divider"}),s.createElement("p",null,s.createElement(v.x6,null,"In this section you can choose which email notifications will be sent.")),s.createElement("div",{className:"section"},s.createElement("div",{className:"password-section"},s.createElement("label",null,s.createElement(v.x6,null,"Passwords")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"passwordCreate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.passwordCreate,id:"send-password-create-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-password-create-toggle-button"},s.createElement(v.x6,null,"When a password is created, notify its creator."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"passwordUpdate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.passwordUpdate,id:"send-password-update-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-password-update-toggle-button"},s.createElement(v.x6,null,"When a password is updated, notify the users who have access to it."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"passwordDelete",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.passwordDelete,id:"send-password-delete-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-password-delete-toggle-button"},s.createElement(v.x6,null,"When a password is deleted, notify the users who had access to it."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"passwordShare",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.passwordShare,id:"send-password-share-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-password-share-toggle-button"},s.createElement(v.x6,null,"When a password is shared, notify the users who gain access to it.")))),this.canUseFolders()&&s.createElement("div",{className:"folder-section"},s.createElement("label",null,s.createElement(v.x6,null,"Folders")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"folderCreate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.folderCreate,id:"send-folder-create-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-folder-create-toggle-button"},s.createElement(v.x6,null,"When a folder is created, notify its creator."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"folderUpdate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.folderUpdate,id:"send-folder-update-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-folder-update-toggle-button"},s.createElement(v.x6,null,"When a folder is updated, notify the users who have access to it."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"folderDelete",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.folderDelete,id:"send-folder-delete-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-folder-delete-toggle-button"},s.createElement(v.x6,null,"When a folder is deleted, notify the users who had access to it."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"folderShare",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.folderShare,id:"send-folder-share-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-folder-share-toggle-button"},s.createElement(v.x6,null,"When a folder is shared, notify the users who gain access to it."))))),s.createElement("div",{className:"section"},s.createElement("div",{className:"comment-section"},s.createElement("label",null,s.createElement(v.x6,null,"Comments")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"commentAdd",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.commentAdd,id:"send-comment-add-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-comment-add-toggle-button"},s.createElement(v.x6,null,"When a comment is posted on a password, notify the users who have access to this password."))))),s.createElement("div",{className:"section"},s.createElement("div",{className:"group-section"},s.createElement("label",null,s.createElement(v.x6,null,"Group membership")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"groupDelete",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.groupDelete,id:"send-group-delete-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-group-delete-toggle-button"},s.createElement(v.x6,null,"When a group is deleted, notify the users who were members of it."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"groupUserAdd",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.groupUserAdd,id:"send-group-user-add-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-group-user-add-toggle-button"},s.createElement(v.x6,null,"When users are added to a group, notify them."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"groupUserDelete",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.groupUserDelete,id:"send-group-user-delete-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-group-user-delete-toggle-button"},s.createElement(v.x6,null,"When users are removed from a group, notify them."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"groupUserUpdate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.groupUserUpdate,id:"send-group-user-update-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-group-user-update-toggle-button"},s.createElement(v.x6,null,"When user roles change in a group, notify the corresponding users.")))),s.createElement("div",{className:"group-admin-section"},s.createElement("label",null,s.createElement(v.x6,null,"Group manager")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"groupManagerUpdate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.groupManagerUpdate,id:"send-group-manager-update-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-group-manager-update-toggle-button"},s.createElement(v.x6,null,"When members of a group change, notify the group manager(s)."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"groupManagerRequestAddUser",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.groupManagerRequestAddUser,id:"send-group-manager-request-add-user-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-group-manager-request-add-user-toggle-button"},s.createElement(v.x6,null,"When group managers are requested to add users to a group, notify them."))))),s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Registration & Recovery")),s.createElement("div",{className:"divider"}),s.createElement("div",{className:"section"},s.createElement("div",{className:"admin-section"},s.createElement("label",null,s.createElement(v.x6,null,"Admin")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userSetupCompleteAdmin",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.userSetupCompleteAdmin,id:"user-setup-complete-admin-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"user-setup-complete-admin-toggle-button"},s.createElement(v.x6,null,"When a user completed a setup, notify all the administrators."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userRecoverCompleteAdmin",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.userRecoverCompleteAdmin,id:"user-recover-complete-admin-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"user-recover-complete-admin-toggle-button"},s.createElement(v.x6,null,"When a user completed a recover, notify all the administrators."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userRecoverAbortAdmin",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.userRecoverAbortAdmin,id:"user-recover-abort-admin-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"user-recover-abort-admin-toggle-button"},s.createElement(v.x6,null,"When a user aborted a recover, notify all the administrators.")))),s.createElement("div",{className:"user-section"},s.createElement("label",null,s.createElement(v.x6,null,"User")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userCreate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.userCreate,id:"send-user-create-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-user-create-toggle-button"},s.createElement(v.x6,null,"When new users are invited to passbolt, notify them."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userRecover",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.userRecover,id:"send-user-recover-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"send-user-recover-toggle-button"},s.createElement(v.x6,null,"When users try to recover their account, notify them."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"userRecoverComplete",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.userRecoverComplete,id:"user-recover-complete-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"user-recover-complete-toggle-button"},s.createElement(v.x6,null,"When users completed the recover of their account, notify them."))))),this.canUseAccountRecovery()&&s.createElement(s.Fragment,null,s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Account recovery")),s.createElement("div",{className:"divider"}),s.createElement("div",{className:"section"},s.createElement("div",{className:"admin-section"},s.createElement("label",null,s.createElement(v.x6,null,"Admin")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestAdmin",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestAdmin,id:"account-recovery-request-admin-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-request-admin-toggle-button"},s.createElement(v.x6,null,"When an account recovery is requested, notify all the administrators."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestPolicyUpdate",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestPolicyUpdate,id:"account-recovery-policy-update-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-policy-update-toggle-button"},s.createElement(v.x6,null,"When an account recovery policy is updated, notify all the administrators."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestCreatedAmin",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestCreatedAmin,id:"account-recovery-response-created-admin-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-response-created-admin-toggle-button"},s.createElement(v.x6,null,"When an administrator answered to an account recovery request, notify the administrator at the origin of the action."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestCreatedAllAdmins",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestCreatedAllAdmins,id:"account-recovery-response-created-all-admin-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-response-created-all-admin-toggle-button"},s.createElement(v.x6,null,"When an administrator answered to an account recovery request, notify all the administrators.")))),s.createElement("div",{className:"user-section"},s.createElement("label",null,s.createElement(v.x6,null,"User")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestUser",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestUser,id:"account-recovery-request-user-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-request-user-toggle-button"},s.createElement(v.x6,null,"When an account recovery is requested, notify the user."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestUserApproved",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestUserApproved,id:"account-recovery-response-user-approved-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-response-user-approved-toggle-button"},s.createElement(v.x6,null,"When an account recovery is approved, notify the user."))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"accountRecoveryRequestUserRejected",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.accountRecoveryRequestUserRejected,id:"account-recovery-response-user-rejected-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"account-recovery-response-user-rejected-toggle-button"},s.createElement(v.x6,null,"When an account recovery is rejected, notify the user.")))))),this.canUsePasswordExpiry()&&s.createElement(s.Fragment,null,s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Password expiry")),s.createElement("div",{className:"divider"}),s.createElement("div",{className:"section"},s.createElement("div",{className:"password-expiry-section"},s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"passwordExpiryExpiredUser",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.passwordExpiryExpiredUser,id:"password-expiry-expired-user-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"password-expiry-expired-user-toggle-button"},s.createElement(v.x6,null,"When a permission is revoked on a consumed password, notify the owner(s) to change it.")))))),s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Email content visibility")),s.createElement("div",{className:"divider"}),s.createElement("p",null,s.createElement(v.x6,null,"In this section you can adjust the composition of the emails, e.g. which information will be included in the notification.")),s.createElement("div",{className:"section"},s.createElement("div",{className:"password-section"},s.createElement("label",null,s.createElement(v.x6,null,"Passwords")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"showUsername",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.showUsername,id:"show-username-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"show-username-toggle-button"},s.createElement(v.x6,null,"Username"))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"showUri",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.showUri,id:"show-uri-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"show-uri-toggle-button"},s.createElement(v.x6,null,"URI"))),s.createElement("span",{className:"input toggle-switch form-element ready"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"showSecret",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.showSecret,id:"show-secret-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"show-secret-toggle-button"},s.createElement(v.x6,null,"Encrypted secret"))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"showDescription",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.showDescription,id:"show-description-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"show-description-toggle-button"},s.createElement(v.x6,null,"Description")))),s.createElement("div",{className:"comment-section"},s.createElement("label",null,s.createElement(v.x6,null,"Comments")),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"showComment",disabled:this.hasAllInputDisabled(),onChange:this.handleInputChange,checked:e.showComment,id:"show-comment-toggle-button"}),s.createElement("label",{className:"text",htmlFor:"show-comment-toggle-button"},s.createElement(v.x6,null,"Comment content")))))),i&&s.createElement("div",{className:"warning message"},t&&s.createElement("div",{id:"email-notification-save-banner"},s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))),a&&!n&&s.createElement("div",{id:"email-notification-fileconfig-exists-banner"},s.createElement("p",null,s.createElement(v.x6,null,"You seem to have Email Notification Settings defined in your passbolt.php (or via environment variables).")," ",s.createElement(v.x6,null,"Submitting the form will overwrite those settings with the ones you choose in the form below."))),a&&n&&s.createElement("div",{id:"email-notification-setting-overridden-banner"},s.createElement("p",null,s.createElement(v.x6,null,"Settings have been found in your database as well as in your passbolt.php (or environment variables).")," ",s.createElement(v.x6,null,"The settings displayed in the form below are the one stored in your database and have precedence over others."))))),s.createElement(Ws,null),Ea(s.createElement(s.Fragment,null,s.createElement("div",{className:"sidebar-help-section",id:"email-notifications-source"},s.createElement("h3",null,s.createElement(v.x6,null,"Configuration source")),s.createElement("p",null,s.createElement(v.x6,null,"This current configuration source is: "),this.configurationSource,".")),s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need some help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about email notification, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/emails/email-notifications/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ft,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation"))))),document.getElementById("administration-help-panel")))}}Vs.propTypes={context:r().any,administrationWorkspaceContext:r().object,adminEmailNotificationContext:r().object,t:r().func};const Bs=I(qs(Ee((0,v.CI)("common")(Vs))));var Gs,$s,Hs=a(6685);function Ys(){return Ys=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ys.apply(null,arguments)}const Js=function(e){return s.createElement("svg",Ys({shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",viewBox:"0 0 128 128"},e),Gs||(Gs=s.createElement("circle",{id:"success-circle",r:62.5,fill:"none",strokeDasharray:392.7,strokeDashoffset:392.7,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,transform:"rotate(-90 64 0)"})),$s||($s=s.createElement("path",{id:"success-check",fill:"none",strokeDasharray:65.24,strokeDashoffset:65.24,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"M87.062 46.703 55.351 78.415 40.936 64"})))};var Zs,Qs,Xs;function en(){return en=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},en.apply(null,arguments)}const tn=function(e){return s.createElement("svg",en({shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",viewBox:"0 0 128 128"},e),Zs||(Zs=s.createElement("path",{id:"warning-dot",fill:"none",strokeDasharray:23.42,strokeDashoffset:23.42,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"M64.038 46.76v23.413"})),Qs||(Qs=s.createElement("path",{id:"warning-bar",fill:"none",strokeDasharray:.09,strokeDashoffset:.09,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"M64.038 93.585h.088"})),Xs||(Xs=s.createElement("path",{id:"warning-triangle",fill:"none",strokeDasharray:364.98,strokeDashoffset:364.98,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M53.954 16.685 4.412 99.459a11.66 11.66 0 0 0-1.167 8.872 11.66 11.66 0 0 0 5.464 7.087 10.97 10.97 0 0 0 5.7 1.578h99.17a11.67 11.67 0 0 0 8.253-3.508 11.68 11.68 0 0 0 3.323-8.329 11 11 0 0 0-1.579-5.7L74.033 16.685A11.66 11.66 0 0 0 57.9 12.739a12.1 12.1 0 0 0-3.946 3.946"})))};var an,sn,nn;function rn(){return rn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},rn.apply(null,arguments)}const on=function(e){return s.createElement("svg",rn({shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",viewBox:"0 0 128 128"},e),an||(an=s.createElement("circle",{id:"attention-circle",r:62.5,fill:"none",strokeDasharray:392.7,strokeDashoffset:392.7,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,transform:"rotate(-90 64 0)"})),sn||(sn=s.createElement("path",{id:"attention-dot",fill:"none",strokeDasharray:23.42,strokeDashoffset:23.42,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"M63.956 40.588V64",transform:"rotate(180 63.956 52.294)"})),nn||(nn=s.createElement("path",{id:"attention-bar",fill:"none",strokeDasharray:.09,strokeDashoffset:.09,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"M63.956 87.412h.088"})))};var ln,cn,mn;function dn(){return dn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},dn.apply(null,arguments)}const pn=function(e){return s.createElement("svg",dn({shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",viewBox:"0 0 128 128"},e),ln||(ln=s.createElement("circle",{id:"error-circle",r:62.5,fill:"none",strokeDasharray:392.7,strokeDashoffset:392.7,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,transform:"rotate(-90 64 0)"})),cn||(cn=s.createElement("path",{id:"error-stroke-1",fill:"none",strokeDasharray:37.96,strokeDashoffset:37.96,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"m50.58 50.58 26.84 26.84",transform:"rotate(180 64 64)"})),mn||(mn=s.createElement("path",{id:"error-stroke-2",fill:"none",strokeDasharray:37.96,strokeDashoffset:37.96,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:7,d:"M77.42 50.58 50.58 77.42"})))},un={success:s.createElement(Js,null),warning:s.createElement(tn,null),attention:s.createElement(on,null),error:s.createElement(pn,null)};class hn extends s.Component{get animatedIconSVG(){return un[this.props.name]}render(){return s.createElement("div",{className:"illustration icon-feedback"},s.createElement("div",{className:this.props.name},this.animatedIconSVG))}}hn.defaultProps={},hn.propTypes={name:r().string};const gn=hn;class bn extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.getClassName=this.getClassName.bind(this)}getClassName(){let e="button primary form";return this.props.warning?e+=" warning":this.props.attention&&(e+=" attention"),this.props.disabled&&(e+=" disabled"),this.props.processing&&(e+=" processing"),this.props.big&&(e+=" big"),this.props.medium&&(e+=" medium"),this.props.fullWidth&&(e+=" full-width"),e}render(){return s.createElement("button",{type:"submit",className:this.getClassName(),disabled:this.props.disabled},this.props.value||s.createElement(v.x6,null,"Save"),this.props.processing&&s.createElement(La,null))}}bn.defaultProps={warning:!1,attention:!1},bn.propTypes={processing:r().bool,disabled:r().bool,value:r().oneOfType([r().arrayOf(r().node),r().node,r().string]),warning:r().bool,attention:r().bool,big:r().bool,medium:r().bool,fullWidth:r().bool};const yn=(0,v.CI)("common")(bn),fn=class{constructor(e){this.customerId=e?.customer_id||"",this.subscriptionId=e?"subscription_id"in e?e.subscription_id:"N/A":"",this.users=e?.users||null,this.email=e?"email"in e?e.email:"N/A":"",this.expiry=e?.expiry||null,this.created=e?.created||null,this.data=e?.data||null}};function vn(){return vn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},vn.apply(null,arguments)}const En=s.createContext({getSubscription:()=>{},findSubscriptionKey:()=>{},isProcessing:()=>{},setProcessing:()=>{},getActiveUsers:()=>{},clearContext:()=>{}});class wn extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{subscription:new fn,processing:!0,getSubscription:this.getSubscription.bind(this),findSubscriptionKey:this.findSubscriptionKey.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),getActiveUsers:this.getActiveUsers.bind(this),clearContext:this.clearContext.bind(this)}}async findSubscriptionKey(){this.setProcessing(!0);let e=new fn;try{const t=await this.props.context.onGetSubscriptionKeyRequested();e=new fn(t)}catch(t){"PassboltSubscriptionError"===t.name&&(e=new fn(t.subscription))}finally{this.setState({subscription:e}),this.setProcessing(!1)}}async getActiveUsers(){return(await this.props.context.port.request("passbolt.users.get-all")).filter((e=>e.active)).length}getSubscription(){return this.state.subscription}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}clearContext(){const{subscription:e,processing:t}=this.defaultState;this.setState({subscription:e,processing:t})}render(){return s.createElement(En.Provider,{value:this.state},this.props.children)}}function kn(e){return class extends s.Component{render(){return s.createElement(En.Consumer,null,(t=>s.createElement(e,vn({adminSubscriptionContext:t},this.props))))}}}wn.propTypes={context:r().any,children:r().any},I(wn);class xn extends s.Component{constructor(e){super(e),this.state=this.getDefaultState(),this.initEventHandlers(),this.createInputRef()}getDefaultState(){return{selectedFile:null,key:"",keyError:"",processing:!1,hasBeenValidated:!1}}initEventHandlers(){this.handleCloseClick=this.handleCloseClick.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleKeyInputKeyUp=this.handleKeyInputKeyUp.bind(this),this.handleSelectSubscriptionKeyFile=this.handleSelectSubscriptionKeyFile.bind(this),this.handleSelectFile=this.handleSelectFile.bind(this)}createInputRef(){this.keyInputRef=s.createRef(),this.fileUploaderRef=s.createRef()}componentDidMount(){this.setState({key:this.props.context.editSubscriptionKey.key||""})}async handleFormSubmit(e){e.preventDefault(),this.state.processing||await this.save()}handleInputChange(e){const t=e.target,a=t.value,s=t.name;this.setState({[s]:a})}handleKeyInputKeyUp(){if(this.state.hasAlreadyBeenValidated){const e=this.validateNameInput();this.setState(e)}}handleCloseClick(){this.props.context.setContext({editSubscriptionKey:null}),this.props.onClose()}handleSelectFile(){this.fileUploaderRef.current.click()}get selectedFilename(){return this.state.selectedFile?this.state.selectedFile.name:""}async handleSelectSubscriptionKeyFile(e){const[t]=e.target.files,a=await this.readSubscriptionKeyFile(t);this.setState({key:a,selectedFile:t}),this.state.hasBeenValidated&&await this.validate()}readSubscriptionKeyFile(e){const t=new FileReader;return new Promise(((a,s)=>{t.onloadend=()=>{try{a(t.result)}catch(e){s(e)}},t.readAsText(e)}))}async save(){if(this.state.processing)return;if(await this.setState({hasBeenValidated:!0}),await this.toggleProcessing(),!await this.validate())return this.handleValidateError(),void await this.toggleProcessing();const e={data:this.state.key};try{await this.props.administrationWorkspaceContext.onUpdateSubscriptionKeyRequested(e),await this.handleSaveSuccess(),await this.props.adminSubscriptionContext.findSubscriptionKey()}catch(e){await this.toggleProcessing(),this.handleSaveError(e),this.focusFieldError()}}handleValidateError(){this.focusFieldError()}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.translate("The subscription key has been updated successfully.")),this.props.administrationWorkspaceContext.onMustRefreshSubscriptionKey(),this.props.context.setContext({editSubscriptionKey:null,refreshSubscriptionAnnouncement:!0}),this.props.onClose()}async handleSaveError(e){if("PassboltSubscriptionError"===e.name)this.setState({keyError:e.message});else if("EntityValidationError"===e.name)this.setState({keyError:this.translate("The subscription key is invalid.")});else if("PassboltApiFetchError"===e.name&&e.data&&400===e.data.code)this.setState({keyError:e.message});else{console.error(e);const t={error:e};this.props.dialogContext.open(Pt,t)}}focusFieldError(){this.state.keyError&&this.keyInputRef.current.focus()}validateKeyInput(){const e=this.state.key.trim();let t="";return e.length||(t=this.translate("A subscription key is required.")),new Promise((e=>{this.setState({keyError:t},e)}))}async validate(){return this.setState({keyError:""}),await this.validateKeyInput(),""===this.state.keyError}async toggleProcessing(){await this.setState({processing:!this.state.processing})}hasAllInputDisabled(){return this.state.processing}get translate(){return this.props.t}render(){return s.createElement(wt,{title:this.translate("Edit subscription key"),onClose:this.handleCloseClick,disabled:this.state.processing,className:"edit-subscription-dialog"},s.createElement("form",{onSubmit:this.handleFormSubmit,noValidate:!0},s.createElement("div",{className:"form-content"},s.createElement("div",{className:`input textarea required ${this.state.keyError?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",{htmlFor:"edit-tag-form-name"},s.createElement(v.x6,null,"Subscription key")),s.createElement("textarea",{id:"edit-subscription-form-key",name:"key",value:this.state.key,onKeyUp:this.handleKeyInputKeyUp,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),ref:this.keyInputRef,className:"required full_report",required:"required",autoComplete:"off",autoFocus:!0})),s.createElement("div",{className:"input file "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("input",{type:"file",ref:this.fileUploaderRef,disabled:this.hasAllInputDisabled(),onChange:this.handleSelectSubscriptionKeyFile}),s.createElement("div",{className:"input-file-inline"},s.createElement("input",{type:"text",disabled:!0,placeholder:this.translate("No key file selected"),value:this.selectedFilename}),s.createElement("button",{type:"button",className:"button primary",onClick:this.handleSelectFile,disabled:this.hasAllInputDisabled()},s.createElement("span",null,s.createElement(v.x6,null,"Choose a file")))),this.state.keyError&&s.createElement("div",{className:"key error-message"},this.state.keyError))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.hasAllInputDisabled(),onClick:this.handleCloseClick}),s.createElement(yn,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Save")}))))}}xn.propTypes={context:r().any,onClose:r().func,actionFeedbackContext:r().any,adminSubscriptionContext:r().object,dialogContext:r().any,administrationWorkspaceContext:r().any,t:r().func};const Cn=I(kn(Ee(d(g((0,v.CI)("common")(xn))))));class Sn{constructor(e){this.context=e.context,this.dialogContext=e.dialogContext,this.subscriptionContext=e.adminSubscriptionContext}static getInstance(e){return this.instance||(this.instance=new Sn(e)),this.instance}static killInstance(){this.instance=null}editSubscription(){const e={key:this.subscriptionContext.getSubscription().data};this.context.setContext({editSubscriptionKey:e}),this.dialogContext.open(Cn)}}const _n=Sn,Nn=(e,t,a)=>{if(null===e)return"n/a";if("Infinity"===e)return t("Never");const s=Hs.c9.fromISO(e),n=s.diffNow().toMillis();return n>-1e3&&n<0?t("Just now"):s.toRelative({locale:a})};var In,Pn;function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},An.apply(null,arguments)}const Tn=function(e){return s.createElement("svg",An({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),In||(In=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 3H3a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 3 15h12a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 15 3"})),Pn||(Pn=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16.5 5.25 9.773 9.525a1.46 1.46 0 0 1-1.546 0L1.5 5.25"})))};class Rn extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.subscriptionActionService=_n.getInstance(this.props)}get defaultState(){return{activeUsers:null}}async componentDidMount(){this.findActiveUsers(),await this.findSubscriptionKey()}componentWillUnmount(){this.props.adminSubscriptionContext.clearContext(),_n.killInstance(),this.mfaFormService=null}bindCallbacks(){this.handleRenewKey=this.handleRenewKey.bind(this),this.handleUpdateKey=this.handleUpdateKey.bind(this)}async findActiveUsers(){const e=await this.props.adminSubscriptionContext.getActiveUsers();this.setState({activeUsers:e})}async findSubscriptionKey(){this.props.adminSubscriptionContext.findSubscriptionKey()}handleRenewKey(){const e=this.props.adminSubscriptionContext.getSubscription();this.hasLimitUsersExceeded()?this.props.navigationContext.onGoToNewTab(`https://www.passbolt.com/subscription/ee/update/qty?subscription_id=${e.subscriptionId}&customer_id=${e.customerId}`):(this.hasSubscriptionKeyExpired()||this.hasSubscriptionKeyGoingToExpire())&&this.props.navigationContext.onGoToNewTab(`https://www.passbolt.com/subscription/ee/update/renew?subscription_id=${e.subscriptionId}&customer_id=${e.customerId}`)}handleUpdateKey(){this.subscriptionActionService.editSubscription()}hasSubscriptionKeyExpired(){return Hs.c9.fromISO(this.props.adminSubscriptionContext.getSubscription().expiry)<Hs.c9.now()}hasSubscriptionKeyGoingToExpire(){return Hs.c9.fromISO(this.props.adminSubscriptionContext.getSubscription().expiry)<Hs.c9.now().plus({days:30})&&!this.hasSubscriptionKeyExpired()}hasSubscriptionKey(){return Boolean(this.props.adminSubscriptionContext.getSubscription().data)}get shouldShowRenewKey(){return this.hasSubscriptionKey()&&(this.hasLimitUsersExceeded()||this.hasSubscriptionKeyExpired()||this.hasSubscriptionKeyGoingToExpire())}hasLimitUsersExceeded(){return this.props.adminSubscriptionContext.getSubscription().users<this.state.activeUsers}hasValidSubscription(){return this.hasSubscriptionKey()&&!this.hasLimitUsersExceeded()&&!this.hasSubscriptionKeyExpired()}hasInvalidSubscription(){return!this.hasSubscriptionKey()||this.hasLimitUsersExceeded()||this.hasSubscriptionKeyExpired()}formatDate(e){try{return Hs.c9.fromISO(e).setLocale(this.props.context.locale).toLocaleString(Hs.c9.DATE_SHORT)}catch(e){return""}}get translate(){return this.props.t}render(){const e=this.props.adminSubscriptionContext.getSubscription(),t=this.props.adminSubscriptionContext.isProcessing();return s.createElement("div",{className:"row"},!t&&s.createElement(s.Fragment,null,s.createElement("div",{className:"subscription-key main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Subscription key details")),s.createElement("div",{className:"feedback-card"},this.hasValidSubscription()&&!this.hasSubscriptionKeyGoingToExpire()&&s.createElement(gn,{name:"success"}),this.hasInvalidSubscription()&&s.createElement(gn,{name:"error"}),this.hasValidSubscription()&&this.hasSubscriptionKeyGoingToExpire()&&s.createElement(gn,{name:"warning"}),s.createElement("div",{className:"subscription-information"},!this.hasSubscriptionKey()&&s.createElement(s.Fragment,null,s.createElement("h4",{className:"subscription-information-subtitle"},s.createElement(v.x6,null,"Your subscription key is either missing or not valid.")),s.createElement("p",null,s.createElement(v.x6,null,"Sorry your subscription is either missing or not readable."),s.createElement("br",null),s.createElement(v.x6,null,"Update the subscription key and try again.")," ",s.createElement(v.x6,null,"If this does not work get in touch with support."))),this.hasValidSubscription()&&this.hasSubscriptionKeyGoingToExpire()&&s.createElement("h4",{className:"subscription-information-subtitle"},s.createElement(v.x6,null,"Your subscription key is going to expire.")),this.hasSubscriptionKey()&&this.hasInvalidSubscription()&&s.createElement("h4",{className:"subscription-information-subtitle"},s.createElement(v.x6,null,"Your subscription key is not valid.")),this.hasValidSubscription()&&!this.hasSubscriptionKeyGoingToExpire()&&s.createElement("h4",{className:"subscription-information-subtitle"},s.createElement(v.x6,null,"Your subscription key is valid and up to date!")),this.hasSubscriptionKey()&&s.createElement("div",{className:"information"},s.createElement("div",{className:"information-label"},s.createElement("span",{className:"customer-id label"},s.createElement(v.x6,null,"Customer id:")),s.createElement("span",{className:"subscription-id label"},s.createElement(v.x6,null,"Subscription id:")),s.createElement("span",{className:"email label"},s.createElement(v.x6,null,"Email:")),s.createElement("span",{className:"users label"},s.createElement(v.x6,null,"Users limit:")),s.createElement("span",{className:"created label"},s.createElement(v.x6,null,"Valid from:")),s.createElement("span",{className:"expiry label"},s.createElement(v.x6,null,"Expires on:"))),s.createElement("div",{className:"information-value"},s.createElement("span",{className:"customer-id value"},e.customerId),s.createElement("span",{className:"subscription-id value"},e.subscriptionId),s.createElement("span",{className:"email value"},e.email),s.createElement("span",{className:"users value "+(this.hasLimitUsersExceeded()?"error":"")},e.users," ",s.createElement("span",{className:"secondary-information"},"(",s.createElement(v.x6,null,"currently:")," ",this.state.activeUsers,")")),s.createElement("span",{className:"created value"},this.formatDate(e.created)),s.createElement("span",{className:`expiry value ${this.hasSubscriptionKeyExpired()?"error":""} ${this.hasSubscriptionKeyGoingToExpire()?"warning":""}`},this.formatDate(e.expiry)," ",s.createElement("span",{className:"secondary-information"},"(",`${this.hasSubscriptionKeyExpired()?this.translate("expired "):""}${Nn(e.expiry,this.props.t,this.props.context.locale)}`,")")))))))),s.createElement("div",{className:"actions-wrapper"},this.shouldShowRenewKey&&s.createElement("button",{className:"button secondary",type:"button",onClick:this.handleRenewKey},s.createElement(v.x6,null,"Renew key")),this.hasSubscriptionKey()?s.createElement("button",{className:"button primary form",type:"button",onClick:this.handleUpdateKey},s.createElement(v.x6,null,"Update key")):s.createElement("button",{className:"button primary form",type:"button",onClick:this.handleUpdateKey},s.createElement(v.x6,null,"Add key")))),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"For any change or question related to your passbolt subscription, kindly contact our sales team.")),s.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://www.passbolt.com/contact"},s.createElement(Tn,null),s.createElement("span",null,s.createElement(v.x6,null,"Contact Sales")))),document.getElementById("administration-help-panel")))}}Rn.propTypes={context:r().any,navigationContext:r().any,administrationWorkspaceContext:r().object,adminSubscriptionContext:r().object,dialogContext:r().any,t:r().func};const Dn=I(Oe(kn(Ee(g((0,v.CI)("common")(Rn))))));var On;function Un(){return Un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Un.apply(null,arguments)}const Mn=function(e){return s.createElement("svg",Un({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",viewBox:"0 0 17 16"},e),On||(On=s.createElement("g",{clipPath:"url(#heart_svg__clip0_93_734678)"},s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13.497 9.333c.993-.973 2-2.14 2-3.666A3.667 3.667 0 0 0 11.83 2c-1.173 0-2 .333-3 1.333-1-1-1.827-1.333-3-1.333a3.667 3.667 0 0 0-3.667 3.667c0 1.533 1 2.7 2 3.666L8.83 14z"}))))},Fn=class{constructor(e){e.setResourceName("locale/settings"),this.apiClient=new Qt(e)}async save(e){return(await this.apiClient.create(e)).body}};function jn(){return jn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},jn.apply(null,arguments)}const zn=s.createContext({getCurrentLocale:()=>{},getLocale:()=>{},supportedLocales:()=>{},setLocale:()=>{},hasLocaleChanges:()=>{},findLocale:()=>{},save:()=>{},setProcessing:()=>{},isProcessing:()=>{},clearContext:()=>{}});class Ln extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.internalisationService=new Fn(t)}get defaultState(){return{currentLocale:null,locale:"en-UK",processing:!0,getCurrentLocale:this.getCurrentLocale.bind(this),getLocale:this.getLocale.bind(this),setLocale:this.setLocale.bind(this),findLocale:this.findLocale.bind(this),hasLocaleChanges:this.hasLocaleChanges.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),save:this.save.bind(this),clearContext:this.clearContext.bind(this)}}findLocale(){this.setProcessing(!0);const e=this.props.context.siteSettings.locale;this.setState({currentLocale:e,locale:e,processing:!1})}getCurrentLocale(){return this.state.currentLocale}getLocale(){return this.state.locale}async setLocale(e){await this.setState({locale:e})}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasLocaleChanges(){return this.state.locale!==this.state.currentLocale}clearContext(){const{currentLocale:e,locale:t,processing:a}=this.defaultState;this.setState({currentLocale:e,locale:t,processing:a})}async save(){this.setProcessing(!0),await this.internalisationService.save({value:this.state.locale}),this.props.context.onRefreshLocaleRequested(this.state.locale),this.findLocale()}render(){return s.createElement(zn.Provider,{value:this.state},this.props.children)}}Ln.propTypes={context:r().any,children:r().any};const qn=I(Ln);function Kn(e){return class extends s.Component{render(){return s.createElement(zn.Consumer,null,(t=>s.createElement(e,jn({adminInternationalizationContext:t},this.props))))}}}class Wn extends s.Component{constructor(e){super(e),this.bindCallbacks()}async handleSaveClick(){try{await this.props.adminInternationalizationContext.save(),this.handleSaveSuccess()}catch(e){this.handleSaveError(e)}finally{this.props.adminInternationalizationContext.setProcessing(!1)}}isSaveEnabled(){return!this.props.adminInternationalizationContext.isProcessing()&&this.props.adminInternationalizationContext.hasLocaleChanges()}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this)}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The internationalization settings were updated."))}async handleSaveError(e){"UserAbortsOperationError"!==e.name&&(console.error(e),await this.handleError(e))}async handleError(e){await this.props.actionFeedbackContext.displayError(e.message)}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{className:"button primary form",id:"save-settings",type:"button",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Wn.propTypes={context:r().object,adminInternationalizationContext:r().object,actionFeedbackContext:r().object,t:r().func};const Vn=Kn(d((0,v.CI)("common")(Wn)));class Bn extends s.Component{constructor(e){super(e),this.bindCallbacks()}componentDidMount(){this.props.adminInternationalizationContext.findLocale()}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminInternationalizationContext.clearContext()}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this)}handleInputChange(e){this.props.adminInternationalizationContext.setLocale(e.target.value)}get supportedLocales(){return this.props.context.siteSettings.supportedLocales?this.props.context.siteSettings.supportedLocales.map((e=>({value:e.locale,label:e.label}))):[]}render(){const e=this.props.adminInternationalizationContext.getLocale(),t=null!==this.props.adminInternationalizationContext.getCurrentLocale()&&this.props.adminInternationalizationContext.hasLocaleChanges();return s.createElement("div",{className:"row"},s.createElement("div",{className:"internationalisation-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Internationalisation")),s.createElement("form",{className:"form"},s.createElement("div",{className:"select-wrapper input"},s.createElement("label",{htmlFor:"app-locale-input"},s.createElement(v.x6,null,"Language")),s.createElement(Oa,{className:"medium",id:"locale-input",name:"locale",items:this.supportedLocales,value:e,onChange:this.handleInputChange}),s.createElement("p",null,s.createElement(v.x6,null,"The default language of the organisation."))))),t&&s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(Vn,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Want to contribute?")),s.createElement("p",null,s.createElement(v.x6,null,"Your language is missing or you discovered an error in the translation, help us to improve passbolt.")),s.createElement("a",{className:"button",href:"https://help.passbolt.com/contribute/translation",target:"_blank",rel:"noopener noreferrer"},s.createElement(Mn,null),s.createElement("span",null,s.createElement(v.x6,null,"Contribute")))),document.getElementById("administration-help-panel")))}}Bn.propTypes={context:r().object,administrationWorkspaceContext:r().object,adminInternationalizationContext:r().object,t:r().func};const Gn=I(Kn(Ee((0,v.CI)("common")(Bn))));function $n(){return $n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},$n.apply(null,arguments)}const Hn=s.createContext({currentPolicy:null,policyChanges:{},findAccountRecoveryPolicy:()=>{},getKeyInfo:()=>{},changePolicy:()=>{},changePublicKey:()=>{},hasPolicyChanges:()=>{},resetChanges:()=>{},downloadPrivateKey:()=>{},save:()=>{}});class Yn extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{currentPolicy:null,policyChanges:{},findAccountRecoveryPolicy:this.findAccountRecoveryPolicy.bind(this),getKeyInfo:this.getKeyInfo.bind(this),changePolicy:this.changePolicy.bind(this),changePublicKey:this.changePublicKey.bind(this),hasPolicyChanges:this.hasPolicyChanges.bind(this),resetChanges:this.resetChanges.bind(this),downloadPrivateKey:this.downloadPrivateKey.bind(this),save:this.save.bind(this)}}async findAccountRecoveryPolicy(){if(!this.props.context.siteSettings.canIUse("accountRecovery"))return;const e=await this.props.context.port.request("passbolt.account-recovery.get-organization-policy");this.setState({currentPolicy:e})}async changePolicy(e){const t=this.state.policyChanges;e===this.state.currentPolicy?.policy?delete t.policy:t.policy=e,"disabled"===e&&delete t.publicKey,await this.setState({policyChanges:t})}async changePublicKey(e){const t={...this.state.policyChanges,publicKey:e};await this.setState({policyChanges:t})}hasPolicyChanges(){return Boolean(this.state.policyChanges?.publicKey)||Boolean(this.state.policyChanges?.policy)}async getKeyInfo(e){return e?this.props.context.port.request("passbolt.keyring.get-key-info",e):null}async resetChanges(){await this.setState({policyChanges:{}})}async downloadPrivateKey(e){await this.props.context.port.request("passbolt.account-recovery.download-organization-generated-key",e)}async save(e){const t=this.buildPolicySaveDto(),a=await this.props.context.port.request("passbolt.account-recovery.save-organization-policy",t,e);this.setState({currentPolicy:a,policyChanges:{}}),this.props.accountRecoveryContext.reloadAccountRecoveryPolicy()}buildPolicySaveDto(){const e={};return this.state.policyChanges.policy&&(e.policy=this.state.policyChanges.policy),this.state.policyChanges.publicKey&&(e.account_recovery_organization_public_key={armored_key:this.state.policyChanges.publicKey}),e}render(){return s.createElement(Hn.Provider,{value:this.state},this.props.children)}}function Jn(e){return class extends s.Component{render(){return s.createElement(Hn.Consumer,null,(t=>s.createElement(e,$n({adminAccountRecoveryContext:t},this.props))))}}}function Zn(){return Zn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Zn.apply(null,arguments)}Yn.propTypes={context:r().any,children:r().any,accountRecoveryContext:r().object},I(ze(Yn));const Qn=s.createContext({workflows:[],start:()=>{},stop:()=>{}});class Xn extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{workflows:[],start:(e,t)=>{const a=(0,o.A)();return this.setState({workflows:[...this.state.workflows,{key:a,Workflow:e,workflowProps:t}]}),a},stop:async e=>await this.setState({workflows:this.state.workflows.filter((t=>e!==t.key))})}}render(){return s.createElement(Qn.Provider,{value:this.state},this.props.children)}}Xn.displayName="WorkflowContextProvider",Xn.propTypes={children:r().any};class ei extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.createInputRef()}get defaultState(){return{processing:!1,key:"",keyError:"",password:"",passwordError:"",passwordWarning:"",hasAlreadyBeenValidated:!1,selectedFile:null}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleCloseClick=this.handleCloseClick.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleKeyInputKeyUp=this.handleKeyInputKeyUp.bind(this),this.handlePasswordInputKeyUp=this.handlePasswordInputKeyUp.bind(this),this.handleSelectFile=this.handleSelectFile.bind(this),this.handleSelectOrganizationKeyFile=this.handleSelectOrganizationKeyFile.bind(this)}createInputRef(){this.keyInputRef=s.createRef(),this.fileUploaderRef=s.createRef(),this.passwordInputRef=s.createRef()}handleKeyInputKeyUp(){if(this.state.hasAlreadyBeenValidated){const e=this.validateKeyInput();this.setState(e)}}async handleSelectOrganizationKeyFile(e){const[t]=e.target.files,a=await this.readOrganizationKeyFile(t);await this.fillOrganizationKey(a),this.setState({selectedFile:t}),this.state.hasAlreadyBeenValidated&&await this.validate()}readOrganizationKeyFile(e){const t=new FileReader;return new Promise(((a,s)=>{t.onloadend=()=>{try{a(t.result)}catch(e){s(e)}},t.readAsText(e)}))}async fillOrganizationKey(e){await this.setState({key:e})}validateKeyInput(){const e=this.state.key.trim();let t="";return e.length||(t=this.translate("An organization key is required.")),new Promise((e=>{this.setState({keyError:t},e)}))}focusFirstFieldError(){this.state.keyError?this.keyInputRef.current.focus():this.state.passwordError&&this.passwordInputRef.current.focus()}handlePasswordInputKeyUp(){if(this.state.hasAlreadyBeenValidated)this.setState({passwordError:""});else{const e=this.state.password.length>=4096,t=this.translate("this is the maximum size for this field, make sure your data was not truncated"),a=e?t:"";this.setState({passwordWarning:a})}}handleInputChange(e){const t=e.target,a=t.value,s=t.name;this.setState({[s]:a})}handleSelectFile(){this.fileUploaderRef.current.click()}async handleFormSubmit(e){e.preventDefault(),this.state.processing||await this.save()}async save(){if(this.setState({hasAlreadyBeenValidated:!0}),await this.toggleProcessing(),!await this.validate())return this.handleValidateError(),void await this.toggleProcessing();const e={armored_key:this.state.key,passphrase:this.state.password};try{await this.props.context.port.request("passbolt.account-recovery.validate-organization-private-key",e),await this.props.onSubmit(e),await this.toggleProcessing(),this.props.onClose()}catch(e){await this.handleSubmitError(e),await this.toggleProcessing()}}async handleSubmitError(e){"UserAbortsOperationError"!==e.name&&("WrongOrganizationRecoveryKeyError"===e.name?this.setState({expectedFingerprintError:e.expectedFingerprint}):"InvalidMasterPasswordError"===e.name?this.setState({passwordError:this.translate("This is not a valid passphrase.")}):"BadSignatureMessageGpgKeyError"===e.name||"GpgKeyError"===e.name?this.setState({keyError:e.message}):(console.error("Uncaught uncontrolled error"),this.onUnexpectedError(e)))}onUnexpectedError(e){const t={error:e};this.props.dialogContext.open(Pt,t)}handleValidateError(){this.focusFirstFieldError()}async validate(){return this.setState({keyError:"",passwordError:"",expectedFingerprintError:""}),await this.validateKeyInput(),""===this.state.keyError&&""===this.state.passwordError}async toggleProcessing(){await this.setState({processing:!this.state.processing})}hasAllInputDisabled(){return this.state.processing}handleCloseClick(){this.props.onClose()}formatFingerprint(e){if(!e)return s.createElement(s.Fragment,null);const t=e.toUpperCase().replace(/.{4}/g,"$& ");return s.createElement(s.Fragment,null,t.substr(0,24),s.createElement("br",null),t.substr(25))}get selectedFilename(){return this.state.selectedFile?this.state.selectedFile.name:""}get translate(){return this.props.t}render(){return s.createElement(wt,{title:this.translate("Organization Recovery Key"),onClose:this.handleCloseClick,disabled:this.state.processing,className:"provide-organization-recover-key-dialog"},s.createElement("form",{onSubmit:this.handleFormSubmit,noValidate:!0},s.createElement("div",{className:"form-content provide-organization-key"},s.createElement("div",{className:"input textarea required "+(this.state.keyError||this.state.expectedFingerprintError?"error":"")},s.createElement("label",{htmlFor:"organization-recover-form-key"},s.createElement(v.x6,null,"Enter the private key used by your organization for account recovery")),s.createElement("textarea",{id:"organization-recover-form-key",name:"key",value:this.state.key,onKeyUp:this.handleKeyInputKeyUp,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),ref:this.keyInputRef,className:"required",placeholder:this.translate("Paste the OpenPGP Private key here"),required:"required",autoComplete:"off",autoFocus:!0})),s.createElement("div",{className:"input file"},s.createElement("input",{type:"file",id:"dialog-import-private-key",ref:this.fileUploaderRef,disabled:this.hasAllInputDisabled(),onChange:this.handleSelectOrganizationKeyFile}),s.createElement("label",{htmlFor:"dialog-import-private-key"},s.createElement(v.x6,null,"Select a file to import")),s.createElement("div",{className:"input-file-inline"},s.createElement("input",{type:"text",disabled:!0,placeholder:this.translate("No file selected"),defaultValue:this.selectedFilename}),s.createElement("button",{className:"button primary",type:"button",disabled:this.hasAllInputDisabled(),onClick:this.handleSelectFile},s.createElement("span",null,s.createElement(v.x6,null,"Choose a file")))),this.state.keyError&&s.createElement("div",{className:"key error-message"},this.state.keyError),this.state.expectedFingerprintError&&s.createElement("div",{className:"key error-message"},s.createElement(v.x6,null,"Error, this is not the current organization recovery key."),s.createElement("br",null),s.createElement(v.x6,null,"Expected fingerprint:"),s.createElement("br",null),s.createElement("br",null),s.createElement("span",{className:"fingerprint"},this.formatFingerprint(this.state.expectedFingerprintError)))),s.createElement("div",{className:"input-password-wrapper input "+(this.state.passwordError?"error":"")},s.createElement("label",{htmlFor:"generate-organization-key-form-password"},s.createElement(v.x6,null,"Organization key passphrase"),this.state.passwordWarning&&s.createElement($e,null)),s.createElement(va,{id:"generate-organization-key-form-password",name:"password",placeholder:this.translate("Passphrase"),autoComplete:"new-password",onKeyUp:this.handlePasswordInputKeyUp,value:this.state.password,securityToken:this.props.context.userSettings.getSecurityToken(),preview:!0,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),inputRef:this.passwordInputRef}),this.state.passwordError&&s.createElement("div",{className:"password error-message"},this.state.passwordError),this.state.passwordWarning&&s.createElement("div",{className:"password warning-message"},s.createElement("strong",null,s.createElement(v.x6,null,"Warning:"))," ",this.state.passwordWarning))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.hasAllInputDisabled(),onClick:this.handleCloseClick}),s.createElement(yn,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Submit")}))))}}ei.propTypes={context:r().any.isRequired,onClose:r().func,onSubmit:r().func,actionFeedbackContext:r().any,dialogContext:r().object,t:r().func};const ti=I(g((0,v.CI)("common")(ei)));class ai extends s.Component{constructor(e){super(e),this.state=this.getDefaultState(),this.bindCallbacks()}getDefaultState(){return{processing:!1}}bindCallbacks(){this.handleSubmit=this.handleSubmit.bind(this),this.handleClose=this.handleClose.bind(this)}handleClose(){this.props.onClose()}async toggleProcessing(){await this.setState({processing:!this.state.processing})}get isProcessing(){return this.state.processing}async handleSubmit(e){e.preventDefault(),await this.toggleProcessing();try{await this.props.onSubmit(),this.props.onClose()}catch(e){if(await this.toggleProcessing(),"UserAbortsOperationError"!==e.name)throw console.error("Uncaught uncontrolled error"),e}}formatFingerprint(e){const t=(e=e||"").toUpperCase().replace(/.{4}/g,"$& ");return s.createElement(s.Fragment,null,t.substr(0,24),s.createElement("br",null),t.substr(25))}formatUserIds(e){return(e=e||[]).map(((e,t)=>s.createElement(s.Fragment,{key:t},e.name,"<",e.email,">",s.createElement("br",null))))}formatDate(e){return Hs.c9.fromJSDate(new Date(e)).setLocale(this.props.context.locale).toLocaleString(Hs.c9.DATETIME_FULL)}get translate(){return this.props.t}render(){return s.createElement(wt,{title:this.translate("Save Settings Summary"),onClose:this.handleClose,disabled:this.state.processing,className:"save-recovery-account-settings-dialog"},s.createElement("form",{onSubmit:this.handleSubmit},s.createElement("div",{className:"form-content"},this.props.policy&&s.createElement(s.Fragment,null,s.createElement("label",null,s.createElement(v.x6,null,"New Account Recovery Policy")),s.createElement("div",{className:"account-recovery-setting-save"},s.createElement("p",{className:"name"},{mandatory:s.createElement(v.x6,null,"Prompt"),"opt-out":s.createElement(v.x6,null,"Optional, Opt-out"),"opt-in":s.createElement(v.x6,null,"Optional, Opt-in"),disabled:s.createElement(v.x6,null,"Disable")}[this.props.policy]),s.createElement("p",{className:"info"},{mandatory:s.createElement(s.Fragment,null,s.createElement(v.x6,null,"Every user is required to provide a copy of their private key and passphrase during setup."),s.createElement("br",null),s.createElement(v.x6,null,"Warning: You should inform your users not to store personal passwords.")),"opt-out":s.createElement(v.x6,null,"Every user will be prompted to provide a copy of their private key and passphrase by default during the setup, but they can opt out."),"opt-in":s.createElement(v.x6,null,"Every user can decide to provide a copy of their private key and passphrase by default during the setup, but they can opt in."),disabled:s.createElement(s.Fragment,null,s.createElement(v.x6,null,"Backup of the private key and passphrase will not be stored. This is the safest option."),s.createElement("br",null),s.createElement(v.x6,null,"Warning: If users lose their private key and passphrase they will not be able to recover their account."))}[this.props.policy]))),this.props.keyInfo&&s.createElement(s.Fragment,null,s.createElement("label",null,s.createElement(v.x6,null,"New Organization Recovery Key")),s.createElement("div",{className:"recovery-key-details"},s.createElement("table",{className:"table-info recovery-key"},s.createElement("tbody",null,s.createElement("tr",{className:"user-ids"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Uid")),s.createElement("td",{className:"value"},this.formatUserIds(this.props.keyInfo.user_ids))),s.createElement("tr",{className:"fingerprint"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Fingerprint")),s.createElement("td",{className:"value"},this.formatFingerprint(this.props.keyInfo.fingerprint))),s.createElement("tr",{className:"algorithm"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Algorithm")),s.createElement("td",{className:"value"},this.props.keyInfo.algorithm)),s.createElement("tr",{className:"key-length"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Key length")),s.createElement("td",{className:"value"},this.props.keyInfo.length)),s.createElement("tr",{className:"created"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Created")),s.createElement("td",{className:"value"},this.formatDate(this.props.keyInfo.created))),s.createElement("tr",{className:"expires"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Expires")),s.createElement("td",{className:"value"},Nn(this.props.keyInfo.expires,this.props.t,this.props.context.locale))))))),s.createElement("div",{className:"warning message no-margin"},s.createElement(v.x6,null,"Please review carefully this configuration as it will not be trivial to change this later."))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.passbolt.com/docs/admin/authentication/account-recovery/",className:"button button-left "+(this.isProcessing?"disabled":"")},s.createElement(v.x6,null,"Learn more")),s.createElement(Ma,{onClick:this.handleClose,disabled:this.isProcessing}),s.createElement(yn,{value:this.translate("Save"),disabled:this.isProcessing,processing:this.isProcessing,warning:!0}))))}}ai.propTypes={context:r().any,onClose:r().func,onSubmit:r().func,policy:r().string,keyInfo:r().object,t:r().func};const si=I((0,v.CI)("common")(ai));class ni extends s.Component{constructor(e){super(e),this.bindCallbacks()}componentDidMount(){this.displayConfirmSummaryDialog()}bindCallbacks(){this.handleCloseDialog=this.handleCloseDialog.bind(this),this.handleConfirmSave=this.handleConfirmSave.bind(this),this.handleSave=this.handleSave.bind(this),this.handleError=this.handleError.bind(this)}async displayConfirmSummaryDialog(){this.props.dialogContext.open(si,{policy:this.props.adminAccountRecoveryContext.policyChanges?.policy,keyInfo:await this.getNewOrganizationKeyInfo(),onClose:this.handleCloseDialog,onSubmit:this.handleConfirmSave})}getNewOrganizationKeyInfo(){const e=this.props.adminAccountRecoveryContext.policyChanges?.publicKey;return e?this.props.adminAccountRecoveryContext.getKeyInfo(e):null}displayProvideAccountRecoveryOrganizationKeyDialog(){this.props.dialogContext.open(ti,{onClose:this.handleCloseDialog,onSubmit:this.handleSave})}handleCloseDialog(){this.props.onStop()}async handleConfirmSave(){Boolean(this.props.adminAccountRecoveryContext.currentPolicy?.account_recovery_organization_public_key)?this.displayProvideAccountRecoveryOrganizationKeyDialog():await this.handleSave()}async handleSave(e=null){try{await this.props.adminAccountRecoveryContext.save(e),await this.props.actionFeedbackContext.displaySuccess(this.translate("The organization recovery policy has been updated successfully")),this.props.onStop()}catch(e){this.handleError(e)}}handleError(e){if(["UserAbortsOperationError","WrongOrganizationRecoveryKeyError","InvalidMasterPasswordError","BadSignatureMessageGpgKeyError","GpgKeyError"].includes(e.name))throw e;"PassboltApiFetchError"===e.name&&e?.data?.body?.account_recovery_organization_public_key?.fingerprint?.isNotAccountRecoveryOrganizationPublicKeyFingerprintRule?this.props.dialogContext.open(Pt,{error:new Error(this.translate("The new organization recovery key should not be a formerly used organization recovery key."))}):this.props.dialogContext.open(Pt,{error:e}),this.props.onStop()}get translate(){return this.props.t}render(){return s.createElement(s.Fragment,null)}}ni.propTypes={dialogContext:r().any,adminAccountRecoveryContext:r().any,actionFeedbackContext:r().object,context:r().object,onStop:r().func.isRequired,t:r().func};const ii=I(g(d(Jn((0,v.CI)("common")(ni)))));class ri extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this),this.handleEditSubscriptionClick=this.handleEditSubscriptionClick.bind(this)}handleSaveClick(){this.props.workflowContext.start(ii,{})}handleEditSubscriptionClick(){this.props.adminAccountRecoveryContext.resetChanges()}isSaveEnabled(){if(!this.props.adminAccountRecoveryContext.hasPolicyChanges())return!1;const e=this.props.adminAccountRecoveryContext.policyChanges,t=this.props.adminAccountRecoveryContext.currentPolicy;if(e?.policy===Fe.POLICY_DISABLED)return!0;const a=e.publicKey||t?.account_recovery_organization_public_key?.armored_key;return!(!Boolean(e.policy)||!Boolean(a))||t.policy!==Fe.POLICY_DISABLED&&Boolean(e.publicKey)}isResetEnabled(){return this.props.adminAccountRecoveryContext.hasPolicyChanges()}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("div",{className:"left-actions-wrapper"},s.createElement("button",{type:"button",className:"button secondary",disabled:!this.isResetEnabled(),onClick:this.handleEditSubscriptionClick},s.createElement("span",null,s.createElement(v.x6,null,"Reset settings")))),s.createElement("button",{type:"button",className:"button primary form",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}ri.propTypes={adminAccountRecoveryContext:r().object,workflowContext:r().any};const oi=function(e){return class extends s.Component{render(){return s.createElement(Qn.Consumer,null,(t=>s.createElement(e,Zn({workflowContext:t},this.props))))}}}(Jn((0,v.CI)("common")(ri)));class li extends s.Component{constructor(e){super(e),this.bindCallback()}bindCallback(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.onClick(this.props.name)}render(){return s.createElement("li",{className:"tab "+(this.props.isActive?"active":"")},s.createElement("button",{type:"button",className:"tab-link",onClick:this.handleClick},this.props.name))}}li.propTypes={name:r().string,type:r().string.isRequired,isActive:r().bool,onClick:r().func,children:r().any};const ci=li;class mi extends s.Component{constructor(e){super(e),this.state=this.getDefaultState(e),this.bindCallback()}getDefaultState(e){return{activeTabName:e.activeTabName}}bindCallback(){this.handleTabClick=this.handleTabClick.bind(this)}handleTabClick(e){this.setState({activeTabName:e.type}),"function"==typeof e.onClick&&e.onClick()}render(){return s.createElement("div",{className:"tabs"},s.createElement("ul",{className:"tabs-nav"},this.props.children.map((({key:e,props:t})=>s.createElement(ci,{key:e,name:t.name,type:t.type,onClick:()=>this.handleTabClick(t),isActive:t.type===this.state.activeTabName})))),s.createElement("div",{className:"tabs-active-content"},this.props.children.find((e=>e.props.type===this.state.activeTabName)).props.children))}}mi.propTypes={activeTabName:r().string,children:r().any};const di=mi;class pi extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.createInputRef()}get defaultState(){return{processing:!1,key:"",keyError:"",hasAlreadyBeenValidated:!1,selectedFile:null}}bindCallbacks(){this.handleSelectFile=this.handleSelectFile.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleSelectOrganizationKeyFile=this.handleSelectOrganizationKeyFile.bind(this)}createInputRef(){this.keyInputRef=s.createRef(),this.fileUploaderRef=s.createRef()}async handleSelectOrganizationKeyFile(e){const[t]=e.target.files,a=await this.readOrganizationKeyFile(t);this.setState({key:a,selectedFile:t})}readOrganizationKeyFile(e){const t=new FileReader;return new Promise(((a,s)=>{t.onloadend=()=>{try{a(t.result)}catch(e){s(e)}},t.readAsText(e)}))}async validateKeyInput(){const e=this.state.key.trim();return""===e?Promise.reject(new Error(this.translate("The key can't be empty."))):await this.props.context.port.request("passbolt.account-recovery.validate-organization-key",e)}async validate(){return this.setState({keyError:""}),await this.validateKeyInput().then((()=>!0)).catch((e=>(this.setState({keyError:e.message}),!1)))}handleInputChange(e){const t=e.target;this.setState({[t.name]:t.value})}handleSelectFile(){this.fileUploaderRef.current.click()}async handleFormSubmit(e){e.preventDefault(),this.state.processing||await this.save()}async save(){if(await this.setState({hasAlreadyBeenValidated:!0}),await this.toggleProcessing(),!await this.validate())return this.handleValidateError(),void await this.toggleProcessing();await this.props.onUpdateOrganizationKey(this.state.key.trim())}handleValidateError(){this.focusFieldError()}focusFieldError(){this.state.keyError&&this.keyInputRef.current.focus()}async toggleProcessing(){await this.setState({processing:!this.state.processing})}hasAllInputDisabled(){return this.state.processing}get translate(){return this.props.t}get selectedFilename(){return this.state.selectedFile?this.state.selectedFile.name:""}render(){return s.createElement("form",{onSubmit:this.handleFormSubmit,noValidate:!0},s.createElement("div",{className:"form-content import-organization-key"},s.createElement("div",{className:"input textarea required "+(this.state.keyError?"error":"")},s.createElement("label",{htmlFor:"organization-recover-form-key"},s.createElement(v.x6,null,"Import an OpenPGP Public key")),s.createElement("textarea",{id:"organization-recover-form-key",name:"key",value:this.state.key,onKeyUp:this.handleKeyInputKeyUp,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),ref:this.keyInputRef,className:"required",placeholder:this.translate("Add Open PGP Public key"),required:"required",autoComplete:"off",autoFocus:!0})),s.createElement("div",{className:"input file"},s.createElement("input",{type:"file",id:"dialog-import-private-key",ref:this.fileUploaderRef,disabled:this.hasAllInputDisabled(),onChange:this.handleSelectOrganizationKeyFile}),s.createElement("label",{htmlFor:"dialog-import-private-key"},s.createElement(v.x6,null,"Select a file to import")),s.createElement("div",{className:"input-file-inline"},s.createElement("input",{type:"text",disabled:!0,placeholder:this.translate("No file selected"),defaultValue:this.selectedFilename}),s.createElement("button",{className:"button primary",type:"button",disabled:this.hasAllInputDisabled(),onClick:this.handleSelectFile},s.createElement("span",null,s.createElement(v.x6,null,"Choose a file")))),this.state.keyError&&s.createElement("div",{className:"key error-message"},this.state.keyError)),!this.state.hasAlreadyBeenValidated&&s.createElement("div",{className:"message notice no-margin"},s.createElement(vt,{className:"svg-icon info baseline"}),s.createElement("strong",null,s.createElement(v.x6,null,"Pro tip"),":")," ",s.createElement(v.x6,null,"Learn how to ",s.createElement("a",{href:"https://help.passbolt.com/configure/account-recovery",target:"_blank",rel:"noopener noreferrer"},"generate a key separately.")))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.hasAllInputDisabled(),onClick:this.props.onClose}),s.createElement(yn,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Apply")})))}}pi.propTypes={context:r().object,onUpdateOrganizationKey:r().func,onClose:r().func,t:r().func};const ui=I((0,v.CI)("common")(pi)),hi={"en-UK":["abdominal","acclimate","accompany","activator","acuteness","aerospace","affecting","affection","affidavit","affiliate","afflicted","afterglow","afterlife","aftermath","aftermost","afternoon","aggregate","agonizing","agreeable","agreeably","agreement","alabaster","albatross","algorithm","alienable","alongside","amazingly","ambiguity","ambiguous","ambitious","ambulance","amendable","amendment","amplifier","amusement","anaerobic","anatomist","angelfish","angriness","anguished","animating","animation","animosity","announcer","answering","antarctic","anthology","antiquely","antiquity","antitoxic","antitrust","antiviral","antivirus","appealing","appeasing","appendage","appetizer","appliance","applicant","appointee","appraisal","appraiser","apprehend","arbitrary","arbitrate","armadillo","arrogance","ascension","ascertain","asparagus","astrology","astronaut","astronomy","atrocious","attendant","attention","attentive","attractor","attribute","audacious","augmented","authentic","autograph","automaker","automated","automatic","autopilot","available","avalanche","backboard","backboned","backfield","backlands","backlight","backpedal","backshift","backspace","backstage","backtrack","backwater","bacterium","bagginess","balancing","bannister","barometer","barracuda","barricade","bartender","basically","battalion","battering","blanching","blandness","blaspheme","blasphemy","blatantly","blunderer","bodacious","boogeyman","boogieman","boondocks","borrowing","botanical","boundless","bountiful","breeching","brilliant","briskness","broadband","broadcast","broadness","broadside","broadways","bronchial","brownnose","brutishly","buccaneer","bucktooth","buckwheat","bulginess","bulldozer","bullfight","bunkhouse","cabdriver","calculate","calibrate","camcorder","canopener","capillary","capricorn","captivate","captivity","cardboard","cardstock","carefully","caregiver","caretaker","carnation","carnivore","carpenter","carpentry","carrousel","cartridge","cartwheel","catatonic","catchable","cathedral","cattishly","caucasian","causation","cauterize","celestial","certainly","certainty","certified","challenge","chamomile","chaperone","character","charbroil","chemicals","cherisher","chihuahua","childcare","childhood","childless","childlike","chokehold","circulate","clamshell","clergyman","clubhouse","clustered","coagulant","coastland","coastline","cofounder","cognition","cognitive","coherence","collected","collector","collision","commodity","commodore","commotion","commuting","compacted","compacter","compactly","compactor","companion","component","composite","composure","comprised","computing","concerned","concierge","condiment","condition","conducive","conductor","confidant","confident","confiding","configure","confining","confusing","confusion","congenial","congested","conjoined","connected","connector","consensus","consoling","consonant","constable","constrain","constrict","construct","consuming","container","contented","contently","contusion","copartner","cornbread","cornfield","cornflake","cornstalk","corporate","corroding","corrosive","cosmetics","cosponsor","countable","countdown","countless","crabgrass","craftsman","craftwork","cranberry","craziness","creamlike","creatable","crestless","crispness","crudeness","cruelness","crummiest","crunching","crushable","cubbyhole","culminate","cultivate","cupbearer","curliness","curvature","custodian","customary","customize","cytoplasm","cytoplast","dandelion","daredevil","darkening","darwinism","dastardly","deafening","dealmaker","debatable","decathlon","deceiving","deception","deceptive","decidable","decimeter","decompose","decorated","decorator","dedicator","defection","defective","defendant","defensive","deflation","deflected","deflector","degrading","dehydrate","delegator","delicious","delighted","delirious","deliverer","demanding","demeaning","democracy","demystify","denatured","deodorant","deodorize","departure","depletion","depravity","deprecate","desecrate","deserving","designate","designing","deskbound","destitute","detection","detective","detention","detergent","detonator","deviation","devotedly","devouring","dexterity","dexterous","diagnoses","diagnosis","diaphragm","dictation","difficult","diffusion","diffusive","diligence","dinginess","direction","directive","directory","dirtiness","disbelief","discharge","discourse","disengage","disfigure","disinfect","disliking","dislocate","dismantle","disparate","disparity","dispersal","dispersed","disperser","displease","disregard","dividable","divisible","divisibly","dizziness","dollhouse","doorframe","dormitory","dragonfly","dragonish","drainable","drainpipe","dramatize","dreadlock","dreamboat","dreamland","dreamless","dreamlike","drinkable","drop-down","dubiously","duplicate","duplicity","dwindling","earthlike","earthling","earthworm","eastbound","eastcoast","eccentric","ecologist","economist","ecosphere","ecosystem","education","effective","efficient","eggbeater","egomaniac","egotistic","elaborate","eldercare","electable","elevating","elevation","eliminate","elongated","eloquence","elsewhere","embattled","embellish","embroider","emergency","emphasize","empirical","emptiness","enactment","enchanted","enchilada","enclosure","encounter","encourage","endearing","endocrine","endorphin","endowment","endurable","endurance","energetic","engraving","enigmatic","enjoyable","enjoyably","enjoyment","enlarging","enlighten","entangled","entertain","entourage","enunciate","epidermal","epidermis","epileptic","equipment","equivocal","eradicate","ergonomic","escalator","escapable","esophagus","espionage","essential","establish","estimator","estranged","ethically","euphemism","evaluator","evaporate","everglade","evergreen","everybody","evolution","excavator","exceeding","exception","excitable","excluding","exclusion","exclusive","excretion","excretory","excursion","excusable","excusably","exemplary","exemplify","exemption","exerciser","exfoliate","exonerate","expansion","expansive","expectant","expedited","expediter","expensive","expletive","exploring","exposable","expulsion","exquisite","extending","extenuate","extortion","extradite","extrovert","extruding","exuberant","facecloth","faceplate","facsimile","factsheet","fanciness","fantasize","fantastic","favorable","favorably","ferocious","festivity","fidgeting","financial","finishing","flagstick","flagstone","flammable","flashback","flashbulb","flashcard","flattered","flatterer","flavorful","flavoring","footboard","footprint","fragility","fragrance","fraternal","freemason","freestyle","freezable","frequency","frightful","frigidity","frivolous","frostbite","frostlike","frugality","frustrate","gainfully","gallantly","gallstone","galvanize","gathering","gentleman","geography","geologist","geometric","geriatric","germicide","germinate","germproof","gestation","gibberish","giddiness","gigahertz","gladiator","glamorous","glandular","glorified","glorifier","glutinous","goldsmith","goofiness","graceless","gradation","gradually","grappling","gratified","gratitude","graveness","graveyard","gravitate","greedless","greyhound","grievance","grimacing","griminess","grumbling","guacamole","guileless","gumminess","habitable","hamburger","hamstring","handbrake","handclasp","handcraft","handiness","handiwork","handlebar","handprint","handsfree","handshake","handstand","handwoven","handwrite","hankering","haphazard","happening","happiness","hardcover","hardening","hardiness","hardwired","harmonica","harmonics","harmonize","hastiness","hatchback","hatchling","headboard","headcount","headdress","headfirst","headphone","headpiece","headscarf","headstand","headstone","heaviness","heftiness","hemstitch","herbicide","hesitancy","humiliate","humongous","humorless","hunchback","hundredth","hurricane","huskiness","hydration","hydroxide","hyperlink","hypertext","hypnotism","hypnotist","hypnotize","hypocrisy","hypocrite","ibuprofen","idealness","identical","illicitly","imaginary","imitation","immersion","immorally","immovable","immovably","impatient","impending","imperfect","implement","implicate","implosion","implosive","important","impotence","impotency","imprecise","impromptu","improving","improvise","imprudent","impulsive","irregular","irritable","irritably","isolating","isolation","italicize","itinerary","jackknife","jailbreak","jailhouse","jaywalker","jeeringly","jockstrap","jolliness","joylessly","jubilance","judgingly","judiciary","juiciness","justifier","kilometer","kinswoman","laborious","landowner","landscape","landslide","lankiness","legislate","legwarmer","lethargic","levitator","liability","librarian","limelight","litigator","livestock","lubricant","lubricate","luckiness","lucrative","ludicrous","luminance","lumpiness","lunchroom","lunchtime","luridness","lustfully","lustiness","luxurious","lyrically","machinist","magnesium","magnetism","magnetize","magnifier","magnitude","majorette","makeshift","malformed","mammogram","mandatory","manhandle","manicotti","manifesto","manliness","marauding","margarine","margarita","marmalade","marshland","marsupial","marvelous","masculine","matchbook","matchless","maternity","matriarch","matrimony","mayflower","modulator","moistness","molecular","monastery","moneybags","moneyless","moneywise","monologue","monstrous","moodiness","moonlight","moonscape","moonshine","moonstone","morbidity","mortality","mortician","mortified","mothproof","motivator","motocross","mountable","mousiness","moustache","multitask","multitude","mummified","municipal","murkiness","murmuring","mushiness","muskiness","mustiness","mutilated","mutilator","mystified","nanometer","nastiness","navigator","nebulizer","neglector","negligent","negotiate","neurology","ninetieth","numerator","nuttiness","obedience","oblivious","obnoxious","obscurity","observant","observing","obsession","obsessive","obstinate","obtrusive","occultist","occupancy","onslaught","operating","operation","operative","oppressed","oppressor","opulently","outnumber","outplayed","outskirts","outsource","outspoken","overblown","overboard","overbuilt","overcrowd","overdraft","overdrawn","overdress","overdrive","overeager","overeater","overexert","overgrown","overjoyed","overlabor","overlying","overnight","overplant","overpower","overprice","overreach","overreact","overshoot","oversight","oversized","oversleep","overspend","overstate","overstock","overstuff","oversweet","overthrow","overvalue","overwrite","oxidation","oxidizing","pacemaker","palatable","palpitate","panhandle","panoramic","pantomime","pantyhose","paparazzi","parachute","paragraph","paralegal","paralyses","paralysis","paramedic","parameter","paramount","parasitic","parchment","partition","partridge","passenger","passivism","patchwork","paternity","patriarch","patronage","patronize","pavestone","pediatric","pedometer","penholder","penniless","pentagram","percolate","perennial","perfected","perfectly","periscope","perkiness","perpetual","perplexed","persecute","persevere","persuaded","persuader","pessimism","pessimist","pesticide","petroleum","petticoat","pettiness","phonebook","phoniness","phosphate","plausible","plausibly","playgroup","playhouse","playmaker","plaything","plentiful","plexiglas","plutonium","pointless","polyester","polygraph","porcupine","portfolio","postnasal","powdering","prankster","preaching","precision","predefine","preflight","preformed","pregnancy","preheated","prelaunch","preoccupy","preschool","prescribe","preseason","president","presuming","pretended","pretender","prevalent","prewashed","primarily","privatize","proactive","probation","probiotic","procedure","procreate","profanity","professed","professor","profusely","prognosis","projector","prolonged","promenade","prominent","promotion","pronounce","proofread","propeller","proponent","protector","prototype","protozoan","providing","provoking","provolone","proximity","prudishly","publisher","pulmonary","pulverize","punctuate","punctured","pureblood","purgatory","purposely","pursuable","pushchair","pushiness","pyromania","qualified","qualifier","quartered","quarterly","quickness","quicksand","quickstep","quintuple","quizzical","quotation","radiantly","radiation","rancidity","ravishing","reacquire","reanalyze","reappoint","reapprove","rearrange","rebalance","recapture","recharger","recipient","reclining","reclusive","recognize","recollect","reconcile","reconfirm","reconvene","rectangle","rectified","recycling","reexamine","referable","reference","refinance","reflected","reflector","reformist","refueling","refurbish","refurnish","refutable","registrar","regretful","regulator","rehydrate","reimburse","reiterate","rejoicing","relapsing","relatable","relenting","relieving","reluctant","remindful","remission","remodeler","removable","rendering","rendition","renewable","renewably","renovator","repackage","repacking","repayment","repossess","repressed","reprimand","reprocess","reproduce","reprogram","reptilian","repugnant","repulsion","repulsive","repurpose","reputable","reputably","requisite","reshuffle","residence","residency","resilient","resistant","resisting","resurface","resurrect","retaining","retaliate","retention","retrieval","retriever","reverence","reversing","reversion","revisable","revivable","revocable","revolving","riverbank","riverboat","riverside","rockiness","rockslide","roundness","roundworm","runaround","sacrament","sacrifice","saddlebag","safeguard","safehouse","salvaging","salvation","sanctuary","sandblast","sandpaper","sandstone","sandstorm","sanitizer","sappiness","sarcastic","sasquatch","satirical","satisfied","sauciness","saxophone","scapegoat","scarecrow","scariness","scavenger","schematic","schilling","scientist","scorebook","scorecard","scoreless","scoundrel","scrambled","scrambler","scrimmage","scrounger","sculpture","secluding","seclusion","sectional","selection","selective","semicolon","semifinal","semisweet","sensation","sensitive","sensitize","sensually","september","sequester","serotonin","sevenfold","seventeen","shadiness","shakiness","sharpener","sharpness","shiftless","shininess","shivering","shortcake","shorthand","shortlist","shortness","shortwave","showpiece","showplace","shredding","shrubbery","shuffling","silliness","similarly","simmering","sincerity","situation","sixtyfold","skedaddle","skintight","skyrocket","slackness","slapstick","sliceable","slideshow","slighting","slingshot","slouching","smartness","smilingly","smokeless","smokiness","smuggling","snowboard","snowbound","snowdrift","snowfield","snowflake","snowiness","snowstorm","spearfish","spearhead","spearmint","spectacle","spectator","speculate","spellbind","spendable","spherical","spiritism","spiritual","splashing","spokesman","spotlight","sprinkled","sprinkler","squatting","squealing","squeamish","squeezing","squishier","stability","stabilize","stainable","stainless","stalemate","staleness","starboard","stargazer","starlight","startling","statistic","statutory","steadfast","steadying","steerable","steersman","stegosaur","sterility","sterilize","sternness","stiffness","stillness","stimulant","stimulate","stipulate","stonewall","stoneware","stonework","stoplight","stoppable","stopwatch","storeroom","storewide","straggler","straining","strangely","strategic","strenuous","strongbox","strongman","structure","stumbling","stylishly","subarctic","subatomic","subdivide","subheader","submarine","submersed","submitter","subscribe","subscript","subsector","subsiding","subsidize","substance","subsystem","subwoofer","succulent","suffering","suffocate","sulphuric","superbowl","superglue","superhero","supernova","supervise","supremacy","surcharge","surfacing","surfboard","surrender","surrogate","surviving","sustained","sustainer","swaddling","swampland","swiftness","swimmable","symphonic","synthesis","synthetic","tableware","tackiness","taekwondo","tarantula","tastiness","theatrics","thesaurus","thickness","thirstily","thirsting","threefold","throbbing","throwaway","throwback","thwarting","tightness","tightrope","tinderbox","tiptoeing","tradition","trailside","transform","translate","transpire","transport","transpose","trapezoid","treachery","treadmill","trembling","tribesman","tributary","trickster","trifocals","trimester","troubling","trustable","trustless","turbulent","twentieth","twiddling","twistable","ultimatum","umbilical","unabashed","unadorned","unadvised","unaligned","unaltered","unarmored","unashamed","unaudited","unbalance","unblended","unblessed","unbounded","unbraided","unbuckled","uncertain","unchanged","uncharted","unclaimed","unclamped","unclothed","uncolored","uncorrupt","uncounted","uncrushed","uncurious","undamaged","undaunted","undecided","undefined","undercoat","undercook","underdone","underfeed","underfoot","undergrad","underhand","underline","underling","undermine","undermost","underpaid","underpass","underrate","undertake","undertone","undertook","underwear","underwent","underwire","undesired","undiluted","undivided","undrafted","undrilled","uneatable","unelected","unengaged","unethical","unexpired","unexposed","unfailing","unfeeling","unfitting","unfixable","unfocused","unfounded","unfrosted","ungreased","unguarded","unhappily","unhealthy","unhearing","unhelpful","unhitched","uniformed","uniformly","unimpeded","uninjured","uninstall","uninsured","uninvited","unisexual","universal","unknotted","unknowing","unlearned","unleveled","unlighted","unlikable","unlimited","unlivable","unlocking","unlovable","unluckily","unmanaged","unmasking","unmatched","unmindful","unmixable","unmovable","unnamable","unnatural","unnerving","unnoticed","unopposed","unpainted","unpiloted","unplanned","unplanted","unpleased","unpledged","unpopular","unraveled","unreached","unreeling","unrefined","unrelated","unretired","unrevised","unrivaled","unroasted","unruffled","unscathed","unscented","unsecured","unselfish","unsettled","unshackle","unsheathe","unshipped","unsightly","unskilled","unspoiled","unstaffed","unstamped","unsterile","unstirred","unstopped","unstuffed","unstylish","untainted","untangled","untoasted","untouched","untracked","untrained","untreated","untrimmed","unvarying","unveiling","unvisited","unwarlike","unwatched","unwelcome","unwilling","unwitting","unwomanly","unworldly","unworried","unwrapped","unwritten","upcountry","uplifting","urologist","uselessly","vagrantly","vagueness","valuables","vaporizer","vehicular","veneering","ventricle","verbalize","vertebrae","viability","viewpoint","vindicate","violation","viscosity","vivacious","vividness","wackiness","washbasin","washboard","washcloth","washhouse","washstand","whimsical","wieldable","wikipedia","willfully","willpower","wolverine","womanhood","womankind","womanless","womanlike","worrisome","worsening","worshiper","wrongdoer","wrongness","yesterday","zestfully","zigzagged","zookeeper","zoologist","abnormal","abrasion","abrasive","abruptly","absentee","absently","absinthe","absolute","abstract","accuracy","accurate","accustom","achiness","acquaint","activate","activism","activist","activity","aeration","aerobics","affected","affluent","aflutter","agnostic","agreeing","alienate","alkaline","alkalize","almighty","alphabet","although","altitude","aluminum","amaretto","ambiance","ambition","amicably","ammonium","amniotic","amperage","amusable","anaconda","aneurism","animator","annotate","annoying","annually","anointer","anteater","antelope","antennae","antibody","antidote","antihero","antiques","antirust","anyplace","anything","anywhere","appendix","appetite","applause","approach","approval","aptitude","aqueduct","ardently","arguable","arguably","armchair","arrogant","aspirate","astonish","atlantic","atonable","attendee","attitude","atypical","audacity","audience","audition","autistic","avenging","aversion","aviation","babbling","backache","backdrop","backfire","backhand","backlash","backless","backpack","backrest","backroom","backside","backslid","backspin","backstab","backtalk","backward","backwash","backyard","bacteria","baffling","baguette","bakeshop","balsamic","banister","bankable","bankbook","banknote","bankroll","barbecue","bargraph","baritone","barrette","barstool","barterer","battered","blatancy","blighted","blinking","blissful","blizzard","bloating","bloomers","blooming","blustery","boastful","boasting","bondless","bonehead","boneless","bonelike","bootlace","borrower","botanist","bottling","bouncing","bounding","breeches","breeding","brethren","broiling","bronzing","browbeat","browsing","bruising","brunette","brussels","bubbling","buckshot","buckskin","buddhism","buddhist","bullfrog","bullhorn","bullring","bullseye","bullwhip","bunkmate","busybody","cadillac","calamari","calamity","calculus","camisole","campfire","campsite","canister","cannabis","capacity","cardigan","cardinal","careless","carmaker","carnival","cartload","cassette","casually","casualty","catacomb","catalyst","catalyze","catapult","cataract","catching","catering","catfight","cathouse","cautious","cavalier","celibacy","celibate","ceramics","ceremony","cesarean","cesspool","chaffing","champion","chaplain","charcoal","charging","charting","chastise","chastity","chatroom","chatting","cheating","chewable","childish","chirping","chitchat","chivalry","chloride","chlorine","choosing","chowtime","cilantro","cinnamon","circling","circular","citation","clambake","clanking","clapping","clarinet","clavicle","clerical","climatic","clinking","closable","clothing","clubbing","clumsily","coasting","coauthor","coeditor","cogwheel","coherent","cohesive","coleslaw","coliseum","collapse","colonial","colonist","colonize","colossal","commence","commerce","composed","composer","compound","compress","computer","conceded","conclude","concrete","condense","confetti","confider","confined","conflict","confound","confront","confused","congrats","congress","conjuror","constant","consumer","contempt","contents","contrite","cornball","cornhusk","cornmeal","coronary","corporal","corridor","cosigner","counting","covenant","coveting","coziness","crabbing","crablike","crabmeat","cradling","craftily","crawfish","crawlers","crawling","crayfish","creasing","creation","creative","creature","credible","credibly","crescent","cresting","crewless","crewmate","cringing","crisping","criteria","crumpled","cruncher","crusader","crushing","cucumber","cufflink","culinary","culpable","cultural","customer","cylinder","daffodil","daintily","dallying","dandruff","dangling","daringly","darkened","darkness","darkroom","datebook","daughter","daunting","daybreak","daydream","daylight","dazzling","deafness","debating","debtless","deceased","deceiver","december","decipher","declared","decrease","dedicate","deepness","defacing","defender","deferral","deferred","defiance","defiling","definite","deflator","deforest","degraded","degrease","dejected","delegate","deletion","delicacy","delicate","delirium","delivery","delusion","demeanor","democrat","demotion","deniable","departed","deplored","depraved","deputize","deranged","designed","designer","deskwork","desolate","destruct","detached","detector","detonate","detoxify","deviancy","deviator","devotion","devourer","devoutly","diabetes","diabetic","diabolic","diameter","dictator","diffused","diffuser","dilation","diligent","diminish","directed","directly","direness","disabled","disagree","disallow","disarray","disaster","disburse","disclose","discolor","discount","discover","disgrace","dislodge","disloyal","dismount","disorder","dispatch","dispense","displace","disposal","disprove","dissuade","distance","distaste","distinct","distract","distress","district","distrust","dividend","dividers","dividing","divinely","divinity","division","divisive","divorcee","doctrine","document","domelike","domestic","dominion","dominoes","donation","doorbell","doorknob","doornail","doorpost","doorstep","doorstop","doubling","dragging","dragster","drainage","dramatic","dreadful","dreamily","drearily","drilling","drinking","dripping","drivable","driveway","dropkick","drowsily","duckbill","duckling","ducktail","dullness","dumpling","dumpster","duration","dwelling","dynamite","dyslexia","dyslexic","earphone","earpiece","earplugs","easiness","eastward","economic","edginess","educated","educator","eggplant","eggshell","election","elective","elephant","elevator","eligible","eligibly","elliptic","eloquent","embezzle","embolism","emission","emoticon","empathic","emphases","emphasis","emphatic","employed","employee","employer","emporium","encircle","encroach","endanger","endeared","endpoint","enduring","energize","enforced","enforcer","engaging","engraved","engraver","enjoying","enlarged","enlisted","enquirer","entering","enticing","entrench","entryway","envelope","enviable","enviably","envision","epidemic","epidural","epilepsy","epilogue","epiphany","equation","erasable","escalate","escapade","escapist","escargot","espresso","esteemed","estimate","estrogen","eternity","evacuate","evaluate","everyday","everyone","evidence","excavate","exchange","exciting","existing","exorcism","exorcist","expenses","expiring","explicit","exponent","exporter","exposure","extended","exterior","external","fabulous","facebook","facedown","faceless","facelift","facility","familiar","famished","fastball","fastness","favoring","favorite","felt-tip","feminine","feminism","feminist","feminize","fernlike","ferocity","festival","fiddling","fidelity","fiftieth","figurine","filtrate","finalist","finalize","fineness","finished","finisher","fiscally","flagpole","flagship","flanking","flannels","flashily","flashing","flatfoot","flatness","flattery","flatware","flatworm","flavored","flaxseed","flogging","flounder","flypaper","follicle","fondling","fondness","football","footbath","footgear","foothill","foothold","footless","footnote","footpath","footrest","footsore","footwear","footwork","founding","fountain","fraction","fracture","fragment","fragrant","freckled","freckles","freebase","freefall","freehand","freeload","freeness","freeware","freewill","freezing","frenzied","frequent","friction","frighten","frigidly","frostily","frosting","fructose","frugally","galleria","gambling","gangrene","gatherer","gauntlet","generous","genetics","geologic","geometry","geranium","germless","gigabyte","gigantic","giggling","giveaway","glancing","glaucoma","gleaming","gloating","gloomily","glorious","glowworm","goatskin","goldfish","goldmine","goofball","gorgeous","graceful","gracious","gradient","graduate","graffiti","grafting","granddad","grandkid","grandson","granular","gratuity","greasily","greedily","greeting","grieving","grievous","grinning","groggily","grooving","grudging","grueling","grumpily","guidable","guidance","gullible","gurgling","gyration","habitant","habitual","handball","handbook","handcart","handclap","handcuff","handgrip","handheld","handling","handmade","handpick","handrail","handwash","handwork","handyman","hangnail","hangover","happiest","hardcopy","hardcore","harddisk","hardened","hardener","hardhead","hardness","hardship","hardware","hardwood","harmless","hatchery","hatching","hazelnut","haziness","headache","headband","headgear","headlamp","headless","headlock","headrest","headroom","headsman","headwear","helpless","helpline","henchman","heritage","hesitant","hesitate","hexagram","huddling","humbling","humility","humorist","humorous","humpback","hungrily","huntress","huntsman","hydrated","hydrogen","hypnoses","hypnosis","hypnotic","idealism","idealist","idealize","identify","identity","ideology","ignition","illusion","illusive","imagines","imbecile","immature","imminent","immobile","immodest","immortal","immunity","immunize","impaired","impeding","imperial","implicit","impolite","importer","imposing","impotent","imprison","improper","impurity","irrigate","irritant","irritate","islamist","isolated","jailbird","jalapeno","jaundice","jingling","jokester","jokingly","joyfully","joystick","jubilant","judicial","juggling","junction","juncture","junkyard","justness","juvenile","kangaroo","keenness","kerchief","kerosene","kilobyte","kilogram","kilowatt","kindling","kindness","kissable","knapsack","knickers","laboring","labrador","ladylike","landfall","landfill","landlady","landless","landline","landlord","landmark","landmass","landmine","landside","language","latitude","latticed","lavender","laxative","laziness","lecturer","leggings","lethargy","leverage","levitate","licorice","ligament","likeness","likewise","limpness","linguini","linguist","linoleum","litigate","luckless","lukewarm","luminous","lunchbox","luncheon","lushness","lustrous","lyricism","lyricist","macarena","macaroni","magazine","magician","magnetic","magnolia","mahogany","majestic","majority","makeover","managing","mandarin","mandolin","manicure","manpower","marathon","marbling","marigold","maritime","massager","matchbox","matching","material","maternal","maturely","maturing","maturity","maverick","maximize","mobility","mobilize","modified","moisture","molasses","molecule","molehill","monetary","monetize","mongoose","monkhood","monogamy","monogram","monopoly","monorail","monotone","monotype","monoxide","monsieur","monument","moonbeam","moonlike","moonrise","moonwalk","morality","morbidly","morphine","morphing","mortally","mortuary","mothball","motivate","mountain","mounting","mournful","mulberry","multiple","multiply","mumbling","munchkin","muscular","mushroom","mutation","national","nativity","naturist","nautical","navigate","nearness","neatness","negation","negative","negligee","neurosis","neurotic","nickname","nicotine","nineteen","nintendo","numbness","numerate","numerous","nuptials","nutrient","nutshell","obedient","obituary","obligate","oblivion","observer","obsessed","obsolete","obstacle","obstruct","occupant","occupier","ointment","olympics","omission","omnivore","oncoming","onlooker","onscreen","operable","operator","opponent","opposing","opposite","outboard","outbound","outbreak","outburst","outclass","outdated","outdoors","outfield","outflank","outgoing","outhouse","outlying","outmatch","outreach","outright","outscore","outshine","outshoot","outsider","outsmart","outtakes","outthink","outweigh","overarch","overbill","overbite","overbook","overcast","overcoat","overcome","overcook","overfeed","overfill","overflow","overfull","overhand","overhang","overhaul","overhead","overhear","overheat","overhung","overkill","overlaid","overload","overlook","overlord","overpass","overplay","overrate","override","overripe","overrule","overshot","oversold","overstay","overstep","overtake","overtime","overtone","overture","overturn","overview","oxymoron","pacifier","pacifism","pacifist","paddling","palpable","pampered","pamperer","pamphlet","pancreas","pandemic","panorama","parabola","parakeet","paralyze","parasail","parasite","parmesan","passable","passably","passcode","passerby","passover","passport","password","pastrami","paternal","patience","pavement","pavilion","paycheck","payphone","peculiar","peddling","pedicure","pedigree","pegboard","penalize","penknife","pentagon","perceive","perjurer","peroxide","petition","phrasing","placidly","platform","platinum","platonic","platypus","playable","playback","playlist","playmate","playroom","playtime","pleading","plethora","plunging","pointing","politely","popsicle","populace","populate","porridge","portable","porthole","portside","possible","possibly","postcard","pouncing","powdered","praising","prancing","prankish","preacher","preamble","precinct","predator","pregnant","premiere","premises","prenatal","preorder","pretense","previous","prideful","princess","pristine","probable","probably","proclaim","procurer","prodigal","profound","progress","prologue","promoter","prompter","promptly","proofing","properly","property","proposal","protegee","protract","protrude","provable","provided","provider","province","prowling","punctual","punisher","purchase","purebred","pureness","purifier","purplish","pursuant","purveyor","pushcart","pushover","puzzling","quadrant","quaintly","quarters","quotable","radiance","radiated","radiator","railroad","rambling","reabsorb","reaction","reactive","reaffirm","reappear","rearview","reassign","reassure","reattach","reburial","rebuttal","reckless","recliner","recovery","recreate","recycled","recycler","reemerge","refinery","refining","refinish","reforest","reformat","reformed","reformer","refreeze","refusing","register","registry","regulate","rekindle","relation","relative","reliable","reliably","reliance","relocate","remedial","remember","reminder","removing","renderer","renegade","renounce","renovate","rentable","reoccupy","repaying","repeated","repeater","rephrase","reporter","reproach","resample","research","reselect","reseller","resemble","resident","residual","resigned","resolute","resolved","resonant","resonate","resource","resubmit","resupply","retainer","retiring","retorted","reusable","reverend","reversal","revision","reviving","revolver","richness","riddance","ripeness","ripening","rippling","riverbed","riveting","robotics","rockband","rockfish","rocklike","rockstar","roulette","rounding","roundish","rumbling","sabotage","saddling","safeness","salaried","salutary","sampling","sanction","sanctity","sandbank","sandfish","sandworm","sanitary","satiable","saturate","saturday","scalding","scallion","scalping","scanning","scarcity","scarring","schedule","scheming","schnapps","scolding","scorpion","scouring","scouting","scowling","scrabble","scraggly","scribble","scribing","scrubbed","scrubber","scrutiny","sculptor","secluded","securely","security","sedation","sedative","sediment","seducing","selected","selector","semantic","semester","semisoft","senorita","sensuous","sequence","serrated","sessions","settling","severity","shakable","shamrock","shelving","shifting","shoplift","shopping","shoptalk","shortage","shortcut","showcase","showdown","showgirl","showroom","shrapnel","shredder","shrewdly","shrouded","shucking","siberian","silenced","silencer","simplify","singular","sinister","situated","sixtieth","sizzling","skeletal","skeleton","skillful","skimming","skimpily","skincare","skinhead","skinless","skinning","skipping","skirmish","skydiver","skylight","slacking","slapping","slashing","slighted","slightly","slimness","slinging","slobbery","sloppily","smashing","smelting","smuggler","smugness","sneezing","snipping","snowbird","snowdrop","snowfall","snowless","snowplow","snowshoe","snowsuit","snugness","spearman","specimen","speckled","spectrum","spelling","spending","spinning","spinster","spirited","splashed","splatter","splendid","splendor","splicing","splinter","splotchy","spoilage","spoiling","spookily","sporting","spotless","spotting","spyglass","squabble","squander","squatted","squatter","squealer","squeegee","squiggle","squiggly","stagnant","stagnate","staining","stalling","stallion","stapling","stardust","starfish","starless","starring","starship","starting","starving","steadier","steadily","steering","sterling","stifling","stimulus","stingily","stinging","stingray","stinking","stoppage","stopping","storable","stowaway","straddle","strained","strainer","stranger","strangle","strategy","strength","stricken","striking","striving","stroller","strongly","struggle","stubborn","stuffing","stunning","sturdily","stylized","subduing","subfloor","subgroup","sublease","sublevel","submerge","subpanel","subprime","subsonic","subtitle","subtotal","subtract","sufferer","suffrage","suitable","suitably","suitcase","sulphate","superior","superjet","superman","supermom","supplier","sureness","surgical","surprise","surround","survival","survivor","suspense","swapping","swimming","swimsuit","swimwear","swinging","sycamore","sympathy","symphony","syndrome","synopses","synopsis","tableful","tackling","tactical","tactless","talisman","tameness","tapeless","tapering","tapestry","tartness","tattered","tattling","theology","theorize","thespian","thieving","thievish","thinness","thinning","thirteen","thousand","threaten","thriving","throttle","throwing","thumping","thursday","tidiness","tightwad","tingling","tinkling","tinsmith","traction","trailing","tranquil","transfer","trapdoor","trapping","traverse","travesty","treading","trespass","triangle","tribunal","trickery","trickily","tricking","tricolor","tricycle","trillion","trimming","trimness","tripping","trolling","trombone","tropical","trousers","trustful","trusting","tubeless","tumbling","turbofan","turbojet","tweezers","twilight","twisting","ultimate","umbrella","unafraid","unbeaten","unbiased","unbitten","unbolted","unbridle","unbroken","unbundle","unburned","unbutton","uncapped","uncaring","uncoated","uncoiled","uncombed","uncommon","uncooked","uncouple","uncurled","underage","underarm","undercut","underdog","underfed","underpay","undertow","underuse","undocked","undusted","unearned","uneasily","unedited","unending","unenvied","unfasten","unfilled","unfitted","unflawed","unframed","unfreeze","unfrozen","unfunded","unglazed","ungloved","ungraded","unguided","unharmed","unheated","unhidden","unicycle","uniquely","unissued","universe","unjustly","unlawful","unleaded","unlinked","unlisted","unloaded","unloader","unlocked","unlovely","unloving","unmanned","unmapped","unmarked","unmasked","unmolded","unmoving","unneeded","unopened","unpadded","unpaired","unpeeled","unpicked","unpinned","unplowed","unproven","unranked","unrented","unrigged","unrushed","unsaddle","unsalted","unsavory","unsealed","unseated","unseeing","unseemly","unselect","unshaken","unshaved","unshaven","unsigned","unsliced","unsmooth","unsocial","unsoiled","unsolved","unsorted","unspoken","unstable","unsteady","unstitch","unsubtle","unsubtly","unsuited","untagged","untapped","unthawed","unthread","untimely","untitled","unturned","unusable","unvalued","unvaried","unveiled","unvented","unviable","unwanted","unwashed","unwieldy","unworthy","upcoming","upheaval","uplifted","uprising","upstairs","upstream","upstroke","upturned","urethane","vacation","vagabond","vagrancy","vanquish","variable","variably","vascular","vaseline","vastness","velocity","vendetta","vengeful","venomous","verbally","vertical","vexingly","vicinity","viewable","viewless","vigorous","vineyard","violator","virtuous","viselike","visiting","vitality","vitalize","vitamins","vocalist","vocalize","vocation","volatile","washable","washbowl","washroom","waviness","whacking","whenever","whisking","whomever","whooping","wildcard","wildfire","wildfowl","wildland","wildlife","wildness","winnings","wireless","wisplike","wobbling","wreckage","wrecking","wrongful","yearbook","yearling","yearning","zeppelin","abdomen","abiding","ability","abreast","abridge","absence","absolve","abstain","acclaim","account","acetone","acquire","acrobat","acronym","actress","acutely","aerosol","affront","ageless","agility","agonize","aground","alfalfa","algebra","almanac","alright","amenity","amiable","ammonia","amnesty","amplify","amusing","anagram","anatomy","anchovy","ancient","android","angelic","angling","angrily","angular","animate","annuity","another","antacid","anthill","antonym","anybody","anymore","anytime","apostle","appease","applaud","applied","approve","apricot","armband","armhole","armless","armoire","armored","armrest","arousal","arrange","arrival","ashamed","aspirin","astound","astride","atrophy","attempt","auction","audible","audibly","average","aviator","awkward","backing","backlit","backlog","badland","badness","baggage","bagging","bagpipe","balance","balcony","banking","banshee","barbell","barcode","barista","barmaid","barrack","barrier","battery","batting","bazooka","blabber","bladder","blaming","blazing","blemish","blinked","blinker","bloated","blooper","blubber","blurred","boaster","bobbing","bobsled","bobtail","bolster","bonanza","bonding","bonfire","booting","bootleg","borough","boxlike","breeder","brewery","brewing","bridged","brigade","brisket","briskly","bristle","brittle","broaden","broadly","broiler","brought","budding","buffalo","buffing","buffoon","bulldog","bullion","bullish","bullpen","bunkbed","busload","cabbage","caboose","cadmium","cahoots","calcium","caliber","caloric","calorie","calzone","camping","candied","canning","canteen","capable","capably","capital","capitol","capsize","capsule","caption","captive","capture","caramel","caravan","cardiac","carless","carload","carnage","carpool","carport","carried","cartoon","carving","carwash","cascade","catalog","catcall","catcher","caterer","catfish","catlike","cattail","catwalk","causing","caution","cavalry","certify","chalice","chamber","channel","chapped","chapter","charger","chariot","charity","charred","charter","chasing","chatter","cheddar","chemist","chevron","chewing","choking","chooser","chowder","citable","citadel","citizen","clapped","clapper","clarify","clarity","clatter","cleaver","clicker","climate","clobber","cloning","closure","clothes","clubbed","clutter","coastal","coaster","cobbler","coconut","coexist","collage","collide","comfort","commend","comment","commode","commute","company","compare","compile","compost","comrade","concave","conceal","concept","concert","concise","condone","conduit","confess","confirm","conform","conical","conjure","consent","console","consult","contact","contend","contest","context","contort","contour","control","convene","convent","copilot","copious","corncob","coroner","correct","corrode","corsage","cottage","country","courier","coveted","coyness","crafter","cranial","cranium","craving","crazily","creamed","creamer","crested","crevice","crewman","cricket","crimson","crinkle","crinkly","crisped","crisply","critter","crouton","crowbar","crucial","crudely","cruelly","cruelty","crumpet","crunchy","crushed","crusher","cryptic","crystal","cubical","cubicle","culprit","culture","cupcake","cupping","curable","curator","curling","cursive","curtain","custard","custody","customs","cycling","cyclist","dancing","darkish","darling","dawdler","daycare","daylong","dayroom","daytime","dazzler","dealing","debrief","decency","decibel","decimal","decline","default","defense","defiant","deflate","defraud","defrost","delouse","density","dentist","denture","deplete","depress","deprive","derived","deserve","desktop","despair","despise","despite","destiny","detract","devalue","deviant","deviate","devious","devotee","diagram","dictate","dimness","dingbat","diocese","dioxide","diploma","dipping","disband","discard","discern","discuss","disdain","disjoin","dislike","dismiss","disobey","display","dispose","dispute","disrupt","distant","distill","distort","divided","dolphin","donated","donator","doorman","doormat","doorway","drained","drainer","drapery","drastic","dreaded","dribble","driller","driving","drizzle","drizzly","dropbox","droplet","dropout","dropper","duchess","ducking","dumping","durable","durably","dutiful","dwelled","dweller","dwindle","dynamic","dynasty","earache","eardrum","earflap","earlobe","earmark","earmuff","earring","earshot","earthen","earthly","easeful","easiest","eatable","eclipse","ecology","economy","edition","effects","egotism","elastic","elderly","elevate","elitism","ellipse","elusive","embargo","embassy","emblaze","emerald","emotion","empathy","emperor","empower","emptier","enclose","encrust","encrypt","endless","endnote","endorse","engaged","engorge","engross","enhance","enjoyer","enslave","ensnare","entitle","entrust","entwine","envious","episode","equator","equinox","erasure","erratic","esquire","essence","etching","eternal","ethanol","evacuee","evasion","evasive","evident","exalted","example","exclaim","exclude","exhaust","expanse","explain","explode","exploit","explore","express","extinct","extrude","faceted","faction","factoid","factual","faculty","failing","falsify","fanatic","fancied","fanfare","fanning","fantasy","fascism","fasting","favored","federal","fencing","ferment","festive","fiction","fidgety","fifteen","figment","filling","finally","finance","finicky","finless","finlike","flaccid","flagman","flakily","flanked","flaring","flatbed","flatten","flattop","fleshed","florist","flyable","flyaway","flyover","footage","footing","footman","footpad","footsie","founder","fragile","framing","frantic","fraying","freebee","freebie","freedom","freeing","freeway","freight","fretful","fretted","frisbee","fritter","frosted","gaining","gallery","gallows","gangway","garbage","garland","garment","garnish","gauging","generic","gentile","geology","gestate","gesture","getaway","getting","giddily","gimmick","gizzard","glacial","glacier","glamour","glaring","glazing","gleeful","gliding","glimmer","glimpse","glisten","glitter","gloater","glorify","glowing","glucose","glutton","goggles","goliath","gondola","gosling","grading","grafted","grandly","grandma","grandpa","granite","granola","grapple","gratify","grating","gravity","grazing","greeter","grimace","gristle","grouped","growing","gruffly","grumble","grumbly","guiding","gumball","gumdrop","gumming","gutless","guzzler","habitat","hacking","hacksaw","haggler","halogen","hammock","hamster","handbag","handful","handgun","handled","handler","handoff","handsaw","handset","hangout","happier","happily","hardhat","harmful","harmony","harness","harpist","harvest","hastily","hatchet","hatless","heading","headset","headway","heavily","heaving","hedging","helpful","helping","hemlock","heroics","heroism","herring","herself","hexagon","humming","hunting","hurling","hurried","husband","hydrant","iciness","ideally","imaging","imitate","immerse","impeach","implant","implode","impound","imprint","improve","impulse","islamic","isotope","issuing","italics","jackpot","janitor","january","jarring","jasmine","jawless","jawline","jaybird","jellied","jitters","jittery","jogging","joining","joyride","jugular","jujitsu","jukebox","juniper","junkman","justice","justify","karaoke","kindred","kinetic","kinfolk","kinship","kinsman","kissing","kitchen","kleenex","krypton","labored","laborer","ladybug","lagging","landing","lantern","lapping","latrine","launder","laundry","legible","legibly","legroom","legwork","leotard","letdown","lettuce","liberty","library","licking","lifting","liftoff","limeade","limping","linseed","liquefy","liqueur","livable","lividly","luckily","lullaby","lumping","lumpish","lustily","machine","magenta","magical","magnify","majesty","mammary","manager","manatee","mandate","manhole","manhood","manhunt","mankind","manlike","manmade","mannish","marbled","marbles","marital","married","marxism","mashing","massive","mastiff","matador","matcher","maximum","moaning","mobster","modular","moisten","mollusk","mongrel","monitor","monsoon","monthly","moocher","moonlit","morally","mortify","mounted","mourner","movable","mullets","mummify","mundane","mushily","mustang","mustard","mutable","myspace","mystify","napping","nastily","natural","nearest","nemeses","nemesis","nervous","neutron","nuclear","nucleus","nullify","numbing","numeral","numeric","nursery","nursing","nurture","nutcase","nutlike","obliged","obscure","obvious","octagon","october","octopus","ominous","onboard","ongoing","onshore","onstage","opacity","operate","opossum","osmosis","outback","outcast","outcome","outgrow","outlast","outline","outlook","outmost","outpost","outpour","outrage","outrank","outsell","outward","overact","overall","overbid","overdue","overfed","overlap","overlay","overpay","overrun","overtly","overuse","oxidant","oxidize","pacific","padding","padlock","pajamas","pampers","pancake","panning","panther","paprika","papyrus","paradox","parched","parking","parkway","parsley","parsnip","partake","parting","partner","passage","passing","passion","passive","pastime","pasture","patient","patriot","payable","payback","payment","payroll","pelican","penalty","pendant","pending","pennant","pension","percent","perfume","perjury","petunia","phantom","phoenix","phonics","placard","placate","planner","plaster","plastic","plating","platter","playful","playing","playoff","playpen","playset","pliable","plunder","plywood","pointed","pointer","polygon","polymer","popcorn","popular","portion","postage","postbox","posting","posture","postwar","pouring","powdery","pranker","praying","preachy","precise","precook","predict","preface","pregame","prelude","premium","prepaid","preplan","preshow","presoak","presume","preteen","pretext","pretzel","prevail","prevent","preview","primary","primate","privacy","private","probing","problem","process","prodigy","produce","product","profane","profile","progeny","program","propose","prorate","proving","provoke","prowess","prowler","pruning","psychic","pulsate","pungent","purging","puritan","pursuit","pushing","pushpin","putdown","pyramid","quaking","qualify","quality","quantum","quarrel","quartet","quicken","quickly","quintet","ragweed","railcar","railing","railway","ranging","ranking","ransack","ranting","rasping","ravioli","reactor","reapply","reawake","rebirth","rebound","rebuild","rebuilt","recital","reclaim","recluse","recolor","recount","rectify","reenact","reenter","reentry","referee","refined","refocus","refract","refrain","refresh","refried","refusal","regalia","regally","regress","regroup","regular","reissue","rejoice","relapse","related","relearn","release","reliant","relieve","relight","remarry","rematch","remnant","remorse","removal","removed","remover","renewal","renewed","reoccur","reorder","repaint","replace","replica","reprint","reprise","reptile","request","require","reroute","rescuer","reshape","reshoot","residue","respect","rethink","retinal","retired","retiree","retouch","retrace","retract","retrain","retread","retreat","retrial","retying","reunion","reunite","reveler","revenge","revenue","revered","reverse","revisit","revival","reviver","rewrite","ribcage","rickety","ricotta","rifling","rigging","rimless","rinsing","ripcord","ripping","riptide","risotto","ritalin","riveter","roaming","robbing","rocking","rotting","rotunda","roundup","routine","routing","rubbing","rubdown","rummage","rundown","running","rupture","sabbath","saddled","sadness","saffron","sagging","salvage","sandbag","sandbar","sandbox","sanding","sandlot","sandpit","sapling","sarcasm","sardine","satchel","satisfy","savanna","savings","scabbed","scalded","scaling","scallop","scandal","scanner","scarily","scholar","science","scooter","scoring","scoured","scratch","scrawny","scrooge","scruffy","scrunch","scuttle","secrecy","secular","segment","seismic","seizing","seltzer","seminar","senator","serpent","service","serving","setback","setting","seventh","seventy","shadily","shading","shakily","shaking","shallot","shallow","shampoo","shaping","sharper","sharpie","sharply","shelter","shifter","shimmer","shindig","shingle","shining","shopper","shorten","shorter","shortly","showbiz","showing","showman","showoff","shrivel","shudder","shuffle","siamese","sibling","sighing","silicon","sincere","singing","sinless","sinuous","sitting","sixfold","sixteen","sixties","sizable","sizably","skating","skeptic","skilled","skillet","skimmed","skimmer","skipper","skittle","skyline","skyward","slacked","slacker","slander","slashed","slather","slicing","sliding","sloping","slouchy","smartly","smasher","smashup","smitten","smoking","smolder","smother","snagged","snaking","snippet","snooper","snoring","snorkel","snowcap","snowman","snuggle","species","specked","speller","spender","spinach","spindle","spinner","spinout","spirits","splashy","splurge","spoiled","spoiler","sponsor","spotted","spotter","spousal","sputter","squeeze","squishy","stadium","staging","stained","stamina","stammer","stardom","staring","starlet","starlit","starter","startle","startup","starved","stature","statute","staunch","stellar","stencil","sterile","sternum","stiffen","stiffly","stimuli","stinger","stipend","stoning","stopped","stopper","storage","stowing","stratus","stretch","strudel","stubbed","stubble","stubbly","student","studied","stuffed","stumble","stunned","stunner","styling","stylist","subdued","subject","sublime","subplot","subside","subsidy","subsoil","subtext","subtype","subzero","suction","suffice","suggest","sulfate","sulfide","sulfite","support","supreme","surface","surgery","surging","surname","surpass","surplus","surreal","survive","suspect","suspend","swagger","swifter","swiftly","swimmer","swinger","swizzle","swooned","symptom","synapse","synergy","t-shirt","tabasco","tabloid","tacking","tactful","tactics","tactile","tadpole","tainted","tannery","tanning","tantrum","tapered","tapioca","tapping","tarnish","tasting","theater","thermal","thermos","thicken","thicket","thimble","thinner","thirsty","thrower","thyself","tidings","tighten","tightly","tigress","timothy","tinfoil","tinwork","tipping","tracing","tractor","trading","traffic","tragedy","traitor","trapeze","trapped","trapper","treason","trekker","tremble","tribune","tribute","triceps","trickle","trident","trilogy","trimmer","trinity","triumph","trivial","trodden","tropics","trouble","truffle","trustee","tubular","tucking","tuesday","tuition","turbine","turmoil","twiddle","twisted","twister","twitter","unaired","unawake","unaware","unbaked","unblock","unboxed","uncanny","unchain","uncheck","uncivil","unclasp","uncloak","uncouth","uncover","uncross","uncrown","uncured","undated","undergo","undoing","undress","undying","unearth","uneaten","unequal","unfazed","unfiled","unfixed","ungodly","unhappy","unheard","unhinge","unicorn","unified","unifier","unkempt","unknown","unlaced","unlatch","unleash","unlined","unloved","unlucky","unmixed","unmoral","unmoved","unnamed","unnerve","unpaved","unquote","unrated","unrobed","unsaved","unscrew","unstuck","unsworn","untaken","untamed","untaxed","untimed","untried","untruth","untwist","untying","unusual","unvocal","unweave","unwired","unwound","unwoven","upchuck","upfront","upgrade","upright","upriver","upscale","upstage","upstart","upstate","upswing","uptight","uranium","urgency","urology","useable","utensil","utility","utilize","vacancy","vaguely","valiant","vanilla","vantage","variety","various","varmint","varnish","varsity","varying","vending","venture","verbose","verdict","version","vertigo","veteran","victory","viewing","village","villain","vintage","violate","virtual","viscous","visible","visibly","visitor","vitally","vividly","vocally","voicing","voltage","volumes","voucher","walmart","wannabe","wanting","washday","washing","washout","washtub","wasting","whoever","whoopee","wielder","wildcat","willing","wincing","winking","wistful","womanly","worried","worrier","wrangle","wrecker","wriggle","wriggly","wrinkle","wrinkly","writing","written","wronged","wrongly","wrought","yanking","yapping","yelling","yiddish","zealous","zipfile","zipping","zoology","abacus","ablaze","abroad","absurd","accent","aching","acting","action","active","affair","affirm","afford","aflame","afloat","afraid","agency","agenda","aghast","agreed","aliens","almost","alumni","always","ambush","amends","amount","amulet","amused","amuser","anchor","anemia","anemic","angled","angler","angles","animal","anthem","antics","antler","anyhow","anyone","anyway","apache","appear","armful","arming","armory","around","arrest","arrive","ascend","ascent","asleep","aspect","aspire","astute","atrium","attach","attain","attest","attire","august","author","autism","avatar","avenge","avenue","awaken","awhile","awning","babble","babied","baboon","backed","backer","backup","badass","baffle","bagful","bagged","baggie","bakery","baking","bamboo","banana","banish","banked","banker","banner","banter","barbed","barber","barley","barman","barrel","basics","basket","batboy","battle","bauble","blazer","bleach","blinks","blouse","bluish","blurry","bobbed","bobble","bobcat","bogged","boggle","bonded","bonnet","bonsai","booted","bootie","boring","botany","bottle","bottom","bounce","bouncy","bovine","boxcar","boxing","breach","breath","breeze","breezy","bright","broken","broker","bronco","bronze","browse","brunch","bubble","bubbly","bucked","bucket","buckle","budget","buffed","buffer","bulgur","bundle","bungee","bunion","busboy","busily","cabana","cabbie","cackle","cactus","caddie","camera","camper","campus","canary","cancel","candle","canine","canned","cannon","cannot","canola","canopy","canyon","capped","carbon","carded","caress","caring","carrot","cartel","carton","casing","casino","casket","catchy","catnap","catnip","catsup","cattle","caucus","causal","caviar","cavity","celery","celtic","cement","census","chance","change","chaste","chatty","cheese","cheesy","cherub","chewer","chirpy","choice","choosy","chosen","chrome","chubby","chummy","cinema","circle","circus","citric","citrus","clammy","clamor","clause","clench","clever","client","clinic","clique","clover","clumsy","clunky","clutch","cobalt","cobweb","coerce","coffee","collar","collie","colony","coming","common","compel","comply","concur","copied","copier","coping","copper","cornea","corned","corner","corral","corset","cortex","cosmic","cosmos","cotton","county","cozily","cradle","crafty","crayon","crazed","crease","create","credit","creole","cringe","crispy","crouch","crummy","crying","cuddle","cuddly","cupped","curdle","curfew","curing","curled","curler","cursor","curtly","curtsy","cussed","cyclic","cymbal","dagger","dainty","dander","danger","dangle","dating","daybed","deacon","dealer","debate","debtor","debunk","decade","deceit","decent","decode","decree","deduce","deduct","deepen","deeply","deface","defame","defeat","defile","define","deftly","defuse","degree","delete","deluge","deluxe","demise","demote","denial","denote","dental","depict","deploy","deport","depose","deputy","derail","detail","detest","device","diaper","dicing","dilute","dimmed","dimmer","dimple","dinghy","dining","dinner","dipped","dipper","disarm","dismay","disown","diving","doable","docile","dollar","dollop","domain","doodle","dorsal","dosage","dotted","douche","dreamt","dreamy","dreary","drench","drippy","driven","driver","drudge","dubbed","duffel","dugout","duller","duplex","duress","during","earful","earthy","earwig","easily","easing","easter","eatery","eating","eclair","edging","editor","effort","egging","eggnog","either","elated","eldest","eleven","elixir","embark","emblem","embody","emboss","enable","enamel","encode","encore","ending","energy","engine","engulf","enrage","enrich","enroll","ensure","entail","entire","entity","entomb","entrap","entree","enzyme","equate","equity","erased","eraser","errand","errant","eskimo","estate","ethics","evolve","excess","excuse","exhale","exhume","exodus","expand","expend","expert","expire","expose","extent","extras","fabric","facial","facing","factor","fading","falcon","family","famine","faster","faucet","fedora","feeble","feisty","feline","fender","ferret","ferris","fervor","fester","fiddle","figure","filing","filled","filler","filter","finale","finite","flashy","flatly","fleshy","flight","flinch","floral","flying","follow","fondly","fondue","footer","fossil","foster","frayed","freely","french","frenzy","friday","fridge","friend","fringe","frolic","frosty","frozen","frying","galley","gallon","galore","gaming","gander","gangly","garage","garden","gargle","garlic","garnet","garter","gating","gazing","geiger","gender","gently","gerbil","giblet","giggle","giggly","gigolo","gilled","girdle","giving","gladly","glance","glider","glitch","glitzy","gloomy","gluten","gnarly","google","gopher","gorged","gossip","gothic","gotten","graded","grader","granny","gravel","graves","greedy","grinch","groggy","groove","groovy","ground","grower","grudge","grunge","gurgle","gutter","hacked","hacker","halved","halves","hamlet","hamper","handed","hangup","hankie","harbor","hardly","hassle","hatbox","hatred","hazard","hazily","hazing","headed","header","helium","helmet","helper","herald","herbal","hermit","hubcap","huddle","humble","humbly","hummus","humped","humvee","hunger","hungry","hunter","hurdle","hurled","hurler","hurray","husked","hybrid","hyphen","idiocy","ignore","iguana","impale","impart","impish","impose","impure","iodine","iodize","iphone","itunes","jackal","jacket","jailer","jargon","jersey","jester","jigsaw","jingle","jockey","jogger","jovial","joyous","juggle","jumble","junior","junkie","jurist","justly","karate","keenly","kennel","kettle","kimono","kindle","kindly","kisser","kitten","kosher","ladder","ladies","lagged","lagoon","landed","lapdog","lapped","laptop","lather","latter","launch","laurel","lavish","lazily","legacy","legend","legged","legume","length","lesser","letter","levers","liable","lifter","likely","liking","lining","linked","liquid","litmus","litter","little","lively","living","lizard","lugged","lumber","lunacy","lushly","luster","luxury","lyrics","maggot","maimed","making","mammal","manger","mangle","manila","manned","mantis","mantra","manual","margin","marina","marine","marlin","maroon","marrow","marshy","mascot","mashed","masses","mating","matrix","matron","matted","matter","mayday","moaner","mobile","mocker","mockup","modify","module","monday","mooing","mooned","morale","mosaic","motion","motive","moving","mowing","mulled","mumble","muppet","museum","musket","muster","mutate","mutiny","mutual","muzzle","myself","naming","napkin","napped","narrow","native","nature","nearby","nearly","neatly","nebula","nectar","negate","nephew","neuron","neuter","nibble","nimble","nimbly","nuclei","nugget","number","numbly","nutmeg","nuzzle","object","oblong","obtain","obtuse","occupy","ocelot","octane","online","onward","oppose","outage","outbid","outfit","outing","outlet","output","outwit","oxford","oxygen","oyster","pacify","padded","paddle","paging","palace","paltry","panama","pantry","papaya","parade","parcel","pardon","parish","parlor","parole","parrot","parted","partly","pasted","pastel","pastor","patchy","patrol","pauper","paving","pawing","payday","paying","pebble","pebbly","pectin","pellet","pelvis","pencil","penpal","perish","pester","petite","petted","phobia","phoney","phrase","plasma","plated","player","pledge","plenty","plural","pointy","poison","poking","police","policy","polish","poncho","poplar","popper","porous","portal","portly","posing","possum","postal","posted","poster","pounce","powwow","prance","prayer","precut","prefix","prelaw","prepay","preppy","preset","pretty","prewar","primal","primer","prison","prissy","pronto","proofs","proton","proved","proven","prozac","public","pucker","pueblo","pumice","pummel","puppet","purely","purify","purist","purity","purple","pusher","pushup","puzzle","python","quarry","quench","quiver","racing","racism","racoon","radial","radish","raffle","ragged","raging","raider","raisin","raking","ramble","ramrod","random","ranged","ranger","ranked","rarity","rascal","ravage","ravine","raving","reason","rebate","reboot","reborn","rebuff","recall","recant","recast","recede","recent","recess","recite","recoil","recopy","record","recoup","rectal","refill","reflex","reflux","refold","refund","refuse","refute","regain","reggae","regime","region","reheat","rehire","rejoin","relish","relive","reload","relock","remake","remark","remedy","remold","remote","rename","rental","rented","renter","reopen","repair","repave","repeal","repent","replay","repose","repost","resale","reseal","resend","resent","resize","resort","result","resume","retail","retake","retold","retool","return","retype","reveal","reverb","revert","revise","revoke","revolt","reward","rewash","rewind","rewire","reword","rework","rewrap","ribbon","riches","richly","ridden","riding","rimmed","ripple","rising","roamer","robust","rocker","rocket","roping","roster","rotten","roving","rubbed","rubber","rubble","ruckus","rudder","ruined","rumble","runner","runway","sacred","sadden","safari","safely","salami","salary","saline","saloon","salute","sample","sandal","sanded","savage","savior","scabby","scarce","scared","scenic","scheme","scorch","scored","scorer","scotch","scouts","screen","scribe","script","scroll","scurvy","second","secret","sector","sedate","seduce","seldom","senate","senior","septic","septum","sequel","series","sermon","sesame","settle","shabby","shaded","shadow","shanty","sheath","shelve","sherry","shield","shifty","shimmy","shorts","shorty","shower","shrank","shriek","shrill","shrimp","shrine","shrink","shrubs","shrunk","siding","sierra","siesta","silent","silica","silver","simile","simple","simply","singer","single","sinner","sister","sitcom","sitter","sizing","sizzle","skater","sketch","skewed","skewer","skiing","skinny","slacks","sleeve","sliced","slicer","slider","slinky","sliver","slogan","sloped","sloppy","sludge","smoked","smooth","smudge","smudgy","smugly","snazzy","sneeze","snitch","snooze","snugly","specks","speech","sphere","sphinx","spider","spiffy","spinal","spiral","spleen","splice","spoils","spoken","sponge","spongy","spooky","sports","sporty","spotty","spouse","sprain","sprang","sprawl","spring","sprint","sprite","sprout","spruce","sprung","squall","squash","squeak","squint","squire","squirt","stable","staple","starch","starry","static","statue","status","stench","stereo","stifle","stingy","stinky","stitch","stooge","streak","stream","street","stress","strewn","strict","stride","strife","strike","strive","strobe","strode","struck","strung","stucco","studio","stuffy","stupor","sturdy","stylus","sublet","subpar","subtly","suburb","subway","sudden","sudoku","suffix","suitor","sulfur","sullen","sultry","supper","supply","surely","surfer","survey","swerve","switch","swivel","swoosh","system","tables","tablet","tackle","taking","talcum","tamale","tamper","tanned","target","tarmac","tartar","tartly","tassel","tattle","tattoo","tavern","thesis","thinly","thirty","thrash","thread","thrift","thrill","thrive","throat","throng","tidbit","tiling","timing","tingle","tingly","tinker","tinsel","tipoff","tipped","tipper","tiptop","tiring","tissue","trance","travel","treble","tremor","trench","triage","tricky","trifle","tripod","trophy","trough","trowel","trunks","tumble","turban","turkey","turret","turtle","twelve","twenty","twisty","twitch","tycoon","umpire","unable","unbend","unbent","unclad","unclip","unclog","uncork","undead","undone","unease","uneasy","uneven","unfair","unfold","unglue","unholy","unhook","unison","unkind","unless","unmade","unpack","unpaid","unplug","unread","unreal","unrest","unripe","unroll","unruly","unsafe","unsaid","unseen","unsent","unsnap","unsold","unsure","untidy","untold","untrue","unused","unwary","unwell","unwind","unworn","upbeat","update","upheld","uphill","uphold","upload","uproar","uproot","upside","uptake","uptown","upward","upwind","urchin","urgent","urging","usable","utmost","utopia","vacant","vacate","valium","valley","vanish","vanity","varied","vastly","veggie","velcro","velvet","vendor","verify","versus","vessel","viable","viewer","violet","violin","vision","volley","voting","voyage","waffle","waggle","waking","walnut","walrus","wanted","wasabi","washed","washer","waving","whacky","whinny","whoops","widely","widget","wilder","wildly","willed","willow","winner","winter","wiring","wisdom","wizard","wobble","wobbly","wooing","wreath","wrench","yearly","yippee","yogurt","yonder","zodiac","zombie","zoning","abide","acorn","affix","afoot","agent","agile","aging","agony","ahead","alarm","album","alias","alibi","alike","alive","aloft","aloha","alone","aloof","amaze","amber","amigo","amino","amiss","among","ample","amply","amuck","anger","anime","ankle","annex","antsy","anvil","aorta","apple","apply","april","apron","aptly","arena","argue","arise","armed","aroma","arose","array","arson","ashen","ashes","aside","askew","atlas","attic","audio","avert","avoid","await","award","aware","awoke","bacon","badge","badly","bagel","baggy","baked","balmy","banjo","barge","basil","basin","basis","batch","baton","blade","blame","blank","blast","bleak","bleep","blend","bless","blimp","bling","blitz","bluff","blunt","blurb","blurt","blush","bogus","boned","boney","bonus","booth","boots","boozy","borax","botch","boxer","briar","bribe","brick","bride","bring","brink","brook","broom","brunt","brush","brute","buddy","buggy","bulge","bully","bunch","bunny","cable","cache","cacti","caddy","cadet","cameo","canal","candy","canon","carat","cargo","carol","carry","carve","catty","cause","cedar","chafe","chain","chair","chant","chaos","chaps","charm","chase","cheek","cheer","chemo","chess","chest","chevy","chewy","chief","chili","chill","chimp","chive","chomp","chuck","chump","chunk","churn","chute","cider","cinch","civic","civil","claim","clamp","clang","clash","clasp","class","clean","clear","cleat","cleft","clerk","cling","cloak","clock","clone","cloud","clump","coach","cocoa","comfy","comic","comma","conch","coral","corny","couch","cough","could","cover","cramp","crane","crank","crate","crave","crazy","creed","creme","crepe","crept","cried","crier","crimp","croak","crock","crook","croon","cross","crowd","crown","crumb","crust","cupid","curly","curry","curse","curve","curvy","cushy","cycle","daily","dairy","daisy","dance","dandy","dares","dealt","debit","debug","decaf","decal","decay","decoy","defog","deity","delay","delta","denim","dense","depth","derby","deuce","diary","dimly","diner","dingo","dingy","ditch","ditto","ditzy","dizzy","dodge","dodgy","doily","doing","dolly","donor","donut","doozy","dowry","drank","dress","dried","drier","drift","drone","drool","droop","drove","drown","ducky","duvet","dwarf","dweeb","eagle","early","easel","eaten","ebony","ebook","ecard","eject","elbow","elite","elope","elude","elves","email","ember","emcee","emote","empty","ended","envoy","equal","error","erupt","essay","ether","evade","evict","evoke","exact","exert","exile","expel","fable","false","fancy","feast","femur","fence","ferry","fetal","fetch","fever","fiber","fifth","fifty","filth","finch","finer","flail","flaky","flame","flask","flick","flier","fling","flint","flirt","float","flock","floss","flyer","folic","foyer","frail","frame","frays","fresh","fried","frill","frisk","front","froth","frown","fruit","gaffe","gains","gamma","gauze","gecko","genre","gents","getup","giant","giddy","gills","given","giver","gizmo","glade","glare","glass","glory","gloss","glove","going","gonad","gooey","goofy","grain","grant","grape","graph","grasp","grass","gravy","green","grief","grill","grime","grimy","groin","groom","grope","grout","grove","growl","grunt","guide","guise","gully","gummy","gusto","gusty","haiku","hanky","happy","hardy","harsh","haste","hasty","haunt","haven","heave","hedge","hefty","hence","henna","herbs","hertz","human","humid","hurry","icing","idiom","igloo","image","imply","irate","issue","ivory","jaunt","jawed","jelly","jiffy","jimmy","jolly","judge","juice","juicy","jumbo","juror","kabob","karma","kebab","kitty","knelt","knoll","koala","kooky","kudos","ladle","lance","lanky","lapel","large","lasso","latch","legal","lemon","level","lilac","lilly","limes","limit","lingo","lived","liver","lucid","lunar","lurch","lusty","lying","macaw","magma","maker","mango","mangy","manly","manor","march","mardi","marry","mauve","maybe","mocha","molar","moody","morse","mossy","motor","motto","mouse","mousy","mouth","movie","mower","mulch","mumbo","mummy","mumps","mural","murky","mushy","music","musky","musty","nacho","nanny","nappy","nervy","never","niece","nifty","ninja","ninth","nutty","nylon","oasis","ocean","olive","omega","onion","onset","opium","other","otter","ought","ounce","outer","ovary","ozone","paced","pagan","pager","panda","panic","pants","paper","parka","party","pasta","pasty","patio","paver","payee","payer","pecan","penny","perch","perky","pesky","petal","petri","petty","phony","photo","plank","plant","plaza","pleat","pluck","poach","poise","poker","polar","polio","polka","poppy","poser","pouch","pound","power","press","pried","primp","print","prior","prism","prize","probe","prone","prong","props","proud","proxy","prude","prune","pulse","punch","pupil","puppy","purge","purse","pushy","quack","quail","quake","qualm","query","quiet","quill","quilt","quirk","quote","rabid","radar","radio","rally","ranch","rants","raven","reach","rebel","rehab","relax","relay","relic","remix","reply","rerun","reset","retry","reuse","rhyme","rigid","rigor","rinse","ritzy","rival","roast","robin","rocky","rogue","roman","rover","royal","rumor","runny","rural","sadly","saggy","saint","salad","salon","salsa","sandy","santa","sappy","sassy","satin","saucy","sauna","saved","savor","scale","scant","scarf","scary","scion","scoff","scone","scoop","scope","scorn","scrap","scuba","scuff","sedan","sepia","serve","setup","shack","shady","shaft","shaky","shale","shame","shank","shape","share","shawl","sheep","sheet","shelf","shell","shine","shiny","shirt","shock","shone","shore","shout","shove","shown","showy","shrug","shush","silly","siren","sixth","skied","skier","skies","skirt","skype","slain","slang","slate","sleek","sleep","sleet","slept","slick","slimy","slurp","slush","small","smell","smile","smirk","smite","smith","smock","smoky","snack","snare","snarl","sneak","sneer","snide","sniff","snore","snort","snout","snowy","snuff","speak","speed","spent","spied","spill","spilt","spiny","spoof","spool","spoon","spore","spout","spray","spree","sprig","squad","squid","stack","staff","stage","stamp","stand","stank","stark","stash","state","stays","steam","steed","steep","stick","stilt","stock","stoic","stoke","stole","stomp","stony","stood","stool","stoop","storm","stout","stove","straw","stray","strep","strum","strut","stuck","study","stump","stung","stunt","suave","sugar","suing","sushi","swarm","swear","sweat","sweep","swell","swept","swipe","swirl","swoop","swore","sworn","swung","syrup","tabby","tacky","talon","tamer","tarot","taste","tasty","taunt","thank","theft","theme","these","thigh","thing","think","thong","thorn","those","thumb","tiara","tibia","tidal","tiger","timid","trace","track","trade","train","traps","trash","treat","trend","trial","tried","trout","truce","truck","trump","truth","tubby","tulip","tummy","tutor","tweak","tweed","tweet","twerp","twice","twine","twins","twirl","tying","udder","ultra","uncle","uncut","unify","union","unlit","untie","until","unwed","unzip","upper","urban","usage","usher","usual","utter","valid","value","vegan","venue","venus","verse","vibes","video","viper","viral","virus","visor","vista","vixen","voice","voter","vowed","vowel","wafer","waged","wager","wages","wagon","waltz","watch","water","wharf","wheat","whiff","whiny","whole","widen","widow","width","wince","wired","wispy","woozy","worry","worst","wound","woven","wrath","wrist","xerox","yahoo","yeast","yield","yo-yo","yodel","yummy","zebra","zesty","zippy","able","acid","acre","acts","afar","aged","ahoy","aide","aids","ajar","aloe","alto","amid","anew","aqua","area","army","ashy","atom","atop","avid","awry","axis","barn","bash","bath","bats","blah","blip","blob","blog","blot","boat","body","boil","bolt","bony","book","boss","both","boxy","brim","bulb","bulk","bunt","bush","bust","buzz","cage","cake","calm","cane","cape","case","cash","chef","chip","chop","chug","city","clad","claw","clay","clip","coat","coil","coke","cola","cold","colt","coma","come","cone","cope","copy","cork","cost","cozy","crib","crop","crux","cube","cure","cusp","darn","dart","dash","data","dawn","dean","deck","deed","deem","defy","deny","dial","dice","dill","dime","dish","disk","dock","dole","dork","dose","dove","down","doze","drab","draw","drew","drum","duct","dude","duke","duly","dupe","dusk","dust","duty","each","eats","ebay","echo","edge","edgy","emit","envy","epic","even","evil","exes","exit","fade","fall","fame","fang","feed","feel","film","five","flap","fled","flip","flop","foam","foil","folk","font","food","fool","from","gala","game","gave","gawk","gear","geek","gift","glue","gnat","goal","goes","golf","gone","gong","good","goon","gore","gory","gout","gown","grab","gray","grew","grid","grip","grit","grub","gulf","gulp","guru","gush","guts","half","halt","hash","hate","hazy","heap","heat","huff","hula","hulk","hull","hunk","hurt","hush","icky","icon","idly","ipad","ipod","iron","item","java","jaws","jazz","jeep","jinx","john","jolt","judo","july","jump","june","jury","keep","kelp","kept","kick","kiln","kilt","king","kite","kiwi","knee","kung","lair","lake","lard","lark","lash","last","late","lazy","left","lego","lend","lens","lent","life","lily","limb","line","lint","lion","lisp","list","lung","lure","lurk","mace","malt","mama","many","math","mold","most","move","much","muck","mule","mute","mutt","myth","nail","name","nape","navy","neon","nerd","nest","next","oboe","ogle","oink","okay","omen","omit","only","onto","onyx","oops","ooze","oozy","opal","open","ouch","oval","oven","palm","pang","path","pelt","perm","peso","plod","plop","plot","plow","ploy","plug","plus","poem","poet","pogo","polo","pond","pony","pope","pork","posh","pout","pull","pulp","puma","punk","purr","putt","quit","race","rack","raft","rage","rake","ramp","rare","rash","ream","rely","reps","rice","ride","rift","rind","rink","riot","rise","risk","robe","romp","rope","rosy","ruby","rule","runt","ruse","rush","rust","saga","sage","said","sake","salt","same","sank","sash","scam","self","send","shed","ship","shun","shut","sift","silk","silo","silt","size","skid","slab","slam","slaw","sled","slip","slit","slot","slug","slum","smog","snap","snub","spew","spry","spud","spur","stem","step","stew","stir","such","suds","sulk","swab","swan","sway","taco","take","tall","tank","taps","task","that","thaw","thee","thud","thus","tidy","tile","till","tilt","tint","tiny","tray","tree","trio","turf","tusk","tutu","twig","tyke","unit","upon","used","user","veal","very","vest","veto","vice","visa","void","wake","walk","wand","wasp","wavy","wham","wick","wife","wifi","wilt","wimp","wind","wing","wipe","wiry","wise","wish","wolf","womb","woof","wool","word","work","xbox","yard","yarn","yeah","yelp","yoga","yoyo","zero","zips","zone","zoom","aim","art","bok","cod","cut","dab","dad","dig","dry","duh","duo","eel","elf","elk","elm","emu","fax","fit","foe","fog","fox","gab","gag","gap","gas","gem","guy","had","hug","hut","ice","icy","ion","irk","ivy","jab","jam","jet","job","jot","keg","lid","lip","map","mom","mop","mud","mug","nag","net","oaf","oak","oat","oil","old","opt","owl","pep","pod","pox","pry","pug","rug","rut","say","shy","sip","sly","tag","try","tug","tux","wad","why","wok","wow","yam","yen","yin","zap","zen","zit"]};var gi=a(2052),bi=a.n(gi);const yi=[{id:"not_available",label:"n/a",strength:0},{id:"very-weak",label:"Very weak",strength:1},{id:"weak",label:"Weak",strength:60},{id:"fair",label:"Fair",strength:80},{id:"strong",label:"Strong",strength:112},{id:"very-strong",label:"Very strong",strength:128}],fi={mask_upper:{label:"A-Z",characters:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},mask_lower:{label:"a-z",characters:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},mask_digit:{label:"0-9",characters:["0","1","2","3","4","5","6","7","8","9"]},mask_char1:{label:"# $ % & @ ^ ~",characters:["#","$","%","&","@","^","~"]},mask_parenthesis:{label:"{ [ ( | ) ] }",characters:["{","(","[","|","]",")","}"]},mask_char2:{label:". , : ;",characters:[".",",",":",";"]},mask_char3:{label:"' \" `",characters:["'",'"',"`"]},mask_char4:{label:"/ \\ _ -",characters:["/","\\","_","-"]},mask_char5:{label:"< * + ! ? =",characters:["<","*","+","!","?","="]},mask_emoji:{label:"😘",characters:["😀","😁","😂","😃","😄","😅","😆","😇","😈","😉","😊","😋","😌","😍","😎","😏","😐","😑","😒","😓","😔","😕","😖","😗","😘","😙","😚","😛","😜","😝","😞","😟","😠","😡","😢","😣","😤","😥","😦","😧","😨","😩","😪","😫","😬","😭","😮","😯","😰","😱","😲","😳","😴","😵","😶","😷","😸","😹","😺","😻","😼","😽","😾","😿","🙀","🙁","🙂","🙃","🙄","🙅","🙆","🙇","🙈","🙉","🙊","🙋","🙌","🙍","🙎","🙏"]}},vi=["O","l","|","I","0","1"],Ei=Object.values(fi).flatMap((e=>e.characters)),wi={evaluateMaxPasswordEntropy:e=>{const t=Object.entries(fi).filter((([t])=>e[t])).reduce(((e,[t])=>[...e,...fi[t].characters]),[]).filter((t=>!e.exclude_look_alike_chars||!vi.includes(t)));return ki(e.length,t.length)},entropyPassword:(e="")=>{const t=(new(bi())).splitGraphemes(e);let a=0;for(const[e]of Object.entries(fi)){const s=fi[e];t.some((e=>s.characters.includes(e)))&&(a+=s.characters.length)}const s=new Set(t.filter((e=>!Ei.includes(e))));return ki(t.length,a+s.size)},entropyPassphrase:(e=0,t="")=>ki(e,3*hi["en-UK"].length)+wi.entropyPassword(t),strength:(e=0)=>yi.reduce(((t,a)=>t?a.strength>t.strength&&e>=a.strength?a:t:a)),calculEntropy:ki};function ki(e,t){return e&&t?e*(Math.log(t)/Math.log(2)):0}const xi=function(e){const t={isPassphrase:!1};if(!e)return t;const a=hi["en-UK"].reduce(((e,t)=>{const a=e.remainingSecret.replace(new RegExp(t,"g"),""),s=(e.remainingSecret.length-a.length)/t.length;return{numberReplacement:e.numberReplacement+s,remainingSecret:a}}),{numberReplacement:0,remainingSecret:e.toLowerCase()}),s=a.remainingSecret,n=a.numberReplacement-1;if(1===n)return-1===e.indexOf(s)||e.startsWith(s)||e.endsWith(s)?t:{numberWords:2,separator:s,isPassphrase:!0};if(0==s.length)return{numberWords:a.numberReplacement,separator:"",isPassphrase:!0};if(s.length%n!=0)return t;const i=s.length/n,r=s.substring(0,i),o=String(r).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1"),l=0===s.replace(new RegExp(o,"g"),"").length;return{numberWords:a.numberReplacement,separator:r,isPassphrase:l&&!e.startsWith(r)&&!e.endsWith(r)}};class Ci extends Error{constructor(e){super(e=e||"The external service is unavailable"),this.name="ExternalServiceUnavailableError"}}const Si=Ci;class _i extends Error{constructor(e){super(e=e||"An error occurred when requesting the external service."),this.name="ExternalServiceError"}}const Ni=_i,Ii=class{constructor(e){this.port=e}async evaluateSecret(e){let t=!0,a=!0;try{t=await this.checkIfPasswordPowned(e)}catch(e){t=!1,a=!1}return{inDictionary:t,isPwnedServiceAvailable:a}}async checkIfPasswordPowned(e){return await this.port.request("passbolt.secrets.powned-password",e)>0}},Pi=(e,t)=>t.split(".").reduce(((e,t)=>e?.[t]),e),Ai=(e,t)=>{if(void 0===e||"string"!=typeof e||!e.length)return!1;if((t=t||{}).whitelistedProtocols&&!Array.isArray(t.whitelistedProtocols))throw new TypeError("The whitelistedProtocols should be an array of string.");if(t.defaultProtocol&&"string"!=typeof t.defaultProtocol)throw new TypeError("The defaultProtocol should be a string.");const a=t.whitelistedProtocols||[Ti.HTTP,Ti.HTTPS],s=[Ti.JAVASCRIPT],n=t.defaultProtocol||"";!/^((?!:\/\/).)*:\/\//.test(e)&&n&&(e=`${n}//${e}`);try{const t=new URL(e);return!s.includes(t.protocol)&&!!a.includes(t.protocol)&&t.href}catch(e){return!1}},Ti={FTP:"http:",FTPS:"https:",HTTP:"http:",HTTPS:"https:",JAVASCRIPT:"javascript:",SSH:"ssh:"};class Ri{constructor(e){this.settings=this.sanitizeDto(e)}sanitizeDto(e){const t=JSON.parse(JSON.stringify(e));return this.sanitizeEmailValidateRegex(t),t}sanitizeEmailValidateRegex(e){const t=e?.passbolt?.email?.validate?.regex;t&&"string"==typeof t&&t.trim().length&&(e.passbolt.email.validate.regex=t.trim().replace(/^\/+/,"").replace(/\/+$/,""))}canIUse(e){let t=!1;const a=`passbolt.plugins.${e}`,s=Pi(this.settings,a)||null;if(s&&"object"==typeof s){const e=Pi(s,"enabled");void 0!==e&&!0!==e||(t=!0)}return t}getPluginSettings(e){const t=`passbolt.plugins.${e}`;return Pi(this.settings,t)}getRememberMeOptions(){return(this.getPluginSettings("rememberMe")||{}).options||{}}get hasRememberMeUntilILogoutOption(){return void 0!==(this.getRememberMeOptions()||{})[-1]}getServerTimezone(){return Pi(this.settings,"passbolt.app.server_timezone")}get termsLink(){const e=Pi(this.settings,"passbolt.legal.terms.url");return!!e&&Ai(e)}get privacyLink(){const e=Pi(this.settings,"passbolt.legal.privacy_policy.url");return!!e&&Ai(e)}get registrationPublic(){return!0===Pi(this.settings,"passbolt.registration.public")}get debug(){return!0===Pi(this.settings,"app.debug")}get url(){return Pi(this.settings,"app.url")||""}get version(){return Pi(this.settings,"app.version.number")}get locale(){return Pi(this.settings,"app.locale")||Ri.DEFAULT_LOCALE.locale}async setLocale(e){this.settings.app.locale=e}get supportedLocales(){return Pi(this.settings,"passbolt.plugins.locale.options")||Ri.DEFAULT_SUPPORTED_LOCALES}get generatorConfiguration(){return Pi(this.settings,"passbolt.plugins.generator.configuration")}get emailValidateRegex(){return this.settings?.passbolt?.email?.validate?.regex||null}static get DEFAULT_SUPPORTED_LOCALES(){return[Ri.DEFAULT_LOCALE]}static get DEFAULT_LOCALE(){return{locale:"en-UK",label:"English"}}}class Di{static validate(e){return"string"==typeof e&&ra()("^[\\p{L}0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[\\p{L}0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[_\\p{L}0-9][-_\\p{L}0-9]*\\.)*(?:[\\p{L}0-9][-\\p{L}0-9]{0,62})\\.(?:(?:[a-z]{2}\\.)?[a-z]{2,})$","i").test(e)}}class Oi{constructor(e){if("string"!=typeof e)throw Error("The regex should be a string.");this.regex=new(ra())(e)}validate(e){return"string"==typeof e&&this.regex.test(e)}}class Ui{static validate(e,t){return Ui.getValidator(t).validate(e)}static getValidator(e){return e&&e instanceof Ri&&e.emailValidateRegex?new Oi(e.emailValidateRegex):Di}}function Mi(){return Mi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Mi.apply(null,arguments)}const Fi=s.createContext({policies:null,getPolicies:()=>{},findPolicies:()=>{},shouldRunDictionaryCheck:()=>{}});class ji extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{policies:null,getPolicies:this.getPolicies.bind(this),findPolicies:this.findPolicies.bind(this),shouldRunDictionaryCheck:this.shouldRunDictionaryCheck.bind(this)}}async findPolicies(){if(null!==this.getPolicies())return;const e=await this.props.context.port.request("passbolt.password-policies.get");this.setState({policies:e})}getPolicies(){return this.state.policies}shouldRunDictionaryCheck(){return Boolean(this.state.policies?.external_dictionary_check)}render(){return s.createElement(Fi.Provider,{value:this.state},this.props.children)}}ji.propTypes={context:r().any,children:r().any},I(ji);class zi extends s.PureComponent{static getRelativeEntropyPosition(e){return 100-99/(1+Math.pow(e/90,3))}formatEntropy(e){return(e=e||0).toFixed(1)}get relativeTargetEntropyRatio(){return zi.getRelativeEntropyPosition(this.props.targetEntropy)}get targetEntropyPositionStyle(){return{left:`calc(${this.relativeTargetEntropyRatio}% - 0.6rem`}}get colorClassName(){return this.hasEntropy()?this.props.entropy>=this.props.targetEntropy?"reached":this.props.isMinimumEntropyRequired?"required":"recommended":""}get targetTooltipMessage(){return this.props.isMinimumEntropyRequired?this.props.t("Minimal requirement"):this.props.t("Minimal recommendation")}get currentEntropyTooltipMessage(){const e=this.formatEntropy(this.props.entropy),t=this.formatEntropy(this.props.targetEntropy);return s.createElement(v.x6,null,"Entropy: ",{currentEntropy:e}," / ",{targettedEntropy:t}," bits")}get passwordStrengthLabel(){if(!this.hasEntropy()&&!this.hasError())return s.createElement(v.x6,null,"Quality");const e=wi.strength(this.props.entropy);return s.createElement(s.Fragment,null,e.label)}getProgresseBarStyle(e){return{width:`${zi.getRelativeEntropyPosition(e)}%`}}hasEntropy(){return null!==this.props.entropy&&void 0!==this.props.entropy}hasError(){return this.props.error}render(){return s.createElement("div",{className:"password-complexity with-goal"},s.createElement("span",{className:"complexity-text"},s.createElement(bt,{message:this.currentEntropyTooltipMessage},this.passwordStrengthLabel," ",s.createElement(vt,null))),s.createElement("span",{className:"progress"},s.createElement("span",{className:"progress-bar background"}),s.createElement("span",{className:`progress-bar target ${this.colorClassName}`,style:this.hasEntropy()?this.getProgresseBarStyle(this.props.targetEntropy):null}),s.createElement("span",{className:`progress-bar foreground ${this.colorClassName}`,style:this.hasEntropy()?this.getProgresseBarStyle(this.props.entropy):null}),s.createElement("span",{className:`target-entropy ${this.colorClassName}`,style:this.targetEntropyPositionStyle},s.createElement(bt,{message:this.targetTooltipMessage},s.createElement("span",{className:"tooltip-anchor"})))))}}zi.defaultProps={isMinimumEntropyRequired:!0},zi.propTypes={targetEntropy:r().number.isRequired,isMinimumEntropyRequired:r().bool.isRequired,entropy:r().number,error:r().bool,t:r().func};const Li=(0,v.CI)("common")(zi);class qi extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.createInputRef()}get defaultState(){return{name:"",nameError:"",email:"",emailError:"",algorithm:"RSA",keySize:4096,passphrase:"",passphraseConfirmation:"",passphraseWarning:"",passphraseEntropy:null,hasAlreadyBeenValidated:!1,isPwnedServiceAvailable:!0,passphraseInDictionnary:!1}}async componentDidMount(){await this.props.passwordPoliciesContext.findPolicies(),this.initPwnedPasswordService()}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleNameInputKeyUp=this.handleNameInputKeyUp.bind(this),this.handleEmailInputKeyUp=this.handleEmailInputKeyUp.bind(this),this.handlePassphraseChange=this.handlePassphraseChange.bind(this)}createInputRef(){this.nameInputRef=s.createRef(),this.emailInputRef=s.createRef(),this.passphraseInputRef=s.createRef(),this.passphraseConfirmationInputRef=s.createRef()}initPwnedPasswordService(){const e=this.props.passwordPoliciesContext.shouldRunDictionaryCheck();e&&(this.pownedService=new Ii(this.props.context.port)),this.setState({isPwnedServiceAvailable:e})}handleNameInputKeyUp(){this.state.hasAlreadyBeenValidated&&this.validateNameInput()}validateNameInput(){let e=null;return this.state.name.trim().length||(e=this.translate("A name is required.")),this.setState({nameError:e}),null===e}handleEmailInputKeyUp(){this.state.hasAlreadyBeenValidated&&this.validateEmailInput()}validateEmailInput(){let e=null;const t=this.state.email.trim();return t.length?Ui.validate(t,this.props.context.siteSettings)||(e=this.translate("Please enter a valid email address.")):e=this.translate("An email is required."),this.setState({email:t,emailError:e}),null===e}async handlePassphraseChange(e){const t=e.target.value;this.setState({passphrase:t},(()=>this.checkPassphraseValidity()))}async checkPassphraseValidity(){let e=null;if(this.state.passphrase.length>0?e=(e=>{const{numberWords:t,separator:a,isPassphrase:s}=xi(e);return s?wi.entropyPassphrase(t,a):wi.entropyPassword(e)})(this.state.passphrase):this.setState({passphraseInDictionnary:!1,passwordEntropy:null}),this.state.hasAlreadyBeenValidated)this.setState({passphraseInDictionnary:!1}),this.validatePassphraseInput();else{const e=this.state.passphrase.length>=4096,t=this.translate("this is the maximum size for this field, make sure your data was not truncated"),a=e?t:"";this.setState({passphraseWarning:a})}this.setState({passphraseEntropy:e})}validatePassphraseInput(){return!this.hasAnyErrors()}validatePassphraseConfirmationInput(){return!this.isEmptyPasswordConfirmation()&&!this.isPassphraseAndConfirmationDifferent()}hasWeakPassword(){return!this.isMinimumRequiredEntropyReached(this.state.passphraseEntropy)}isEmptyPasswordConfirmation(){return!this.state.passphraseConfirmation.length}isEmptyPassword(){return!this.state.passphrase.length}isPassphraseAndConfirmationDifferent(){return!this.isEmptyPasswordConfirmation()&&this.state.passphrase!==this.state.passphraseConfirmation}async evaluatePassphraseIsInDictionary(e){let t=this.state.isPwnedServiceAvailable;if(!t||!this.pownedService)return!1;let a=!1;try{const s=await this.pownedService.evaluateSecret(e);a=this.state.passphrase&&s.inDictionary&&this.isMinimumRequiredEntropyReached(this.state.passphraseEntropy),t=s.isPwnedServiceAvailable}catch(e){if(!(e instanceof Si||e instanceof Ni))throw e;t=!1,a=!1}return this.setState({isPwnedServiceAvailable:t,passphraseInDictionnary:a}),a}handleInputChange(e){const t=e.target;this.setState({[t.name]:t.value})}handleValidateError(){this.focusFirstFieldError()}focusFirstFieldError(){this.state.nameError?this.nameInputRef.current.focus():this.state.emailError?this.emailInputRef.current.focus():this.hasAnyErrors()?this.passphraseInputRef.current.focus():this.validatePassphraseConfirmationInput()||this.passphraseConfirmationInputRef.current.focus()}async handleFormSubmit(e){e.preventDefault(),this.state.processing||(this.setState({hasAlreadyBeenValidated:!0}),await this.save())}hasAnyErrors(){const e=[this.isEmptyPassword(),this.state.passphraseInDictionnary];return e.push(this.hasWeakPassword()),e.push(!this.pownedService&&this.state.passphrase.length<8),e.includes(!0)}async save(){if(this.toggleProcessing(),!await this.validate())return this.handleValidateError(),void this.toggleProcessing();if(await this.evaluatePassphraseIsInDictionary(this.state.passphrase))return void this.toggleProcessing();const e=await this.generateKey();this.props.onUpdateOrganizationKey(e.public_key.armored_key,e.private_key.armored_key)}async validate(){const e=this.validateNameInput(),t=this.validateEmailInput(),a=this.validatePassphraseInput(),s=this.validatePassphraseConfirmationInput();return e&&t&&a&&s}async generateKey(){const e={name:this.state.name,email:this.state.email,algorithm:this.state.algorithm,keySize:this.state.keySize,passphrase:this.state.passphrase};return await this.props.context.port.request("passbolt.account-recovery.generate-organization-key",e)}toggleProcessing(){this.setState({processing:!this.state.processing})}hasAllInputDisabled(){return this.state.processing}isMinimumRequiredEntropyReached(e){return e>=80}get translate(){return this.props.t}get isPassphraseWarning(){return this.state.passphrase?.length>0&&!this.state.hasAlreadyBeenValidated&&(!this.state.isPwnedServiceAvailable||this.state.passphraseInDictionnary)}render(){const e=this.state.passphraseInDictionnary?0:this.state.passphraseEntropy;return s.createElement("form",{onSubmit:this.handleFormSubmit,noValidate:!0},s.createElement("div",{className:"form-content generate-organization-key"},s.createElement("div",{className:"input text required "+(this.state.nameError?"error":"")},s.createElement("label",{htmlFor:"generate-organization-key-form-name"},s.createElement(v.x6,null,"Name")),s.createElement("input",{id:"generate-organization-key-form-name",name:"name",type:"text",value:this.state.name,onKeyUp:this.handleNameInputKeyUp,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),ref:this.nameInputRef,className:"required fluid",maxLength:"64",required:"required",autoComplete:"off",autoFocus:!0,placeholder:this.translate("Name")}),this.state.nameError&&s.createElement("div",{className:"name error-message"},this.state.nameError)),s.createElement("div",{className:"input text required "+(this.state.emailError?"error":"")},s.createElement("label",{htmlFor:"generate-organization-key-form-email"},s.createElement(v.x6,null,"Email")),s.createElement("input",{id:"generate-organization-key-form-email",name:"email",ref:this.emailInputRef,className:"required fluid",maxLength:"64",type:"email",autoComplete:"off",value:this.state.email,onChange:this.handleInputChange,placeholder:this.translate("Email Address"),onKeyUp:this.handleEmailInputKeyUp,disabled:this.hasAllInputDisabled(),required:"required"}),this.state.emailError&&s.createElement("div",{className:"email error-message"},this.state.emailError)),s.createElement("div",{className:"input select-wrapper"},s.createElement("label",{htmlFor:"generate-organization-key-form-algorithm"},s.createElement(v.x6,null,"Algorithm"),s.createElement(bt,{message:this.translate("Algorithm and key size cannot be changed at the moment. These are secure default")},s.createElement(vt,null))),s.createElement("input",{id:"generate-organization-key-form-algorithm",name:"algorithm",value:this.state.algorithm,className:"fluid",type:"text",autoComplete:"off",disabled:!0})),s.createElement("div",{className:"input select-wrapper"},s.createElement("label",{htmlFor:"generate-organization-key-form-keySize"},s.createElement(v.x6,null,"Key Size"),s.createElement(bt,{message:this.translate("Algorithm and key size cannot be changed at the moment. These are secure default")},s.createElement(vt,null))),s.createElement("input",{id:"generate-organization-key-form-key-size",name:"keySize",value:this.state.keySize,className:"fluid",type:"text",autoComplete:"off",disabled:!0})),s.createElement("div",{className:"input-password-wrapper input required "+(this.hasAnyErrors()&&this.state.hasAlreadyBeenValidated?"error":"")},s.createElement("label",{htmlFor:"generate-organization-key-form-password"},s.createElement(v.x6,null,"Organization key passphrase"),this.isPassphraseWarning&&s.createElement($e,{className:"attention-required"})),s.createElement(va,{id:"generate-organization-key-form-password",name:"password",placeholder:this.translate("Passphrase"),autoComplete:"new-password",preview:!0,securityToken:this.props.context.userSettings.getSecurityToken(),value:this.state.passphrase,onChange:this.handlePassphraseChange,disabled:this.hasAllInputDisabled(),inputRef:this.passphraseInputRef}),s.createElement(Li,{entropy:e,targetEntropy:80}),this.state.hasAlreadyBeenValidated&&s.createElement("div",{className:"password error-message"},this.isEmptyPassword()&&s.createElement("div",{className:"empty-passphrase error-message"},s.createElement(v.x6,null,"A passphrase is required.")),this.hasWeakPassword()&&e>0&&s.createElement("div",{className:"invalid-passphrase error-message"},s.createElement(v.x6,null,"A strong passphrase is required. The minimum complexity must be 'fair'.")),this.state.passphraseInDictionnary&&0===e&&!this.isEmptyPassword()&&s.createElement("div",{className:"invalid-passphrase error-message"},s.createElement(v.x6,null,"The passphrase should not be part of an exposed data breach.")))),s.createElement("div",{className:"input-password-wrapper input required "+(this.state.hasAlreadyBeenValidated&&!this.validatePassphraseConfirmationInput()?"error":"")},s.createElement("label",{htmlFor:"generate-organization-key-form-password"},s.createElement(v.x6,null,"Organization key passphrase confirmation")),s.createElement(va,{id:"generate-organization-key-form-password-confirmation",name:"passphraseConfirmation",placeholder:this.translate("Passphrase confirmation"),autoComplete:"new-password",preview:!0,securityToken:this.props.context.userSettings.getSecurityToken(),value:this.state.passphraseConfirmation,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),inputRef:this.passphraseConfirmationInputRef}),this.state.hasAlreadyBeenValidated&&s.createElement("div",{className:"password-confirmation error-message"},this.isEmptyPasswordConfirmation()&&s.createElement("div",{className:"empty-passphrase-confirmation error-message"},s.createElement(v.x6,null,"The passphrase confirmation is required.")),this.isPassphraseAndConfirmationDifferent()&&s.createElement("div",{className:"invalid-passphrase-confirmation error-message"},s.createElement(v.x6,null,"The passphrase confirmation should match the passphrase")))),s.createElement("div",{className:"warning message no-margin",id:"generate-organization-key-setting-overridden-banner"},s.createElement("p",null,s.createElement(v.x6,null,"Warning, we encourage you to generate your OpenPGP Organization Recovery Key separately. Make sure you keep a backup in a safe place.")))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.hasAllInputDisabled(),onClick:this.props.onClose}),s.createElement(yn,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Generate & Apply")})))}}qi.propTypes={context:r().any,onUpdateOrganizationKey:r().func,onClose:r().func,t:r().func,passwordPoliciesContext:r().object};const Ki=I(g(function(e){return class extends s.Component{render(){return s.createElement(Fi.Consumer,null,(t=>s.createElement(e,Mi({passwordPoliciesContext:t},this.props))))}}}((0,v.CI)("common")(qi))));function Wi(){return Wi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Wi.apply(null,arguments)}class Vi extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{processing:!1}}bindCallbacks(){this.handleCloseClick=this.handleCloseClick.bind(this),this.handleApplyChanges=this.handleApplyChanges.bind(this)}handleCloseClick(){this.props.onClose()}handleApplyChanges(e,t){this.handleCloseClick(),this.props.handleUpdateOrganizationKey(e,t)}render(){return s.createElement(wt,{title:this.props.t("Organization Recovery Key"),onClose:this.handleCloseClick,disabled:this.state.processing,className:"organization-recover-key-dialog"},s.createElement(di,{activeTabName:"Import"},s.createElement(ci,{key:"Import",name:this.props.t("Import"),type:"Import"},s.createElement(ui,Wi({},this.props,{onClose:this.handleCloseClick,onUpdateOrganizationKey:this.handleApplyChanges}))),s.createElement(ci,{key:"Generate",name:this.props.t("Generate"),type:"Generate"},s.createElement(Ki,Wi({},this.props,{onClose:this.handleCloseClick,onUpdateOrganizationKey:this.handleApplyChanges})))))}}Vi.propTypes={handleUpdateOrganizationKey:r().func,onClose:r().func,t:r().func};const Bi=(0,v.CI)("common")(Vi);class Gi extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{processing:!1}}bindCallbacks(){this.handleCloseClick=this.handleCloseClick.bind(this)}handleCloseClick(){this.props.onClose()}render(){return s.createElement(wt,{title:this.props.t("Confirm Organization Recovery Key download"),onClose:this.handleCloseClick,disabled:!1,className:"organization-recover-key-download-dialog"},s.createElement("div",{className:"dialog-body"},s.createElement("p",null,s.createElement(v.x6,null,"A download of the organization private key has automatically started.")),s.createElement("p",null,s.createElement(v.x6,null,"Make sure your print it or store it in a safe place. You may need it later!"))),s.createElement("div",{className:"dialog-footer clearfix"},s.createElement("button",{className:"button button-left cancel medium",type:"button",onClick:this.props.handleDownloadAgain},s.createElement(v.x6,null,"Download again")),s.createElement("button",{className:"button primary form",type:"button",onClick:this.handleCloseClick,disabled:this.isProcessing},s.createElement("span",null,s.createElement(v.x6,null,"Ok")))))}}Gi.propTypes={onClose:r().func,handleDownloadAgain:r().func,privateKey:r().string,t:r().func};const $i=(0,v.CI)("common")(Gi);var Hi;function Yi(){return Yi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Yi.apply(null,arguments)}const Ji=function(e){return s.createElement("svg",Yi({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Hi||(Hi=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#buoy_svg__clip0_2062_453102)"},s.createElement("path",{d:"M9 16.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15M3.698 3.697l3.18 3.18M11.123 6.877l3.18-3.18M11.123 11.122l3.18 3.18M6.878 11.122l-3.18 3.18"}),s.createElement("path",{d:"M9 12a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))))};class Zi extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{keyInfoDto:null,loading:!0,processing:!1}}async componentDidMount(){this.findAccountRecoveryPolicy()}componentWillUnmount(){this.props.adminAccountRecoveryContext.resetChanges()}async componentDidUpdate(){const e=this.props?.adminAccountRecoveryContext?.policyChanges?.publicKey||this.props?.adminAccountRecoveryContext?.currentPolicy?.account_recovery_organization_public_key?.armored_key,t=await(this.props?.adminAccountRecoveryContext?.getKeyInfo(e));Boolean(e)&&this.state.keyInfoDto?.fingerprint!==t?.fingerprint?this.setState({keyInfoDto:t}):!e&&this.state.keyInfoDto&&this.setState({keyInfoDto:null})}bindCallbacks(){this.handlePolicyInputChange=this.handlePolicyInputChange.bind(this),this.HandleUpdatePublicKeyClick=this.HandleUpdatePublicKeyClick.bind(this),this.handleUpdateOrganizationKey=this.handleUpdateOrganizationKey.bind(this),this.downloadPrivateKey=this.downloadPrivateKey.bind(this)}get policy(){return this.props.adminAccountRecoveryContext.policyChanges.policy||this.props.adminAccountRecoveryContext.currentPolicy?.policy}get organizationKey(){return this.props.adminAccountRecoveryContext.policyChanges.publicKey||this.props.adminAccountRecoveryContext.currentPolicy?.account_recovery_organization_public_key.armored_key}get organizationKeyInfo(){return this.state.keyInfoDto}async findAccountRecoveryPolicy(){await this.props.adminAccountRecoveryContext.findAccountRecoveryPolicy(),this.setState({loading:!1})}async handlePolicyInputChange(e){const t=e.target.value;"disabled"===t&&this.resetKeyInfo(),await this.props.adminAccountRecoveryContext.changePolicy(t)}HandleUpdatePublicKeyClick(){this.props.dialogContext.open(Bi,{handleUpdateOrganizationKey:this.handleUpdateOrganizationKey})}async handleUpdateOrganizationKey(e,t){this.resetKeyInfo(),await this.props.adminAccountRecoveryContext.changePublicKey(e),t&&await this.downloadPrivateKey(t)}async downloadPrivateKey(e){await this.props.adminAccountRecoveryContext.downloadPrivateKey(e),this.props.dialogContext.open($i,{privateKey:e,handleDownloadAgain:async()=>{await this.props.adminAccountRecoveryContext.downloadPrivateKey(e)}})}hasAllInputDisabled(){return this.state.processing||this.state.loading}hasOrganisationRecoveryKey(){const e=this.state.keyInfoDto;return Boolean(e)}isPolicyEnabled(){return Boolean("disabled"!==this.policy)}resetKeyInfo(){this.setState({keyInfoDto:null})}async toggleProcessing(){this.setState({processing:!this.state.processing})}formatFingerprint(e){if(!e)return null;const t=e.toUpperCase().replace(/.{4}/g,"$& ");return s.createElement(s.Fragment,null,t.substr(0,24),s.createElement("br",null),t.substr(25))}formatUserIds(e){return e?e.map(((e,t)=>s.createElement(s.Fragment,{key:t},e.name," <",e.email,">",s.createElement("br",null)))):null}get translate(){return this.props.t}render(){const e=this.props.adminAccountRecoveryContext.hasPolicyChanges()||!this.hasOrganisationRecoveryKey()&&this.isPolicyEnabled();return s.createElement("div",{className:"row"},s.createElement("div",{className:"recover-account-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Account Recovery")),s.createElement("form",{className:"form"},s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Account Recovery Policy")),s.createElement("p",null,s.createElement(v.x6,null,"In this section you can choose the default behavior of account recovery for all users.")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio "+("mandatory"===this.policy?"checked":"")},s.createElement("input",{type:"radio",value:"mandatory",onChange:this.handlePolicyInputChange,name:"accountRecoveryPolicy",checked:"mandatory"===this.policy,id:"accountRecoveryPolicyMandatory",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"accountRecoveryPolicyMandatory"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Prompt")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Every user is required to provide a copy of their private key and passphrase during setup."),s.createElement("br",null),s.createElement(v.x6,null,"You should inform your users not to store personal passwords.")))),s.createElement("div",{className:"input radio "+("opt-out"===this.policy?"checked":"")},s.createElement("input",{type:"radio",value:"opt-out",onChange:this.handlePolicyInputChange,name:"accountRecoveryPolicy",checked:"opt-out"===this.policy,id:"accountRecoveryPolicyOptOut",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"accountRecoveryPolicyOptOut"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Optional, Opt-out")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Every user will be prompted to provide a copy of their private key and passphrase by default during the setup, but they can opt out.")))),s.createElement("div",{className:"input radio "+("opt-in"===this.policy?"checked":"")},s.createElement("input",{type:"radio",value:"opt-in",onChange:this.handlePolicyInputChange,name:"accountRecoveryPolicy",checked:"opt-in"===this.policy,id:"accountRecoveryPolicyOptIn",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"accountRecoveryPolicyOptIn"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Optional, Opt-in")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Every user can decide to provide a copy of their private key and passphrase by default during the setup, but they can opt in.")))),s.createElement("div",{className:"input radio "+("disabled"===this.policy?"checked":"")},s.createElement("input",{type:"radio",value:"disabled",onChange:this.handlePolicyInputChange,name:"accountRecoveryPolicy",checked:"disabled"===this.policy,id:"accountRecoveryPolicyDisable",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"accountRecoveryPolicyDisable"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Disable (Default)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Backup of the private key and passphrase will not be stored. This is the safest option."),s.createElement(v.x6,null,"If users lose their private key and passphrase they will not be able to recover their account."))))),s.createElement("h4",null,s.createElement("span",{className:"input toggle-switch form-element "},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"organisationRecoveryKeyToggle",disabled:this.hasAllInputDisabled(),checked:this.isPolicyEnabled(),id:"recovery-key-toggle-button"}),s.createElement("label",{htmlFor:"recovery-key-toggle-button"},s.createElement(v.x6,null,"Organization Recovery Key")))),this.isPolicyEnabled()&&s.createElement(s.Fragment,null,s.createElement("p",null,s.createElement(v.x6,null,"Your organization recovery key will be used to decrypt and recover the private key and passphrase of the users that are participating in the account recovery program.")," ",s.createElement(v.x6,null,"The organization private recovery key should not be stored in passbolt.")," ",s.createElement(v.x6,null,"You should keep it offline in a safe place.")),s.createElement("div",{className:"recovery-key-details"},s.createElement("table",{className:"table-info recovery-key"},s.createElement("tbody",null,s.createElement("tr",{className:"user-ids"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"User ids")),this.organizationKeyInfo?.user_ids&&s.createElement("td",{className:"value"},this.formatUserIds(this.organizationKeyInfo.user_ids)),!this.organizationKeyInfo?.user_ids&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"not available")),s.createElement("td",{className:"table-button"},s.createElement("button",{className:"button primary",type:"button",disabled:this.hasAllInputDisabled(),onClick:this.HandleUpdatePublicKeyClick},this.hasOrganisationRecoveryKey()&&s.createElement(v.x6,null,"Rotate Key"),!this.hasOrganisationRecoveryKey()&&s.createElement(v.x6,null,"Add an Organization Recovery Key")))),s.createElement("tr",{className:"fingerprint"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Fingerprint")),this.organizationKeyInfo?.fingerprint&&s.createElement("td",{className:"value"},this.formatFingerprint(this.organizationKeyInfo.fingerprint)),!this.organizationKeyInfo?.fingerprint&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"not available"))),s.createElement("tr",{className:"algorithm"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Algorithm")),this.organizationKeyInfo?.algorithm&&s.createElement("td",{className:"value"},this.organizationKeyInfo.algorithm),!this.organizationKeyInfo?.algorithm&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"not available"))),s.createElement("tr",{className:"key-length"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Key length")),this.organizationKeyInfo?.length&&s.createElement("td",{className:"value"},this.organizationKeyInfo.length),!this.organizationKeyInfo?.length&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"not available"))),s.createElement("tr",{className:"created"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Created")),this.organizationKeyInfo?.created&&s.createElement("td",{className:"value"},Nn(this.organizationKeyInfo.created,this.props.t,this.props.context.locale)),!this.organizationKeyInfo?.created&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"not available"))),s.createElement("tr",{className:"expires"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Expires")),this.organizationKeyInfo?.expires&&s.createElement("td",{className:"value"},Nn(this.organizationKeyInfo.expires,this.props.t,this.props.context.locale)),!this.organizationKeyInfo?.expires&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"not available"))))))))),e&&s.createElement("div",{className:"warning message",id:"email-notification-setting-overridden-banner"},this.props.adminAccountRecoveryContext.hasPolicyChanges()&&s.createElement("div",{id:"email-notification-setting-overridden-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification.")))),!this.hasOrganisationRecoveryKey()&&this.isPolicyEnabled()&&s.createElement("div",{id:"email-notification-setting-overridden-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Warning, Don't forget to add an organization recovery key.")))))),s.createElement(oi,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need some help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about account recovery, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/authentication/account-recovery/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ji,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}Zi.propTypes={context:r().object,dialogContext:r().any,administrationWorkspaceContext:r().object,adminAccountRecoveryContext:r().object,t:r().func};const Qi=I(g(Ee(Jn((0,v.CI)("common")(Zi))))),Xi={25:{port:25,tls:!1},2525:{port:2525,tls:!1},587:{port:587,tls:!0},588:{port:588,tls:!0},465:{port:465,tls:!0}};function er(e,t){const a=[];for(let s=0;s<e.length;s++){const n=e[s];for(let e=0;e<t.length;e++){const s=Xi[t[e].toString()];a.push({host:n,...s})}}return a}function tr(e,t,a){return e.availableConfigurations.find((e=>(!a||e.host===a)&&e.port===t))}const ar={id:"aws-ses",name:"AWS SES",icon:"aws-ses.svg",help_page:"https://docs.aws.amazon.com/ses/latest/dg/send-email-smtp.html",availableConfigurations:er(function(){const e=[];return["us-east-2","us-east-1","us-west-1","us-west-2","ap-south-1","ap-northeast-3","ap-northeast-2","ap-northeast-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-west-1","eu-west-2","eu-west-3","sa-east-1","us-gov-west-1"].forEach((t=>{e.push(`email-smtp.${t}.amazonaws.com`)})),e}(),[25,2525,587])};ar.defaultConfiguration=tr(ar,587,"email-smtp.eu-central-1.amazonaws.com");const sr={id:"elastic-email",name:"ElasticEmail",icon:"elastic-email.svg",help_page:"https://help.elasticemail.com/en/articles/4803409-smtp-settings",availableConfigurations:er(["smtp.elasticemail.com","smtp25.elasticemail.com"],[25,2525,587])};sr.defaultConfiguration=tr(sr,587,"smtp.elasticemail.com");const nr={id:"google-workspace",name:"Google Workspace",icon:"gmail.svg",help_page:"https://support.google.com/a/answer/2956491",availableConfigurations:er(["smtp-relay.gmail.com"],[25,587])};nr.defaultConfiguration=tr(nr,587);const ir={id:"google-mail",name:"Google Mail",icon:"gmail.svg",help_page:"https://support.google.com/a/answer/2956491",availableConfigurations:er(["smtp.gmail.com"],[587])};ir.defaultConfiguration=tr(ir,587);const rr={id:"mailgun",name:"MailGun",icon:"mailgun.svg",help_page:"https://documentation.mailgun.com/en/latest/quickstart-sending.html",availableConfigurations:er(["smtp.mailgun.com"],[587])};rr.defaultConfiguration=rr.availableConfigurations[0];const or={id:"mailjet",name:"Mailjet",icon:"mailjet.svg",help_page:"https://dev.mailjet.com/smtp-relay/configuration/",availableConfigurations:er(["in-v3.mailjet.com"],[25,2525,587,588])};or.defaultConfiguration=tr(or,587);const lr={id:"mandrill",name:"Mandrill",icon:"mandrill.svg",help_page:"https://mailchimp.com/developer/transactional/docs/smtp-integration/",availableConfigurations:er(["smtp.mandrillapp.com"],[25,2525,587])};lr.defaultConfiguration=tr(lr,587);const cr={id:"office-365",name:"Office 365",icon:"office365.svg",help_page:"https://learn.microsoft.com/exchange/mail-flow-best-practices/how-to-set-up-a-multifunction-device-or-application-to-send-email-using-microsoft-365-or-office-365",availableConfigurations:er(["smtp.office365.com"],[25,587])};cr.defaultConfiguration=tr(cr,587);const mr={id:"outlook",name:"Outlook",icon:"outlook.svg",help_page:"https://support.microsoft.com/office/pop-imap-and-smtp-settings-for-outlook-com-d088b986-291d-42b8-9564-9c414e2aa040",availableConfigurations:er(["smtp-mail.outlook.com"],[587])};mr.defaultConfiguration=tr(mr,587);const dr={id:"sendgrid",name:"Sendgrid",icon:"sendgrid.svg",help_page:"https://docs.sendgrid.com/for-developers/sending-email/integrating-with-the-smtp-api",availableConfigurations:er(["smtp.sendgrid.net"],[25,2525,587])};dr.defaultConfiguration=tr(dr,587);const pr={id:"sendinblue",name:"Sendinblue",icon:"sendinblue.svg",help_page:"https://help.sendinblue.com/hc/en-us/articles/209462765",availableConfigurations:er(["smtp-relay.sendinblue.com"],[25,587])};pr.defaultConfiguration=tr(pr,587);const ur={id:"zoho",name:"Zoho",icon:"zoho.svg",help_page:"https://www.zoho.com/mail/help/zoho-smtp.html",availableConfigurations:er(["smtp.zoho.eu","smtppro.zoho.eu"],[587])};ur.defaultConfiguration=tr(ur,587,"smtp.zoho.eu");const hr=[ar,sr,ir,nr,rr,or,lr,cr,mr,dr,pr,ur,{id:"other",name:"Other",icon:null,availableConfigurations:[],defaultConfiguration:{host:"",port:"",tls:!0}}],gr=class{constructor(e){e.setResourceName("smtp/settings"),this.apiClient=new Qt(e)}async find(){const e=await this.apiClient.findAll(),t=e?.body;return t.client=t.client??"",t.tls=Boolean(t?.tls),t}async save(e){const t=(await this.apiClient.create(e)).body;return t.tls=Boolean(t.tls),t}},br=class{constructor(e){this.smtpSettingsService=new gr(e)}findSmtpSettings(){return this.smtpSettingsService.find()}saveSmtpSettings(e){return this.smtpSettingsService.save(e)}},yr=class{constructor(e){e.setResourceName("smtp/email"),this.apiClient=new Qt(e)}async sendTestEmail(e){return(await this.apiClient.create(e)).body}},fr=class{constructor(e){this.smtpTestSettingsService=new yr(e)}sendTestEmail(e,t){const{sender_name:a,sender_email:s,host:n,port:i,client:r,username:o,password:l,tls:c}=e,m={sender_name:a,sender_email:s,host:n,port:i,client:r,username:o,password:l,tls:c,email_test_to:t};return m.client=m.client||null,this.smtpTestSettingsService.sendTestEmail(m)}},vr=["0-mail.com","007addict.com","020.co.uk","027168.com","0815.ru","0815.su","0clickemail.com","0sg.net","0wnd.net","0wnd.org","1033edge.com","10mail.org","10minutemail.co.za","10minutemail.com","11mail.com","123-m.com","123.com","123box.net","123india.com","123mail.cl","123mail.org","123qwe.co.uk","126.com","126.net","138mail.com","139.com","150mail.com","150ml.com","15meg4free.com","163.com","16mail.com","188.com","189.cn","1auto.com","1ce.us","1chuan.com","1colony.com","1coolplace.com","1email.eu","1freeemail.com","1fsdfdsfsdf.tk","1funplace.com","1internetdrive.com","1mail.ml","1mail.net","1me.net","1mum.com","1musicrow.com","1netdrive.com","1nsyncfan.com","1pad.de","1under.com","1webave.com","1webhighway.com","1zhuan.com","2-mail.com","20email.eu","20mail.in","20mail.it","20minutemail.com","212.com","21cn.com","247emails.com","24horas.com","2911.net","2980.com","2bmail.co.uk","2coolforyou.net","2d2i.com","2die4.com","2fdgdfgdfgdf.tk","2hotforyou.net","2mydns.com","2net.us","2prong.com","2trom.com","3000.it","30minutemail.com","30minutesmail.com","3126.com","321media.com","33mail.com","360.ru","37.com","3ammagazine.com","3dmail.com","3email.com","3g.ua","3mail.ga","3trtretgfrfe.tk","3xl.net","444.net","4email.com","4email.net","4gfdsgfdgfd.tk","4mg.com","4newyork.com","4warding.com","4warding.net","4warding.org","4x4fan.com","4x4man.com","50mail.com","5fm.za.com","5ghgfhfghfgh.tk","5iron.com","5star.com","60minutemail.com","6hjgjhgkilkj.tk","6ip.us","6mail.cf","6paq.com","702mail.co.za","74.ru","7mail.ga","7mail.ml","7tags.com","88.am","8848.net","888.nu","8mail.ga","8mail.ml","97rock.com","99experts.com","9ox.net","a-bc.net","a-player.org","a2z4u.net","a45.in","aaamail.zzn.com","aahlife.com","aamail.net","aapt.net.au","aaronkwok.net","abbeyroadlondon.co.uk","abcflash.net","abdulnour.com","aberystwyth.com","abolition-now.com","about.com","absolutevitality.com","abusemail.de","abv.bg","abwesend.de","abyssmail.com","ac20mail.in","academycougars.com","acceso.or.cr","access4less.net","accessgcc.com","accountant.com","acdcfan.com","acdczone.com","ace-of-base.com","acmecity.com","acmemail.net","acninc.net","acrobatmail.com","activatormail.com","activist.com","adam.com.au","add3000.pp.ua","addcom.de","address.com","adelphia.net","adexec.com","adfarrow.com","adinet.com.uy","adios.net","admin.in.th","administrativos.com","adoption.com","ados.fr","adrenalinefreak.com","adres.nl","advalvas.be","advantimo.com","aeiou.pt","aemail4u.com","aeneasmail.com","afreeinternet.com","africa-11.com","africamail.com","africamel.net","africanpartnersonline.com","afrobacon.com","ag.us.to","agedmail.com","agelessemail.com","agoodmail.com","ahaa.dk","ahk.jp","aichi.com","aim.com","aircraftmail.com","airforce.net","airforceemail.com","airpost.net","aiutamici.com","ajacied.com","ajaxapp.net","ak47.hu","aknet.kg","akphantom.com","albawaba.com","alecsmail.com","alex4all.com","alexandria.cc","algeria.com","algeriamail.com","alhilal.net","alibaba.com","alice.it","aliceadsl.fr","aliceinchainsmail.com","alivance.com","alive.cz","aliyun.com","allergist.com","allmail.net","alloymail.com","allracing.com","allsaintsfan.com","alltel.net","alpenjodel.de","alphafrau.de","alskens.dk","altavista.com","altavista.net","altavista.se","alternativagratis.com","alumni.com","alumnidirector.com","alvilag.hu","ama-trade.de","amail.com","amazonses.com","amele.com","america.hm","ameritech.net","amilegit.com","amiri.net","amiriindustries.com","amnetsal.com","amorki.pl","amrer.net","amuro.net","amuromail.com","ananzi.co.za","ancestry.com","andreabocellimail.com","andylau.net","anfmail.com","angelfan.com","angelfire.com","angelic.com","animail.net","animal.net","animalhouse.com","animalwoman.net","anjungcafe.com","anniefans.com","annsmail.com","ano-mail.net","anonmails.de","anonymbox.com","anonymous.to","anote.com","another.com","anotherdomaincyka.tk","anotherwin95.com","anti-ignorance.net","anti-social.com","antichef.com","antichef.net","antiqueemail.com","antireg.ru","antisocial.com","antispam.de","antispam24.de","antispammail.de","antongijsen.com","antwerpen.com","anymoment.com","anytimenow.com","aol.co.uk","aol.com","aol.de","aol.fr","aol.it","aol.jp","aon.at","apexmail.com","apmail.com","apollo.lv","aport.ru","aport2000.ru","apple.sib.ru","appraiser.net","approvers.net","aquaticmail.net","arabia.com","arabtop.net","arcademaster.com","archaeologist.com","archerymail.com","arcor.de","arcotronics.bg","arcticmail.com","argentina.com","arhaelogist.com","aristotle.org","army.net","armyspy.com","arnet.com.ar","art-en-ligne.pro","artistemail.com","artlover.com","artlover.com.au","artman-conception.com","as-if.com","asdasd.nl","asean-mail","asean-mail.com","asheville.com","asia-links.com","asia-mail.com","asia.com","asiafind.com","asianavenue.com","asiancityweb.com","asiansonly.net","asianwired.net","asiapoint.net","askaclub.ru","ass.pp.ua","assala.com","assamesemail.com","astroboymail.com","astrolover.com","astrosfan.com","astrosfan.net","asurfer.com","atheist.com","athenachu.net","atina.cl","atl.lv","atlas.cz","atlaswebmail.com","atlink.com","atmc.net","ato.check.com","atozasia.com","atrus.ru","att.net","attglobal.net","attymail.com","au.ru","auctioneer.net","aufeminin.com","aus-city.com","ausi.com","aussiemail.com.au","austin.rr.com","australia.edu","australiamail.com","austrosearch.net","autoescuelanerja.com","autograf.pl","automail.ru","automotiveauthority.com","autorambler.ru","aver.com","avh.hu","avia-tonic.fr","avtoritet.ru","awayonvacation.com","awholelotofamechi.com","awsom.net","axoskate.com","ayna.com","azazazatashkent.tk","azimiweb.com","azmeil.tk","bachelorboy.com","bachelorgal.com","backfliper.com","backpackers.com","backstreet-boys.com","backstreetboysclub.com","backtothefuturefans.com","backwards.com","badtzmail.com","bagherpour.com","bahrainmail.com","bakpaka.com","bakpaka.net","baldmama.de","baldpapa.de","ballerstatus.net","ballyfinance.com","balochistan.org","baluch.com","bangkok.com","bangkok2000.com","bannertown.net","baptistmail.com","baptized.com","barcelona.com","bareed.ws","barid.com","barlick.net","bartender.net","baseball-email.com","baseballmail.com","basketballmail.com","batuta.net","baudoinconsulting.com","baxomale.ht.cx","bboy.com","bboy.zzn.com","bcvibes.com","beddly.com","beeebank.com","beefmilk.com","beenhad.com","beep.ru","beer.com","beerandremotes.com","beethoven.com","beirut.com","belice.com","belizehome.com","belizemail.net","belizeweb.com","bell.net","bellair.net","bellsouth.net","berkscounty.com","berlin.com","berlin.de","berlinexpo.de","bestmail.us","betriebsdirektor.de","bettergolf.net","bharatmail.com","big1.us","big5mail.com","bigassweb.com","bigblue.net.au","bigboab.com","bigfoot.com","bigfoot.de","bigger.com","biggerbadder.com","bigmailbox.com","bigmir.net","bigpond.au","bigpond.com","bigpond.com.au","bigpond.net","bigpond.net.au","bigramp.com","bigstring.com","bikemechanics.com","bikeracer.com","bikeracers.net","bikerider.com","billsfan.com","billsfan.net","bimamail.com","bimla.net","bin-wieder-da.de","binkmail.com","bio-muesli.info","bio-muesli.net","biologyfan.com","birdfanatic.com","birdlover.com","birdowner.net","bisons.com","bitmail.com","bitpage.net","bizhosting.com","bk.ru","bkkmail.com","bla-bla.com","blackburnfans.com","blackburnmail.com","blackplanet.com","blader.com","bladesmail.net","blazemail.com","bleib-bei-mir.de","blink182.net","blockfilter.com","blogmyway.org","blondandeasy.com","bluebottle.com","bluehyppo.com","bluemail.ch","bluemail.dk","bluesfan.com","bluewin.ch","blueyonder.co.uk","blumail.org","blushmail.com","blutig.me","bmlsports.net","boardermail.com","boarderzone.com","boatracers.com","bobmail.info","bodhi.lawlita.com","bofthew.com","bol.com.br","bolando.com","bollywoodz.com","bolt.com","boltonfans.com","bombdiggity.com","bonbon.net","boom.com","bootmail.com","bootybay.de","bornagain.com","bornnaked.com","bossofthemoss.com","bostonoffice.com","boun.cr","bounce.net","bounces.amazon.com","bouncr.com","box.az","box.ua","boxbg.com","boxemail.com","boxformail.in","boxfrog.com","boximail.com","boyzoneclub.com","bradfordfans.com","brasilia.net","bratan.ru","brazilmail.com","brazilmail.com.br","breadtimes.press","breakthru.com","breathe.com","brefmail.com","brennendesreich.de","bresnan.net","brestonline.com","brew-master.com","brew-meister.com","brfree.com.br","briefemail.com","bright.net","britneyclub.com","brittonsign.com","broadcast.net","broadwaybuff.com","broadwaylove.com","brokeandhappy.com","brokenvalve.com","brujula.net","brunetka.ru","brusseler.com","bsdmail.com","bsnow.net","bspamfree.org","bt.com","btcc.org","btcmail.pw","btconnect.co.uk","btconnect.com","btinternet.com","btopenworld.co.uk","buerotiger.de","buffymail.com","bugmenot.com","bulgaria.com","bullsfan.com","bullsgame.com","bumerang.ro","bumpymail.com","bumrap.com","bund.us","bunita.net","bunko.com","burnthespam.info","burntmail.com","burstmail.info","buryfans.com","bushemail.com","business-man.com","businessman.net","businessweekmail.com","bust.com","busta-rhymes.com","busymail.com","busymail.com.com","busymail.comhomeart.com","butch-femme.net","butovo.net","buyersusa.com","buymoreplays.com","buzy.com","bvimailbox.com","byke.com","byom.de","byteme.com","c2.hu","c2i.net","c3.hu","c4.com","c51vsgq.com","cabacabana.com","cable.comcast.com","cableone.net","caere.it","cairomail.com","calcuttaads.com","calendar-server.bounces.google.com","calidifontain.be","californiamail.com","callnetuk.com","callsign.net","caltanet.it","camidge.com","canada-11.com","canada.com","canadianmail.com","canoemail.com","cantv.net","canwetalk.com","caramail.com","card.zp.ua","care2.com","careceo.com","careerbuildermail.com","carioca.net","cartelera.org","cartestraina.ro","casablancaresort.com","casema.nl","cash4u.com","cashette.com","casino.com","casualdx.com","cataloniamail.com","cataz.com","catcha.com","catchamail.com","catemail.com","catholic.org","catlover.com","catsrule.garfield.com","ccnmail.com","cd2.com","cek.pm","celineclub.com","celtic.com","center-mail.de","centermail.at","centermail.com","centermail.de","centermail.info","centermail.net","centoper.it","centralpets.com","centrum.cz","centrum.sk","centurylink.net","centurytel.net","certifiedmail.com","cfl.rr.com","cgac.es","cghost.s-a-d.de","chacuo.net","chaiyo.com","chaiyomail.com","chalkmail.net","chammy.info","chance2mail.com","chandrasekar.net","channelonetv.com","charityemail.com","charmedmail.com","charter.com","charter.net","chat.ru","chatlane.ru","chattown.com","chauhanweb.com","cheatmail.de","chechnya.conf.work","check.com","check.com12","check1check.com","cheeb.com","cheerful.com","chef.net","chefmail.com","chek.com","chello.nl","chemist.com","chequemail.com","cheshiremail.com","cheyenneweb.com","chez.com","chickmail.com","chil-e.com","childrens.md","childsavetrust.org","china.com","china.net.vg","chinalook.com","chinamail.com","chinesecool.com","chirk.com","chocaholic.com.au","chocofan.com","chogmail.com","choicemail1.com","chong-mail.com","chong-mail.net","christianmail.net","chronicspender.com","churchusa.com","cia-agent.com","cia.hu","ciaoweb.it","cicciociccio.com","cincinow.net","cirquefans.com","citeweb.net","citiz.net","citlink.net","city-of-bath.org","city-of-birmingham.com","city-of-brighton.org","city-of-cambridge.com","city-of-coventry.com","city-of-edinburgh.com","city-of-lichfield.com","city-of-lincoln.com","city-of-liverpool.com","city-of-manchester.com","city-of-nottingham.com","city-of-oxford.com","city-of-swansea.com","city-of-westminster.com","city-of-westminster.net","city-of-york.net","city2city.com","citynetusa.com","cityofcardiff.net","cityoflondon.org","ciudad.com.ar","ckaazaza.tk","claramail.com","classicalfan.com","classicmail.co.za","clear.net.nz","clearwire.net","clerk.com","clickforadate.com","cliffhanger.com","clixser.com","close2you.ne","close2you.net","clrmail.com","club-internet.fr","club4x4.net","clubalfa.com","clubbers.net","clubducati.com","clubhonda.net","clubmember.org","clubnetnoir.com","clubvdo.net","cluemail.com","cmail.net","cmail.org","cmail.ru","cmpmail.com","cmpnetmail.com","cnegal.com","cnnsimail.com","cntv.cn","codec.ro","codec.ro.ro","codec.roemail.ro","coder.hu","coid.biz","coldemail.info","coldmail.com","collectiblesuperstore.com","collector.org","collegebeat.com","collegeclub.com","collegemail.com","colleges.com","columbus.rr.com","columbusrr.com","columnist.com","comast.com","comast.net","comcast.com","comcast.net","comic.com","communityconnect.com","complxmind.com","comporium.net","comprendemail.com","compuserve.com","computer-expert.net","computer-freak.com","computer4u.com","computerconfused.com","computermail.net","computernaked.com","conexcol.com","cong.ru","conk.com","connect4free.net","connectbox.com","conok.com","consultant.com","consumerriot.com","contractor.net","contrasto.cu.cc","cookiemonster.com","cool.br","cool.fr.nf","coole-files.de","coolgoose.ca","coolgoose.com","coolkiwi.com","coollist.com","coolmail.com","coolmail.net","coolrio.com","coolsend.com","coolsite.net","cooooool.com","cooperation.net","cooperationtogo.net","copacabana.com","copper.net","copticmail.com","cornells.com","cornerpub.com","corporatedirtbag.com","correo.terra.com.gt","corrsfan.com","cortinet.com","cosmo.com","cotas.net","counsellor.com","countrylover.com","courriel.fr.nf","courrieltemporaire.com","cox.com","cox.net","coxinet.net","cpaonline.net","cracker.hu","craftemail.com","crapmail.org","crazedanddazed.com","crazy.ru","crazymailing.com","crazysexycool.com","crewstart.com","cristianemail.com","critterpost.com","croeso.com","crosshairs.com","crosswinds.net","crunkmail.com","crwmail.com","cry4helponline.com","cryingmail.com","cs.com","csinibaba.hu","cubiclink.com","cuemail.com","cumbriamail.com","curio-city.com","curryworld.de","curtsmail.com","cust.in","cute-girl.com","cuteandcuddly.com","cutekittens.com","cutey.com","cuvox.de","cww.de","cyber-africa.net","cyber-innovation.club","cyber-matrix.com","cyber-phone.eu","cyber-wizard.com","cyber4all.com","cyberbabies.com","cybercafemaui.com","cybercity-online.net","cyberdude.com","cyberforeplay.net","cybergal.com","cybergrrl.com","cyberinbox.com","cyberleports.com","cybermail.net","cybernet.it","cyberservices.com","cyberspace-asia.com","cybertrains.org","cyclefanz.com","cymail.net","cynetcity.com","d3p.dk","dabsol.net","dacoolest.com","dadacasa.com","daha.com","dailypioneer.com","dallas.theboys.com","dallasmail.com","dandikmail.com","dangerous-minds.com","dansegulvet.com","dasdasdascyka.tk","data54.com","date.by","daum.net","davegracey.com","dawnsonmail.com","dawsonmail.com","dayrep.com","dazedandconfused.com","dbzmail.com","dcemail.com","dcsi.net","ddns.org","deadaddress.com","deadlymob.org","deadspam.com","deafemail.net","deagot.com","deal-maker.com","dearriba.com","death-star.com","deepseafisherman.net","deforestationsucks.com","degoo.com","dejanews.com","delikkt.de","deliveryman.com","deneg.net","depechemode.com","deseretmail.com","desertmail.com","desertonline.com","desertsaintsmail.com","desilota.com","deskmail.com","deskpilot.com","despam.it","despammed.com","destin.com","detik.com","deutschland-net.com","devnullmail.com","devotedcouples.com","dezigner.ru","dfgh.net","dfwatson.com","dglnet.com.br","dgoh.org","di-ve.com","diamondemail.com","didamail.com","die-besten-bilder.de","die-genossen.de","die-optimisten.de","die-optimisten.net","die.life","diehardmail.com","diemailbox.de","digibel.be","digital-filestore.de","digitalforeplay.net","digitalsanctuary.com","digosnet.com","dingbone.com","diplomats.com","directbox.com","director-general.com","diri.com","dirtracer.com","dirtracers.com","discard.email","discard.ga","discard.gq","discardmail.com","discardmail.de","disciples.com","discofan.com","discovery.com","discoverymail.com","discoverymail.net","disign-concept.eu","disign-revelation.com","disinfo.net","dispomail.eu","disposable.com","disposableaddress.com","disposableemailaddresses.com","disposableinbox.com","dispose.it","dispostable.com","divismail.ru","divorcedandhappy.com","dm.w3internet.co.uk","dmailman.com","dmitrovka.net","dmitry.ru","dnainternet.net","dnsmadeeasy.com","doar.net","doclist.bounces.google.com","docmail.cz","docs.google.com","doctor.com","dodgeit.com","dodgit.com","dodgit.org","dodo.com.au","dodsi.com","dog.com","dogit.com","doglover.com","dogmail.co.uk","dogsnob.net","doityourself.com","domforfb1.tk","domforfb2.tk","domforfb3.tk","domforfb4.tk","domforfb5.tk","domforfb6.tk","domforfb7.tk","domforfb8.tk","domozmail.com","doneasy.com","donegal.net","donemail.ru","donjuan.com","dontgotmail.com","dontmesswithtexas.com","dontreg.com","dontsendmespam.de","doramail.com","dostmail.com","dotcom.fr","dotmsg.com","dotnow.com","dott.it","download-privat.de","dplanet.ch","dr.com","dragoncon.net","dragracer.com","drdrb.net","drivehq.com","dropmail.me","dropzone.com","drotposta.hu","dubaimail.com","dublin.com","dublin.ie","dump-email.info","dumpandjunk.com","dumpmail.com","dumpmail.de","dumpyemail.com","dunlopdriver.com","dunloprider.com","duno.com","duskmail.com","dustdevil.com","dutchmail.com","dvd-fan.net","dwp.net","dygo.com","dynamitemail.com","dyndns.org","e-apollo.lv","e-hkma.com","e-mail.com","e-mail.com.tr","e-mail.dk","e-mail.org","e-mail.ru","e-mail.ua","e-mailanywhere.com","e-mails.ru","e-tapaal.com","e-webtec.com","e4ward.com","earthalliance.com","earthcam.net","earthdome.com","earthling.net","earthlink.net","earthonline.net","eastcoast.co.za","eastlink.ca","eastmail.com","eastrolog.com","easy.com","easy.to","easypeasy.com","easypost.com","easytrashmail.com","eatmydirt.com","ebprofits.net","ec.rr.com","ecardmail.com","ecbsolutions.net","echina.com","ecolo-online.fr","ecompare.com","edmail.com","ednatx.com","edtnmail.com","educacao.te.pt","educastmail.com","eelmail.com","ehmail.com","einmalmail.de","einrot.com","einrot.de","eintagsmail.de","eircom.net","ekidz.com.au","elisanet.fi","elitemail.org","elsitio.com","eltimon.com","elvis.com","elvisfan.com","email-fake.gq","email-london.co.uk","email-value.com","email.biz","email.cbes.net","email.com","email.cz","email.ee","email.it","email.nu","email.org","email.ro","email.ru","email.si","email.su","email.ua","email.women.com","email2me.com","email2me.net","email4u.info","email60.com","emailacc.com","emailaccount.com","emailaddresses.com","emailage.ga","emailage.gq","emailasso.net","emailchoice.com","emailcorner.net","emailem.com","emailengine.net","emailengine.org","emailer.hubspot.com","emailforyou.net","emailgaul.com","emailgo.de","emailgroups.net","emailias.com","emailinfive.com","emailit.com","emaillime.com","emailmiser.com","emailoregon.com","emailpinoy.com","emailplanet.com","emailplus.org","emailproxsy.com","emails.ga","emails.incisivemedia.com","emails.ru","emailsensei.com","emailservice.com","emailsydney.com","emailtemporanea.com","emailtemporanea.net","emailtemporar.ro","emailtemporario.com.br","emailthe.net","emailtmp.com","emailto.de","emailuser.net","emailwarden.com","emailx.at.hm","emailx.net","emailxfer.com","emailz.ga","emailz.gq","emale.ru","ematic.com","embarqmail.com","emeil.in","emeil.ir","emil.com","eml.cc","eml.pp.ua","empereur.com","emptymail.com","emumail.com","emz.net","end-war.com","enel.net","enelpunto.net","engineer.com","england.com","england.edu","englandmail.com","epage.ru","epatra.com","ephemail.net","epiqmail.com","epix.net","epomail.com","epost.de","eposta.hu","eprompter.com","eqqu.com","eramail.co.za","eresmas.com","eriga.lv","ero-tube.org","eshche.net","esmailweb.net","estranet.it","ethos.st","etoast.com","etrademail.com","etranquil.com","etranquil.net","eudoramail.com","europamel.net","europe.com","europemail.com","euroseek.com","eurosport.com","evafan.com","evertonfans.com","every1.net","everyday.com.kh","everymail.net","everyone.net","everytg.ml","evopo.com","examnotes.net","excite.co.jp","excite.co.uk","excite.com","excite.it","execs.com","execs2k.com","executivemail.co.za","exemail.com.au","exg6.exghost.com","explodemail.com","express.net.ua","expressasia.com","extenda.net","extended.com","extremail.ru","eyepaste.com","eyou.com","ezagenda.com","ezcybersearch.com","ezmail.egine.com","ezmail.ru","ezrs.com","f-m.fm","f1fans.net","facebook-email.ga","facebook.com","facebookmail.com","facebookmail.gq","fadrasha.net","fadrasha.org","fahr-zur-hoelle.org","fake-email.pp.ua","fake-mail.cf","fake-mail.ga","fake-mail.ml","fakeinbox.com","fakeinformation.com","fakemailz.com","falseaddress.com","fan.com","fan.theboys.com","fannclub.com","fansonlymail.com","fansworldwide.de","fantasticmail.com","fantasymail.de","farang.net","farifluset.mailexpire.com","faroweb.com","fast-email.com","fast-mail.fr","fast-mail.org","fastacura.com","fastchevy.com","fastchrysler.com","fastem.com","fastemail.us","fastemailer.com","fastemailextractor.net","fastermail.com","fastest.cc","fastimap.com","fastkawasaki.com","fastmail.ca","fastmail.cn","fastmail.co.uk","fastmail.com","fastmail.com.au","fastmail.es","fastmail.fm","fastmail.gr","fastmail.im","fastmail.in","fastmail.jp","fastmail.mx","fastmail.net","fastmail.nl","fastmail.se","fastmail.to","fastmail.tw","fastmail.us","fastmailbox.net","fastmazda.com","fastmessaging.com","fastmitsubishi.com","fastnissan.com","fastservice.com","fastsubaru.com","fastsuzuki.com","fasttoyota.com","fastyamaha.com","fatcock.net","fatflap.com","fathersrightsne.org","fatyachts.com","fax.ru","fbi-agent.com","fbi.hu","fdfdsfds.com","fea.st","federalcontractors.com","feinripptraeger.de","felicity.com","felicitymail.com","female.ru","femenino.com","fepg.net","fetchmail.co.uk","fetchmail.com","fettabernett.de","feyenoorder.com","ffanet.com","fiberia.com","fibertel.com.ar","ficken.de","fificorp.com","fificorp.net","fightallspam.com","filipinolinks.com","filzmail.com","financefan.net","financemail.net","financier.com","findfo.com","findhere.com","findmail.com","findmemail.com","finebody.com","fineemail.com","finfin.com","finklfan.com","fire-brigade.com","fireman.net","fishburne.org","fishfuse.com","fivemail.de","fixmail.tk","fizmail.com","flashbox.5july.org","flashemail.com","flashmail.com","flashmail.net","fleckens.hu","flipcode.com","floridaemail.net","flytecrew.com","fmail.co.uk","fmailbox.com","fmgirl.com","fmguy.com","fnbmail.co.za","fnmail.com","folkfan.com","foodmail.com","footard.com","football.theboys.com","footballmail.com","foothills.net","for-president.com","force9.co.uk","forfree.at","forgetmail.com","fornow.eu","forpresident.com","fortuncity.com","fortunecity.com","forum.dk","fossefans.com","foxmail.com","fr33mail.info","francefans.com","francemel.fr","frapmail.com","free-email.ga","free-online.net","free-org.com","free.com.pe","free.fr","freeaccess.nl","freeaccount.com","freeandsingle.com","freebox.com","freedom.usa.com","freedomlover.com","freefanmail.com","freegates.be","freeghana.com","freelance-france.eu","freeler.nl","freemail.bozz.com","freemail.c3.hu","freemail.com.au","freemail.com.pk","freemail.de","freemail.et","freemail.gr","freemail.hu","freemail.it","freemail.lt","freemail.ms","freemail.nl","freemail.org.mk","freemail.ru","freemails.ga","freemeil.gq","freenet.de","freenet.kg","freeola.com","freeola.net","freeproblem.com","freesbee.fr","freeserve.co.uk","freeservers.com","freestamp.com","freestart.hu","freesurf.fr","freesurf.nl","freeuk.com","freeuk.net","freeukisp.co.uk","freeweb.org","freewebemail.com","freeyellow.com","freezone.co.uk","fresnomail.com","freudenkinder.de","freundin.ru","friction.net","friendlydevices.com","friendlymail.co.uk","friends-cafe.com","friendsfan.com","from-africa.com","from-america.com","from-argentina.com","from-asia.com","from-australia.com","from-belgium.com","from-brazil.com","from-canada.com","from-china.net","from-england.com","from-europe.com","from-france.net","from-germany.net","from-holland.com","from-israel.com","from-italy.net","from-japan.net","from-korea.com","from-mexico.com","from-outerspace.com","from-russia.com","from-spain.net","fromalabama.com","fromalaska.com","fromarizona.com","fromarkansas.com","fromcalifornia.com","fromcolorado.com","fromconnecticut.com","fromdelaware.com","fromflorida.net","fromgeorgia.com","fromhawaii.net","fromidaho.com","fromillinois.com","fromindiana.com","frominter.net","fromiowa.com","fromjupiter.com","fromkansas.com","fromkentucky.com","fromlouisiana.com","frommaine.net","frommaryland.com","frommassachusetts.com","frommiami.com","frommichigan.com","fromminnesota.com","frommississippi.com","frommissouri.com","frommontana.com","fromnebraska.com","fromnevada.com","fromnewhampshire.com","fromnewjersey.com","fromnewmexico.com","fromnewyork.net","fromnorthcarolina.com","fromnorthdakota.com","fromohio.com","fromoklahoma.com","fromoregon.net","frompennsylvania.com","fromrhodeisland.com","fromru.com","fromru.ru","fromsouthcarolina.com","fromsouthdakota.com","fromtennessee.com","fromtexas.com","fromthestates.com","fromutah.com","fromvermont.com","fromvirginia.com","fromwashington.com","fromwashingtondc.com","fromwestvirginia.com","fromwisconsin.com","fromwyoming.com","front.ru","frontier.com","frontiernet.net","frostbyte.uk.net","fsmail.net","ftc-i.net","ftml.net","fuckingduh.com","fudgerub.com","fullmail.com","funiran.com","funkfan.com","funky4.com","fuorissimo.com","furnitureprovider.com","fuse.net","fusemail.com","fut.es","fux0ringduh.com","fwnb.com","fxsmails.com","fyii.de","galamb.net","galaxy5.com","galaxyhit.com","gamebox.com","gamebox.net","gamegeek.com","games.com","gamespotmail.com","gamil.com","gamil.com.au","gamno.config.work","garbage.com","gardener.com","garliclife.com","gatwickemail.com","gawab.com","gay.com","gaybrighton.co.uk","gaza.net","gazeta.pl","gazibooks.com","gci.net","gdi.net","gee-wiz.com","geecities.com","geek.com","geek.hu","geeklife.com","gehensiemirnichtaufdensack.de","gelitik.in","gencmail.com","general-hospital.com","gentlemansclub.de","genxemail.com","geocities.com","geography.net","geologist.com","geopia.com","germanymail.com","get.pp.ua","get1mail.com","get2mail.fr","getairmail.cf","getairmail.com","getairmail.ga","getairmail.gq","getmails.eu","getonemail.com","getonemail.net","gfxartist.ru","gh2000.com","ghanamail.com","ghostmail.com","ghosttexter.de","giantmail.de","giantsfan.com","giga4u.de","gigileung.org","girl4god.com","girlsundertheinfluence.com","gishpuppy.com","givepeaceachance.com","glay.org","glendale.net","globalfree.it","globalpagan.com","globalsite.com.br","globetrotter.net","globo.com","globomail.com","gmail.co.za","gmail.com","gmail.com.au","gmail.com.br","gmail.ru","gmial.com","gmx.at","gmx.ch","gmx.co.uk","gmx.com","gmx.de","gmx.fr","gmx.li","gmx.net","gmx.us","gnwmail.com","go.com","go.ro","go.ru","go2.com.py","go2net.com","go4.it","gobrainstorm.net","gocollege.com","gocubs.com","godmail.dk","goemailgo.com","gofree.co.uk","gol.com","goldenmail.ru","goldmail.ru","goldtoolbox.com","golfemail.com","golfilla.info","golfmail.be","gonavy.net","gonuts4free.com","goodnewsmail.com","goodstick.com","google.com","googlegroups.com","googlemail.com","goosemoose.com","goplay.com","gorillaswithdirtyarmpits.com","gorontalo.net","gospelfan.com","gothere.uk.com","gotmail.com","gotmail.net","gotmail.org","gotomy.com","gotti.otherinbox.com","govolsfan.com","gportal.hu","grabmail.com","graduate.org","graffiti.net","gramszu.net","grandmamail.com","grandmasmail.com","graphic-designer.com","grapplers.com","gratisweb.com","great-host.in","greenmail.net","greensloth.com","groupmail.com","grr.la","grungecafe.com","gsrv.co.uk","gtemail.net","gtmc.net","gua.net","guerillamail.biz","guerillamail.com","guerrillamail.biz","guerrillamail.com","guerrillamail.de","guerrillamail.info","guerrillamail.net","guerrillamail.org","guerrillamailblock.com","guessmail.com","guju.net","gurlmail.com","gustr.com","guy.com","guy2.com","guyanafriends.com","gwhsgeckos.com","gyorsposta.com","gyorsposta.hu","h-mail.us","hab-verschlafen.de","hablas.com","habmalnefrage.de","hacccc.com","hackermail.com","hackermail.net","hailmail.net","hairdresser.com","hairdresser.net","haltospam.com","hamptonroads.com","handbag.com","handleit.com","hang-ten.com","hangglidemail.com","hanmail.net","happemail.com","happycounsel.com","happypuppy.com","harakirimail.com","haramamba.ru","hardcorefreak.com","hardyoungbabes.com","hartbot.de","hat-geld.de","hatespam.org","hawaii.rr.com","hawaiiantel.net","headbone.com","healthemail.net","heartthrob.com","heavynoize.net","heerschap.com","heesun.net","hehe.com","hello.hu","hello.net.au","hello.to","hellokitty.com","helter-skelter.com","hempseed.com","herediano.com","heremail.com","herono1.com","herp.in","herr-der-mails.de","hetnet.nl","hewgen.ru","hey.to","hhdevel.com","hideakifan.com","hidemail.de","hidzz.com","highmilton.com","highquality.com","highveldmail.co.za","hilarious.com","hinduhome.com","hingis.org","hiphopfan.com","hispavista.com","hitmail.com","hitmanrecords.com","hitthe.net","hkg.net","hkstarphoto.com","hmamail.com","hochsitze.com","hockeymail.com","hollywoodkids.com","home-email.com","home.de","home.nl","home.no.net","home.ro","home.se","homeart.com","homelocator.com","homemail.com","homenetmail.com","homeonthethrone.com","homestead.com","homeworkcentral.com","honduras.com","hongkong.com","hookup.net","hoopsmail.com","hopemail.biz","horrormail.com","host-it.com.sg","hot-mail.gq","hot-shop.com","hot-shot.com","hot.ee","hotbot.com","hotbox.ru","hotbrev.com","hotcoolmail.com","hotepmail.com","hotfire.net","hotletter.com","hotlinemail.com","hotmail.be","hotmail.ca","hotmail.ch","hotmail.co","hotmail.co.il","hotmail.co.jp","hotmail.co.nz","hotmail.co.uk","hotmail.co.za","hotmail.com","hotmail.com.ar","hotmail.com.au","hotmail.com.br","hotmail.com.mx","hotmail.com.tr","hotmail.de","hotmail.es","hotmail.fi","hotmail.fr","hotmail.it","hotmail.kg","hotmail.kz","hotmail.my","hotmail.nl","hotmail.ro","hotmail.roor","hotmail.ru","hotpop.com","hotpop3.com","hotvoice.com","housefan.com","housefancom","housemail.com","hsuchi.net","html.tou.com","hu2.ru","hughes.net","hulapla.de","humanoid.net","humanux.com","humn.ws.gy","humour.com","hunsa.com","hurting.com","hush.com","hushmail.com","hypernautica.com","i-connect.com","i-france.com","i-love-cats.com","i-mail.com.au","i-mailbox.net","i-p.com","i.am","i.am.to","i.amhey.to","i.ua","i12.com","i2828.com","i2pmail.org","iam4msu.com","iamawoman.com","iamfinallyonline.com","iamwaiting.com","iamwasted.com","iamyours.com","icestorm.com","ich-bin-verrueckt-nach-dir.de","ich-will-net.de","icloud.com","icmsconsultants.com","icq.com","icqmail.com","icrazy.com","icu.md","id-base.com","id.ru","ididitmyway.com","idigjesus.com","idirect.com","ieatspam.eu","ieatspam.info","ieh-mail.de","iespana.es","ifoward.com","ig.com.br","ignazio.it","ignmail.com","ihateclowns.com","ihateyoualot.info","iheartspam.org","iinet.net.au","ijustdontcare.com","ikbenspamvrij.nl","ilkposta.com","ilovechocolate.com","ilovegiraffes.net","ilovejesus.com","ilovelionking.com","ilovepokemonmail.com","ilovethemovies.com","ilovetocollect.net","ilse.nl","imaginemail.com","imail.org","imail.ru","imailbox.com","imails.info","imap-mail.com","imap.cc","imapmail.org","imel.org","imgof.com","imgv.de","immo-gerance.info","imneverwrong.com","imposter.co.uk","imstations.com","imstressed.com","imtoosexy.com","in-box.net","in2jesus.com","iname.com","inbax.tk","inbound.plus","inbox.com","inbox.lv","inbox.net","inbox.ru","inbox.si","inboxalias.com","inboxclean.com","inboxclean.org","incamail.com","includingarabia.com","incredimail.com","indeedemail.com","index.ua","indexa.fr","india.com","indiatimes.com","indo-mail.com","indocities.com","indomail.com","indosat.net.id","indus.ru","indyracers.com","inerted.com","inet.com","inet.net.au","info-media.de","info-radio.ml","info.com","info66.com","infoapex.com","infocom.zp.ua","infohq.com","infomail.es","infomart.or.jp","informaticos.com","infospacemail.com","infovia.com.ar","inicia.es","inmail.sk","inmail24.com","inmano.com","inmynetwork.tk","innocent.com","inonesearch.com","inorbit.com","inoutbox.com","insidebaltimore.net","insight.rr.com","inspectorjavert.com","instant-mail.de","instantemailaddress.com","instantmail.fr","instruction.com","instructor.net","insurer.com","interburp.com","interfree.it","interia.pl","interlap.com.ar","intermail.co.il","internet-club.com","internet-e-mail.com","internet-mail.org","internet-police.com","internetbiz.com","internetdrive.com","internetegypt.com","internetemails.net","internetmailing.net","internode.on.net","invalid.com","investormail.com","inwind.it","iobox.com","iobox.fi","iol.it","iol.pt","iowaemail.com","ip3.com","ip4.pp.ua","ip6.li","ip6.pp.ua","ipdeer.com","ipex.ru","ipoo.org","iportalexpress.com","iprimus.com.au","iqemail.com","irangate.net","iraqmail.com","ireland.com","irelandmail.com","irish2me.com","irj.hu","iroid.com","iscooler.com","isellcars.com","iservejesus.com","islamonline.net","islandemail.net","isleuthmail.com","ismart.net","isonfire.com","isp9.net","israelmail.com","ist-allein.info","ist-einmalig.de","ist-ganz-allein.de","ist-willig.de","italymail.com","itelefonica.com.br","itloox.com","itmom.com","ivebeenframed.com","ivillage.com","iwan-fals.com","iwi.net","iwmail.com","iwon.com","izadpanah.com","jabble.com","jahoopa.com","jakuza.hu","japan.com","jaydemail.com","jazzandjava.com","jazzfan.com","jazzgame.com","je-recycle.info","jeanvaljean.com","jerusalemmail.com","jesusanswers.com","jet-renovation.fr","jetable.com","jetable.de","jetable.fr.nf","jetable.net","jetable.org","jetable.pp.ua","jetemail.net","jewishmail.com","jfkislanders.com","jingjo.net","jippii.fi","jmail.co.za","jnxjn.com","job4u.com","jobbikszimpatizans.hu","joelonsoftware.com","joinme.com","jojomail.com","jokes.com","jordanmail.com","journalist.com","jourrapide.com","jovem.te.pt","joymail.com","jpopmail.com","jsrsolutions.com","jubiimail.dk","jump.com","jumpy.it","juniormail.com","junk1e.com","junkmail.com","junkmail.gq","juno.com","justemail.net","justicemail.com","justmail.de","justmailz.com","justmarriedmail.com","jwspamspy","k.ro","kaazoo.com","kabissa.org","kaduku.net","kaffeeschluerfer.com","kaffeeschluerfer.de","kaixo.com","kalpoint.com","kansascity.com","kapoorweb.com","karachian.com","karachioye.com","karbasi.com","kasmail.com","kaspop.com","katamail.com","kayafmmail.co.za","kbjrmail.com","kcks.com","kebi.com","keftamail.com","keg-party.com","keinpardon.de","keko.com.ar","kellychen.com","keptprivate.com","keromail.com","kewpee.com","keyemail.com","kgb.hu","khosropour.com","kichimail.com","kickassmail.com","killamail.com","killergreenmail.com","killermail.com","killmail.com","killmail.net","kimo.com","kimsdisk.com","kinglibrary.net","kinki-kids.com","kismail.ru","kissfans.com","kitemail.com","kittymail.com","kitznet.at","kiwibox.com","kiwitown.com","klassmaster.com","klassmaster.net","klzlk.com","km.ru","kmail.com.au","knol-power.nl","koko.com","kolumbus.fi","kommespaeter.de","konkovo.net","konsul.ru","konx.com","korea.com","koreamail.com","kosino.net","koszmail.pl","kozmail.com","kpnmail.nl","kreditor.ru","krim.ws","krongthip.com","krovatka.net","krunis.com","ksanmail.com","ksee24mail.com","kube93mail.com","kukamail.com","kulturbetrieb.info","kumarweb.com","kurzepost.de","kuwait-mail.com","kuzminki.net","kyokodate.com","kyokofukada.net","l33r.eu","la.com","labetteraverouge.at","lackmail.ru","ladyfire.com","ladymail.cz","lagerlouts.com","lags.us","lahoreoye.com","lakmail.com","lamer.hu","land.ru","langoo.com","lankamail.com","laoeq.com","laposte.net","lass-es-geschehen.de","last-chance.pro","lastmail.co","latemodels.com","latinmail.com","latino.com","lavabit.com","lavache.com","law.com","lawlita.com","lawyer.com","lazyinbox.com","learn2compute.net","lebanonatlas.com","leeching.net","leehom.net","lefortovo.net","legalactions.com","legalrc.loan","legislator.com","legistrator.com","lenta.ru","leonlai.net","letsgomets.net","letterbox.com","letterboxes.org","letthemeatspam.com","levele.com","levele.hu","lex.bg","lexis-nexis-mail.com","lhsdv.com","lianozovo.net","libero.it","liberomail.com","lick101.com","liebt-dich.info","lifebyfood.com","link2mail.net","linkmaster.com","linktrader.com","linuxfreemail.com","linuxmail.org","lionsfan.com.au","liontrucks.com","liquidinformation.net","lissamail.com","list.ru","listomail.com","litedrop.com","literaturelover.com","littleapple.com","littleblueroom.com","live.at","live.be","live.ca","live.cl","live.cn","live.co.uk","live.co.za","live.com","live.com.ar","live.com.au","live.com.mx","live.com.my","live.com.pt","live.com.sg","live.de","live.dk","live.fr","live.hk","live.ie","live.in","live.it","live.jp","live.nl","live.no","live.ru","live.se","liveradio.tk","liverpoolfans.com","ljiljan.com","llandudno.com","llangollen.com","lmxmail.sk","lobbyist.com","localbar.com","localgenius.com","locos.com","login-email.ga","loh.pp.ua","lol.ovpn.to","lolfreak.net","lolito.tk","lolnetwork.net","london.com","loobie.com","looksmart.co.uk","looksmart.com","looksmart.com.au","lookugly.com","lopezclub.com","lortemail.dk","louiskoo.com","lov.ru","love.com","love.cz","loveable.com","lovecat.com","lovefall.ml","lovefootball.com","loveforlostcats.com","lovelygirl.net","lovemail.com","lover-boy.com","lovergirl.com","lovesea.gq","lovethebroncos.com","lovethecowboys.com","lovetocook.net","lovetohike.com","loveyouforever.de","lovingjesus.com","lowandslow.com","lr7.us","lr78.com","lroid.com","lubovnik.ru","lukop.dk","luso.pt","luukku.com","luv2.us","luvrhino.com","lvie.com.sg","lvwebmail.com","lycos.co.uk","lycos.com","lycos.es","lycos.it","lycos.ne.jp","lycos.ru","lycosemail.com","lycosmail.com","m-a-i-l.com","m-hmail.com","m21.cc","m4.org","m4ilweb.info","mac.com","macbox.com","macbox.ru","macfreak.com","machinecandy.com","macmail.com","mad.scientist.com","madcrazy.com","madcreations.com","madonnafan.com","madrid.com","maennerversteherin.com","maennerversteherin.de","maffia.hu","magicmail.co.za","mahmoodweb.com","mail-awu.de","mail-box.cz","mail-center.com","mail-central.com","mail-easy.fr","mail-filter.com","mail-me.com","mail-page.com","mail-temporaire.fr","mail-tester.com","mail.austria.com","mail.az","mail.be","mail.bg","mail.bulgaria.com","mail.by","mail.byte.it","mail.co.za","mail.com","mail.com.tr","mail.ee","mail.entrepeneurmag.com","mail.freetown.com","mail.gr","mail.hitthebeach.com","mail.htl22.at","mail.kmsp.com","mail.md","mail.mezimages.net","mail.misterpinball.de","mail.nu","mail.org.uk","mail.pf","mail.pharmacy.com","mail.pt","mail.r-o-o-t.com","mail.ru","mail.salu.net","mail.sisna.com","mail.spaceports.com","mail.svenz.eu","mail.theboys.com","mail.usa.com","mail.vasarhely.hu","mail.vu","mail.wtf","mail.zp.ua","mail114.net","mail15.com","mail1a.de","mail1st.com","mail2007.com","mail21.cc","mail2aaron.com","mail2abby.com","mail2abc.com","mail2actor.com","mail2admiral.com","mail2adorable.com","mail2adoration.com","mail2adore.com","mail2adventure.com","mail2aeolus.com","mail2aether.com","mail2affection.com","mail2afghanistan.com","mail2africa.com","mail2agent.com","mail2aha.com","mail2ahoy.com","mail2aim.com","mail2air.com","mail2airbag.com","mail2airforce.com","mail2airport.com","mail2alabama.com","mail2alan.com","mail2alaska.com","mail2albania.com","mail2alcoholic.com","mail2alec.com","mail2alexa.com","mail2algeria.com","mail2alicia.com","mail2alien.com","mail2allan.com","mail2allen.com","mail2allison.com","mail2alpha.com","mail2alyssa.com","mail2amanda.com","mail2amazing.com","mail2amber.com","mail2america.com","mail2american.com","mail2andorra.com","mail2andrea.com","mail2andy.com","mail2anesthesiologist.com","mail2angela.com","mail2angola.com","mail2ann.com","mail2anna.com","mail2anne.com","mail2anthony.com","mail2anything.com","mail2aphrodite.com","mail2apollo.com","mail2april.com","mail2aquarius.com","mail2arabia.com","mail2arabic.com","mail2architect.com","mail2ares.com","mail2argentina.com","mail2aries.com","mail2arizona.com","mail2arkansas.com","mail2armenia.com","mail2army.com","mail2arnold.com","mail2art.com","mail2artemus.com","mail2arthur.com","mail2artist.com","mail2ashley.com","mail2ask.com","mail2astronomer.com","mail2athena.com","mail2athlete.com","mail2atlas.com","mail2atom.com","mail2attitude.com","mail2auction.com","mail2aunt.com","mail2australia.com","mail2austria.com","mail2azerbaijan.com","mail2baby.com","mail2bahamas.com","mail2bahrain.com","mail2ballerina.com","mail2ballplayer.com","mail2band.com","mail2bangladesh.com","mail2bank.com","mail2banker.com","mail2bankrupt.com","mail2baptist.com","mail2bar.com","mail2barbados.com","mail2barbara.com","mail2barter.com","mail2basketball.com","mail2batter.com","mail2beach.com","mail2beast.com","mail2beatles.com","mail2beauty.com","mail2becky.com","mail2beijing.com","mail2belgium.com","mail2belize.com","mail2ben.com","mail2bernard.com","mail2beth.com","mail2betty.com","mail2beverly.com","mail2beyond.com","mail2biker.com","mail2bill.com","mail2billionaire.com","mail2billy.com","mail2bio.com","mail2biologist.com","mail2black.com","mail2blackbelt.com","mail2blake.com","mail2blind.com","mail2blonde.com","mail2blues.com","mail2bob.com","mail2bobby.com","mail2bolivia.com","mail2bombay.com","mail2bonn.com","mail2bookmark.com","mail2boreas.com","mail2bosnia.com","mail2boston.com","mail2botswana.com","mail2bradley.com","mail2brazil.com","mail2breakfast.com","mail2brian.com","mail2bride.com","mail2brittany.com","mail2broker.com","mail2brook.com","mail2bruce.com","mail2brunei.com","mail2brunette.com","mail2brussels.com","mail2bryan.com","mail2bug.com","mail2bulgaria.com","mail2business.com","mail2buy.com","mail2ca.com","mail2california.com","mail2calvin.com","mail2cambodia.com","mail2cameroon.com","mail2canada.com","mail2cancer.com","mail2capeverde.com","mail2capricorn.com","mail2cardinal.com","mail2cardiologist.com","mail2care.com","mail2caroline.com","mail2carolyn.com","mail2casey.com","mail2cat.com","mail2caterer.com","mail2cathy.com","mail2catlover.com","mail2catwalk.com","mail2cell.com","mail2chad.com","mail2champaign.com","mail2charles.com","mail2chef.com","mail2chemist.com","mail2cherry.com","mail2chicago.com","mail2chile.com","mail2china.com","mail2chinese.com","mail2chocolate.com","mail2christian.com","mail2christie.com","mail2christmas.com","mail2christy.com","mail2chuck.com","mail2cindy.com","mail2clark.com","mail2classifieds.com","mail2claude.com","mail2cliff.com","mail2clinic.com","mail2clint.com","mail2close.com","mail2club.com","mail2coach.com","mail2coastguard.com","mail2colin.com","mail2college.com","mail2colombia.com","mail2color.com","mail2colorado.com","mail2columbia.com","mail2comedian.com","mail2composer.com","mail2computer.com","mail2computers.com","mail2concert.com","mail2congo.com","mail2connect.com","mail2connecticut.com","mail2consultant.com","mail2convict.com","mail2cook.com","mail2cool.com","mail2cory.com","mail2costarica.com","mail2country.com","mail2courtney.com","mail2cowboy.com","mail2cowgirl.com","mail2craig.com","mail2crave.com","mail2crazy.com","mail2create.com","mail2croatia.com","mail2cry.com","mail2crystal.com","mail2cuba.com","mail2culture.com","mail2curt.com","mail2customs.com","mail2cute.com","mail2cutey.com","mail2cynthia.com","mail2cyprus.com","mail2czechrepublic.com","mail2dad.com","mail2dale.com","mail2dallas.com","mail2dan.com","mail2dana.com","mail2dance.com","mail2dancer.com","mail2danielle.com","mail2danny.com","mail2darlene.com","mail2darling.com","mail2darren.com","mail2daughter.com","mail2dave.com","mail2dawn.com","mail2dc.com","mail2dealer.com","mail2deanna.com","mail2dearest.com","mail2debbie.com","mail2debby.com","mail2deer.com","mail2delaware.com","mail2delicious.com","mail2demeter.com","mail2democrat.com","mail2denise.com","mail2denmark.com","mail2dennis.com","mail2dentist.com","mail2derek.com","mail2desert.com","mail2devoted.com","mail2devotion.com","mail2diamond.com","mail2diana.com","mail2diane.com","mail2diehard.com","mail2dilemma.com","mail2dillon.com","mail2dinner.com","mail2dinosaur.com","mail2dionysos.com","mail2diplomat.com","mail2director.com","mail2dirk.com","mail2disco.com","mail2dive.com","mail2diver.com","mail2divorced.com","mail2djibouti.com","mail2doctor.com","mail2doglover.com","mail2dominic.com","mail2dominica.com","mail2dominicanrepublic.com","mail2don.com","mail2donald.com","mail2donna.com","mail2doris.com","mail2dorothy.com","mail2doug.com","mail2dough.com","mail2douglas.com","mail2dow.com","mail2downtown.com","mail2dream.com","mail2dreamer.com","mail2dude.com","mail2dustin.com","mail2dyke.com","mail2dylan.com","mail2earl.com","mail2earth.com","mail2eastend.com","mail2eat.com","mail2economist.com","mail2ecuador.com","mail2eddie.com","mail2edgar.com","mail2edwin.com","mail2egypt.com","mail2electron.com","mail2eli.com","mail2elizabeth.com","mail2ellen.com","mail2elliot.com","mail2elsalvador.com","mail2elvis.com","mail2emergency.com","mail2emily.com","mail2engineer.com","mail2english.com","mail2environmentalist.com","mail2eos.com","mail2eric.com","mail2erica.com","mail2erin.com","mail2erinyes.com","mail2eris.com","mail2eritrea.com","mail2ernie.com","mail2eros.com","mail2estonia.com","mail2ethan.com","mail2ethiopia.com","mail2eu.com","mail2europe.com","mail2eurus.com","mail2eva.com","mail2evan.com","mail2evelyn.com","mail2everything.com","mail2exciting.com","mail2expert.com","mail2fairy.com","mail2faith.com","mail2fanatic.com","mail2fancy.com","mail2fantasy.com","mail2farm.com","mail2farmer.com","mail2fashion.com","mail2fat.com","mail2feeling.com","mail2female.com","mail2fever.com","mail2fighter.com","mail2fiji.com","mail2filmfestival.com","mail2films.com","mail2finance.com","mail2finland.com","mail2fireman.com","mail2firm.com","mail2fisherman.com","mail2flexible.com","mail2florence.com","mail2florida.com","mail2floyd.com","mail2fly.com","mail2fond.com","mail2fondness.com","mail2football.com","mail2footballfan.com","mail2found.com","mail2france.com","mail2frank.com","mail2frankfurt.com","mail2franklin.com","mail2fred.com","mail2freddie.com","mail2free.com","mail2freedom.com","mail2french.com","mail2freudian.com","mail2friendship.com","mail2from.com","mail2fun.com","mail2gabon.com","mail2gabriel.com","mail2gail.com","mail2galaxy.com","mail2gambia.com","mail2games.com","mail2gary.com","mail2gavin.com","mail2gemini.com","mail2gene.com","mail2genes.com","mail2geneva.com","mail2george.com","mail2georgia.com","mail2gerald.com","mail2german.com","mail2germany.com","mail2ghana.com","mail2gilbert.com","mail2gina.com","mail2girl.com","mail2glen.com","mail2gloria.com","mail2goddess.com","mail2gold.com","mail2golfclub.com","mail2golfer.com","mail2gordon.com","mail2government.com","mail2grab.com","mail2grace.com","mail2graham.com","mail2grandma.com","mail2grandpa.com","mail2grant.com","mail2greece.com","mail2green.com","mail2greg.com","mail2grenada.com","mail2gsm.com","mail2guard.com","mail2guatemala.com","mail2guy.com","mail2hades.com","mail2haiti.com","mail2hal.com","mail2handhelds.com","mail2hank.com","mail2hannah.com","mail2harold.com","mail2harry.com","mail2hawaii.com","mail2headhunter.com","mail2heal.com","mail2heather.com","mail2heaven.com","mail2hebe.com","mail2hecate.com","mail2heidi.com","mail2helen.com","mail2hell.com","mail2help.com","mail2helpdesk.com","mail2henry.com","mail2hephaestus.com","mail2hera.com","mail2hercules.com","mail2herman.com","mail2hermes.com","mail2hespera.com","mail2hestia.com","mail2highschool.com","mail2hindu.com","mail2hip.com","mail2hiphop.com","mail2holland.com","mail2holly.com","mail2hollywood.com","mail2homer.com","mail2honduras.com","mail2honey.com","mail2hongkong.com","mail2hope.com","mail2horse.com","mail2hot.com","mail2hotel.com","mail2houston.com","mail2howard.com","mail2hugh.com","mail2human.com","mail2hungary.com","mail2hungry.com","mail2hygeia.com","mail2hyperspace.com","mail2hypnos.com","mail2ian.com","mail2ice-cream.com","mail2iceland.com","mail2idaho.com","mail2idontknow.com","mail2illinois.com","mail2imam.com","mail2in.com","mail2india.com","mail2indian.com","mail2indiana.com","mail2indonesia.com","mail2infinity.com","mail2intense.com","mail2iowa.com","mail2iran.com","mail2iraq.com","mail2ireland.com","mail2irene.com","mail2iris.com","mail2irresistible.com","mail2irving.com","mail2irwin.com","mail2isaac.com","mail2israel.com","mail2italian.com","mail2italy.com","mail2jackie.com","mail2jacob.com","mail2jail.com","mail2jaime.com","mail2jake.com","mail2jamaica.com","mail2james.com","mail2jamie.com","mail2jan.com","mail2jane.com","mail2janet.com","mail2janice.com","mail2japan.com","mail2japanese.com","mail2jasmine.com","mail2jason.com","mail2java.com","mail2jay.com","mail2jazz.com","mail2jed.com","mail2jeffrey.com","mail2jennifer.com","mail2jenny.com","mail2jeremy.com","mail2jerry.com","mail2jessica.com","mail2jessie.com","mail2jesus.com","mail2jew.com","mail2jeweler.com","mail2jim.com","mail2jimmy.com","mail2joan.com","mail2joann.com","mail2joanna.com","mail2jody.com","mail2joe.com","mail2joel.com","mail2joey.com","mail2john.com","mail2join.com","mail2jon.com","mail2jonathan.com","mail2jones.com","mail2jordan.com","mail2joseph.com","mail2josh.com","mail2joy.com","mail2juan.com","mail2judge.com","mail2judy.com","mail2juggler.com","mail2julian.com","mail2julie.com","mail2jumbo.com","mail2junk.com","mail2justin.com","mail2justme.com","mail2k.ru","mail2kansas.com","mail2karate.com","mail2karen.com","mail2karl.com","mail2karma.com","mail2kathleen.com","mail2kathy.com","mail2katie.com","mail2kay.com","mail2kazakhstan.com","mail2keen.com","mail2keith.com","mail2kelly.com","mail2kelsey.com","mail2ken.com","mail2kendall.com","mail2kennedy.com","mail2kenneth.com","mail2kenny.com","mail2kentucky.com","mail2kenya.com","mail2kerry.com","mail2kevin.com","mail2kim.com","mail2kimberly.com","mail2king.com","mail2kirk.com","mail2kiss.com","mail2kosher.com","mail2kristin.com","mail2kurt.com","mail2kuwait.com","mail2kyle.com","mail2kyrgyzstan.com","mail2la.com","mail2lacrosse.com","mail2lance.com","mail2lao.com","mail2larry.com","mail2latvia.com","mail2laugh.com","mail2laura.com","mail2lauren.com","mail2laurie.com","mail2lawrence.com","mail2lawyer.com","mail2lebanon.com","mail2lee.com","mail2leo.com","mail2leon.com","mail2leonard.com","mail2leone.com","mail2leslie.com","mail2letter.com","mail2liberia.com","mail2libertarian.com","mail2libra.com","mail2libya.com","mail2liechtenstein.com","mail2life.com","mail2linda.com","mail2linux.com","mail2lionel.com","mail2lipstick.com","mail2liquid.com","mail2lisa.com","mail2lithuania.com","mail2litigator.com","mail2liz.com","mail2lloyd.com","mail2lois.com","mail2lola.com","mail2london.com","mail2looking.com","mail2lori.com","mail2lost.com","mail2lou.com","mail2louis.com","mail2louisiana.com","mail2lovable.com","mail2love.com","mail2lucky.com","mail2lucy.com","mail2lunch.com","mail2lust.com","mail2luxembourg.com","mail2luxury.com","mail2lyle.com","mail2lynn.com","mail2madagascar.com","mail2madison.com","mail2madrid.com","mail2maggie.com","mail2mail4.com","mail2maine.com","mail2malawi.com","mail2malaysia.com","mail2maldives.com","mail2mali.com","mail2malta.com","mail2mambo.com","mail2man.com","mail2mandy.com","mail2manhunter.com","mail2mankind.com","mail2many.com","mail2marc.com","mail2marcia.com","mail2margaret.com","mail2margie.com","mail2marhaba.com","mail2maria.com","mail2marilyn.com","mail2marines.com","mail2mark.com","mail2marriage.com","mail2married.com","mail2marries.com","mail2mars.com","mail2marsha.com","mail2marshallislands.com","mail2martha.com","mail2martin.com","mail2marty.com","mail2marvin.com","mail2mary.com","mail2maryland.com","mail2mason.com","mail2massachusetts.com","mail2matt.com","mail2matthew.com","mail2maurice.com","mail2mauritania.com","mail2mauritius.com","mail2max.com","mail2maxwell.com","mail2maybe.com","mail2mba.com","mail2me4u.com","mail2mechanic.com","mail2medieval.com","mail2megan.com","mail2mel.com","mail2melanie.com","mail2melissa.com","mail2melody.com","mail2member.com","mail2memphis.com","mail2methodist.com","mail2mexican.com","mail2mexico.com","mail2mgz.com","mail2miami.com","mail2michael.com","mail2michelle.com","mail2michigan.com","mail2mike.com","mail2milan.com","mail2milano.com","mail2mildred.com","mail2milkyway.com","mail2millennium.com","mail2millionaire.com","mail2milton.com","mail2mime.com","mail2mindreader.com","mail2mini.com","mail2minister.com","mail2minneapolis.com","mail2minnesota.com","mail2miracle.com","mail2missionary.com","mail2mississippi.com","mail2missouri.com","mail2mitch.com","mail2model.com","mail2moldova.commail2molly.com","mail2mom.com","mail2monaco.com","mail2money.com","mail2mongolia.com","mail2monica.com","mail2montana.com","mail2monty.com","mail2moon.com","mail2morocco.com","mail2morpheus.com","mail2mors.com","mail2moscow.com","mail2moslem.com","mail2mouseketeer.com","mail2movies.com","mail2mozambique.com","mail2mp3.com","mail2mrright.com","mail2msright.com","mail2museum.com","mail2music.com","mail2musician.com","mail2muslim.com","mail2my.com","mail2myboat.com","mail2mycar.com","mail2mycell.com","mail2mygsm.com","mail2mylaptop.com","mail2mymac.com","mail2mypager.com","mail2mypalm.com","mail2mypc.com","mail2myphone.com","mail2myplane.com","mail2namibia.com","mail2nancy.com","mail2nasdaq.com","mail2nathan.com","mail2nauru.com","mail2navy.com","mail2neal.com","mail2nebraska.com","mail2ned.com","mail2neil.com","mail2nelson.com","mail2nemesis.com","mail2nepal.com","mail2netherlands.com","mail2network.com","mail2nevada.com","mail2newhampshire.com","mail2newjersey.com","mail2newmexico.com","mail2newyork.com","mail2newzealand.com","mail2nicaragua.com","mail2nick.com","mail2nicole.com","mail2niger.com","mail2nigeria.com","mail2nike.com","mail2no.com","mail2noah.com","mail2noel.com","mail2noelle.com","mail2normal.com","mail2norman.com","mail2northamerica.com","mail2northcarolina.com","mail2northdakota.com","mail2northpole.com","mail2norway.com","mail2notus.com","mail2noway.com","mail2nowhere.com","mail2nuclear.com","mail2nun.com","mail2ny.com","mail2oasis.com","mail2oceanographer.com","mail2ohio.com","mail2ok.com","mail2oklahoma.com","mail2oliver.com","mail2oman.com","mail2one.com","mail2onfire.com","mail2online.com","mail2oops.com","mail2open.com","mail2ophthalmologist.com","mail2optometrist.com","mail2oregon.com","mail2oscars.com","mail2oslo.com","mail2painter.com","mail2pakistan.com","mail2palau.com","mail2pan.com","mail2panama.com","mail2paraguay.com","mail2paralegal.com","mail2paris.com","mail2park.com","mail2parker.com","mail2party.com","mail2passion.com","mail2pat.com","mail2patricia.com","mail2patrick.com","mail2patty.com","mail2paul.com","mail2paula.com","mail2pay.com","mail2peace.com","mail2pediatrician.com","mail2peggy.com","mail2pennsylvania.com","mail2perry.com","mail2persephone.com","mail2persian.com","mail2peru.com","mail2pete.com","mail2peter.com","mail2pharmacist.com","mail2phil.com","mail2philippines.com","mail2phoenix.com","mail2phonecall.com","mail2phyllis.com","mail2pickup.com","mail2pilot.com","mail2pisces.com","mail2planet.com","mail2platinum.com","mail2plato.com","mail2pluto.com","mail2pm.com","mail2podiatrist.com","mail2poet.com","mail2poland.com","mail2policeman.com","mail2policewoman.com","mail2politician.com","mail2pop.com","mail2pope.com","mail2popular.com","mail2portugal.com","mail2poseidon.com","mail2potatohead.com","mail2power.com","mail2presbyterian.com","mail2president.com","mail2priest.com","mail2prince.com","mail2princess.com","mail2producer.com","mail2professor.com","mail2protect.com","mail2psychiatrist.com","mail2psycho.com","mail2psychologist.com","mail2qatar.com","mail2queen.com","mail2rabbi.com","mail2race.com","mail2racer.com","mail2rachel.com","mail2rage.com","mail2rainmaker.com","mail2ralph.com","mail2randy.com","mail2rap.com","mail2rare.com","mail2rave.com","mail2ray.com","mail2raymond.com","mail2realtor.com","mail2rebecca.com","mail2recruiter.com","mail2recycle.com","mail2redhead.com","mail2reed.com","mail2reggie.com","mail2register.com","mail2rent.com","mail2republican.com","mail2resort.com","mail2rex.com","mail2rhodeisland.com","mail2rich.com","mail2richard.com","mail2ricky.com","mail2ride.com","mail2riley.com","mail2rita.com","mail2rob.com","mail2robert.com","mail2roberta.com","mail2robin.com","mail2rock.com","mail2rocker.com","mail2rod.com","mail2rodney.com","mail2romania.com","mail2rome.com","mail2ron.com","mail2ronald.com","mail2ronnie.com","mail2rose.com","mail2rosie.com","mail2roy.com","mail2rss.org","mail2rudy.com","mail2rugby.com","mail2runner.com","mail2russell.com","mail2russia.com","mail2russian.com","mail2rusty.com","mail2ruth.com","mail2rwanda.com","mail2ryan.com","mail2sa.com","mail2sabrina.com","mail2safe.com","mail2sagittarius.com","mail2sail.com","mail2sailor.com","mail2sal.com","mail2salaam.com","mail2sam.com","mail2samantha.com","mail2samoa.com","mail2samurai.com","mail2sandra.com","mail2sandy.com","mail2sanfrancisco.com","mail2sanmarino.com","mail2santa.com","mail2sara.com","mail2sarah.com","mail2sat.com","mail2saturn.com","mail2saudi.com","mail2saudiarabia.com","mail2save.com","mail2savings.com","mail2school.com","mail2scientist.com","mail2scorpio.com","mail2scott.com","mail2sean.com","mail2search.com","mail2seattle.com","mail2secretagent.com","mail2senate.com","mail2senegal.com","mail2sensual.com","mail2seth.com","mail2sevenseas.com","mail2sexy.com","mail2seychelles.com","mail2shane.com","mail2sharon.com","mail2shawn.com","mail2ship.com","mail2shirley.com","mail2shoot.com","mail2shuttle.com","mail2sierraleone.com","mail2simon.com","mail2singapore.com","mail2single.com","mail2site.com","mail2skater.com","mail2skier.com","mail2sky.com","mail2sleek.com","mail2slim.com","mail2slovakia.com","mail2slovenia.com","mail2smile.com","mail2smith.com","mail2smooth.com","mail2soccer.com","mail2soccerfan.com","mail2socialist.com","mail2soldier.com","mail2somalia.com","mail2son.com","mail2song.com","mail2sos.com","mail2sound.com","mail2southafrica.com","mail2southamerica.com","mail2southcarolina.com","mail2southdakota.com","mail2southkorea.com","mail2southpole.com","mail2spain.com","mail2spanish.com","mail2spare.com","mail2spectrum.com","mail2splash.com","mail2sponsor.com","mail2sports.com","mail2srilanka.com","mail2stacy.com","mail2stan.com","mail2stanley.com","mail2star.com","mail2state.com","mail2stephanie.com","mail2steve.com","mail2steven.com","mail2stewart.com","mail2stlouis.com","mail2stock.com","mail2stockholm.com","mail2stockmarket.com","mail2storage.com","mail2store.com","mail2strong.com","mail2student.com","mail2studio.com","mail2studio54.com","mail2stuntman.com","mail2subscribe.com","mail2sudan.com","mail2superstar.com","mail2surfer.com","mail2suriname.com","mail2susan.com","mail2suzie.com","mail2swaziland.com","mail2sweden.com","mail2sweetheart.com","mail2swim.com","mail2swimmer.com","mail2swiss.com","mail2switzerland.com","mail2sydney.com","mail2sylvia.com","mail2syria.com","mail2taboo.com","mail2taiwan.com","mail2tajikistan.com","mail2tammy.com","mail2tango.com","mail2tanya.com","mail2tanzania.com","mail2tara.com","mail2taurus.com","mail2taxi.com","mail2taxidermist.com","mail2taylor.com","mail2taz.com","mail2teacher.com","mail2technician.com","mail2ted.com","mail2telephone.com","mail2teletubbie.com","mail2tenderness.com","mail2tennessee.com","mail2tennis.com","mail2tennisfan.com","mail2terri.com","mail2terry.com","mail2test.com","mail2texas.com","mail2thailand.com","mail2therapy.com","mail2think.com","mail2tickets.com","mail2tiffany.com","mail2tim.com","mail2time.com","mail2timothy.com","mail2tina.com","mail2titanic.com","mail2toby.com","mail2todd.com","mail2togo.com","mail2tom.com","mail2tommy.com","mail2tonga.com","mail2tony.com","mail2touch.com","mail2tourist.com","mail2tracey.com","mail2tracy.com","mail2tramp.com","mail2travel.com","mail2traveler.com","mail2travis.com","mail2trekkie.com","mail2trex.com","mail2triallawyer.com","mail2trick.com","mail2trillionaire.com","mail2troy.com","mail2truck.com","mail2trump.com","mail2try.com","mail2tunisia.com","mail2turbo.com","mail2turkey.com","mail2turkmenistan.com","mail2tv.com","mail2tycoon.com","mail2tyler.com","mail2u4me.com","mail2uae.com","mail2uganda.com","mail2uk.com","mail2ukraine.com","mail2uncle.com","mail2unsubscribe.com","mail2uptown.com","mail2uruguay.com","mail2usa.com","mail2utah.com","mail2uzbekistan.com","mail2v.com","mail2vacation.com","mail2valentines.com","mail2valerie.com","mail2valley.com","mail2vamoose.com","mail2vanessa.com","mail2vanuatu.com","mail2venezuela.com","mail2venous.com","mail2venus.com","mail2vermont.com","mail2vickie.com","mail2victor.com","mail2victoria.com","mail2vienna.com","mail2vietnam.com","mail2vince.com","mail2virginia.com","mail2virgo.com","mail2visionary.com","mail2vodka.com","mail2volleyball.com","mail2waiter.com","mail2wallstreet.com","mail2wally.com","mail2walter.com","mail2warren.com","mail2washington.com","mail2wave.com","mail2way.com","mail2waycool.com","mail2wayne.com","mail2webmaster.com","mail2webtop.com","mail2webtv.com","mail2weird.com","mail2wendell.com","mail2wendy.com","mail2westend.com","mail2westvirginia.com","mail2whether.com","mail2whip.com","mail2white.com","mail2whitehouse.com","mail2whitney.com","mail2why.com","mail2wilbur.com","mail2wild.com","mail2willard.com","mail2willie.com","mail2wine.com","mail2winner.com","mail2wired.com","mail2wisconsin.com","mail2woman.com","mail2wonder.com","mail2world.com","mail2worship.com","mail2wow.com","mail2www.com","mail2wyoming.com","mail2xfiles.com","mail2xox.com","mail2yachtclub.com","mail2yahalla.com","mail2yemen.com","mail2yes.com","mail2yugoslavia.com","mail2zack.com","mail2zambia.com","mail2zenith.com","mail2zephir.com","mail2zeus.com","mail2zipper.com","mail2zoo.com","mail2zoologist.com","mail2zurich.com","mail3000.com","mail333.com","mail4trash.com","mail4u.info","mail8.com","mailandftp.com","mailandnews.com","mailas.com","mailasia.com","mailbidon.com","mailbiz.biz","mailblocks.com","mailbolt.com","mailbomb.net","mailboom.com","mailbox.as","mailbox.co.za","mailbox.gr","mailbox.hu","mailbox72.biz","mailbox80.biz","mailbr.com.br","mailbucket.org","mailc.net","mailcan.com","mailcat.biz","mailcatch.com","mailcc.com","mailchoose.co","mailcity.com","mailclub.fr","mailclub.net","mailde.de","mailde.info","maildrop.cc","maildrop.gq","maildx.com","mailed.ro","maileimer.de","mailexcite.com","mailexpire.com","mailfa.tk","mailfly.com","mailforce.net","mailforspam.com","mailfree.gq","mailfreeonline.com","mailfreeway.com","mailfs.com","mailftp.com","mailgate.gr","mailgate.ru","mailgenie.net","mailguard.me","mailhaven.com","mailhood.com","mailimate.com","mailin8r.com","mailinatar.com","mailinater.com","mailinator.com","mailinator.net","mailinator.org","mailinator.us","mailinator2.com","mailinblack.com","mailincubator.com","mailingaddress.org","mailingweb.com","mailisent.com","mailismagic.com","mailite.com","mailmate.com","mailme.dk","mailme.gq","mailme.ir","mailme.lv","mailme24.com","mailmetrash.com","mailmight.com","mailmij.nl","mailmoat.com","mailms.com","mailnator.com","mailnesia.com","mailnew.com","mailnull.com","mailops.com","mailorg.org","mailoye.com","mailpanda.com","mailpick.biz","mailpokemon.com","mailpost.zzn.com","mailpride.com","mailproxsy.com","mailpuppy.com","mailquack.com","mailrock.biz","mailroom.com","mailru.com","mailsac.com","mailscrap.com","mailseal.de","mailsent.net","mailserver.ru","mailservice.ms","mailshell.com","mailshuttle.com","mailsiphon.com","mailslapping.com","mailsnare.net","mailstart.com","mailstartplus.com","mailsurf.com","mailtag.com","mailtemp.info","mailto.de","mailtome.de","mailtothis.com","mailtrash.net","mailtv.net","mailtv.tv","mailueberfall.de","mailup.net","mailwire.com","mailworks.org","mailzi.ru","mailzilla.com","mailzilla.org","makemetheking.com","maktoob.com","malayalamtelevision.net","malayalapathram.com","male.ru","maltesemail.com","mamber.net","manager.de","manager.in.th","mancity.net","manlymail.net","mantrafreenet.com","mantramail.com","mantraonline.com","manutdfans.com","manybrain.com","marchmail.com","marfino.net","margarita.ru","mariah-carey.ml.org","mariahc.com","marijuana.com","marijuana.nl","marketing.lu","marketingfanatic.com","marketweighton.com","married-not.com","marriedandlovingit.com","marry.ru","marsattack.com","martindalemail.com","martinguerre.net","mash4077.com","masrawy.com","matmail.com","mauimail.com","mauritius.com","maximumedge.com","maxleft.com","maxmail.co.uk","mayaple.ru","mbox.com.au","mbx.cc","mchsi.com","mcrmail.com","me-mail.hu","me.com","meanpeoplesuck.com","meatismurder.net","medical.net.au","medmail.com","medscape.com","meetingmall.com","mega.zik.dj","megago.com","megamail.pt","megapoint.com","mehrani.com","mehtaweb.com","meine-dateien.info","meine-diashow.de","meine-fotos.info","meine-urlaubsfotos.de","meinspamschutz.de","mekhong.com","melodymail.com","meloo.com","meltmail.com","members.student.com","menja.net","merda.flu.cc","merda.igg.biz","merda.nut.cc","merda.usa.cc","merseymail.com","mesra.net","message.hu","message.myspace.com","messagebeamer.de","messages.to","messagez.com","metacrawler.com","metalfan.com","metaping.com","metta.lk","mexicomail.com","mezimages.net","mfsa.ru","miatadriver.com","mierdamail.com","miesto.sk","mighty.co.za","migmail.net","migmail.pl","migumail.com","miho-nakayama.com","mikrotamanet.com","millionaireintraining.com","millionairemail.com","milmail.com","milmail.com15","mindless.com","mindspring.com","minermail.com","mini-mail.com","minister.com","ministry-of-silly-walks.de","mintemail.com","misery.net","misterpinball.de","mit.tc","mittalweb.com","mixmail.com","mjfrogmail.com","ml1.net","mlanime.com","mlb.bounce.ed10.net","mm.st","mmail.com","mns.ru","mo3gov.net","moakt.com","mobico.ru","mobilbatam.com","mobileninja.co.uk","mochamail.com","modemnet.net","modernenglish.com","modomail.com","mohammed.com","mohmal.com","moldova.cc","moldova.com","moldovacc.com","mom-mail.com","momslife.com","moncourrier.fr.nf","monemail.com","monemail.fr.nf","money.net","mongol.net","monmail.fr.nf","monsieurcinema.com","montevideo.com.uy","monumentmail.com","moomia.com","moonman.com","moose-mail.com","mor19.uu.gl","mortaza.com","mosaicfx.com","moscowmail.com","mosk.ru","most-wanted.com","mostlysunny.com","motorcyclefan.net","motormania.com","movemail.com","movieemail.net","movieluver.com","mox.pp.ua","mozartmail.com","mozhno.net","mp3haze.com","mp4.it","mr-potatohead.com","mrpost.com","mrspender.com","mscold.com","msgbox.com","msn.cn","msn.com","msn.nl","msx.ru","mt2009.com","mt2014.com","mt2015.com","mt2016.com","mttestdriver.com","muehlacker.tk","multiplechoices","mundomail.net","munich.com","music.com","music.com19","music.maigate.ru","musician.com","musician.org","musicscene.org","muskelshirt.de","muslim.com","muslimemail.com","muslimsonline.com","mutantweb.com","mvrht.com","my.com","my10minutemail.com","mybox.it","mycabin.com","mycampus.com","mycard.net.ua","mycity.com","mycleaninbox.net","mycool.com","mydomain.com","mydotcomaddress.com","myfairpoint.net","myfamily.com","myfastmail.com","myfunnymail.com","mygo.com","myiris.com","myjazzmail.com","mymac.ru","mymacmail.com","mymail-in.net","mymail.ro","mynamedot.com","mynet.com","mynetaddress.com","mynetstore.de","myotw.net","myownemail.com","myownfriends.com","mypacks.net","mypad.com","mypartyclip.de","mypersonalemail.com","myphantomemail.com","myplace.com","myrambler.ru","myrealbox.com","myremarq.com","mysamp.de","myself.com","myspaceinc.net","myspamless.com","mystupidjob.com","mytemp.email","mytempemail.com","mytempmail.com","mythirdage.com","mytrashmail.com","myway.com","myworldmail.com","n2.com","n2baseball.com","n2business.com","n2mail.com","n2soccer.com","n2software.com","nabc.biz","nabuma.com","nafe.com","nagarealm.com","nagpal.net","nakedgreens.com","name.com","nameplanet.com","nanaseaikawa.com","nandomail.com","naplesnews.net","naseej.com","nate.com","nativestar.net","nativeweb.net","naui.net","naver.com","navigator.lv","navy.org","naz.com","nc.rr.com","nc.ru","nchoicemail.com","neeva.net","nekto.com","nekto.net","nekto.ru","nemra1.com","nenter.com","neo.rr.com","neomailbox.com","nepwk.com","nervhq.org","nervmich.net","nervtmich.net","net-c.be","net-c.ca","net-c.cat","net-c.com","net-c.es","net-c.fr","net-c.it","net-c.lu","net-c.nl","net-c.pl","net-pager.net","net-shopping.com","net.tf","net4b.pt","net4you.at","netaddres.ru","netaddress.ru","netbounce.com","netbroadcaster.com","netby.dk","netc.eu","netc.fr","netc.it","netc.lu","netc.pl","netcenter-vn.net","netcity.ru","netcmail.com","netcourrier.com","netexecutive.com","netexpressway.com","netfirms.com","netgenie.com","netian.com","netizen.com.ar","netkushi.com","netlane.com","netlimit.com","netmail.kg","netmails.com","netmails.net","netman.ru","netmanor.com","netmongol.com","netnet.com.sg","netnoir.net","netpiper.com","netposta.net","netradiomail.com","netralink.com","netscape.net","netscapeonline.co.uk","netspace.net.au","netspeedway.com","netsquare.com","netster.com","nettaxi.com","nettemail.com","netterchef.de","netti.fi","netvigator.com","netzero.com","netzero.net","netzidiot.de","netzoola.com","neue-dateien.de","neuf.fr","neuro.md","neustreet.com","neverbox.com","newap.ru","newarbat.net","newmail.com","newmail.net","newmail.ru","newsboysmail.com","newyork.com","newyorkcity.com","nextmail.ru","nexxmail.com","nfmail.com","ngs.ru","nhmail.com","nice-4u.com","nicebush.com","nicegal.com","nicholastse.net","nicolastse.com","niepodam.pl","nightimeuk.com","nightmail.com","nightmail.ru","nikopage.com","nikulino.net","nimail.com","nincsmail.hu","ninfan.com","nirvanafan.com","nm.ru","nmail.cf","nnh.com","nnov.ru","no-spam.ws","no4ma.ru","noavar.com","noblepioneer.com","nogmailspam.info","nomail.pw","nomail.xl.cx","nomail2me.com","nomorespamemails.com","nonpartisan.com","nonspam.eu","nonspammer.de","nonstopcinema.com","norika-fujiwara.com","norikomail.com","northgates.net","nospam.ze.tc","nospam4.us","nospamfor.us","nospammail.net","nospamthanks.info","notmailinator.com","notsharingmy.info","notyouagain.com","novogireevo.net","novokosino.net","nowhere.org","nowmymail.com","ntelos.net","ntlhelp.net","ntlworld.com","ntscan.com","null.net","nullbox.info","numep.ru","nur-fuer-spam.de","nurfuerspam.de","nus.edu.sg","nuvse.com","nwldx.com","nxt.ru","ny.com","nybce.com","nybella.com","nyc.com","nycmail.com","nz11.com","nzoomail.com","o-tay.com","o2.co.uk","o2.pl","oaklandas-fan.com","oath.com","objectmail.com","obobbo.com","oceanfree.net","ochakovo.net","odaymail.com","oddpost.com","odmail.com","odnorazovoe.ru","office-dateien.de","office-email.com","officedomain.com","offroadwarrior.com","oi.com.br","oicexchange.com","oikrach.com","ok.kz","ok.net","ok.ru","okbank.com","okhuman.com","okmad.com","okmagic.com","okname.net","okuk.com","oldbuthealthy.com","oldies1041.com","oldies104mail.com","ole.com","olemail.com","oligarh.ru","olympist.net","olypmall.ru","omaninfo.com","omen.ru","ondikoi.com","onebox.com","onenet.com.ar","oneoffemail.com","oneoffmail.com","onet.com.pl","onet.eu","onet.pl","onewaymail.com","oninet.pt","onlatedotcom.info","online.de","online.ie","online.ms","online.nl","online.ru","onlinecasinogamblings.com","onlinewiz.com","onmicrosoft.com","onmilwaukee.com","onobox.com","onvillage.com","oopi.org","op.pl","opayq.com","opendiary.com","openmailbox.org","operafan.com","operamail.com","opoczta.pl","optician.com","optonline.net","optusnet.com.au","orange.fr","orange.net","orbitel.bg","ordinaryamerican.net","orgmail.net","orthodontist.net","osite.com.br","oso.com","otakumail.com","otherinbox.com","our-computer.com","our-office.com","our.st","ourbrisbane.com","ourklips.com","ournet.md","outel.com","outgun.com","outlawspam.com","outlook.at","outlook.be","outlook.cl","outlook.co.id","outlook.co.il","outlook.co.nz","outlook.co.th","outlook.com","outlook.com.au","outlook.com.br","outlook.com.gr","outlook.com.pe","outlook.com.tr","outlook.com.vn","outlook.cz","outlook.de","outlook.dk","outlook.es","outlook.fr","outlook.hu","outlook.ie","outlook.in","outlook.it","outlook.jp","outlook.kr","outlook.lv","outlook.my","outlook.nl","outlook.ph","outlook.pt","outlook.sa","outlook.sg","outlook.sk","outloook.com","over-the-rainbow.com","ovi.com","ovpn.to","owlpic.com","ownmail.net","ozbytes.net.au","ozemail.com.au","ozz.ru","pacbell.net","pacific-ocean.com","pacific-re.com","pacificwest.com","packersfan.com","pagina.de","pagons.org","paidforsurf.com","pakistanmail.com","pakistanoye.com","palestinemail.com","pancakemail.com","pandawa.com","pandora.be","paradiseemail.com","paris.com","parkjiyoon.com","parrot.com","parsmail.com","partlycloudy.com","partybombe.de","partyheld.de","partynight.at","parvazi.com","passwordmail.com","pathfindermail.com","patmail.com","patra.net","pconnections.net","pcpostal.com","pcsrock.com","pcusers.otherinbox.com","peachworld.com","pechkin.ru","pediatrician.com","pekklemail.com","pemail.net","penpen.com","peoplepc.com","peopleweb.com","pepbot.com","perfectmail.com","perovo.net","perso.be","personal.ro","personales.com","petlover.com","petml.com","petr.ru","pettypool.com","pezeshkpour.com","pfui.ru","phayze.com","phone.net","photo-impact.eu","photographer.net","phpbb.uu.gl","phreaker.net","phus8kajuspa.cu.cc","physicist.net","pianomail.com","pickupman.com","picusnet.com","piercedallover.com","pigeonportal.com","pigmail.net","pigpig.net","pilotemail.com","pimagop.com","pinoymail.com","piracha.net","pisem.net","pjjkp.com","planet-mail.com","planet.nl","planetaccess.com","planetall.com","planetarymotion.net","planetdirect.com","planetearthinter.net","planetmail.com","planetmail.net","planetout.com","plasa.com","playersodds.com","playful.com","playstation.sony.com","plexolan.de","pluno.com","plus.com","plus.google.com","plusmail.com.br","pmail.net","pobox.com","pobox.hu","pobox.ru","pobox.sk","pochta.by","pochta.ru","pochta.ws","pochtamt.ru","poczta.fm","poczta.onet.pl","poetic.com","pokemail.net","pokemonpost.com","pokepost.com","polandmail.com","polbox.com","policeoffice.com","politician.com","politikerclub.de","polizisten-duzer.de","polyfaust.com","poofy.org","poohfan.com","pookmail.com","pool-sharks.com","poond.com","pop3.ru","popaccount.com","popmail.com","popsmail.com","popstar.com","populus.net","portableoffice.com","portugalmail.com","portugalmail.pt","portugalnet.com","positive-thinking.com","post.com","post.cz","post.sk","posta.net","posta.ro","posta.rosativa.ro.org","postaccesslite.com","postafiok.hu","postafree.com","postaweb.com","poste.it","postfach.cc","postinbox.com","postino.ch","postino.it","postmark.net","postmaster.co.uk","postmaster.twitter.com","postpro.net","pousa.com","powerdivas.com","powerfan.com","pp.inet.fi","praize.com","pray247.com","predprinimatel.ru","premium-mail.fr","premiumproducts.com","premiumservice.com","prepodavatel.ru","presidency.com","presnya.net","press.co.jp","prettierthanher.com","priest.com","primposta.com","primposta.hu","printesamargareta.ro","privacy.net","privatdemail.net","privy-mail.com","privymail.de","pro.hu","probemail.com","prodigy.net","prodigy.net.mx","professor.ru","progetplus.it","programist.ru","programmer.net","programozo.hu","proinbox.com","project2k.com","prokuratura.ru","prolaunch.com","promessage.com","prontomail.com","prontomail.compopulus.net","protestant.com","protonmail.com","proxymail.eu","prtnx.com","prydirect.info","psv-supporter.com","ptd.net","public-files.de","public.usa.com","publicist.com","pulp-fiction.com","punkass.com","puppy.com.my","purinmail.com","purpleturtle.com","put2.net","putthisinyourspamdatabase.com","pwrby.com","q.com","qatar.io","qatarmail.com","qdice.com","qip.ru","qmail.com","qprfans.com","qq.com","qrio.com","quackquack.com","quake.ru","quakemail.com","qualityservice.com","quantentunnel.de","qudsmail.com","quepasa.com","quickhosts.com","quickinbox.com","quickmail.nl","quickmail.ru","quicknet.nl","quickwebmail.com","quiklinks.com","quikmail.com","qv7.info","qwest.net","qwestoffice.net","r-o-o-t.com","r7.com","raakim.com","racedriver.com","racefanz.com","racingfan.com.au","racingmail.com","radicalz.com","radiku.ye.vc","radiologist.net","ragingbull.com","ralib.com","rambler.ru","ranmamail.com","rastogi.net","ratt-n-roll.com","rattle-snake.com","raubtierbaendiger.de","ravearena.com","ravefan.com","ravemail.co.za","ravemail.com","razormail.com","rccgmail.org","rcn.com","rcpt.at","realemail.net","realestatemail.net","reality-concept.club","reallyfast.biz","reallyfast.info","reallymymail.com","realradiomail.com","realtyagent.com","realtyalerts.ca","reborn.com","recode.me","reconmail.com","recursor.net","recycledmail.com","recycler.com","recyclermail.com","rediff.com","rediffmail.com","rediffmailpro.com","rednecks.com","redseven.de","redsfans.com","redwhitearmy.com","regbypass.com","reggaefan.com","reggafan.com","regiononline.com","registerednurses.com","regspaces.tk","reincarnate.com","relia.com","reliable-mail.com","religious.com","remail.ga","renren.com","repairman.com","reply.hu","reply.ticketmaster.com","represantive.com","representative.com","rescueteam.com","resgedvgfed.tk","resource.calendar.google.com","resumemail.com","retailfan.com","rexian.com","rezai.com","rhyta.com","richmondhill.com","rickymail.com","rin.ru","ring.by","riopreto.com.br","rklips.com","rmqkr.net","rn.com","ro.ru","roadrunner.com","roanokemail.com","rock.com","rocketmail.com","rocketship.com","rockfan.com","rodrun.com","rogers.com","rojname.com","rol.ro","rome.com","romymichele.com","roosh.com","rootprompt.org","rotfl.com","roughnet.com","royal.net","rpharmacist.com","rr.com","rrohio.com","rsub.com","rt.nl","rtrtr.com","ru.ru","rubyridge.com","runbox.com","rushpost.com","ruttolibero.com","rvshop.com","rxdoc.biz","s-mail.com","s0ny.net","sabreshockey.com","sacbeemail.com","saeuferleber.de","safarimail.com","safe-mail.net","safersignup.de","safetymail.info","safetypost.de","safrica.com","sagra.lu","sagra.lu.lu","sagra.lumarketing.lu","sags-per-mail.de","sailormoon.com","saint-mike.org","saintly.com","saintmail.net","sale-sale-sale.com","salehi.net","salesperson.net","samerica.com","samilan.net","samiznaetekogo.net","sammimail.com","sanchezsharks.com","sandelf.de","sanfranmail.com","sanook.com","sanriotown.com","santanmail.com","sapo.pt","sativa.ro.org","saturnfans.com","saturnperformance.com","saudia.com","savecougars.com","savelife.ml","saveowls.com","sayhi.net","saynotospams.com","sbcglbal.net","sbcglobal.com","sbcglobal.net","scandalmail.com","scanova.in","scanova.io","scarlet.nl","scfn.net","schafmail.de","schizo.com","schmusemail.de","schoolemail.com","schoolmail.com","schoolsucks.com","schreib-doch-mal-wieder.de","schrott-email.de","schweiz.org","sci.fi","science.com.au","scientist.com","scifianime.com","scotland.com","scotlandmail.com","scottishmail.co.uk","scottishtories.com","scottsboro.org","scrapbookscrapbook.com","scubadiving.com","seanet.com","search.ua","search417.com","searchwales.com","sebil.com","seckinmail.com","secret-police.com","secretarias.com","secretary.net","secretemail.de","secretservices.net","secure-mail.biz","secure-mail.cc","seductive.com","seekstoyboy.com","seguros.com.br","sekomaonline.com","selfdestructingmail.com","sellingspree.com","send.hu","sendmail.ru","sendme.cz","sendspamhere.com","senseless-entertainment.com","sent.as","sent.at","sent.com","sentrismail.com","serga.com.ar","servemymail.com","servermaps.net","services391.com","sesmail.com","sexmagnet.com","seznam.cz","sfr.fr","shahweb.net","shaniastuff.com","shared-files.de","sharedmailbox.org","sharewaredevelopers.com","sharklasers.com","sharmaweb.com","shaw.ca","she.com","shellov.net","shieldedmail.com","shieldemail.com","shiftmail.com","shinedyoureyes.com","shitaway.cf","shitaway.cu.cc","shitaway.ga","shitaway.gq","shitaway.ml","shitaway.tk","shitaway.usa.cc","shitmail.de","shitmail.me","shitmail.org","shitware.nl","shmeriously.com","shockinmytown.cu.cc","shootmail.com","shortmail.com","shortmail.net","shotgun.hu","showfans.com","showslow.de","shqiptar.eu","shuf.com","sialkotcity.com","sialkotian.com","sialkotoye.com","sibmail.com","sify.com","sigaret.net","silkroad.net","simbamail.fm","sina.cn","sina.com","sinamail.com","singapore.com","singles4jesus.com","singmail.com","singnet.com.sg","singpost.com","sinnlos-mail.de","sirindia.com","siteposter.net","skafan.com","skeefmail.com","skim.com","skizo.hu","skrx.tk","skunkbox.com","sky.com","skynet.be","slamdunkfan.com","slapsfromlastnight.com","slaskpost.se","slave-auctions.net","slickriffs.co.uk","slingshot.com","slippery.email","slipry.net","slo.net","slotter.com","sm.westchestergov.com","smap.4nmv.ru","smapxsmap.net","smashmail.de","smellfear.com","smellrear.com","smileyface.comsmithemail.net","sminkymail.com","smoothmail.com","sms.at","smtp.ru","snail-mail.net","snail-mail.ney","snakebite.com","snakemail.com","sndt.net","sneakemail.com","sneakmail.de","snet.net","sniper.hu","snkmail.com","snoopymail.com","snowboarding.com","snowdonia.net","so-simple.org","socamail.com","socceraccess.com","socceramerica.net","soccermail.com","soccermomz.com","social-mailer.tk","socialworker.net","sociologist.com","sofimail.com","sofort-mail.de","sofortmail.de","softhome.net","sogetthis.com","sogou.com","sohu.com","sokolniki.net","sol.dk","solar-impact.pro","solcon.nl","soldier.hu","solution4u.com","solvemail.info","songwriter.net","sonnenkinder.org","soodomail.com","soodonims.com","soon.com","soulfoodcookbook.com","soundofmusicfans.com","southparkmail.com","sovsem.net","sp.nl","space-bank.com","space-man.com","space-ship.com","space-travel.com","space.com","spaceart.com","spacebank.com","spacemart.com","spacetowns.com","spacewar.com","spainmail.com","spam.2012-2016.ru","spam4.me","spamail.de","spamarrest.com","spamavert.com","spambob.com","spambob.net","spambob.org","spambog.com","spambog.de","spambog.net","spambog.ru","spambooger.com","spambox.info","spambox.us","spamcannon.com","spamcannon.net","spamcero.com","spamcon.org","spamcorptastic.com","spamcowboy.com","spamcowboy.net","spamcowboy.org","spamday.com","spamdecoy.net","spameater.com","spameater.org","spamex.com","spamfree.eu","spamfree24.com","spamfree24.de","spamfree24.info","spamfree24.net","spamfree24.org","spamgoes.in","spamgourmet.com","spamgourmet.net","spamgourmet.org","spamherelots.com","spamhereplease.com","spamhole.com","spamify.com","spaminator.de","spamkill.info","spaml.com","spaml.de","spammotel.com","spamobox.com","spamoff.de","spamslicer.com","spamspot.com","spamstack.net","spamthis.co.uk","spamtroll.net","spankthedonkey.com","spartapiet.com","spazmail.com","speed.1s.fr","speedemail.net","speedpost.net","speedrules.com","speedrulz.com","speedy.com.ar","speedymail.org","sperke.net","spils.com","spinfinder.com","spiritseekers.com","spl.at","spoko.pl","spoofmail.de","sportemail.com","sportmail.ru","sportsmail.com","sporttruckdriver.com","spray.no","spray.se","spybox.de","spymac.com","sraka.xyz","srilankan.net","ssl-mail.com","st-davids.net","stade.fr","stalag13.com","standalone.net","starbuzz.com","stargateradio.com","starmail.com","starmail.org","starmedia.com","starplace.com","starspath.com","start.com.au","starting-point.com","startkeys.com","startrekmail.com","starwars-fans.com","stealthmail.com","stillchronic.com","stinkefinger.net","stipte.nl","stockracer.com","stockstorm.com","stoned.com","stones.com","stop-my-spam.pp.ua","stopdropandroll.com","storksite.com","streber24.de","streetwisemail.com","stribmail.com","strompost.com","strongguy.com","student.su","studentcenter.org","stuffmail.de","subnetwork.com","subram.com","sudanmail.net","sudolife.me","sudolife.net","sudomail.biz","sudomail.com","sudomail.net","sudoverse.com","sudoverse.net","sudoweb.net","sudoworld.com","sudoworld.net","sueddeutsche.de","suhabi.com","suisse.org","sukhumvit.net","sul.com.br","sunmail1.com","sunpoint.net","sunrise-sunset.com","sunsgame.com","sunumail.sn","suomi24.fi","super-auswahl.de","superdada.com","supereva.it","supergreatmail.com","supermail.ru","supermailer.jp","superman.ru","superposta.com","superrito.com","superstachel.de","surat.com","suremail.info","surf3.net","surfree.com","surfsupnet.net","surfy.net","surgical.net","surimail.com","survivormail.com","susi.ml","sviblovo.net","svk.jp","swbell.net","sweb.cz","swedenmail.com","sweetville.net","sweetxxx.de","swift-mail.com","swiftdesk.com","swingeasyhithard.com","swingfan.com","swipermail.zzn.com","swirve.com","swissinfo.org","swissmail.com","swissmail.net","switchboardmail.com","switzerland.org","sx172.com","sympatico.ca","syom.com","syriamail.com","t-online.de","t.psh.me","t2mail.com","tafmail.com","takoe.com","takoe.net","takuyakimura.com","talk21.com","talkcity.com","talkinator.com","talktalk.co.uk","tamb.ru","tamil.com","tampabay.rr.com","tangmonkey.com","tankpolice.com","taotaotano.com","tatanova.com","tattooedallover.com","tattoofanatic.com","tbwt.com","tcc.on.ca","tds.net","teacher.com","teachermail.net","teachers.org","teamdiscovery.com","teamtulsa.net","tech-center.com","tech4peace.org","techemail.com","techie.com","technisamail.co.za","technologist.com","technologyandstocks.com","techpointer.com","techscout.com","techseek.com","techsniper.com","techspot.com","teenagedirtbag.com","teewars.org","tele2.nl","telebot.com","telebot.net","telefonica.net","teleline.es","telenet.be","telepac.pt","telerymd.com","teleserve.dynip.com","teletu.it","teleworm.com","teleworm.us","telfort.nl","telfortglasvezel.nl","telinco.net","telkom.net","telpage.net","telstra.com","telstra.com.au","temp-mail.com","temp-mail.de","temp-mail.org","temp-mail.ru","temp.headstrong.de","tempail.com","tempe-mail.com","tempemail.biz","tempemail.co.za","tempemail.com","tempemail.net","tempinbox.co.uk","tempinbox.com","tempmail.eu","tempmail.it","tempmail.us","tempmail2.com","tempmaildemo.com","tempmailer.com","tempmailer.de","tempomail.fr","temporarioemail.com.br","temporaryemail.net","temporaryemail.us","temporaryforwarding.com","temporaryinbox.com","temporarymailaddress.com","tempthe.net","tempymail.com","temtulsa.net","tenchiclub.com","tenderkiss.com","tennismail.com","terminverpennt.de","terra.cl","terra.com","terra.com.ar","terra.com.br","terra.com.pe","terra.es","test.com","test.de","tfanus.com.er","tfbnw.net","tfz.net","tgasa.ru","tgma.ru","tgngu.ru","tgu.ru","thai.com","thaimail.com","thaimail.net","thanksnospam.info","thankyou2010.com","thc.st","the-african.com","the-airforce.com","the-aliens.com","the-american.com","the-animal.com","the-army.com","the-astronaut.com","the-beauty.com","the-big-apple.com","the-biker.com","the-boss.com","the-brazilian.com","the-canadian.com","the-canuck.com","the-captain.com","the-chinese.com","the-country.com","the-cowboy.com","the-davis-home.com","the-dutchman.com","the-eagles.com","the-englishman.com","the-fastest.net","the-fool.com","the-frenchman.com","the-galaxy.net","the-genius.com","the-gentleman.com","the-german.com","the-gremlin.com","the-hooligan.com","the-italian.com","the-japanese.com","the-lair.com","the-madman.com","the-mailinglist.com","the-marine.com","the-master.com","the-mexican.com","the-ministry.com","the-monkey.com","the-newsletter.net","the-pentagon.com","the-police.com","the-prayer.com","the-professional.com","the-quickest.com","the-russian.com","the-seasiders.com","the-snake.com","the-spaceman.com","the-stock-market.com","the-student.net","the-whitehouse.net","the-wild-west.com","the18th.com","thecoolguy.com","thecriminals.com","thedoghousemail.com","thedorm.com","theend.hu","theglobe.com","thegolfcourse.com","thegooner.com","theheadoffice.com","theinternetemail.com","thelanddownunder.com","thelimestones.com","themail.com","themillionare.net","theoffice.net","theplate.com","thepokerface.com","thepostmaster.net","theraces.com","theracetrack.com","therapist.net","thereisnogod.com","thesimpsonsfans.com","thestreetfighter.com","theteebox.com","thewatercooler.com","thewebpros.co.uk","thewizzard.com","thewizzkid.com","thexyz.ca","thexyz.cn","thexyz.com","thexyz.es","thexyz.fr","thexyz.in","thexyz.mobi","thexyz.net","thexyz.org","thezhangs.net","thirdage.com","thisgirl.com","thisisnotmyrealemail.com","thismail.net","thoic.com","thraml.com","thrott.com","throwam.com","throwawayemailaddress.com","thundermail.com","tibetemail.com","tidni.com","tilien.com","timein.net","timormail.com","tin.it","tipsandadvice.com","tiran.ru","tiscali.at","tiscali.be","tiscali.co.uk","tiscali.it","tiscali.lu","tiscali.se","tittbit.in","tizi.com","tkcity.com","tlcfan.com","tmail.ws","tmailinator.com","tmicha.net","toast.com","toke.com","tokyo.com","tom.com","toolsource.com","toomail.biz","toothfairy.com","topchat.com","topgamers.co.uk","topletter.com","topmail-files.de","topmail.com.ar","topranklist.de","topsurf.com","topteam.bg","toquedequeda.com","torba.com","torchmail.com","torontomail.com","tortenboxer.de","totalmail.com","totalmail.de","totalmusic.net","totalsurf.com","toughguy.net","townisp.com","tpg.com.au","tradermail.info","trainspottingfan.com","trash-amil.com","trash-mail.at","trash-mail.com","trash-mail.de","trash-mail.ga","trash-mail.ml","trash2009.com","trash2010.com","trash2011.com","trashdevil.com","trashdevil.de","trashemail.de","trashmail.at","trashmail.com","trashmail.de","trashmail.me","trashmail.net","trashmail.org","trashmailer.com","trashymail.com","trashymail.net","travel.li","trayna.com","trbvm.com","trbvn.com","trevas.net","trialbytrivia.com","trialmail.de","trickmail.net","trillianpro.com","trimix.cn","tritium.net","trjam.net","trmailbox.com","tropicalstorm.com","truckeremail.net","truckers.com","truckerz.com","truckracer.com","truckracers.com","trust-me.com","truth247.com","truthmail.com","tsamail.co.za","ttml.co.in","tulipsmail.net","tunisiamail.com","turboprinz.de","turboprinzessin.de","turkey.com","turual.com","tushino.net","tut.by","tvcablenet.be","tverskie.net","tverskoe.net","tvnet.lv","tvstar.com","twc.com","twcny.com","twentylove.com","twinmail.de","twinstarsmail.com","tx.rr.com","tycoonmail.com","tyldd.com","typemail.com","tyt.by","u14269.ml","u2club.com","ua.fm","uae.ac","uaemail.com","ubbi.com","ubbi.com.br","uboot.com","uggsrock.com","uk2.net","uk2k.com","uk2net.com","uk7.net","uk8.net","ukbuilder.com","ukcool.com","ukdreamcast.com","ukmail.org","ukmax.com","ukr.net","ukrpost.net","ukrtop.com","uku.co.uk","ultapulta.com","ultimatelimos.com","ultrapostman.com","umail.net","ummah.org","umpire.com","unbounded.com","underwriters.com","unforgettable.com","uni.de","uni.de.de","uni.demailto.de","unican.es","unihome.com","universal.pt","uno.ee","uno.it","unofree.it","unomail.com","unterderbruecke.de","uogtritons.com","uol.com.ar","uol.com.br","uol.com.co","uol.com.mx","uol.com.ve","uole.com","uole.com.ve","uolmail.com","uomail.com","upc.nl","upcmail.nl","upf.org","upliftnow.com","uplipht.com","uraniomail.com","ureach.com","urgentmail.biz","uroid.com","us.af","usa.com","usa.net","usaaccess.net","usanetmail.com","used-product.fr","userbeam.com","usermail.com","username.e4ward.com","userzap.com","usma.net","usmc.net","uswestmail.net","uymail.com","uyuyuy.com","uzhe.net","v-sexi.com","v8email.com","vaasfc4.tk","vahoo.com","valemail.net","valudeal.net","vampirehunter.com","varbizmail.com","vcmail.com","velnet.co.uk","velnet.com","velocall.com","veloxmail.com.br","venompen.com","verizon.net","verizonmail.com","verlass-mich-nicht.de","versatel.nl","verticalheaven.com","veryfast.biz","veryrealemail.com","veryspeedy.net","vfemail.net","vickaentb.tk","videotron.ca","viditag.com","viewcastmedia.com","viewcastmedia.net","vinbazar.com","violinmakers.co.uk","vip.126.com","vip.21cn.com","vip.citiz.net","vip.gr","vip.onet.pl","vip.qq.com","vip.sina.com","vipmail.ru","viralplays.com","virgilio.it","virgin.net","virginbroadband.com.au","virginmedia.com","virtual-mail.com","virtualactive.com","virtualguam.com","virtualmail.com","visitmail.com","visitweb.com","visto.com","visualcities.com","vivavelocity.com","vivianhsu.net","viwanet.ru","vjmail.com","vjtimail.com","vkcode.ru","vlcity.ru","vlmail.com","vnet.citiz.net","vnn.vn","vnukovo.net","vodafone.nl","vodafonethuis.nl","voila.fr","volcanomail.com","vollbio.de","volloeko.de","vomoto.com","voo.be","vorsicht-bissig.de","vorsicht-scharf.de","vote-democrats.com","vote-hillary.com","vote-republicans.com","vote4gop.org","votenet.com","vovan.ru","vp.pl","vpn.st","vr9.com","vsimcard.com","vubby.com","vyhino.net","w3.to","wahoye.com","walala.org","wales2000.net","walkmail.net","walkmail.ru","walla.co.il","wam.co.za","wanaboo.com","wanadoo.co.uk","wanadoo.es","wanadoo.fr","wapda.com","war-im-urlaub.de","warmmail.com","warpmail.net","warrior.hu","wasteland.rfc822.org","watchmail.com","waumail.com","wazabi.club","wbdet.com","wearab.net","web-contact.info","web-emailbox.eu","web-ideal.fr","web-mail.com.ar","web-mail.pp.ua","web-police.com","web.de","webaddressbook.com","webadicta.org","webave.com","webbworks.com","webcammail.com","webcity.ca","webcontact-france.eu","webdream.com","webemail.me","webemaillist.com","webinbox.com","webindia123.com","webjump.com","webm4il.info","webmail.bellsouth.net","webmail.blue","webmail.co.yu","webmail.co.za","webmail.fish","webmail.hu","webmail.lawyer","webmail.ru","webmail.wiki","webmails.com","webmailv.com","webname.com","webprogramming.com","webskulker.com","webstation.com","websurfer.co.za","webtopmail.com","webtribe.net","webuser.in","wee.my","weedmail.com","weekmail.com","weekonline.com","wefjo.grn.cc","weg-werf-email.de","wegas.ru","wegwerf-emails.de","wegwerfadresse.de","wegwerfemail.com","wegwerfemail.de","wegwerfmail.de","wegwerfmail.info","wegwerfmail.net","wegwerfmail.org","wegwerpmailadres.nl","wehshee.com","weibsvolk.de","weibsvolk.org","weinenvorglueck.de","welsh-lady.com","wesleymail.com","westnet.com","westnet.com.au","wetrainbayarea.com","wfgdfhj.tk","wh4f.org","whale-mail.com","whartontx.com","whatiaas.com","whatpaas.com","wheelweb.com","whipmail.com","whoever.com","wholefitness.com","whoopymail.com","whtjddn.33mail.com","whyspam.me","wickedmail.com","wickmail.net","wideopenwest.com","wildmail.com","wilemail.com","will-hier-weg.de","willhackforfood.biz","willselfdestruct.com","windowslive.com","windrivers.net","windstream.com","windstream.net","winemaven.info","wingnutz.com","winmail.com.au","winning.com","winrz.com","wir-haben-nachwuchs.de","wir-sind-cool.org","wirsindcool.de","witty.com","wiz.cc","wkbwmail.com","wmail.cf","wo.com.cn","woh.rr.com","wolf-web.com","wolke7.net","wollan.info","wombles.com","women-at-work.org","women-only.net","wonder-net.com","wongfaye.com","wooow.it","work4teens.com","worker.com","workmail.co.za","workmail.com","worldbreak.com","worldemail.com","worldmailer.com","worldnet.att.net","wormseo.cn","wosaddict.com","wouldilie.com","wovz.cu.cc","wow.com","wowgirl.com","wowmail.com","wowway.com","wp.pl","wptamail.com","wrestlingpages.com","wrexham.net","writeme.com","writemeback.com","writeremail.com","wronghead.com","wrongmail.com","wtvhmail.com","wwdg.com","www.com","www.e4ward.com","www.mailinator.com","www2000.net","wwwnew.eu","wx88.net","wxs.net","wyrm.supernews.com","x-mail.net","x-networks.net","x.ip6.li","x5g.com","xagloo.com","xaker.ru","xd.ae","xemaps.com","xents.com","xing886.uu.gl","xmail.com","xmaily.com","xmastime.com","xmenfans.com","xms.nl","xmsg.com","xoom.com","xoommail.com","xoxox.cc","xoxy.net","xpectmore.com","xpressmail.zzn.com","xs4all.nl","xsecurity.org","xsmail.com","xtra.co.nz","xtram.com","xuno.com","xww.ro","xy9ce.tk","xyz.am","xyzfree.net","xzapmail.com","y7mail.com","ya.ru","yada-yada.com","yaho.com","yahoo.ae","yahoo.at","yahoo.be","yahoo.ca","yahoo.ch","yahoo.cn","yahoo.co","yahoo.co.id","yahoo.co.il","yahoo.co.in","yahoo.co.jp","yahoo.co.kr","yahoo.co.nz","yahoo.co.th","yahoo.co.uk","yahoo.co.za","yahoo.com","yahoo.com.ar","yahoo.com.au","yahoo.com.br","yahoo.com.cn","yahoo.com.co","yahoo.com.hk","yahoo.com.is","yahoo.com.mx","yahoo.com.my","yahoo.com.ph","yahoo.com.ru","yahoo.com.sg","yahoo.com.tr","yahoo.com.tw","yahoo.com.vn","yahoo.cz","yahoo.de","yahoo.dk","yahoo.es","yahoo.fi","yahoo.fr","yahoo.gr","yahoo.hu","yahoo.ie","yahoo.in","yahoo.it","yahoo.jp","yahoo.net","yahoo.nl","yahoo.no","yahoo.pl","yahoo.pt","yahoo.ro","yahoo.ru","yahoo.se","yahoofs.com","yahoomail.com","yalla.com","yalla.com.lb","yalook.com","yam.com","yandex.com","yandex.mail","yandex.pl","yandex.ru","yandex.ua","yapost.com","yapped.net","yawmail.com","yclub.com","yeah.net","yebox.com","yeehaa.com","yehaa.com","yehey.com","yemenmail.com","yep.it","yepmail.net","yert.ye.vc","yesbox.net","yesey.net","yeswebmaster.com","ygm.com","yifan.net","ymail.com","ynnmail.com","yogamaven.com","yogotemail.com","yomail.info","yopmail.com","yopmail.fr","yopmail.net","yopmail.org","yopmail.pp.ua","yopolis.com","yopweb.com","youareadork.com","youmailr.com","youpy.com","your-house.com","your-mail.com","yourdomain.com","yourinbox.com","yourlifesucks.cu.cc","yourlover.net","yournightmare.com","yours.com","yourssincerely.com","yourteacher.net","yourwap.com","youthfire.com","youthpost.com","youvegotmail.net","yuuhuu.net","yuurok.com","yyhmail.com","z1p.biz","z6.com","z9mail.com","za.com","zahadum.com","zaktouni.fr","zcities.com","zdnetmail.com","zdorovja.net","zeeks.com","zeepost.nl","zehnminuten.de","zehnminutenmail.de","zensearch.com","zensearch.net","zerocrime.org","zetmail.com","zhaowei.net","zhouemail.510520.org","ziggo.nl","zing.vn","zionweb.org","zip.net","zipido.com","ziplip.com","zipmail.com","zipmail.com.br","zipmax.com","zippymail.info","zmail.pt","zmail.ru","zoemail.com","zoemail.net","zoemail.org","zoho.com","zomg.info","zonai.com","zoneview.net","zonnet.nl","zooglemail.com","zoominternet.net","zubee.com","zuvio.com","zuzzurello.com","zvmail.com","zwallet.com","zweb.in","zxcv.com","zxcvbnm.com","zybermail.com","zydecofan.com","zzn.com","zzom.co.uk","zzz.com"];var Er=a(3975);const wr="(?:[_\\p{L}0-9][-_\\p{L}0-9]*\\.)*(?:[\\p{L}0-9][-\\p{L}0-9]{0,62})\\.(?:(?:[a-z]{2}\\.)?[a-z]{2,})",kr=class{static extractDomainFromEmail(e){const t=ra()(`(?<=@)${wr}`);return ra().match(e,t)||""}static isProfessional(e){return!vr.includes(e)}static checkDomainValidity(e){if(!ra()(`^${wr}$`).test(e))throw new Error("Cannot parse domain. The domain does not match the pattern.");try{if(!new URL(`https://${e}`).host)throw new Error("Cannot parse domain. The domain does not match the pattern.")}catch(e){throw new Error("Cannot parse domain. The domain is not valid.")}}static isValidHostname(e){return ra()(`^${wr}$`).test(e)||(0,Er.A)({exact:!0}).test(e)}};function xr(){return xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},xr.apply(null,arguments)}const Cr=s.createContext({getCurrentSmtpSettings:()=>{},findSmtpSettings:()=>{},changeProvider:()=>{},setData:()=>{},isSettingsModified:()=>{},isSettingsValid:()=>{},getErrors:()=>{},validateData:()=>{},getFieldToFocus:()=>{},saveSmtpSettings:()=>{},isProcessing:()=>{},hasProviderChanged:()=>{},sendTestMailTo:()=>{},isDataReady:()=>{},clearContext:()=>{}});class Sr extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.smtpSettingsModel=new br(t),this.smtpTestSettingsModel=new fr(t),this.fieldToFocus=null,this.providerHasChanged=!1}get defaultState(){return{settingsModified:!1,currentSmtpSettings:{provider:null,username:"",password:"",host:"",tls:!0,port:"",client:"",sender_email:"",sender_name:"Passbolt"},errors:{},isLoaded:!1,processing:!1,hasSumittedForm:!1,getCurrentSmtpSettings:this.getCurrentSmtpSettings.bind(this),findSmtpSettings:this.findSmtpSettings.bind(this),changeProvider:this.changeProvider.bind(this),setData:this.setData.bind(this),isSettingsModified:this.isSettingsModified.bind(this),getErrors:this.getErrors.bind(this),validateData:this.validateData.bind(this),getFieldToFocus:this.getFieldToFocus.bind(this),saveSmtpSettings:this.saveSmtpSettings.bind(this),isProcessing:this.isProcessing.bind(this),hasProviderChanged:this.hasProviderChanged.bind(this),sendTestMailTo:this.sendTestMailTo.bind(this),isDataReady:this.isDataReady.bind(this),clearContext:this.clearContext.bind(this)}}async findSmtpSettings(){if(!this.props.context.siteSettings.canIUse("smtpSettings"))return;let e=this.state.currentSmtpSettings;try{e=await this.smtpSettingsModel.findSmtpSettings(),this.setState({currentSmtpSettings:e,isLoaded:!0})}catch(e){this.handleError(e)}e.sender_email||(e.sender_email=this.props.context.loggedInUser.username),e.host&&e.port&&(e.provider=this.detectProvider(e)),this.setState({currentSmtpSettings:e,isLoaded:!0})}clearContext(){const{settingsModified:e,currentSmtpSettings:t,errors:a,isLoaded:s,processing:n,hasSumittedForm:i}=this.defaultState;this.setState({settingsModified:e,currentSmtpSettings:t,errors:a,isLoaded:s,processing:n,hasSumittedForm:i})}async saveSmtpSettings(){this._doProcess((async()=>{try{const e={...this.state.currentSmtpSettings};delete e.provider,e.client=e.client||null,await this.smtpSettingsModel.saveSmtpSettings(e),this.props.actionFeedbackContext.displaySuccess(this.props.t("The SMTP settings have been saved successfully"));const t=Object.assign({},this.state.currentSmtpSettings,{source:"db"});this.setState({currentSmtpSettings:t})}catch(e){this.handleError(e)}}))}async sendTestMailTo(e){return await this.smtpTestSettingsModel.sendTestEmail(this.getCurrentSmtpSettings(),e)}_doProcess(e){this.setState({processing:!0},(async()=>{await e(),this.setState({processing:!1})}))}hasProviderChanged(){const e=this.providerHasChanged;return this.providerHasChanged=!1,e}changeProvider(e){e.id!==this.state.currentSmtpSettings.provider?.id&&(this.providerHasChanged=!0,this.setState({settingsModified:!0,currentSmtpSettings:{...this.state.currentSmtpSettings,...e.defaultConfiguration,provider:e}}))}setData(e){const t=Object.assign({},this.state.currentSmtpSettings,e),a={currentSmtpSettings:{...t,provider:this.detectProvider(t)},settingsModified:!0};this.setState(a),this.state.hasSumittedForm&&this.validateData(t)}detectProvider(e){for(let t=0;t<hr.length;t++){const a=hr[t];if(a.availableConfigurations.find((t=>t.host===e.host&&t.port===parseInt(e.port,10)&&t.tls===e.tls)))return a}return hr.find((e=>"other"===e.id))}isDataReady(){return this.state.isLoaded}isProcessing(){return this.state.processing}isSettingsModified(){return this.state.settingsModified}getErrors(){return this.state.errors}validateData(e){e=e||this.state.currentSmtpSettings;const t={};let a=!0;return a=this.validate_host(e.host,t)&&a,a=this.validate_sender_email(e.sender_email,t)&&a,a=this.validate_sender_name(e.sender_name,t)&&a,a=this.validate_username(e.username,t)&&a,a=this.validate_password(e.password,t)&&a,a=this.validate_port(e.port,t)&&a,a=this.validate_tls(e.tls,t)&&a,a=this.validate_client(e.client,t)&&a,a||(this.fieldToFocus=this.getFirstFieldInError(t,["username","password","host","tls","port","client","sender_name","sender_email"])),this.setState({errors:t,hasSumittedForm:!0}),a}validate_host(e,t){return"string"!=typeof e?(t.host=this.props.t("SMTP Host must be a valid string"),!1):0!==e.length||(t.host=this.props.t("SMTP Host is required"),!1)}validate_client(e,t){return!!(0===e.length||kr.isValidHostname(e)&&e.length<=2048)||(t.client=this.props.t("SMTP client should be a valid domain or IP address"),!1)}validate_sender_email(e,t){return"string"!=typeof e?(t.sender_email=this.props.t("Sender email must be a valid email"),!1):0===e.length?(t.sender_email=this.props.t("Sender email is required"),!1):!!Ui.validate(e,this.props.context.siteSettings)||(t.sender_email=this.props.t("Sender email must be a valid email"),!1)}validate_sender_name(e,t){return"string"!=typeof e?(t.sender_name=this.props.t("Sender name must be a valid string"),!1):0!==e.length||(t.sender_name=this.props.t("Sender name is required"),!1)}validate_username(e,t){return null===e||"string"==typeof e||(t.username=this.props.t("Username must be a valid string"),!1)}validate_password(e,t){return null===e||"string"==typeof e||(t.password=this.props.t("Password must be a valid string"),!1)}validate_tls(e,t){return"boolean"==typeof e||(t.tls=this.props.t("TLS must be set to 'Yes' or 'No'"),!1)}validate_port(e,t){const a=parseInt(e,10);return isNaN(a)?(t.port=this.props.t("Port must be a valid number"),!1):!(a<1||a>65535)||(t.port=this.props.t("Port must be a number between 1 and 65535"),!1)}getFirstFieldInError(e,t){for(let a=0;a<t.length;a++){const s=t[a];if(void 0!==e[s])return s}return null}getCurrentSmtpSettings(){return this.state.currentSmtpSettings}getFieldToFocus(){const e=this.fieldToFocus;return this.fieldToFocus=null,e}handleError(e){console.error(e),this.props.dialogContext.open(Pt,{error:e})}render(){return s.createElement(Cr.Provider,{value:this.state},this.props.children)}}Sr.propTypes={context:r().any,dialogContext:r().object,actionFeedbackContext:r().object,children:r().any,t:r().func};const _r=I(g(d((0,v.CI)("common")(Sr))));function Nr(e){return class extends s.Component{render(){return s.createElement(Cr.Consumer,null,(t=>s.createElement(e,xr({adminSmtpSettingsContext:t},this.props))))}}}const Ir="form",Pr="error",Ar="success";class Tr extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{uiState:Ir,recipient:this.props.context.loggedInUser.username,processing:!1,displayLogs:!0}}bindCallbacks(){this.handleRetryClick=this.handleRetryClick.bind(this),this.handleError=this.handleError.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleDisplayLogsClick=this.handleDisplayLogsClick.bind(this)}async handleFormSubmit(e){if(e.preventDefault(),this.validateForm()){try{this.setState({processing:!0});const e=await this.props.adminSmtpSettingsContext.sendTestMailTo(this.state.recipient);this.setState({uiState:Ar,debugDetails:this.formatDebug(e.debug),displayLogs:!1})}catch(e){this.handleError(e)}this.setState({processing:!1})}}async handleInputChange(e){this.setState({recipient:e.target.value})}validateForm(){const e=Ui.validate(this.state.recipient,this.props.context.siteSettings);return this.setState({recipientError:e?"":this.translate("Recipient must be a valid email")}),e}formatDebug(e){return JSON.stringify(e,null,4)}handleError(e){const t=e.data?.body?.debug,a=t?.length>0?t:e?.message;this.setState({uiState:Pr,debugDetails:this.formatDebug(a),displayLogs:!0})}handleDisplayLogsClick(){this.setState({displayLogs:!this.state.displayLogs})}handleRetryClick(){this.setState({uiState:Ir})}hasAllInputDisabled(){return this.state.processing}get title(){return{form:this.translate("Send test email"),error:this.translate("Something went wrong!"),success:this.translate("Email sent")}[this.state.uiState]||""}get translate(){return this.props.t}render(){return s.createElement(wt,{className:"send-test-email-dialog",title:this.title,onClose:this.props.handleClose,disabled:this.hasAllInputDisabled()},this.state.uiState===Ir&&s.createElement("form",{onSubmit:this.handleFormSubmit,noValidate:!0},s.createElement("div",{className:"form-content"},s.createElement("div",{className:`input text required ${this.state.recipientError?"error":""} ${this.hasAllInputDisabled()?"disabled":""}`},s.createElement("label",null,s.createElement(v.x6,null,"Recipient")),s.createElement("input",{id:"recipient",type:"text",name:"recipient",required:"required",className:"required fluid form-element ready",placeholder:"name@email.com",onChange:this.handleInputChange,value:this.state.recipient,disabled:this.hasAllInputDisabled()}),this.state.recipientError&&s.createElement("div",{className:"recipient error-message"},this.state.recipientError)),s.createElement("div",{className:"message notice no-margin"},s.createElement("strong",null,s.createElement(v.x6,null,"Pro tip"),":")," ",s.createElement(v.x6,null,"after clicking on send, a test email will be sent to the recipient email in order to check that your configuration is correct."))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.hasAllInputDisabled(),onClick:this.props.handleClose}),s.createElement(yn,{disabled:this.hasAllInputDisabled(),processing:this.state.processing,value:this.translate("Send")}))),this.state.uiState===Pr&&s.createElement(s.Fragment,null,s.createElement("div",{className:"dialog-body"},s.createElement("p",null,s.createElement(v.x6,null,"The test email could not be sent. Kindly check the logs below for more information."),s.createElement("br",null),s.createElement("a",{className:"faq-link",href:"https://help.passbolt.com/faq/hosting/why-email-not-sent",rel:"noopener noreferrer",target:"_blank"},s.createElement(v.x6,null,"FAQ: Why are my emails not sent?"))),s.createElement("div",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleDisplayLogsClick},s.createElement("span",null,s.createElement(v.x6,null,"Logs")),this.state.displayLogs?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),this.state.displayLogs&&s.createElement("div",{className:"accordion-content"},s.createElement("textarea",{className:"full_report",readOnly:!0,value:this.state.debugDetails}))),s.createElement("div",{className:"dialog-footer clearfix"},s.createElement("button",{type:"button",className:"cancel",disabled:this.hasAllInputDisabled(),onClick:this.handleRetryClick},s.createElement(v.x6,null,"Retry")),s.createElement("button",{className:"button primary",type:"button",onClick:this.props.handleClose,disabled:this.isProcessing},s.createElement("span",null,s.createElement(v.x6,null,"Close"))))),this.state.uiState===Ar&&s.createElement(s.Fragment,null,s.createElement("div",{className:"dialog-body"},s.createElement("p",null,s.createElement(v.x6,null,"The test email has been sent. Check your email box, you should receive it in a minute.")),s.createElement("div",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleDisplayLogsClick},s.createElement("span",null,s.createElement(v.x6,null,"Logs")),this.state.displayLogs?s.createElement(Ct,{className:"baseline svg-icon"}):s.createElement(Nt,{className:"baseline svg-icon"}))),this.state.displayLogs&&s.createElement("div",{className:"accordion-content"},s.createElement("textarea",{className:"full_report",readOnly:!0,value:this.state.debugDetails})),s.createElement("div",{className:"message notice no-margin"},s.createElement("strong",null,s.createElement(v.x6,null,"Pro tip"),":")," ",s.createElement(v.x6,null,"Check your spam folder if you do not hear from us after a while."))),s.createElement("div",{className:"dialog-footer clearfix"},s.createElement("button",{type:"button",className:"cancel",disabled:this.hasAllInputDisabled(),onClick:this.handleRetryClick},s.createElement(v.x6,null,"Retry")),s.createElement("button",{className:"button primary",type:"button",onClick:this.props.handleClose,disabled:this.isProcessing},s.createElement("span",null,s.createElement(v.x6,null,"Close"))))))}}Tr.propTypes={context:r().object,adminSmtpSettingsContext:r().object,handleClose:r().func,t:r().func};const Rr=I(Nr((0,v.CI)("common")(Tr)));var Dr,Or;function Ur(){return Ur=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ur.apply(null,arguments)}const Mr=function(e){return s.createElement("svg",Ur({xmlns:"http://www.w3.org/2000/svg",width:19,height:22,fill:"none",viewBox:"0 0 19 22"},e),Dr||(Dr=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5.21 7.08a4.62 4.62 0 0 0 0 6.514 4.555 4.555 0 0 0 6.476 0l3.23-3.25-6.46-6.513-3.23 3.25z"})),Or||(Or=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m5.21 13.58-3.138 3.156c-1.44 1.447-.414 3.927 1.623 3.927h13.824M11.579 3.308l1.974-1.987M15.437 7.189l1.974-1.987M7.614 2.984 15.68 11.1"})))};class Fr extends s.Component{constructor(e){super(e),this.bindCallbacks(),this.dialogId=null}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this),this.handleTestClick=this.handleTestClick.bind(this),this.handleCloseDialog=this.handleCloseDialog.bind(this)}async handleSaveClick(){this.smtpSettings.isProcessing()||this.smtpSettings.validateData()&&await this.smtpSettings.saveSmtpSettings()}async handleTestClick(){this.smtpSettings.isProcessing()||this.smtpSettings.validateData()&&(null!==this.dialogId&&this.handleCloseDialog(),this.dialogId=await this.props.dialogContext.open(Rr,{handleClose:this.handleCloseDialog}))}handleCloseDialog(){this.props.dialogContext.close(this.dialogId),this.dialogId=null}isSaveEnabled(){return this.smtpSettings.isSettingsModified()&&!this.smtpSettings.isProcessing()}isTestEnabled(){return this.smtpSettings.isSettingsModified()&&!this.smtpSettings.isProcessing()}get smtpSettings(){return this.props.adminSmtpSettingsContext}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("div",{className:"left-actions-wrapper"},s.createElement("button",{type:"button",className:"button secondary",disabled:!this.isTestEnabled(),id:"send-test-email",onClick:this.handleTestClick},s.createElement(Mr,null),s.createElement("span",null,s.createElement(v.x6,null,"Send test email")))),s.createElement("button",{type:"button",className:"button primary form",id:"save-settings",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Fr.propTypes={adminSmtpSettingsContext:r().object,dialogContext:r().object};const jr=Nr(g((0,v.CI)("common")(Fr)));var zr;function Lr(){return Lr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Lr.apply(null,arguments)}const qr=function(e){return s.createElement("svg",Lr({xmlns:"http://www.w3.org/2000/svg",width:19,height:18,fill:"none",viewBox:"0 0 19 18"},e),zr||(zr=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#link_svg__clip0_99_1008536)"},s.createElement("path",{d:"M8.33 9.75a3.75 3.75 0 0 0 5.655.405l2.25-2.25a3.75 3.75 0 0 0-5.302-5.303l-1.29 1.283"}),s.createElement("path",{d:"M11.33 8.25a3.75 3.75 0 0 0-5.655-.405l-2.25 2.25a3.75 3.75 0 0 0 5.303 5.302l1.282-1.282"}))))},Kr="None",Wr="Username only",Vr="Username & password";class Br extends s.Component{static get AUTHENTICATION_METHOD_NONE(){return Kr}static get AUTHENTICATION_METHOD_USERNAME(){return Wr}static get AUTHENTICATION_METHOD_USERNAME_PASSWORD(){return Vr}constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.createRefs()}get defaultState(){return{showAdvancedSettings:!1,source:"db"}}createRefs(){this.usernameFieldRef=s.createRef(),this.passwordFieldRef=s.createRef(),this.hostFieldRef=s.createRef(),this.portFieldRef=s.createRef(),this.clientFieldRef=s.createRef(),this.senderEmailFieldRef=s.createRef(),this.senderNameFieldRef=s.createRef()}async componentDidMount(){this.props.administrationWorkspaceContext.setDisplayAdministrationWorkspaceAction(jr),await this.props.adminSmtpSettingsContext.findSmtpSettings();const e=this.props.adminSmtpSettingsContext.getCurrentSmtpSettings();this.setState({showAdvancedSettings:"other"===e.provider?.id})}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminSmtpSettingsContext.clearContext()}componentDidUpdate(){const e=this.props.adminSmtpSettingsContext,t=e.getFieldToFocus();t&&this[`${t}FieldRef`]?.current?.focus(),e.hasProviderChanged()&&this.setState({showAdvancedSettings:"other"===e.getCurrentSmtpSettings().provider?.id})}bindCallbacks(){this.handleAdvancedSettingsToggle=this.handleAdvancedSettingsToggle.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleProviderChange=this.handleProviderChange.bind(this),this.handleAuthenticationMethodChange=this.handleAuthenticationMethodChange.bind(this)}handleProviderChange(e){const t=e.target.value,a=hr.find((e=>e.id===t));this.props.adminSmtpSettingsContext.changeProvider(a)}handleAuthenticationMethodChange(e){let t=null,a=null;e.target.value===Wr?t="":e.target.value===Vr&&(t="",a=""),this.props.adminSmtpSettingsContext.setData({username:t,password:a})}handleInputChange(e){const t=e.target;this.props.adminSmtpSettingsContext.setData({[t.name]:t.value})}handleAdvancedSettingsToggle(){this.setState({showAdvancedSettings:!this.state.showAdvancedSettings})}isProcessing(){return this.props.adminSmtpSettingsContext.isProcessing()}get providerList(){return hr.map((e=>({value:e.id,label:e.name})))}get authenticationMethodList(){return[{value:Kr,label:this.translate("None")},{value:Wr,label:this.translate("Username only")},{value:Vr,label:this.translate("Username & password")}]}get tlsSelectList(){return[{value:!0,label:this.translate("Yes")},{value:!1,label:this.translate("No")}]}get authenticationMethod(){const e=this.props.adminSmtpSettingsContext.getCurrentSmtpSettings();return null===e?.username?Kr:null===e?.password?Wr:Vr}shouldDisplayUsername(){return this.authenticationMethod===Wr||this.authenticationMethod===Vr}shouldDisplayPassword(){return this.authenticationMethod===Vr}shouldShowSourceWarningMessage(){const e=this.props.adminSmtpSettingsContext;return"db"!==e.getCurrentSmtpSettings().source&&e.isSettingsModified()}isReady(){return this.props.adminSmtpSettingsContext.isDataReady()}get settingsSource(){return this.props.adminSmtpSettingsContext?.getCurrentSmtpSettings()?.source}get configurationSource(){return{env:this.props.t("environment variables"),file:this.props.t("file"),db:this.props.t("database")}[this.settingsSource]||this.props.t("unknown")}get translate(){return this.props.t}render(){const e=this.props.adminSmtpSettingsContext.getCurrentSmtpSettings(),t=this.props.adminSmtpSettingsContext.getErrors(),a=e?.provider?.name,n=this.props.adminSmtpSettingsContext.isSettingsModified(),i=n||this.shouldShowSourceWarningMessage();return s.createElement("div",{className:"row"},s.createElement(s.Fragment,null,s.createElement("div",{className:"third-party-provider-settings smtp-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement(v.x6,null,"Email server")),this.isReady()&&!e?.provider&&s.createElement(s.Fragment,null,s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Select a provider")),s.createElement("div",{className:"provider-list"},hr.map((e=>s.createElement("div",{key:e.id,className:"provider button",id:e.id,onClick:()=>this.props.adminSmtpSettingsContext.changeProvider(e)},s.createElement("div",{className:"provider-logo"},"other"===e.id&&s.createElement(Tn,null),"other"!==e.id&&s.createElement("img",{src:`${this.props.context.trustedDomain}/img/third_party/${e.icon}`})),s.createElement("p",{className:"provider-name"},e.name)))))),this.isReady()&&e?.provider&&s.createElement(s.Fragment,null,s.createElement("form",{className:"form"},s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"SMTP server configuration")),s.createElement("div",{className:"select-wrapper input required "+(this.isProcessing()?"disabled":"")},s.createElement("label",{htmlFor:"smtp-settings-form-provider"},s.createElement(v.x6,null,"Email provider")),s.createElement(Oa,{id:"smtp-settings-form-provider",name:"provider",items:this.providerList,value:e.provider.id,onChange:this.handleProviderChange,disabled:this.isProcessing()})),s.createElement("div",{className:"select-wrapper input required "+(this.isProcessing()?"disabled":"")},s.createElement("label",{htmlFor:"smtp-settings-form-authentication-method"},s.createElement(v.x6,null,"Authentication method")),s.createElement(Oa,{id:"smtp-settings-form-authentication-method",name:"authentication-method",items:this.authenticationMethodList,value:this.authenticationMethod,onChange:this.handleAuthenticationMethodChange,disabled:this.isProcessing()})),this.shouldDisplayUsername()&&s.createElement("div",{className:`input text ${t.username?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-username"},s.createElement(v.x6,null,"Username")),s.createElement("input",{id:"smtp-settings-form-username",ref:this.usernameFieldRef,name:"username",className:"fluid",maxLength:"256",type:"text",autoComplete:"off",value:e.username,onChange:this.handleInputChange,placeholder:this.translate("Username"),disabled:this.isProcessing()}),t.username&&s.createElement("div",{className:"error-message"},t.username)),this.shouldDisplayPassword()&&s.createElement("div",{className:`input-password-wrapper input ${t.password?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-password"},s.createElement(v.x6,null,"Password")),s.createElement(va,{id:"smtp-settings-form-password",name:"password",autoComplete:"new-password",placeholder:this.translate("Password"),preview:!0,value:e.password,onChange:this.handleInputChange,disabled:this.isProcessing(),inputRef:this.passwordFieldRef}),t.password&&s.createElement("div",{className:"password error-message"},t.password)),s.createElement("div",{className:"accordion-header"},s.createElement("button",{type:"button",className:"link no-border",onClick:this.handleAdvancedSettingsToggle},this.state.showAdvancedSettings?s.createElement(Ct,null):s.createElement(Nt,null),s.createElement(v.x6,null,"Advanced settings"))),this.state.showAdvancedSettings&&s.createElement("div",{className:"advanced-settings"},s.createElement("div",{className:`input text required ${t.host?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-host"},s.createElement(v.x6,null,"SMTP host")),s.createElement("input",{id:"smtp-settings-form-host",ref:this.hostFieldRef,name:"host","aria-required":!0,className:"fluid",maxLength:"256",type:"text",autoComplete:"off",value:e.host,onChange:this.handleInputChange,placeholder:this.translate("SMTP server address"),disabled:this.isProcessing()}),t.host&&s.createElement("div",{className:"error-message"},t.host)),s.createElement("div",{className:`input text required ${t.tls?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-tls"},s.createElement(v.x6,null,"Use TLS")),s.createElement(Oa,{id:"smtp-settings-form-tls",name:"tls",items:this.tlsSelectList,value:e.tls,onChange:this.handleInputChange,disabled:this.isProcessing()})),s.createElement("div",{className:`input text required ${t.port?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-port"},s.createElement(v.x6,null,"Port")),s.createElement("input",{id:"smtp-settings-form-port","aria-required":!0,ref:this.portFieldRef,name:"port",className:"fluid",maxLength:"256",type:"text",autoComplete:"off",value:e.port,onChange:this.handleInputChange,placeholder:this.translate("Port number"),disabled:this.isProcessing()}),t.port&&s.createElement("div",{className:"error-message"},t.port)),s.createElement("div",{className:`input text ${t.client?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-client"},s.createElement(v.x6,null,"SMTP client")),s.createElement("input",{id:"smtp-settings-form-client",ref:this.clientFieldRef,name:"client",maxLength:"2048",type:"text",autoComplete:"off",value:e.client,onChange:this.handleInputChange,placeholder:this.translate("SMTP client address"),disabled:this.isProcessing()}),t.client&&s.createElement("div",{className:"error-message"},t.client))),s.createElement("h4",null,s.createElement(v.x6,null,"Sender configuration")),s.createElement("div",{className:`input text required ${t.sender_name?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-sender-name"},s.createElement(v.x6,null,"Sender name")),s.createElement("input",{id:"smtp-settings-form-sender-name",ref:this.senderNameFieldRef,name:"sender_name","aria-required":!0,className:"fluid",maxLength:"256",type:"text",autoComplete:"off",value:e.sender_name,onChange:this.handleInputChange,placeholder:this.translate("Sender name"),disabled:this.isProcessing()}),t.sender_name&&s.createElement("div",{className:"error-message"},t.sender_name),s.createElement("p",null,s.createElement(v.x6,null,"This is the name users will see in their mailbox when passbolt sends a notification."))),s.createElement("div",{className:`input text required ${t.sender_email?"error":""} ${this.isProcessing()?"disabled":""}`},s.createElement("label",{htmlFor:"smtp-settings-form-sender-name"},s.createElement(v.x6,null,"Sender email")),s.createElement("input",{id:"smtp-settings-form-sender-email",ref:this.senderEmailFieldRef,name:"sender_email","aria-required":!0,className:"fluid",maxLength:"256",type:"text",autoComplete:"off",value:e.sender_email,onChange:this.handleInputChange,placeholder:this.translate("Sender email"),disabled:this.isProcessing()}),t.sender_email&&s.createElement("div",{className:"error-message"},t.sender_email),s.createElement("p",null,s.createElement(v.x6,null,"This is the email address users will see in their mail box when passbolt sends a notification.",s.createElement("br",null),"It's a good practice to provide a working email address that users can reply to.")))))),i&&s.createElement("div",{className:"warning message"},this.shouldShowSourceWarningMessage()&&s.createElement("div",{id:"smtp-settings-source-warning"},s.createElement(v.x6,null,"These are the settings provided by a configuration file. If you save it, will ignore the settings on file and use the ones from the database.")),n&&s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(jr,null)),Ea(s.createElement(s.Fragment,null,s.createElement("div",{className:"sidebar-help-section",id:"smtp-settings-source"},s.createElement("h3",null,s.createElement(v.x6,null,"Configuration source")),s.createElement("p",null,s.createElement(v.x6,null,"This current configuration source is: "),this.configurationSource,".")),s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Why do I need an SMTP server?")),s.createElement("p",null,s.createElement(v.x6,null,"Passbolt needs an smtp server in order to send invitation emails after an account creation and to send email notifications.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/emails/email-server/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),e?.provider&&"other"!==e?.provider.id&&s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"How do I configure a ",{smtpProviderName:a}," SMTP server?")),s.createElement("a",{className:"button",href:e.provider.help_page,target:"_blank",rel:"noopener noreferrer"},s.createElement(qr,null),s.createElement("span",null,s.createElement(v.x6,null,"See the ",{smtpProviderName:a}," documentation")))),e?.provider&&("google-mail"===e.provider.id||"google-workspace"===e.provider.id)&&s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Why shouldn't I use my login password ?")),s.createElement("p",null,s.createElement(v.x6,null,'In order to use the "Username & Password" authentication method with Google, you will need to enable MFA on your Google Account. The password should not be your login password, you have to create an "App Password" generated by Google.. However, the email remain the same.')),s.createElement("a",{className:"button",href:"https://support.google.com/mail/answer/185833",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"More informations"))))),document.getElementById("administration-help-panel")))}}Br.propTypes={context:r().object,dialogContext:r().any,administrationWorkspaceContext:r().object,adminSmtpSettingsContext:r().object,t:r().func};const Gr=I(Nr(g(Ee((0,v.CI)("common")(Br))))),$r=class{static clone(e){return new Map(JSON.parse(JSON.stringify(Array.from(e))))}static iterators(e){return[...e.keys()]}static listValues(e){return[...e.values()]}},Hr=class{constructor(e){this.apiClientOptions=e}async find(){this.initClient();const e=await this.apiClient.findAll(),t=e?.body;return t}async save(e){this.initClient(),await this.apiClient.create(e)}async delete(e){this.initClient(),await this.apiClient.delete(e)}async checkDomainAllowed(e){this.initClient("dry-run"),await this.apiClient.create(e)}initClient(e="settings"){this.apiClientOptions.setResourceName(`self-registration/${e}`),this.apiClient=new Qt(this.apiClientOptions)}},Yr=class{constructor(e={}){this.allowedDomains=this.mapAllowedDomains(e.data?.allowed_domains||[])}mapAllowedDomains(e){return new Map(e.map((e=>[(0,o.A)(),e])))}getSettings(){return this.allowedDomains}setSettings(e){this.allowedDomains=this.mapAllowedDomains(e)}},Jr=class{constructor(e,t={}){this.id=t.id,this.provider=t.provider||"email_domains",this.data=this.mapData(e?.allowedDomains)}mapData(e=new Map){return{allowed_domains:Array.from(e.values())}}},Zr=class{constructor(e){this.translate=e,this.fields=new Map}validate(e){return this.fields=e,this.validateInputs()}validateInputs(){const e=new Map;return this.fields.forEach(((t,a)=>{this.validateInput(a,t,e)})),e}validateInput(e,t,a){if(t.length)try{kr.checkDomainValidity(t)}catch{a.set(e,this.translate("This should be a valid domain"))}else a.set(e,this.translate("A domain is required."));this.checkDuplicateValue(a)}checkDuplicateValue(e){this.fields.forEach(((t,a)=>{$r.listValues(this.fields).filter((e=>e===t&&""!==e)).length>1&&e.set(a,this.translate("This domain already exist"))}))}};class Qr extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSubmit=this.handleSubmit.bind(this),this.handleClose=this.handleClose.bind(this)}handleClose(){this.props.onClose()}async handleSubmit(e){e.preventDefault(),await this.props.onSubmit(),this.props.onClose()}get allowedDomains(){return this.props.adminSelfRegistrationContext.getAllowedDomains()}render(){const e=this.props.adminSelfRegistrationContext.isProcessing();return s.createElement(wt,{title:this.props.t("Save self registration settings"),onClose:this.handleClose,disabled:e,className:"save-self-registration-settings-dialog"},s.createElement("form",{onSubmit:this.handleSubmit},s.createElement("div",{className:"form-content"},s.createElement("label",null,s.createElement(v.x6,null,"Allowed domains")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio"},s.createElement("ul",{id:"domains-list"},this.allowedDomains&&$r.iterators(this.allowedDomains).map((e=>s.createElement("li",{key:e},this.allowedDomains.get(e))))))),s.createElement("div",{className:"warning message no-margin"},s.createElement(v.x6,null,"Please review carefully this configuration."))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{onClick:this.handleClose,disabled:e}),s.createElement(yn,{value:this.props.t("Save"),disabled:e,processing:e,warning:!0}))))}}Qr.propTypes={context:r().any,onSubmit:r().func,adminSelfRegistrationContext:r().object,onClose:r().func,t:r().func};const Xr=I(ro((0,v.CI)("common")(Qr)));class eo extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSubmit=this.handleSubmit.bind(this),this.handleClose=this.handleClose.bind(this)}handleClose(){this.props.onClose()}async handleSubmit(e){e.preventDefault(),await this.props.onSubmit(),this.props.onClose()}render(){const e=this.props.adminSelfRegistrationContext.isProcessing();return s.createElement(wt,{title:this.props.t("Disable self registration"),onClose:this.handleClose,disabled:e,className:"delete-self-registration-settings-dialog"},s.createElement("form",{onSubmit:this.handleSubmit},s.createElement("div",{className:"form-content"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Are you sure to disable the self registration for the organization ?")),s.createElement("p",null,s.createElement(v.x6,null,"Users will not be able to self register anymore.")," ",s.createElement(v.x6,null,"Only administrators would be able to invite users to register. ")))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{onClick:this.handleClose,disabled:e}),s.createElement(yn,{value:this.props.t("Save"),disabled:e,processing:e,warning:!0}))))}}eo.propTypes={adminSelfRegistrationContext:r().object,onClose:r().func,onSubmit:r().func,t:r().func};const to=ro((0,v.CI)("common")(eo));function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ao.apply(null,arguments)}const so=s.createContext({getCurrentSettings:()=>{},getAllowedDomains:()=>{},setAllowedDomains:()=>{},hasSettingsChanges:()=>{},setDomains:()=>{},findSettings:()=>{},setProcessing:()=>{},isProcessing:()=>{},clearContext:()=>{},isSubmitted:()=>{},setSubmitted:()=>{},setErrors:()=>{},getErrors:()=>{},setError:()=>{},save:()=>{},delete:()=>{},shouldFocus:()=>{},setFocus:()=>{},isSaved:()=>{},setSaved:()=>{},validateForm:()=>{}});class no extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.selfRegistrationService=new Hr(t),this.selfRegistrationFormService=new Zr(this.props.t)}get defaultState(){return{errors:new Map,submitted:!1,currentSettings:null,focus:!1,saved:!1,domains:new Yr,processing:!0,getCurrentSettings:this.getCurrentSettings.bind(this),getAllowedDomains:this.getAllowedDomains.bind(this),setAllowedDomains:this.setAllowedDomains.bind(this),setDomains:this.setDomains.bind(this),findSettings:this.findSettings.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),clearContext:this.clearContext.bind(this),isSubmitted:this.isSubmitted.bind(this),setSubmitted:this.setSubmitted.bind(this),getErrors:this.getErrors.bind(this),setError:this.setError.bind(this),setErrors:this.setErrors.bind(this),save:this.save.bind(this),shouldFocus:this.shouldFocus.bind(this),setFocus:this.setFocus.bind(this),isSaved:this.isSaved.bind(this),setSaved:this.setSaved.bind(this),deleteSettings:this.deleteSettings.bind(this),validateForm:this.validateForm.bind(this)}}async findSettings(e=()=>{}){this.setProcessing(!0);const t=await this.selfRegistrationService.find();this.setState({currentSettings:t});const a=new Yr(t);this.setDomains(a,e),this.setProcessing(!1)}getCurrentSettings(){return this.state.currentSettings}getAllowedDomains(){return this.state.domains.allowedDomains}setAllowedDomains(e,t,a=()=>{}){this.setState((a=>{const s=$r.clone(a.domains.allowedDomains);return s.set(e,t),{domains:{allowedDomains:s}}}),a)}setDomains(e,t=()=>{}){this.setState({domains:e},t)}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}isSubmitted(){return this.state.submitted}setSubmitted(e){this.setState({submitted:e}),this.setFocus(e)}getErrors(){return this.state.errors}shouldFocus(){return this.state.focus}setFocus(e){this.setState({focus:e})}setError(e,t){this.setState((a=>{const s=$r.clone(a.errors);return s.set(e,t),{errors:s}}))}setErrors(e){this.setState({errors:e})}hasSettingsChanges(){const e=this.state.currentSettings?.data?.allowed_domains||[],t=$r.listValues(this.state.domains.allowedDomains);return JSON.stringify(e)!==JSON.stringify(t)}clearContext(){const{currentSettings:e,domains:t,processing:a}=this.defaultState;this.setState({currentSettings:e,domains:t,processing:a})}save(){this.setSubmitted(!0),this.validateForm()&&(this.hasSettingsChanges()&&0===this.getAllowedDomains().size?this.displayConfirmDeletionDialog():this.displayConfirmSummaryDialog())}validateForm(){const e=this.selfRegistrationFormService.validate(this.state.getAllowedDomains());return this.state.setErrors(e),0===e.size}async handleSubmitError(e){"UserAbortsOperationError"!==e.name&&(console.error(e),await this.handleError(e))}async saveSettings(){try{this.setProcessing(!0);const e=new Jr(this.state.domains,this.state.currentSettings);await this.selfRegistrationService.save(e),await this.findSettings((()=>this.setSaved(!0))),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The self registration settings for the organization were updated."))}catch(e){this.handleSubmitError(e)}finally{this.setProcessing(!1),this.setSubmitted(!1)}}async handleError(e){this.handleCloseDialog();const t={error:e};this.props.dialogContext.open(Pt,t)}handleCloseDialog(){this.props.dialogContext.close()}displayConfirmSummaryDialog(){this.props.dialogContext.open(Xr,{domains:this.getAllowedDomains(),onSubmit:()=>this.saveSettings(),onClose:()=>this.handleCloseDialog()})}displayConfirmDeletionDialog(){this.props.dialogContext.open(to,{onSubmit:()=>this.deleteSettings(),onClose:()=>this.handleCloseDialog()})}async deleteSettings(){try{this.setProcessing(!0),await this.selfRegistrationService.delete(this.state.currentSettings.id),await this.findSettings(),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The self registration settings for the organization were updated."))}catch(e){this.handleSubmitError(e)}finally{this.setProcessing(!1),this.setSubmitted(!1)}}isSaved(){return this.state.saved}setSaved(e){return this.setState({saved:e})}render(){return s.createElement(so.Provider,{value:this.state},this.props.children)}}no.propTypes={context:r().any,children:r().any,t:r().any,dialogContext:r().any,actionFeedbackContext:r().object};const io=I(g(d((0,v.CI)("common")(no))));function ro(e){return class extends s.Component{render(){return s.createElement(so.Consumer,null,(t=>s.createElement(e,ao({adminSelfRegistrationContext:t},this.props))))}}}const oo=new Map;function lo(e){if("string"!=typeof e)return console.warn("useDynamicRefs: Cannot set ref without key");const t=s.createRef();return oo.set(e,t),t}function co(e){return e?oo.get(e):console.warn("useDynamicRefs: Cannot get ref without key")}var mo=a(6459),po=a.n(mo);class uo extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSave=this.handleSave.bind(this)}get allowedDomains(){return this.props.adminSelfRegistrationContext.getAllowedDomains()}isSaveEnabled(){let e=!1;return this.props.adminSelfRegistrationContext.getCurrentSettings()?.provider||(e=!this.props.adminSelfRegistrationContext.hasSettingsChanges()),!this.props.adminSelfRegistrationContext.isProcessing()&&!e}async handleSave(){this.isSaveEnabled()&&this.props.adminSelfRegistrationContext.save()}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{className:"button primary form",type:"button",disabled:!this.isSaveEnabled(),id:"save-settings",onClick:this.handleSave},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}uo.propTypes={adminSelfRegistrationContext:r().object,t:r().func};const ho=(0,v.CI)("common")(ro(uo));var go;function bo(){return bo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},bo.apply(null,arguments)}const yo=function(e){return s.createElement("svg",bo({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",viewBox:"0 0 17 16"},e),go||(go=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8.594 2v12M14.597 7.997h-12"})))};var fo;function vo(){return vo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},vo.apply(null,arguments)}const Eo=function(e){return s.createElement("svg",vo({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),fo||(fo=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 4.5h13.5M14.25 4.5V15c0 .75-.75 1.5-1.5 1.5h-7.5c-.75 0-1.5-.75-1.5-1.5V4.5M6 4.5V3c0-.75.75-1.5 1.5-1.5h3c.75 0 1.5.75 1.5 1.5v1.5M7.5 8.25v4.5M10.5 8.25v4.5"})))};class wo extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.dynamicRefs={getRef:co,setRef:lo},this.checkForPublicDomainDebounce=po()(this.checkForWarnings,300),this.bindCallbacks()}async componentDidMount(){await this.findSettings()}componentDidUpdate(){this.shouldFocusOnError(),this.shouldCheckWarnings()}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminSelfRegistrationContext.clearContext()}get defaultState(){return{isEnabled:!1,warnings:new Map}}bindCallbacks(){this.handleToggleClicked=this.handleToggleClicked.bind(this),this.handleAddRowClick=this.handleAddRowClick.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleDeleteRow=this.handleDeleteRow.bind(this)}get currentUser(){return this.props.context.loggedInUser}get allowedDomains(){return this.props.adminSelfRegistrationContext.getAllowedDomains()}async findSettings(){await this.props.adminSelfRegistrationContext.findSettings(),this.setState({isEnabled:this.allowedDomains.size>0}),this.checkForWarnings(),this.validateForm()}checkForWarnings(){this.setState({warnings:new Map},(()=>{this.allowedDomains.forEach(((e,t)=>this.checkDomainIsProfessional(t,e)))}))}setupSettings(){if(this.props.adminSelfRegistrationContext.setDomains(new Yr(this.props.adminSelfRegistrationContext.getCurrentSettings())),this.checkForWarnings(),0===this.allowedDomains.size){const e=kr.extractDomainFromEmail(this.currentUser?.username);kr.checkDomainValidity(e),this.populateUserDomain(e)}}shouldFocusOnError(){const e=this.props.adminSelfRegistrationContext.shouldFocus(),[t]=this.props.adminSelfRegistrationContext.getErrors().keys();t&&e&&(this.dynamicRefs.getRef(t).current.focus(),this.props.adminSelfRegistrationContext.setFocus(!1))}shouldCheckWarnings(){this.props.adminSelfRegistrationContext.isSaved()&&(this.props.adminSelfRegistrationContext.setSaved(!1),this.checkForWarnings())}populateUserDomain(e){const t=kr.isProfessional(e)?e:"";this.addRow(t)}addRow(e=""){const t=(0,o.A)();this.props.adminSelfRegistrationContext.setAllowedDomains(t,e,(()=>{const e=this.dynamicRefs.getRef(t);e?.current.focus()}))}handleDeleteRow(e){if(this.canDelete()){const t=this.allowedDomains;t.delete(e),this.props.adminSelfRegistrationContext.setDomains({allowedDomains:t}),this.validateForm(),this.checkForWarnings()}}hasWarnings(){return this.state.warnings.size>0}hasAllInputDisabled(){return this.props.adminSelfRegistrationContext.isProcessing()}handleToggleClicked(){this.setState({isEnabled:!this.state.isEnabled},(()=>{this.state.isEnabled?this.setupSettings():(this.props.adminSelfRegistrationContext.setDomains({allowedDomains:new Map}),this.props.adminSelfRegistrationContext.setErrors(new Map))}))}handleAddRowClick(){this.addRow()}checkDomainIsProfessional(e,t){this.setState((a=>{const s=$r.clone(a.warnings);return kr.isProfessional(t)?s.delete(e):s.set(e,"This is not a safe professional domain"),{warnings:s}}))}handleInputChange(e){const t=e.target.value,a=e.target.name;this.props.adminSelfRegistrationContext.setAllowedDomains(a,t,(()=>this.validateForm())),this.checkForPublicDomainDebounce()}validateForm(){this.props.adminSelfRegistrationContext.validateForm()}canDelete(){return this.allowedDomains.size>1}render(){const e=this.props.adminSelfRegistrationContext.isSubmitted(),t=this.props.adminSelfRegistrationContext.getErrors();return s.createElement("div",{className:"row"},s.createElement(s.Fragment,null,s.createElement("div",{className:"self-registration main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",null,s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"settings-toggle",onChange:this.handleToggleClicked,checked:this.state.isEnabled,disabled:this.hasAllInputDisabled(),id:"settings-toggle"}),s.createElement("label",{htmlFor:"settings-toggle"},s.createElement(v.x6,null,"Self Registration")))),!this.state.isEnabled&&s.createElement("p",{className:"description",id:"disabled-description"},s.createElement(v.x6,null,"User self registration is disabled.")," ",s.createElement(v.x6,null,"Only administrators can invite users to register.")),this.state.isEnabled&&s.createElement("div",{className:"self-registration-form"},s.createElement("div",{id:"self-registration-subtitle",className:`input ${this.hasWarnings()&&"warning"} ${e&&t.size>0&&"error"}`},s.createElement("label",{id:"enabled-label"},s.createElement(v.x6,null,"Email domain safe list"))),s.createElement("p",{className:"description",id:"enabled-description"},s.createElement(v.x6,null,"All the users with an email address ending with the domain in the safe list are allowed to register on passbolt.")),$r.iterators(this.allowedDomains).map((a=>s.createElement("div",{key:a,className:"input"},s.createElement("div",{className:"domain-row"},s.createElement("input",{type:"text",className:"full-width",onChange:this.handleInputChange,id:`input-${a}`,name:a,value:this.allowedDomains.get(a),disabled:!this.hasAllInputDisabled,ref:this.dynamicRefs.setRef(a),placeholder:this.props.t("domain")}),s.createElement("button",{type:"button",disabled:!this.canDelete(),className:"button-icon",id:`delete-${a}`,onClick:()=>this.handleDeleteRow(a)},s.createElement(Eo,null))),this.hasWarnings()&&this.state.warnings.get(a)&&s.createElement("div",{id:"domain-name-input-feedback",className:"warning-message"},s.createElement(v.x6,null,this.state.warnings.get(a))),t.get(a)&&e&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,t.get(a)))))),s.createElement("div",{className:"domain-add"},s.createElement("button",{type:"button",onClick:this.handleAddRowClick},s.createElement(yo,null),s.createElement("span",null,s.createElement(v.x6,null,"Add")))))),this.props.adminSelfRegistrationContext.hasSettingsChanges()&&s.createElement("div",{className:"warning message",id:"self-registration-setting-overridden-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(ho,null)),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"What is user self registration?")),s.createElement("p",null,s.createElement(v.x6,null,"User self registration enables users with an email from a whitelisted domain to create their passbolt account without prior admin invitation.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/user-provisioning/self-registration/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}wo.propTypes={dialogContext:r().any,context:r().any,adminSelfRegistrationContext:r().object,administrationWorkspaceContext:r().object,t:r().func};const ko=I(g(ro(Ee((0,v.CI)("common")(wo))))),xo=[{id:"azure",name:"Microsoft",icon:s.createElement("svg",{width:"65",height:"64",viewBox:"0 0 65 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M31.3512 3.04762H3.92261V30.4762H31.3512V3.04762Z",fill:"#F25022"}),s.createElement("path",{d:"M31.3512 33.5238H3.92261V60.9524H31.3512V33.5238Z",fill:"#00A4EF"}),s.createElement("path",{d:"M61.8274 3.04762H34.3988V30.4762H61.8274V3.04762Z",fill:"#7FBA00"}),s.createElement("path",{d:"M61.8274 33.5238H34.3988V60.9524H61.8274V33.5238Z",fill:"#FFB900"})),defaultConfig:{url:"https://login.microsoftonline.com",client_id:"",client_secret:"",tenant_id:"",client_secret_expiry:"",prompt:"login",email_claim:"email"}},{id:"google",name:"Google",icon:s.createElement("svg",{width:"65",height:"64",viewBox:"0 0 65 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M63.9451 32.72C63.9451 30.6133 63.7584 28.6133 63.4384 26.6667H33.3051V38.6933H50.5584C49.7851 42.64 47.5184 45.9733 44.1584 48.24V56.24H54.4517C60.4784 50.6667 63.9451 42.4533 63.9451 32.72Z",fill:"#4285F4"}),s.createElement("path",{d:"M33.305 64C41.945 64 49.1717 61.12 54.4517 56.24L44.1583 48.24C41.2783 50.16 37.625 51.3333 33.305 51.3333C24.9583 51.3333 17.8917 45.7067 15.3583 38.1067H4.745V46.3467C9.99833 56.8 20.7983 64 33.305 64Z",fill:"#34A853"}),s.createElement("path",{d:"M15.3584 38.1067C14.6917 36.1867 14.3451 34.1333 14.3451 32C14.3451 29.8667 14.7184 27.8133 15.3584 25.8933V17.6533H4.74505C2.55838 21.9733 1.30505 26.8267 1.30505 32C1.30505 37.1733 2.55838 42.0267 4.74505 46.3467L15.3584 38.1067Z",fill:"#FBBC05"}),s.createElement("path",{d:"M33.305 12.6667C38.025 12.6667 42.2383 14.2933 45.5717 17.4667L54.6917 8.34667C49.1717 3.17334 41.945 0 33.305 0C20.7983 0 9.99833 7.20001 4.745 17.6533L15.3583 25.8933C17.8917 18.2933 24.9583 12.6667 33.305 12.6667Z",fill:"#EA4335"})),defaultConfig:{client_id:"",client_secret:""}},{id:"oauth2",name:"OpenID",hiddenIfDisabled:!0,disabledForRecover:!0,icon:s.createElement("svg",{width:"65",height:"60",viewBox:"0 0 65 60",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M64.2468 34.9929L62.9089 21.0968L57.9256 23.9083C53.2914 21.0968 47.3581 19.1061 40.7332 18.3046V24.4577C44.5336 25.117 47.9462 26.3321 50.7513 27.9544L45.5031 30.9146L64.2533 34.9929H64.2468Z",fill:"#B3B3B3"}),s.createElement("path",{d:"M9.94184 38.8774C9.94184 32.0069 17.4264 26.2222 27.632 24.4577V18.2981C12.023 20.1854 0.246826 28.6783 0.246826 38.8774C0.246826 49.0766 12.8891 58.1769 29.3319 59.6312V53.5557C18.2666 52.166 9.94184 46.1228 9.94184 38.8774Z",fill:"#B3B3B3"}),s.createElement("path",{d:"M29.332 5.09999V59.6377L39.027 55.0746V0.362366L29.332 5.09999Z",fill:"#F8931E"})),defaultConfig:{url:"",openid_configuration_path:"",scope:"openid email profile",client_id:"",client_secret:""}},{id:"adfs",name:"AD FS",hiddenIfDisabled:!0,disabledForRecover:!0,icon:s.createElement("svg",{width:"65",height:"64",viewBox:"0 0 65 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M64.5443 48.7454V62.166C64.5443 63.7378 64.0607 64.0602 62.5695 63.8184C52.5746 62.3272 42.4587 60.957 32.3831 59.5464C30.5695 59.3046 29.9247 58.6597 29.9247 56.6849C30.0859 49.5514 30.0053 42.3776 29.9247 35.1635C29.9247 33.5917 30.4083 33.1081 31.9801 33.1081C42.2975 33.1887 52.4536 33.1887 62.5695 33.1887C64.2219 33.1887 64.6249 33.8335 64.6249 35.3247C64.4637 39.8386 64.5443 44.2718 64.5443 48.7454Z",fill:"#00AAF2"}),s.createElement("path",{d:"M47.416 30.6093C42.3379 30.6093 37.2598 30.5287 32.1817 30.6093C30.6099 30.6093 29.9651 30.2869 29.9651 28.4733C30.0457 21.1786 30.0457 14.0048 29.9651 6.79069C29.9651 5.38011 30.4487 4.89648 31.7787 4.65467C42.1767 3.16349 52.5747 1.7126 62.9726 0.140816C64.7862 -0.100997 64.4638 1.10807 64.4638 2.11563C64.4638 8.56399 64.5444 15.1333 64.4638 21.5816C64.4638 23.9595 64.3832 26.3373 64.4638 28.7151C64.5444 30.2063 63.9802 30.6093 62.5696 30.6093C57.5721 30.5287 52.4941 30.6093 47.416 30.6093Z",fill:"#00AAF2"}),s.createElement("path",{d:"M13.8038 33.3096H25.1691C26.3782 33.3096 26.9021 33.7126 26.9021 34.962V57.37C26.9021 58.6597 26.3378 58.7806 25.1691 58.6597C17.6326 57.5312 10.096 56.4431 2.59981 55.3952C1.10863 55.1534 0.625 54.6698 0.625 53.098C0.705605 47.1332 0.705605 41.1685 0.625 35.0829C0.625 33.5917 1.02802 33.1887 2.51921 33.1887C6.34792 33.3096 10.0154 33.3096 13.8038 33.3096Z",fill:"#00AAF2"}),s.createElement("path",{d:"M13.8038 30.6093H2.59977C1.18919 30.6093 0.705566 30.1257 0.705566 28.6345C0.786171 22.7504 0.786171 16.8663 0.705566 10.9418C0.705566 9.53126 1.10859 9.04763 2.59977 8.80582C10.1363 7.83856 17.6728 6.7504 25.169 5.54133C26.902 5.29952 27.0633 5.86375 27.0633 7.27433V28.7151C27.0633 30.2869 26.4184 30.5287 25.0078 30.5287C21.2597 30.5287 17.4713 30.6093 13.8038 30.6093Z",fill:"#00AAF2"})),defaultConfig:{url:"",openid_configuration_path:"",scope:"openid email profile",client_id:"",client_secret:""}}],Co="form",So="success";class _o extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{uiState:Co,hasSuccessfullySignedInWithSso:!1,processing:!1,ssoToken:null}}bindCallbacks(){this.handleSignInTestClick=this.handleSignInTestClick.bind(this),this.handleActivateSsoSettings=this.handleActivateSsoSettings.bind(this),this.handleCloseDialog=this.handleCloseDialog.bind(this)}async handleSignInTestClick(e){e.preventDefault();try{this.setState({processing:!0});const e=await this.props.context.port.request("passbolt.sso.dry-run",this.props.configurationId);this.setState({uiState:So,hasSuccessfullySignedInWithSso:!0,ssoToken:e})}catch(e){"UserAbortsOperationError"!==e?.name&&this.props.adminSsoContext.handleError(e)}this.setState({processing:!1})}async handleActivateSsoSettings(e){e.preventDefault();try{this.setState({processing:!0}),await this.props.context.port.request("passbolt.sso.activate-settings",this.props.configurationId,this.state.ssoToken),await this.props.context.port.request("passbolt.sso.generate-sso-kit",this.props.provider.id),this.props.onSuccessfulSettingsActivation(),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The SSO settings have been saved successfully"))}catch(e){this.props.adminSsoContext.handleError(e)}this.setState({processing:!1}),this.handleCloseDialog()}handleCloseDialog(){this.props.onClose(),this.props.handleClose()}hasAllInputDisabled(){return this.state.processing}canSaveSettings(){return!this.hasAllInputDisabled()&&this.state.hasSuccessfullySignedInWithSso}get title(){return{form:this.translate("Test Single Sign-On configuration"),success:this.translate("Save Single Sign-On configuration")}[this.state.uiState]||""}get translate(){return this.props.t}render(){return s.createElement(wt,{className:"test-sso-settings-dialog sso-login-form",title:this.title,onClose:this.handleCloseDialog,disabled:this.hasAllInputDisabled()},s.createElement("form",{onSubmit:this.handleActivateSsoSettings},s.createElement("div",{className:"form-content"},this.state.uiState===Co&&s.createElement(s.Fragment,null,s.createElement("p",null,s.createElement(v.x6,null,"Before saving the settings, we need to test if the configuration is working.")),s.createElement("button",{type:"button",className:`sso-login-button ${this.props.provider.id}`,onClick:this.handleSignInTestClick,disabled:this.hasAllInputDisabled()},s.createElement("span",{className:"provider-logo"},this.props.provider.icon),this.translate("Sign in with {{providerName}}",{providerName:this.props.provider.name}))),this.state.uiState===So&&s.createElement("p",null,this.translate("You susccessfully signed in with your {{providerName}} account. You can safely save your configuration.",{providerName:this.props.provider.name}))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:this.hasAllInputDisabled(),onClick:this.handleCloseDialog}),s.createElement(yn,{disabled:!this.canSaveSettings(),processing:this.state.processing,value:this.translate("Save settings")}))))}}_o.propTypes={context:r().object,adminSsoContext:r().object,onClose:r().func,t:r().func,provider:r().object,configurationId:r().string,actionFeedbackContext:r().any,handleClose:r().func,onSuccessfulSettingsActivation:r().func};const No=I(el(d((0,v.CI)("common")(_o))));class Io extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{processing:!1}}bindCallbacks(){this.handleConfirmDelete=this.handleConfirmDelete.bind(this)}async handleConfirmDelete(e){e.preventDefault(),this.setState({processing:!0}),await this.props.adminSsoContext.deleteSettings(),this.setState({processing:!1}),this.props.onClose()}hasAllInputDisabled(){return this.state.processing}render(){const e=this.hasAllInputDisabled();return s.createElement(wt,{className:"delete-sso-settings-dialog",title:this.props.t("Disable Single Sign-On settings?"),onClose:this.props.onClose,disabled:e},s.createElement("form",{onSubmit:this.handleConfirmDelete,noValidate:!0},s.createElement("div",{className:"form-content"},s.createElement("p",null,s.createElement(v.x6,null,"Are you sure you want to disable the current Single Sign-On settings?")),s.createElement("p",null,s.createElement(v.x6,null,"This action cannot be undone. All the data associated with SSO will be permanently deleted."))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement(Ma,{disabled:e,onClick:this.props.onClose}),s.createElement(yn,{warning:!0,disabled:e,processing:this.state.processing,value:this.props.t("Disable")}))))}}Io.propTypes={adminSsoContext:r().object,onClose:r().func,t:r().func};const Po=el((0,v.CI)("common")(Io)),Ao=["https://login.microsoftonline.com","https://login.microsoftonline.us","https://login.partner.microsoftonline.cn"],To=/^https:\/\/login\.(microsoftonline\.(com|us)|partner\.microsoftonline\.cn)$/;class Ro extends te{constructor(e,t={}){const a=Ro.sanitizeDto(e);super(X.validate(Ro.ENTITY_NAME,a,Ro.getSchema()),t)}static getSchema(){return{type:"object",required:["url","client_id","tenant_id","client_secret","client_secret_expiry"],properties:{url:{type:"string",pattern:To},client_id:{type:"string",format:"uuid"},tenant_id:{type:"string",format:"uuid"},client_secret:{type:"string",minLength:1},client_secret_expiry:{type:"string",format:"date-time"},email_claim:{type:"string",enum:["email","preferred_username","upn"]},prompt:{type:"string",enum:["login","none"]}}}}static sanitizeDto(e){return e=Object.assign({},e),e?.email_claim||(e.email_claim="email"),e?.prompt||(e.prompt="login"),e}static get ENTITY_NAME(){return"AzureSsoSettings"}static get PROVIDER_ID(){return"azure"}static get SUPPORTED_URLS(){return Ao}}const Do=Ro;class Oo{constructor(e={}){this.url=e?.url,this.client_id=e?.client_id,this.tenant_id=e?.tenant_id,this.client_secret=e?.client_secret,this.email_claim=e?.email_claim,this.prompt=e?.prompt,e?.client_secret_expiry&&(this.client_secret_expiry=e.client_secret_expiry.toString().substring(0,10)),e?.id&&(this.id=e.id)}get provider(){return Do.PROVIDER_ID}static getSchema(){const e=Do.getSchema();return{type:"object",required:["url","client_id","tenant_id","client_secret","client_secret_expiry","email_claim","prompt"],properties:{id:{type:"string",format:"uuid"},url:e.properties.url,client_id:e.properties.client_id,tenant_id:e.properties.tenant_id,client_secret:e.properties.client_secret,client_secret_expiry:e.properties.client_secret_expiry,email_claim:e.properties.email_claim,prompt:e.properties.prompt}}}static isDataDifferent(e,t){return["url","client_id","tenant_id","client_secret","client_secret_expiry","email_claim","prompt"].some((a=>e[a]!==t[a]))}isDataDifferent(e){return!(e instanceof Oo)||Oo.isDataDifferent(this,e)}toDto(){return{id:this.id,provider:this.provider,url:this.url,client_id:this.client_id,tenant_id:this.tenant_id,client_secret:this.client_secret,client_secret_expiry:this.client_secret_expiry,email_claim:this.email_claim,prompt:this.prompt}}cloneWithMutation(e,t){const a=this.toDto();return a[e]=t,new Oo(a)}validate(){const e=Oo.getSchema();try{X.validate(this.constructor.name,this,e)}catch(e){if(!(e instanceof $))throw e;return e}return new $}static fromEntityDto(e){const t=e.data,a={id:e?.id,url:t.url,client_id:t.client_id,tenant_id:t.tenant_id,client_secret:t.client_secret,client_secret_expiry:t.client_secret_expiry,email_claim:t.email_claim,prompt:t.prompt};return new Oo(a)}toEntityDto(){let e=this.client_secret_expiry;return this.client_secret_expiry&&(e+=" 00:00:00"),{provider:this.provider,data:{url:this.url,client_id:this.client_id,tenant_id:this.tenant_id,client_secret:this.client_secret,client_secret_expiry:e,email_claim:this.email_claim,prompt:this.prompt}}}}const Uo=Oo,Mo=/^https:\/\/.+[^\/]$/;class Fo extends te{constructor(e,t={}){super(X.validate(Fo.ENTITY_NAME,e,Fo.getSchema()),t)}static getSchema(){return{type:"object",required:["url","openid_configuration_path","scope","client_id","client_secret"],properties:{url:{type:"string",pattern:Mo},openid_configuration_path:{type:"string",minLength:1},scope:{type:"string",minLength:1},client_id:{type:"string",minLength:1},client_secret:{type:"string",minLength:1}}}}static get ENTITY_NAME(){return"OAuth2SsoSettings"}static get PROVIDER_ID(){return"oauth2"}}const jo=Fo;class zo{constructor(e={}){this.url=e?.url,this.openid_configuration_path=e?.openid_configuration_path,this.scope=e?.scope,this.client_id=e?.client_id,this.client_secret=e?.client_secret,e?.id&&(this.id=e.id)}get provider(){return jo.PROVIDER_ID}static getSchema(){const e=jo.getSchema();return{type:"object",required:["url","openid_configuration_path","scope","client_id","client_secret"],properties:{id:{type:"string",format:"uuid"},url:e.properties.url,openid_configuration_path:e.properties.openid_configuration_path,scope:e.properties.scope,client_id:e.properties.client_id,client_secret:e.properties.client_secret}}}static isDataDifferent(e,t){return["url","openid_configuration_path","scope","client_id","client_secret"].some((a=>e[a]!==t[a]))}isDataDifferent(e){return!(e instanceof zo)||zo.isDataDifferent(this,e)}toDto(){return{id:this.id,provider:this.provider,url:this.url,openid_configuration_path:this.openid_configuration_path,scope:this.scope,client_id:this.client_id,client_secret:this.client_secret}}cloneWithMutation(e,t){const a=this.toDto();return a[e]=t,new zo(a)}validate(){const e=zo.getSchema();try{X.validate(this.constructor.name,this,e)}catch(e){if(!(e instanceof $))throw e;return e}return new $}static fromEntityDto(e){const t=e.data,a={id:e?.id,url:t.url,openid_configuration_path:t.openid_configuration_path,scope:t.scope,client_id:t.client_id,client_secret:t.client_secret};return new zo(a)}toEntityDto(){return{provider:this.provider,data:{url:this.url,openid_configuration_path:this.openid_configuration_path,scope:this.scope,client_id:this.client_id,client_secret:this.client_secret}}}}const Lo=zo,qo=["https://accounts.google.com"];class Ko extends te{constructor(e,t={}){super(X.validate(Ko.ENTITY_NAME,e,Ko.getSchema()),t)}static getSchema(){return{type:"object",required:["client_id","client_secret"],properties:{client_id:{type:"string",minLength:1},client_secret:{type:"string",minLength:1}}}}static get ENTITY_NAME(){return"GoogleSsoSettings"}static get PROVIDER_ID(){return"google"}static get SUPPORTED_URLS(){return qo}}const Wo=Ko;class Vo{constructor(e={}){this.client_id=e?.client_id,this.client_secret=e?.client_secret,e?.id&&(this.id=e.id)}get provider(){return Wo.PROVIDER_ID}static getSchema(){const e=Wo.getSchema();return{type:"object",required:["client_id","client_secret"],properties:{id:{type:"string",format:"uuid"},client_id:e.properties.client_id,client_secret:e.properties.client_secret}}}static isDataDifferent(e,t){return["client_id","client_secret"].some((a=>e[a]!==t[a]))}isDataDifferent(e){return!(e instanceof Vo)||Vo.isDataDifferent(this,e)}toDto(){return{id:this.id,provider:this.provider,client_id:this.client_id,client_secret:this.client_secret}}cloneWithMutation(e,t){const a=this.toDto();return a[e]=t,new Vo(a)}validate(){const e=Vo.getSchema();try{X.validate(this.constructor.name,this,e)}catch(e){if(!(e instanceof $))throw e;return e}return new $}static fromEntityDto(e){const t=e.data,a={id:e?.id,client_id:t.client_id,client_secret:t.client_secret};return new Vo(a)}toEntityDto(){return{provider:this.provider,data:{client_id:this.client_id,client_secret:this.client_secret}}}}const Bo=Vo,Go=/^https:\/\/.+[^\/]$/;class $o extends te{constructor(e,t={}){super(X.validate($o.ENTITY_NAME,e,$o.getSchema()),t)}static getSchema(){return{type:"object",required:["url","openid_configuration_path","scope","client_id","client_secret"],properties:{url:{type:"string",pattern:Go},openid_configuration_path:{type:"string",minLength:1},scope:{type:"string",minLength:1},client_id:{type:"string",minLength:1},client_secret:{type:"string",minLength:1}}}}static validateUrl(e){if("string"!=typeof e)throw new TypeError("The url should be a string.");let t;try{t=new URL(e)}catch(e){throw new Error("The url should be a valid url.")}if("https:"!==t.protocol)throw new Error("The url protocol should be HTTPS.")}static get ENTITY_NAME(){return"ADFSSsoSettings"}static get PROVIDER_ID(){return"adfs"}}const Ho=$o;class Yo{constructor(e={}){this.url=e?.url,this.openid_configuration_path=e?.openid_configuration_path,this.scope=e?.scope,this.client_id=e?.client_id,this.client_secret=e?.client_secret,e?.id&&(this.id=e.id)}get provider(){return Ho.PROVIDER_ID}static getSchema(){const e=Ho.getSchema();return{type:"object",required:["url","openid_configuration_path","scope","client_id","client_secret"],properties:{id:{type:"string",format:"uuid"},url:e.properties.url,openid_configuration_path:e.properties.openid_configuration_path,scope:e.properties.scope,client_id:e.properties.client_id,client_secret:e.properties.client_secret}}}static isDataDifferent(e,t){return["url","openid_configuration_path","scope","client_id","client_secret"].some((a=>e[a]!==t[a]))}isDataDifferent(e){return!(e instanceof Yo)||Yo.isDataDifferent(this,e)}toDto(){return{id:this.id,provider:this.provider,url:this.url,openid_configuration_path:this.openid_configuration_path,scope:this.scope,client_id:this.client_id,client_secret:this.client_secret}}cloneWithMutation(e,t){const a=this.toDto();return a[e]=t,new Yo(a)}validate(){const e=Yo.getSchema();try{X.validate(this.constructor.name,this,e)}catch(e){if(!(e instanceof $))throw e;return e}return new $}static fromEntityDto(e){const t=e.data,a={id:e?.id,url:t.url,openid_configuration_path:t.openid_configuration_path,scope:t.scope,client_id:t.client_id,client_secret:t.client_secret};return new Yo(a)}toEntityDto(){return{provider:this.provider,data:{url:this.url,openid_configuration_path:this.openid_configuration_path,scope:this.scope,client_id:this.client_id,client_secret:this.client_secret}}}}const Jo=Yo;function Zo(){return Zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Zo.apply(null,arguments)}const Qo=s.createContext({ssoConfig:null,canDeleteSettings:()=>{},isProcessing:()=>{},loadSsoConfiguration:()=>{},getSsoConfiguration:()=>{},getProviderList:()=>{},isSsoConfigActivated:()=>{},isDataReady:()=>{},save:()=>{},disableSso:()=>{},hasFormChanged:()=>{},validateData:()=>{},saveAndTestConfiguration:()=>{},openTestDialog:()=>{},handleError:()=>{},getErrors:()=>{},deleteSettings:()=>{},showDeleteConfirmationDialog:()=>{}});class Xo extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.isSsoConfigExisting=!1,this.shouldFocusOnError=!1}get defaultState(){return{ssoConfig:null,providers:[],errors:null,originalConfig:null,cachedSsoConfig:{},isLoaded:!1,processing:!1,hasBeenValidated:!1,hasFormChanged:this.hasFormChanged.bind(this),isProcessing:this.isProcessing.bind(this),isDataReady:this.isDataReady.bind(this),loadSsoConfiguration:this.loadSsoConfiguration.bind(this),getSsoConfiguration:this.getSsoConfiguration.bind(this),getProviderList:this.getProviderList.bind(this),isSsoConfigActivated:this.isSsoConfigActivated.bind(this),changeProvider:this.changeProvider.bind(this),disableSso:this.disableSso.bind(this),setValue:this.setValue.bind(this),validateData:this.validateData.bind(this),saveAndTestConfiguration:this.saveAndTestConfiguration.bind(this),handleError:this.handleError.bind(this),getErrors:this.getErrors.bind(this),deleteSettings:this.deleteSettings.bind(this),canDeleteSettings:this.canDeleteSettings.bind(this),showDeleteConfirmationDialog:this.showDeleteConfirmationDialog.bind(this),consumeFocusOnError:this.consumeFocusOnError.bind(this)}}bindCallbacks(){this.handleTestConfigCloseDialog=this.handleTestConfigCloseDialog.bind(this),this.handleSettingsActivation=this.handleSettingsActivation.bind(this)}async loadSsoConfiguration(){let e=null;try{e=await this.props.context.port.request("passbolt.sso.get-current")}catch(e){return void this.props.dialogContext.open(Pt,{error:e})}this.isSsoConfigExisting=Boolean(e.provider);const t=this.getSsoProviderViewModel(e);this.setState({ssoConfig:t,originalConfig:t,providers:e.providers,isLoaded:!0})}getSsoProviderViewModel(e){if(!e?.provider)return null;switch(e.provider){case Do.PROVIDER_ID:return Uo.fromEntityDto(e);case Wo.PROVIDER_ID:return Bo.fromEntityDto(e);case jo.PROVIDER_ID:return Lo.fromEntityDto(e);case Ho.PROVIDER_ID:return Jo.fromEntityDto(e)}return null}getSsoConfiguration(){return this.state.ssoConfig}getProviderList(){return this.state.providers}getSsoConfigurationDto(){return this.state.ssoConfig.toEntityDto()}isSsoConfigActivated(){return Boolean(this.state.ssoConfig)}hasFormChanged(){return null!==this.state.originalConfig&&null===this.state.ssoConfig||null===this.state.originalConfig&&null!==this.state.ssoConfig||this.state.originalConfig?.isDataDifferent(this.state.ssoConfig)}setValue(e,t){const a=this.state.ssoConfig.cloneWithMutation(e,t);this.setState({ssoConfig:a},(()=>{this.state.hasBeenValidated&&this.validateData()}))}disableSso(){const e=this.state.cachedSsoConfig;e[this.state.ssoConfig.provider]=this.state.ssoConfig,this.setState({ssoConfig:null,cachedSsoConfig:e})}isDataReady(){return this.state.isLoaded}isProcessing(){return this.state.processing}changeProvider(e){if(e.disabled)return;const t=this.state.cachedSsoConfig,a=this.state.ssoConfig?.provider;a&&(t[a]=this.state.ssoConfig),this.setState({ssoConfig:this.getCachedSsoConfigOrDefault(e.id),cachedSsoConfig:t},(()=>{this.state.hasBeenValidated&&this.validateData()}))}getCachedSsoConfigOrDefault(e){if(this.state.cachedSsoConfig[e])return this.state.cachedSsoConfig[e];const t=xo.find((t=>t.id===e)),a={id:this.state.ssoConfig?.id,provider:e,data:t.defaultConfig};return this.getSsoProviderViewModel(a)}validateData(e=!1){const t=this.state.ssoConfig.validate(),a=t.hasErrors(),s=a?t:null;return this.setState({errors:s,hasBeenValidated:!0}),this.shouldFocusOnError=e&&a,!a}consumeFocusOnError(){const e=this.shouldFocusOnError;return this.shouldFocusOnError=!1,e}getErrors(){return this.state.errors}async saveAndTestConfiguration(){this.setState({processing:!0});const e=this.getSsoConfigurationDto();let t;try{t=await this.props.context.port.request("passbolt.sso.save-draft",e)}catch(e){return this.handleError(e),void this.setState({processing:!1})}await this.runTestConfig(t);const a=this.getSsoProviderViewModel(t);this.setState({ssoConfig:a})}canDeleteSettings(){return this.isSsoConfigExisting&&null===this.state.ssoConfig}showDeleteConfirmationDialog(){this.props.dialogContext.open(Po)}async deleteSettings(){this.setState({processing:!0});try{const e=this.state.originalConfig.id;await this.props.context.port.request("passbolt.sso.delete-settings",e),this.props.actionFeedbackContext.displaySuccess(this.props.t("The SSO settings have been deleted successfully")),this.isSsoConfigExisting=!1,this.setState({ssoConfig:null,originalConfig:null,processing:!1})}catch(e){this.handleError(e),this.setState({processing:!1})}}async runTestConfig(e){const t=xo.find((t=>t.id===e.provider));this.props.dialogContext.open(No,{provider:t,configurationId:e.id,handleClose:this.handleTestConfigCloseDialog,onSuccessfulSettingsActivation:this.handleSettingsActivation})}handleTestConfigCloseDialog(){this.setState({processing:!1})}handleSettingsActivation(){this.isSsoConfigExisting=!0,this.setState({originalConfig:this.state.ssoConfig})}handleError(e){console.error(e),this.props.dialogContext.open(Pt,{error:e})}render(){return s.createElement(Qo.Provider,{value:this.state},this.props.children)}}function el(e){return class extends s.Component{render(){return s.createElement(Qo.Consumer,null,(t=>s.createElement(e,Zo({adminSsoContext:t},this.props))))}}}Xo.propTypes={context:r().any,children:r().any,accountRecoveryContext:r().object,dialogContext:r().object,actionFeedbackContext:r().object,t:r().func},I(d(g((0,v.CI)("common")(Xo))));class tl extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this)}async handleSaveClick(){const e=this.props.adminSsoContext;e.canDeleteSettings()?e.showDeleteConfirmationDialog():e.validateData(!0)&&await e.saveAndTestConfiguration()}isSaveEnabled(){return Boolean(this.props.adminSsoContext.ssoConfig?.provider)||this.props.adminSsoContext.canDeleteSettings()}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary form",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}tl.propTypes={adminSsoContext:r().object};const al=el((0,v.CI)("common")(tl));var sl;function nl(){return nl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},nl.apply(null,arguments)}const il=function(e){return s.createElement("svg",nl({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),sl||(sl=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#copy_svg__clip0_57_467942)"},s.createElement("path",{d:"M15 6H7.5A1.5 1.5 0 0 0 6 7.5V15a1.5 1.5 0 0 0 1.5 1.5H15a1.5 1.5 0 0 0 1.5-1.5V7.5A1.5 1.5 0 0 0 15 6"}),s.createElement("path",{d:"M3 12c-.825 0-1.5-.675-1.5-1.5V3c0-.825.675-1.5 1.5-1.5h7.5c.825 0 1.5.675 1.5 1.5"}))))};class rl extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.createRefs()}get defaultState(){return{advancedSettingsOpened:!1}}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this),this.handleCopyRedirectUrl=this.handleCopyRedirectUrl.bind(this),this.handleAdvancedSettingsCLick=this.handleAdvancedSettingsCLick.bind(this)}createRefs(){this.clientIdInputRef=s.createRef(),this.tenantIdInputRef=s.createRef(),this.clientSecretInputRef=s.createRef(),this.clientSecretExpiryInputRef=s.createRef()}componentDidUpdate(){if(!this.props.adminSsoContext.consumeFocusOnError())return;const e=this.props.adminSsoContext.getErrors();switch(this.getFirstFieldInError(e,["client_id","tenant_id","client_secret","client_secret_expiry"])){case"client_id":this.clientIdInputRef.current.focus();break;case"tenant_id":this.tenantIdInputRef.current.focus();break;case"client_secret":this.clientSecretInputRef.current.focus();break;case"client_secret_expiry":this.clientSecretExpiryInputRef.current.focus()}}getFirstFieldInError(e,t){for(let a=0;a<t.length;a++){const s=t[a];if(e.hasError(s))return s}return null}handleInputChange(e){const t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;this.props.adminSsoContext.setValue(s,a)}handleAdvancedSettingsCLick(){this.setState({advancedSettingsOpened:!this.state.advancedSettingsOpened})}async handleCopyRedirectUrl(){await navigator.clipboard.writeText(this.fullRedirectUrl),await this.props.actionFeedbackContext.displaySuccess(this.translate("The redirection URL has been copied to the clipboard."))}hasAllInputDisabled(){return this.props.adminSsoContext.isProcessing()}displayErrors(e){return Object.values(e)}get availableUrlList(){return Do.SUPPORTED_URLS.map((e=>({value:e,label:e})))}get emailClaimList(){return[{value:"email",label:this.translate("Email")},{value:"preferred_username",label:this.translate("Preferred username")},{value:"upn",label:this.translate("UPN")}]}get promptOptionList(){return[{value:"login",label:this.translate("Login")},{value:"none",label:this.translate("None")}]}get fullRedirectUrl(){return`${this.props.context.userSettings.getTrustedDomain()}/sso/azure/redirect`}get translate(){return this.props.t}render(){const e=this.props.adminSsoContext,t=e.getSsoConfiguration(),a=e.getErrors();return s.createElement(s.Fragment,null,s.createElement("div",{className:"select-wrapper input required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"sso-azure-url-input"},s.createElement(v.x6,null,"Login URL")),s.createElement(Oa,{id:"sso-azure-url-input",name:"url",items:this.availableUrlList,value:t.url,onChange:this.handleInputChange}),s.createElement("p",null,s.createElement(v.x6,null,"The Azure AD authentication endpoint. See ",s.createElement("a",{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/authentication-national-cloud#azure-ad-authentication-endpoints",rel:"noopener noreferrer",target:"_blank"},"alternatives"),"."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Redirect URL")),s.createElement("div",{className:"button-inline"},s.createElement("input",{id:"sso-redirect-url-input",type:"text",className:"fluid form-element disabled",name:"redirect_url",value:this.fullRedirectUrl,placeholder:this.translate("Redirect URL"),readOnly:!0,disabled:!0}),s.createElement("button",{type:"button",onClick:this.handleCopyRedirectUrl,className:"copy-to-clipboard button-icon"},s.createElement(il,null))),s.createElement("p",null,s.createElement(v.x6,null,"The URL to provide to Azure when registering the application."))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Application (client) ID")),s.createElement("input",{id:"sso-azure-client-id-input",type:"text",className:"fluid form-element",name:"client_id",ref:this.clientIdInputRef,value:t.client_id,onChange:this.handleInputChange,placeholder:this.translate("Application (client) ID"),disabled:this.hasAllInputDisabled()}),a?.hasError("client_id")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_id"))),s.createElement("p",null,s.createElement(v.x6,null,"The public identifier for the app in Azure in UUID format.")," ",s.createElement("a",{href:"https://learn.microsoft.com/en-us/azure/healthcare-apis/register-application#application-id-client-id",rel:"noopener noreferrer",target:"_blank"},s.createElement(v.x6,null,"Where to find it?")))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Directory (tenant) ID")),s.createElement("input",{id:"sso-azure-tenant-id-input",type:"text",className:"fluid form-element",name:"tenant_id",ref:this.tenantIdInputRef,value:t.tenant_id,onChange:this.handleInputChange,placeholder:this.translate("Directory ID"),disabled:this.hasAllInputDisabled()}),a?.hasError("tenant_id")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("tenant_id"))),s.createElement("p",null,s.createElement(v.x6,null,"The Azure Active Directory tenant ID, in UUID format.")," ",s.createElement("a",{href:"https://learn.microsoft.com/en-gb/azure/active-directory/fundamentals/active-directory-how-to-find-tenant",rel:"noopener noreferrer",target:"_blank"},s.createElement(v.x6,null,"Where to find it?")))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Secret")),s.createElement(va,{id:"sso-azure-secret-input",className:"fluid form-element",onChange:this.handleInputChange,autoComplete:"off",name:"client_secret",placeholder:this.translate("Secret"),disabled:this.hasAllInputDisabled(),value:t.client_secret,preview:!0,inputRef:this.clientSecretInputRef}),a?.hasError("client_secret")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_secret"))),s.createElement("p",null,s.createElement(v.x6,null,"Allows Azure and Passbolt API to securely share information.")," ",s.createElement("a",{href:"https://learn.microsoft.com/en-us/azure/marketplace/create-or-update-client-ids-and-secrets#add-a-client-id-and-client-secret",rel:"noopener noreferrer",target:"_blank"},s.createElement(v.x6,null,"Where to find it?")))),s.createElement("div",{className:"input text date-wrapper required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Secret expiry")),s.createElement("div",{className:"button-inline"},s.createElement("input",{id:"sso-azure-secret-expiry-input",type:"date",className:"fluid form-element "+(t.client_secret_expiry?"":"empty"),name:"client_secret_expiry",ref:this.clientSecretExpiryInputRef,value:t.client_secret_expiry||"",onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()}),s.createElement(il,null)),a?.hasError("client_secret_expiry")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_secret_expiry")))),s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement(v.x6,null,s.createElement("b",null,"Warning"),": This secret will expire after some time (typically a few months). Make sure you save the expiry date and rotate it on time."))),s.createElement("div",null,s.createElement("div",{className:"accordion operation-details "+(this.state.advancedSettingsOpened?"":"closed")},s.createElement("div",{className:"accordion-header",onClick:this.handleAdvancedSettingsCLick},s.createElement("button",{type:"button",className:"link no-border",id:"advanced-settings-panel-button"},this.state.advancedSettingsOpened?s.createElement(Ct,{className:"caret-down"}):s.createElement(Nt,{className:"caret-right"}),s.createElement(v.x6,null,"Advanced settings"))))),this.state.advancedSettingsOpened&&s.createElement(s.Fragment,null,s.createElement("div",{className:"select-wrapper input required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"email-claim-input"},s.createElement(v.x6,null,"Email claim")),s.createElement(Oa,{id:"email-claim-input",name:"email_claim",items:this.emailClaimList,value:t.email_claim,onChange:this.handleInputChange}),s.createElement("p",null,s.createElement(v.x6,null,"Defines which Azure field needs to be used as Passbolt username."))),"upn"===t.email_claim&&s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement(v.x6,null,s.createElement("b",null,"Warning"),": UPN is not active by default on Azure and requires a specific option set on Azure to be working."))),s.createElement("div",{className:"select-wrapper input required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"prompt-input"},s.createElement(v.x6,null,"Prompt")),s.createElement(Oa,{id:"prompt-input",name:"prompt",items:this.promptOptionList,value:t.prompt,onChange:this.handleInputChange}),s.createElement("p",null,s.createElement(v.x6,null,"Defines the Azure login behaviour by prompting the user to fully login each time or not.")))))}}rl.propTypes={adminSsoContext:r().object,actionFeedbackContext:r().any,context:r().any,t:r().func};const ol=I(d(el((0,v.CI)("common")(rl))));class ll extends s.PureComponent{constructor(e){super(e),this.bindCallbacks(),this.createRefs()}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this),this.handleCopyRedirectUrl=this.handleCopyRedirectUrl.bind(this)}createRefs(){this.clientIdInputRef=s.createRef(),this.clientSecretInputRef=s.createRef()}componentDidUpdate(){if(!this.props.adminSsoContext.consumeFocusOnError())return;const e=this.props.adminSsoContext.getErrors();switch(this.getFirstFieldInError(e,["client_id","client_secret"])){case"client_id":this.clientIdInputRef.current.focus();break;case"client_secret":this.clientSecretInputRef.current.focus()}}getFirstFieldInError(e,t){for(let a=0;a<t.length;a++){const s=t[a];if(e.hasError(s))return s}return null}handleInputChange(e){const t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;this.props.adminSsoContext.setValue(s,a)}async handleCopyRedirectUrl(){await navigator.clipboard.writeText(this.fullRedirectUrl),await this.props.actionFeedbackContext.displaySuccess(this.translate("The redirection URL has been copied to the clipboard."))}hasAllInputDisabled(){return this.props.adminSsoContext.isProcessing()}displayErrors(e){return Object.values(e)}get fullRedirectUrl(){return`${this.props.context.userSettings.getTrustedDomain()}/sso/google/redirect`}get translate(){return this.props.t}render(){const e=this.props.adminSsoContext,t=e.getSsoConfiguration(),a=e.getErrors();return s.createElement(s.Fragment,null,s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Redirect URL")),s.createElement("div",{className:"button-inline"},s.createElement("input",{id:"sso-redirect-url-input",type:"text",className:"fluid form-element disabled",name:"redirect_url",value:this.fullRedirectUrl,placeholder:this.translate("Redirect URL"),readOnly:!0,disabled:!0}),s.createElement("a",{onClick:this.handleCopyRedirectUrl,className:"copy-to-clipboard button button-icon"},s.createElement(il,null))),s.createElement("p",null,s.createElement(v.x6,null,"The URL to provide to Google when registering the application."))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Application (client) ID")),s.createElement("input",{id:"sso-google-client-id-input",type:"text",className:"fluid form-element",name:"client_id",ref:this.clientIdInputRef,value:t.client_id,onChange:this.handleInputChange,placeholder:this.translate("Application (client) ID"),disabled:this.hasAllInputDisabled()}),a?.hasError("client_id")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_id"))),s.createElement("p",null,s.createElement(v.x6,null,"The public identifier for the app in Google in UUID format.")," ",s.createElement("a",{href:"https://developers.google.com/identity/openid-connect/openid-connect#authenticationuriparameters",rel:"noopener noreferrer",target:"_blank"},s.createElement(v.x6,null,"Where to find it?")))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Secret")),s.createElement(va,{id:"sso-google-secret-input",className:"fluid form-element",onChange:this.handleInputChange,autoComplete:"off",name:"client_secret",placeholder:this.translate("Secret"),disabled:this.hasAllInputDisabled(),value:t.client_secret,preview:!0,inputRef:this.clientSecretInputRef}),a?.hasError("client_secret")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_secret"))),s.createElement("p",null,s.createElement(v.x6,null,"Allows Google and Passbolt API to securely share information.")," ",s.createElement("a",{href:"https://developers.google.com/identity/openid-connect/openid-connect#authenticationuriparameters",rel:"noopener noreferrer",target:"_blank"},s.createElement(v.x6,null,"Where to find it?")))))}}ll.propTypes={adminSsoContext:r().object,actionFeedbackContext:r().any,context:r().any,t:r().func};const cl=I(d(el((0,v.CI)("common")(ll))));class ml extends s.Component{constructor(e){super(e),this.bindCallbacks(),this.createRefs()}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this),this.handleCopyRedirectUrl=this.handleCopyRedirectUrl.bind(this)}createRefs(){this.urlInputRef=s.createRef(),this.clientIdInputRef=s.createRef(),this.clientSecretInputRef=s.createRef(),this.openIdConfigurationPathInputRef=s.createRef(),this.scopeInputRef=s.createRef()}componentDidUpdate(){if(!this.props.adminSsoContext.consumeFocusOnError())return;const e=this.props.adminSsoContext.getErrors();switch(this.getFirstFieldInError(e,["url","openid_configuration_path","scope","client_id","client_secret"])){case"url":this.urlInputRef.current.focus();break;case"openid_configuration_path":this.openIdConfigurationPathInputRef.current.focus();break;case"scope":this.scopeInputRef.current.focus();break;case"client_id":this.clientIdInputRef.current.focus();break;case"client_secret":this.clientSecretInputRef.current.focus()}}getFirstFieldInError(e,t){for(let a=0;a<t.length;a++){const s=t[a];if(e.hasError(s))return s}return null}handleInputChange(e){const t=e.target,a="checkbox"===t.type?t.checked:t.value,s=t.name;this.props.adminSsoContext.setValue(s,a)}async handleCopyRedirectUrl(){await navigator.clipboard.writeText(this.fullRedirectUrl),await this.props.actionFeedbackContext.displaySuccess(this.translate("The redirection URL has been copied to the clipboard."))}hasAllInputDisabled(){return this.props.adminSsoContext.isProcessing()}displayErrors(e){return Object.values(e)}get fullRedirectUrl(){return`${this.props.context.userSettings.getTrustedDomain()}/sso/oauth2/redirect`}get translate(){return this.props.t}render(){const e=this.props.adminSsoContext,t=e.getSsoConfiguration(),a=e.getErrors();return s.createElement(s.Fragment,null,s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Login URL")),s.createElement("input",{id:"sso-oauth2-url-input",type:"text",className:"fluid form-element",name:"url",ref:this.urlInputRef,value:t.url,onChange:this.handleInputChange,placeholder:this.translate("Login URL"),disabled:this.hasAllInputDisabled()}),a?.hasError("url")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("url"))),s.createElement("p",null,s.createElement(v.x6,null,"The OAuth2 authentication endpoint."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Redirect URL")),s.createElement("div",{className:"button-inline"},s.createElement("input",{id:"sso-redirect-url-input",type:"text",className:"fluid form-element disabled",name:"redirect_url",value:this.fullRedirectUrl,placeholder:this.translate("Redirect URL"),readOnly:!0,disabled:!0}),s.createElement("a",{onClick:this.handleCopyRedirectUrl,className:"copy-to-clipboard button button-icon"},s.createElement(il,null))),s.createElement("p",null,s.createElement(v.x6,null,"The URL to provide to the OAuth2 platform when registering the application."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"OpenId Configuration Path")),s.createElement("input",{id:"sso-oauth2-openid-configuration-path-input",type:"text",className:"fluid form-element",name:"openid_configuration_path",ref:this.openIdConfigurationPathInputRef,value:t.openid_configuration_path,onChange:this.handleInputChange,placeholder:this.translate("OpenId Configuration Path"),disabled:this.hasAllInputDisabled()}),a?.hasError("openid_configuration_path")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("openid_configuration_path"))),s.createElement("p",null,s.createElement(v.x6,null,"The OpenId configuration relative path from the given login url."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Scope")),s.createElement("input",{id:"sso-oauth2-scope-input",type:"text",className:"fluid form-element",name:"scope",ref:this.scopeInputRef,value:t.scope,onChange:this.handleInputChange,placeholder:this.translate("Scope"),disabled:this.hasAllInputDisabled()}),a?.hasError("scope")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("scope"))),s.createElement("p",null,s.createElement(v.x6,null,"The OpenId scope."))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Application (client) ID")),s.createElement("input",{id:"sso-oauth2-client-id-input",type:"text",className:"fluid form-element",name:"client_id",ref:this.clientIdInputRef,value:t.client_id,onChange:this.handleInputChange,placeholder:this.translate("Application (client) ID"),disabled:this.hasAllInputDisabled()}),a?.hasError("client_id")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_id"))),s.createElement("p",null,s.createElement(v.x6,null,"The public identifier for the OpenId app."))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Secret")),s.createElement(va,{id:"sso-oauth2-secret-input",className:"fluid form-element",onChange:this.handleInputChange,autoComplete:"off",name:"client_secret",placeholder:this.translate("Secret"),disabled:this.hasAllInputDisabled(),value:t.client_secret,preview:!0,inputRef:this.clientSecretInputRef}),a?.hasError("client_secret")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_secret"))),s.createElement("p",null,s.createElement(v.x6,null,"Allows your OAuth2 provider and Passbolt API to securely share information."))))}}ml.propTypes={adminSsoContext:r().object,actionFeedbackContext:r().any,context:r().any,t:r().func};const dl=I(d(el((0,v.CI)("common")(ml))));class pl extends s.Component{constructor(e){super(e),this.bindCallbacks(),this.createRefs()}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this),this.handleCopyRedirectUrl=this.handleCopyRedirectUrl.bind(this)}createRefs(){this.urlInputRef=s.createRef(),this.clientIdInputRef=s.createRef(),this.clientSecretInputRef=s.createRef(),this.openIdConfigurationPathInputRef=s.createRef(),this.scopeInputRef=s.createRef()}componentDidUpdate(){if(!this.props.adminSsoContext.consumeFocusOnError())return;const e=this.props.adminSsoContext.getErrors();switch(this.getFirstFieldInError(e,["url","openid_configuration_path","scope","client_id","client_secret"])){case"url":this.urlInputRef.current.focus();break;case"openid_configuration_path":this.openIdConfigurationPathInputRef.current.focus();break;case"scope":this.scopeInputRef.current.focus();break;case"client_id":this.clientIdInputRef.current.focus();break;case"client_secret":this.clientSecretInputRef.current.focus()}}getFirstFieldInError(e,t){for(let a=0;a<t.length;a++){const s=t[a];if(e.hasError(s))return s}return null}handleInputChange(e){const{value:t,name:a}=e.target;this.props.adminSsoContext.setValue(a,t)}async handleCopyRedirectUrl(){await navigator.clipboard.writeText(this.fullRedirectUrl),await this.props.actionFeedbackContext.displaySuccess(this.translate("The redirection URL has been copied to the clipboard."))}hasAllInputDisabled(){return this.props.adminSsoContext.isProcessing()}displayErrors(e){return Object.values(e)}get fullRedirectUrl(){return`${this.props.context.userSettings.getTrustedDomain()}/sso/adfs/redirect`}get translate(){return this.props.t}render(){const e=this.props.adminSsoContext,t=e.getSsoConfiguration(),a=e.getErrors();return s.createElement(s.Fragment,null,s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Login URL")),s.createElement("input",{id:"sso-adfs-url-input",type:"text",className:"fluid form-element",name:"url",ref:this.urlInputRef,value:t.url,onChange:this.handleInputChange,placeholder:this.translate("Login URL"),disabled:this.hasAllInputDisabled()}),a?.hasError("url")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("url"))),s.createElement("p",null,s.createElement(v.x6,null,"The AD FS authentication endpoint."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Redirect URL")),s.createElement("div",{className:"button-inline"},s.createElement("input",{id:"sso-redirect-url-input",type:"text",className:"fluid form-element disabled",name:"redirect_url",value:this.fullRedirectUrl,placeholder:this.translate("Redirect URL"),readOnly:!0,disabled:!0}),s.createElement("a",{onClick:this.handleCopyRedirectUrl,className:"copy-to-clipboard button button-icon"},s.createElement(il,null))),s.createElement("p",null,s.createElement(v.x6,null,"The URL to provide to the AD FS platform when registering the application."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"OpenId Configuration Path")),s.createElement("input",{id:"sso-adfs-openid-configuration-path-input",type:"text",className:"fluid form-element",name:"openid_configuration_path",ref:this.openIdConfigurationPathInputRef,value:t.openid_configuration_path,onChange:this.handleInputChange,placeholder:this.translate("OpenId Configuration Path"),disabled:this.hasAllInputDisabled()}),a?.hasError("openid_configuration_path")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("openid_configuration_path"))),s.createElement("p",null,s.createElement(v.x6,null,"The AD FS configuration relative path from the given login url."))),s.createElement("div",{className:"input text input-wrapper "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Scope")),s.createElement("input",{id:"sso-adfs-scope-input",type:"text",className:"fluid form-element",name:"scope",ref:this.scopeInputRef,value:t.scope,onChange:this.handleInputChange,placeholder:this.translate("Scope"),disabled:this.hasAllInputDisabled()}),a?.hasError("scope")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("scope"))),s.createElement("p",null,s.createElement(v.x6,null,"The AD FS scope."))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Application (client) ID")),s.createElement("input",{id:"sso-adfs-client-id-input",type:"text",className:"fluid form-element",name:"client_id",ref:this.clientIdInputRef,value:t.client_id,onChange:this.handleInputChange,placeholder:this.translate("Application (client) ID"),disabled:this.hasAllInputDisabled()}),a?.hasError("client_id")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_id"))),s.createElement("p",null,s.createElement(v.x6,null,"The public identifier for the AD FS app."))),s.createElement("div",{className:"input text required "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",null,s.createElement(v.x6,null,"Secret")),s.createElement(va,{id:"sso-adfs-secret-input",className:"fluid form-element",onChange:this.handleInputChange,autoComplete:"off",name:"client_secret",placeholder:this.translate("Secret"),disabled:this.hasAllInputDisabled(),value:t.client_secret,preview:!0,inputRef:this.clientSecretInputRef}),a?.hasError("client_secret")&&s.createElement("div",{className:"error-message"},this.displayErrors(a.getError("client_secret"))),s.createElement("p",null,s.createElement(v.x6,null,"Allows your AD FS provider and Passbolt API to securely share information."))))}}pl.propTypes={adminSsoContext:r().object,actionFeedbackContext:r().any,context:r().any,t:r().func};const ul=I(d(el((0,v.CI)("common")(pl))));var hl;function gl(){return gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},gl.apply(null,arguments)}const bl=function(e){return s.createElement("svg",gl({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),hl||(hl=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15.75 9.75v4.5a1.5 1.5 0 0 1-1.5 1.5H3.75a1.5 1.5 0 0 1-1.5-1.5V3.75a1.5 1.5 0 0 1 1.5-1.5h4.5M15.75 2.25 9 9M11.25 2.25h4.5v4.5"})))};class yl extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{loading:!0,providers:[]}}async componentDidMount(){await this.props.adminSsoContext.loadSsoConfiguration(),this.setState({loading:!1,providers:this.props.adminSsoContext.getProviderList()||[]})}bindCallbacks(){this.handleProviderInputChange=this.handleProviderInputChange.bind(this),this.handleSsoSettingToggle=this.handleSsoSettingToggle.bind(this)}handleProviderInputChange(e){this.props.adminSsoContext.changeProvider({id:e.target.value})}handleSsoSettingToggle(){this.props.adminSsoContext.isSsoConfigActivated()&&this.props.adminSsoContext.disableSso()}hasAllInputDisabled(){return this.props.adminSsoContext.isProcessing()||this.state.loading}get allSsoProviders(){const e=this.state.providers;return xo.map((t=>{const a={...t};return a.disabled=Boolean(a.disabled)||!e.includes(a.id),a})).filter((e=>!e.disabled||e.disabled&&!e?.hiddenIfDisabled))}get supportedSsoProviders(){const e=this.state.providers,t=[];return e.forEach((e=>{const a=xo.find((t=>t.id===e));a&&!a.disabled&&t.push({value:a.id,label:a.name})})),t}isReady(){return this.props.adminSsoContext.isDataReady()}render(){const e=this.props.adminSsoContext,t=e.getSsoConfiguration(),a=e.isSsoConfigActivated();return s.createElement("div",{className:"row"},s.createElement("div",{className:"third-party-provider-settings sso-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title"},s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"ssoToggle",onChange:this.handleSsoSettingToggle,checked:a,disabled:this.hasAllInputDisabled(),id:"ssoToggle"}),s.createElement("label",{htmlFor:"ssoToggle"},s.createElement(v.x6,null,"Single Sign-On")))),this.isReady()&&!a&&s.createElement(s.Fragment,null,s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Select a provider")),s.createElement("div",{className:"provider-list"},this.allSsoProviders.map((e=>s.createElement("div",{key:e.id,className:"provider button "+(e.disabled?"disabled":""),id:e.id,onClick:()=>this.props.adminSsoContext.changeProvider(e)},s.createElement("div",{className:"provider-logo"},e.icon),s.createElement("p",{className:"provider-name"},e.name,s.createElement("br",null),e.disabled&&s.createElement(v.x6,null,"(not yet available)"))))))),this.isReady()&&a&&s.createElement("form",{className:"form"},s.createElement("div",{className:"select-wrapper input"},s.createElement("label",{htmlFor:"sso-provider-input"},s.createElement(v.x6,null,"Single Sign-On provider")),s.createElement(Oa,{id:"sso-provider-input",name:"provider",items:this.supportedSsoProviders,value:t?.provider,onChange:this.handleProviderInputChange})),t?.provider===Do.PROVIDER_ID&&s.createElement(ol,null),t?.provider===Wo.PROVIDER_ID&&s.createElement(cl,null),t?.provider===jo.PROVIDER_ID&&s.createElement(dl,null),t?.provider===Ho.PROVIDER_ID&&s.createElement(ul,null))),this.props.adminSsoContext.hasFormChanged()&&s.createElement("div",{className:"warning message",id:"sso-setting-overridden-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(al,null),Ea(s.createElement(s.Fragment,null,s.createElement("div",{className:"sidebar-help-section warning message",id:"sso-setting-security-warning-banner"},s.createElement("h3",null,s.createElement(v.x6,null,"Important notice:")),s.createElement("p",null,s.createElement(v.x6,null,"Enabling SSO changes the security risks.")," ",s.createElement(v.x6,null,"For example an attacker with a local machine access maybe be able to access secrets, if the user is still logged in with the Identity provider.")," ",s.createElement(v.x6,null,"Make sure users follow screen lock best practices.")," ",s.createElement("a",{href:"https://passbolt.com/docs/admin/authentication/sso/",target:"_blank",rel:"noopener noreferrer"},s.createElement(v.x6,null,"Learn more")))),s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need some help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about SSO, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/authentication/sso/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),t?.provider===Do.PROVIDER_ID&&s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"How do I configure a AzureAD SSO?")),s.createElement("a",{className:"button",href:"https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/add-application-portal-setup-sso",target:"_blank",rel:"noopener noreferrer"},s.createElement(bl,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),t?.provider===Wo.PROVIDER_ID&&s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"How do I configure a Google SSO?")),s.createElement("a",{className:"button",href:"https://developers.google.com/identity/openid-connect/openid-connect",target:"_blank",rel:"noopener noreferrer"},s.createElement(bl,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),t?.provider===Ho.PROVIDER_ID&&s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"How do I configure an AD FS SSO?")),s.createElement("a",{className:"button",href:"https://learn.microsoft.com/en-gb/microsoft-365/troubleshoot/active-directory/set-up-adfs-for-single-sign-on",target:"_blank",rel:"noopener noreferrer"},s.createElement(bl,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation"))))),document.getElementById("administration-help-panel")))}}yl.propTypes={administrationWorkspaceContext:r().object,adminSsoContext:r().object,actionFeedbackContext:r().any,context:r().any,t:r().func};const fl=I(d(Ee(el((0,v.CI)("common")(yl))))),vl=class{constructor(e={remember_me_for_a_month:!1}){this.policy=e.policy,this.rememberMeForAMonth=e.remember_me_for_a_month}},El=class{constructor(e){e.setResourceName("mfa-policies/settings"),this.apiClient=new Qt(e)}async find(){return(await this.apiClient.findAll()).body}async save(e){await this.apiClient.create(e)}},wl=class{constructor(e={rememberMeForAMonth:!1}){this.policy=e.policy||"opt-in",this.remember_me_for_a_month=e.rememberMeForAMonth}};function kl(){return kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},kl.apply(null,arguments)}const xl=s.createContext({getCurrentSettings:()=>{},getSettings:()=>{},setSettings:()=>{},hasSettingsChanges:()=>{},findSettings:()=>{},setProcessing:()=>{},isProcessing:()=>{},clearContext:()=>{},save:()=>{}});class Cl extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.mfaPolicyService=new El(t)}get defaultState(){return{settings:new vl,currentSettings:new vl,processing:!0,getCurrentSettings:this.getCurrentSettings.bind(this),getSettings:this.getSettings.bind(this),setSettings:this.setSettings.bind(this),findSettings:this.findSettings.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),clearContext:this.clearContext.bind(this),save:this.save.bind(this)}}async findSettings(e=()=>{}){this.setProcessing(!0);const t=await this.mfaPolicyService.find(),a=new vl(t);this.setState({currentSettings:a}),this.setState({settings:a},e),this.setProcessing(!1)}async save(){this.setProcessing(!0);const e=new wl(this.state.settings);await this.mfaPolicyService.save(e),await this.findSettings()}getCurrentSettings(){return this.state.currentSettings}getSettings(){return this.state.settings}setSettings(e,t,a=()=>{}){const s=Object.assign({},this.state.settings,{[e]:t});this.setState({settings:s},a)}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasSettingsChanges(){return JSON.stringify(this.state.currentSettings)!==JSON.stringify(this.state.settings)}clearContext(){const{currentSettings:e,settings:t,processing:a}=this.defaultState;this.setState({currentSettings:e,settings:t,processing:a})}render(){return s.createElement(xl.Provider,{value:this.state},this.props.children)}}Cl.propTypes={context:r().any,children:r().any,t:r().any,actionFeedbackContext:r().object};const Sl=I(Cl);function _l(e){return class extends s.Component{render(){return s.createElement(xl.Consumer,null,(t=>s.createElement(e,kl({adminMfaPolicyContext:t},this.props))))}}}class Nl extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSave=this.handleSave.bind(this)}isSaveEnabled(){return!this.props.adminMfaPolicyContext.isProcessing()}async handleSave(){if(this.isSaveEnabled())try{await this.props.adminMfaPolicyContext.save(),this.handleSaveSuccess()}catch(e){this.handleSaveError(e)}finally{this.props.adminMfaPolicyContext.setProcessing(!1)}}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The MFA policy settings were updated."))}async handleSaveError(e){"UserAbortsOperationError"!==e.name&&(console.error(e),await this.props.actionFeedbackContext.displayError(e.message))}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{className:"button primary form",type:"button",disabled:!this.isSaveEnabled(),id:"save-settings",onClick:this.handleSave},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Nl.propTypes={adminMfaPolicyContext:r().object,actionFeedbackContext:r().object,t:r().func};const Il=_l(d((0,v.CI)("common")(Nl)));class Pl extends s.Component{constructor(e){super(e),this.bindCallbacks()}async componentDidMount(){await this.findSettings()}componentWillUnmount(){this.props.adminMfaPolicyContext.clearContext()}bindCallbacks(){this.handleInputChange=this.handleInputChange.bind(this)}async findSettings(){await this.props.adminMfaPolicyContext.findSettings()}async handleInputChange(e){const t=e.target.name;let a=e.target.value;"rememberMeForAMonth"===t&&(a=e.target.checked),this.props.adminMfaPolicyContext.setSettings(t,a)}hasAllInputDisabled(){return this.props.adminMfaPolicyContext.isProcessing()}render(){const e=this.props.adminMfaPolicyContext.getSettings();return s.createElement("div",{className:"row"},s.createElement("div",{className:"mfa-policy-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title",id:"mfa-policy-settings-title"},s.createElement(v.x6,null,"MFA Policy")),s.createElement("form",{className:"form"},s.createElement("h4",{className:"no-border",id:"mfa-policy-subtitle"},s.createElement(v.x6,null,"Default users multi factor authentication policy")),s.createElement("p",{id:"mfa-policy-description"},s.createElement(v.x6,null,"You can choose the default behaviour of multi factor authentication for all users.")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio "+("mandatory"===e?.policy?"checked":""),id:"mfa-policy-mandatory"},s.createElement("input",{type:"radio",value:"mandatory",onChange:this.handleInputChange,name:"policy",checked:"mandatory"===e?.policy,id:"mfa-policy-mandatory-radio",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"mfa-policy-mandatory-radio"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Prompt")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Users have to enable multi factor authentication. If they don't, they will be reminded every time they log in.")))),s.createElement("div",{className:"input radio "+("opt-in"===e?.policy?"checked":""),id:"mfa-policy-opt-in"},s.createElement("input",{type:"radio",value:"opt-in",onChange:this.handleInputChange,name:"policy",checked:"opt-in"===e?.policy,id:"mfa-policy-opt-in-radio",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"mfa-policy-opt-in-radio"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Opt-in (default)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Users have the choice to enable multi factor authentication in their profile workspace."))))),s.createElement("h4",{id:"mfa-policy-remember-subtitle"},"Remember a device for a month"),s.createElement("span",{className:"input toggle-switch form-element "},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"rememberMeForAMonth",onChange:this.handleInputChange,disabled:this.hasAllInputDisabled(),checked:e?.rememberMeForAMonth,id:"remember-toggle-button"}),s.createElement("label",{htmlFor:"remember-toggle-button"},s.createElement(v.x6,null,"Allow “Remember this device for a month.“ option during MFA."))))),this.props.adminMfaPolicyContext.hasSettingsChanges()&&s.createElement("div",{className:"warning message",id:"mfa-policy-setting-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(Il,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need some help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about MFA policy settings, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/authentication/mfa-policy",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}Pl.propTypes={context:r().object,administrationWorkspaceContext:r().object,adminMfaPolicyContext:r().object,t:r().func};const Al=I(Ee(_l((0,v.CI)("common")(Pl))));class Tl extends te{constructor(e,t={}){super(X.validate(Tl.ENTITY_NAME,e,Tl.getSchema()),t)}static getSchema(){return{type:"object",required:["id","name"],properties:{id:{type:"string",format:"uuid"},name:{type:"string",maxLength:255}}}}get id(){return this._props.id}get name(){return this._props.name}static get ENTITY_NAME(){return"Action"}}const Rl=Tl;class Dl extends te{constructor(e,t={}){super(X.validate(Dl.ENTITY_NAME,e,Dl.getSchema()),t)}static getSchema(){return{type:"object",required:["id","name"],properties:{id:{type:"string",format:"uuid"},name:{type:"string",maxLength:255}}}}get id(){return this._props.id}get name(){return this._props.name}static get ENTITY_NAME(){return"UiAction"}}const Ol=Dl;class Ul extends te{constructor(e,t={}){super(X.validate(Ul.ENTITY_NAME,e,Ul.getSchema()),t),this._props.action&&(this._action=new Rl(this._props.action,{clone:!1})),delete this._props.action,this._props.ui_action&&(this._ui_action=new Ol(this._props.ui_action,{clone:!1})),delete this._props.ui_action}static getSchema(){return{type:"object",required:["id","role_id","foreign_model","foreign_id","control_function"],properties:{id:{type:"string",format:"uuid"},role_id:{type:"string",format:"uuid"},foreign_model:{type:"string",enum:[Ul.FOREIGN_MODEL_ACTION,Ul.FOREIGN_MODEL_UI_ACTION]},foreign_id:{type:"string",format:"uuid"},control_function:{type:"string",enum:[z,L,q]},action:Rl.getSchema(),ui_action:Ol.getSchema()}}}toDto(e){const t=Object.assign({},this._props);return e?(this._action&&e.action&&(t.action=this._action.toDto()),this._ui_action&&e.ui_action&&(t.ui_action=this._ui_action.toDto()),t):t}toUpdateDto(){return{id:this.id,control_function:this.controlFunction}}toJSON(){return this.toDto(Ul.ALL_CONTAIN_OPTIONS)}get id(){return this._props.id}get roleId(){return this._props.role_id}get foreignModel(){return this._props.foreign_model}get foreignId(){return this._props.foreign_id}get controlFunction(){return this._props.control_function}set controlFunction(e){X.validateProp("control_function",e,Ul.getSchema().properties.control_function),this._props.control_function=e}get action(){return this._action||null}get uiAction(){return this._ui_action||null}static get ENTITY_NAME(){return"Rbac"}static get ALL_CONTAIN_OPTIONS(){return{action:!0,ui_action:!0}}static get FOREIGN_MODEL_ACTION(){return"Action"}static get FOREIGN_MODEL_UI_ACTION(){return"UiAction"}}const Ml=Ul;class Fl extends Error{constructor(e,t,a){if(super(a=a||"Entity collection error."),"number"!=typeof e)throw new TypeError("EntityCollectionError requires a valid position");if(!t||"string"!=typeof t)throw new TypeError("EntityCollectionError requires a valid rule");if(!a||"string"!=typeof a)throw new TypeError("EntityCollectionError requires a valid message");this.position=e,this.rule=t}}const jl=Fl;class zl{constructor(e=[],t={}){const a=t?.clone??!0;this._items=[],a&&(e=JSON.parse(JSON.stringify(e))),this._props=e}toDto(){return JSON.parse(JSON.stringify(this._items))}toJSON(){return this.toDto()}get items(){return this._items}get length(){return this._items.length}[Symbol.iterator](){let e=0;return{next:()=>e<this._items.length?{value:this._items[e++],done:!1}:{done:!0}}}getAll(e,t){if("string"!=typeof e)throw new TypeError("EntityCollection excludeAll expects propName to be string.");if("string"!=typeof t)throw new TypeError("EntityCollection excludeAll expects search to be string.");return this._items.filter((a=>Object.prototype.hasOwnProperty.call(a._props,e)&&a._props[e]===t))}getFirst(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("EntityCollection getFirst by expect propName and search to be strings");const a=this.getAll(e,t);if(a&&a.length)return a[0]}extract(e){if("string"!=typeof e)throw new TypeError("EntityCollection extract expects propName to be a string.");return this._items.reduce(((t,a)=>(void 0!==a._props[e]&&t.push(a._props[e]),t)),[])}push(e){return this._items.push(e),this._items.length}unshift(e){return this._items.unshift(e),this._items.length}filterByPropertyValueIn(e,t,a=!0){if("string"!=typeof e)throw new TypeError("EntityCollection filterByPropertyValueIn expects propName to be a string.");if(!Array.isArray(t))throw new TypeError("EntityCollection filterByPropertyValueIn expects needles to be an array.");this.filterByCallback((s=>{const n=Object.prototype.hasOwnProperty.call(s._props,e);return!(a&&!n||n&&!t.includes(s._props[e]))}))}filterByCallback(e){if("function"!=typeof e)throw new TypeError("EntityCollection filterByCallback expects callback to be a function.");for(let t=this._items.length-1;t>=0;t--)e(this._items[t])||this._items.splice(t,1)}assertUniqueByProperty(e,t){const a=`unique_${e}`,s=this.extract(e),n=new Set;t=t||`The collection should only contain items with unique values for the property: ${e}.`,s.forEach(((e,s)=>{if(n.add(e),s!==n.size-1)throw new jl(s,a,t)}))}assertNotExist(e,t,a={}){if(void 0===t)return;let s=a?.haystackSet;if(!s){const t=this.extract(e);s=new Set(t)}if(s.has(t)){const t=new $,s=a?.message||`The collection already includes an element that has a property (${e}) with an identical value.`;throw t.addError(e,"unique",s),t}}}const Ll=zl;class ql extends Ll{constructor(e,t=!1){super(X.validate(ql.ENTITY_NAME,e,ql.getSchema())),this._props.forEach((e=>{try{this._items.push(new Ml(e))}catch(e){if(!t)throw e}})),this._props=null}static getSchema(){return{type:"array",items:Ml.getSchema()}}get rbacs(){return this._items}toBulkUpdateDto(){return this.items.map((e=>e.toUpdateDto()))}findRbacByRoleAndUiActionName(e,t){if(!(e instanceof le))throw new Error("The role parameter should be a role entity.");if("string"!=typeof t&&!(t instanceof String))throw new Error("The name parameter should be a valid string.");return this.rbacs.find((a=>a.roleId===e.id&&a.uiAction?.name===t))}findRbacByActionName(e){if("string"!=typeof e&&!(e instanceof String))throw new Error("The name parameter should be a valid string.");return this.rbacs.find((t=>t.uiAction?.name===e))}push(e){if(!e||"object"!=typeof e)throw new TypeError("The function expect an object as parameter");e instanceof Ml&&(e=e.toDto(Ml.ALL_CONTAIN_OPTIONS));const t=new Ml(e);super.push(t)}addOrReplace(e){const t=this.items.findIndex((t=>t.id===e.id));t>-1?this._items[t]=e:this.push(e)}remove(e){const t=this.items.length;let a=0;for(;a<t;a++)if(this.items[a].id===e.id)return void this._items.splice(a,1)}static get ENTITY_NAME(){return"Rbacs"}static get RULE_UNIQUE_ID(){return"unique_id"}}const Kl=ql,Wl=class{constructor(e,t){e.setResourceName(t),this.apiClient=new Qt(e)}formatContainOptions(e,t){const a={};for(const s in e){if("string"!=typeof s){const t=JSON.stringify(e);throw new TypeError(`Invalid contain ${t}, items should be a string.`)}t.includes(s)&&(a[`contain[${s}]`]=e[s]?"1":"0")}return a}formatFilterOptions(e,t){const a={};for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t.includes(s))if("boolean"==typeof e[s])a[`filter[${s}]`]=e[s]?"1":"0";else if("string"==typeof e[s])a[`filter[${s}]`]=e[s];else{if(!Array.isArray(e[s]))throw new TypeError("Service error. Filter option should be an array or a string.");a[`filter[${s}][]`]=e[s]}return a}formatOrderOptions(e,t){const a={};for(const s in e)t.includes(s)&&(a["order[]"]=s);return a}assertValidId(e){if(!e||"string"!=typeof e||!Y().isUUID(e))throw new TypeError(`Service error. The id '${e}' is not a valid uuid.`)}assertNonEmptyData(e){if(!e)throw new TypeError("Service error. Data cannot be empty.")}};class Vl extends Wl{constructor(e){super(e,Vl.RESOURCE_NAME)}static get RESOURCE_NAME(){return"/rbacs"}static getSupportedContainOptions(){return["action","ui_action"]}async findAll(e){const t=e?this.formatContainOptions(e,Vl.getSupportedContainOptions()):null;return(await this.apiClient.findAll(t)).body}async updateAll(e,t={}){const a=t?this.formatContainOptions(t,Vl.getSupportedContainOptions()):null;return(await this.apiClient.updateAll(e,a)).body}}const Bl=Vl;class Gl extends Wl{constructor(e){super(e,Gl.RESOURCE_NAME)}static get RESOURCE_NAME(){return"roles"}async findAll(){const e=await this.apiClient.findAll();return e.body&&e.body.length?e.body:[]}}const $l=Gl;function Hl(){return Hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Hl.apply(null,arguments)}const Yl=s.createContext({processing:!1,rbacs:null,rbacsUpdated:{},setRbacs:()=>{},setRbacsUpdated:()=>{},save:()=>{},isProcessing:()=>{},hasSettingsChanges:()=>{},clearContext:()=>{}});class Jl extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.rbacService=new Bl(t),this.roleService=new $l(t)}get defaultState(){return{processing:!1,rbacs:null,rbacsUpdated:new Kl([]),setRbacs:this.setRbacs.bind(this),setRbacsUpdated:this.setRbacsUpdated.bind(this),isProcessing:this.isProcessing.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),save:this.save.bind(this),clearContext:this.clearContext.bind(this)}}async setRbacs(e){this.setState({rbacs:e})}async setRbacsUpdated(e){this.setState({rbacsUpdated:e})}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasSettingsChanges(){return this.state.rbacsUpdated.rbacs.length>0}clearContext(){const{rbacs:e,rbacsUpdated:t,processing:a}=this.defaultState;this.setState({rbacs:e,rbacsUpdated:t,processing:a})}async save(){this.setProcessing(!0);try{const e=this.state.rbacsUpdated.toBulkUpdateDto();if(0===this.state.rbacsUpdated.length)return;const t=await this.rbacService.updateAll(e,{ui_action:!0,action:!0}),a=this.state.rbacs;t.forEach((e=>a.addOrReplace(new Ml(e))));const s=new Kl([]);this.setState({rbacs:a,rbacsUpdated:s})}finally{this.setProcessing(!1)}}render(){return s.createElement(Yl.Provider,{value:this.state},this.props.children)}}Jl.propTypes={context:r().any,children:r().any};const Zl=I(Jl);function Ql(e){return class extends s.Component{render(){return s.createElement(Yl.Consumer,null,(t=>s.createElement(e,Hl({adminRbacContext:t},this.props))))}}}class Xl extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSaveClick=this.handleSaveClick.bind(this)}async handleSaveClick(){try{await this.props.adminRbacContext.save(),this.handleSaveSuccess()}catch(e){this.handleSaveError(e)}}isSaveEnabled(){return!this.props.adminRbacContext.isProcessing()}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The role-based access control settings were updated."))}async handleSaveError(e){console.error(e),await this.props.actionFeedbackContext.displayError(e.message)}render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{className:"button primary form",type:"button",disabled:!this.isSaveEnabled(),onClick:this.handleSaveClick},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Xl.propTypes={context:r().object,adminRbacContext:r().object,actionFeedbackContext:r().object,t:r().func};const ec=Ql(d((0,v.CI)("common")(Xl)));class tc extends s.Component{render(){return s.createElement(s.Fragment,null,s.createElement("div",{className:`flex-container inner level-${this.props.level}`},s.createElement("div",{className:"flex-item first"},s.createElement("span",null,s.createElement(Ct,{className:"caret-down"}),"  ",this.props.label)),s.createElement("div",{className:"flex-item"}," "),s.createElement("div",{className:"flex-item"}," ")),this.props.children)}}tc.propTypes={label:r().string,level:r().number,t:r().func,children:r().any};const ac=(0,v.CI)("common")(tc);class sc extends s.Component{constructor(e){super(e),this.handleInputChange=this.handleInputChange.bind(this)}handleInputChange(e,t){this.props.onChange(t,this.props.actionName,e.target.value)}get allowedCtlFunctions(){const e=[{value:z,label:this.props.t("Allow")},{value:L,label:this.props.t("Deny")}];return this.props.actionName===F&&e.push({value:q,label:this.props.t("Allow group manager")}),e}get rowClassName(){return this.props.actionName.toLowerCase().replaceAll(/[^\w]/gi,"-")}getCtlFunctionForRole(e){const t=this.props.rbacsUpdated?.findRbacByRoleAndUiActionName(e,this.props.actionName)||this.props.rbacs?.findRbacByRoleAndUiActionName(e,this.props.actionName);return t?.controlFunction||null}hasChanged(){return!!this.props.rbacsUpdated.findRbacByActionName(this.props.actionName)}render(){let e=[];return this.props.roles&&(e=this.props.roles.items.filter((e=>"user"===e.name))),s.createElement(s.Fragment,null,s.createElement("div",{className:`rbac-row ${this.rowClassName} flex-container inner level-${this.props.level} ${this.hasChanged()?"highlighted":""}`},s.createElement("div",{className:"flex-item first"},s.createElement("span",null,this.props.label)),s.createElement("div",{className:"flex-item"},s.createElement(Oa,{className:"medium admin",items:this.allowedCtlFunctions,value:z,disabled:!0})),e.map((e=>s.createElement("div",{key:`${this.props.actionName}-${e.id}`,className:"flex-item input"},s.createElement(Oa,{className:`${e.name}`,items:this.allowedCtlFunctions,value:this.getCtlFunctionForRole(e),disabled:!(this.props.rbacs?.length>0&&this.getCtlFunctionForRole(e)),onChange:t=>this.handleInputChange(t,e)}),!this.getCtlFunctionForRole(e)&&s.createElement("div",{className:"warning-message"},"There is no valid setting found for this action."))))))}}sc.propTypes={label:r().string.isRequired,level:r().number.isRequired,actionName:r().string.isRequired,rbacs:r().object,rbacsUpdated:r().object,roles:r().object.isRequired,onChange:r().func.isRequired,t:r().func};const nc=(0,v.CI)("common")(sc);class ic extends Ll{constructor(e,t={}){super(X.validate(ic.ENTITY_NAME,e,ic.getSchema()),t),this._props.forEach((e=>{this.push(new le(e,{clone:!1}))})),this._props=null}static getSchema(){return{type:"array",items:le.getSchema()}}get roles(){return this._items}get ids(){return this._items.map((e=>e.id))}assertUniqueId(e){if(!e.id)return;const t=this.roles.length;let a=0;for(;a<t;a++){const t=this.roles[a];if(t.id&&t.id===e.id)throw new jl(a,ic.RULE_UNIQUE_ID,`Role id ${e.id} already exists.`)}}push(e){if(!e||"object"!=typeof e)throw new TypeError("RolesCollection push parameter should be an object.");e instanceof le&&(e=e.toDto());const t=new le(e);this.assertUniqueId(t),super.push(t)}static get ENTITY_NAME(){return"Roles"}static get RULE_UNIQUE_ID(){return"unique_id"}}const rc=ic;class oc extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{roles:null}}bindCallbacks(){this.updateRbacControlFunction=this.updateRbacControlFunction.bind(this)}async componentDidMount(){this.findAndLoadRoles(this.props.RoleService),this.findAndLoadRbacSettings(this.props.RbacService)}componentWillUnmount(){this.props.adminRbacContext.clearContext()}async findAndLoadRoles(){const e=this.props.context.getApiClientOptions(),t=new this.props.RoleService(e),a=await t.findAll(),s=new rc(a);this.setState({roles:s})}async findAndLoadRbacSettings(){const e=this.props.context.getApiClientOptions(),t=new this.props.RbacService(e),a=await t.findAll({ui_action:!0}),s=new Kl(a,!0);this.props.adminRbacContext.setRbacs(s)}updateRbacControlFunction(e,t,a){const s=this.props.adminRbacContext.rbacsUpdated,n=this.props.adminRbacContext.rbacs.findRbacByRoleAndUiActionName(e,t);if(n.controlFunction===a)s.remove(n);else{const e=new Ml(n.toDto({ui_action:!0,action:!0}));e.controlFunction=a,s.addOrReplace(e)}this.props.adminRbacContext.setRbacsUpdated(s)}get canIUseTags(){return this.props.context.siteSettings.canIUse("tags")}get canIUseDesktop(){return this.props.context.siteSettings.canIUse("desktop")}get canIUseMobile(){return this.props.context.siteSettings.canIUse("mobile")}get canIUseFolders(){return this.props.context.siteSettings.canIUse("folders")}get canIUsePreviewPassword(){return this.props.context.siteSettings.canIUse("previewPassword")}get canIUseExport(){return this.props.context.siteSettings.canIUse("export")}get canIUseImport(){return this.props.context.siteSettings.canIUse("import")}get isReady(){return null!==this.state.roles}render(){const e=this.props.adminRbacContext.hasSettingsChanges();return s.createElement("div",{className:"row"},s.createElement("div",{className:"rbac-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",null,s.createElement(v.x6,null,"Role-Based Access Control")),s.createElement("p",null,s.createElement(v.x6,null,"In this section you can define access controls for each user role.")),s.createElement("form",{className:"form"},s.createElement("div",{className:"flex-container outer"},s.createElement("div",{className:"flex-container inner header-flex"},s.createElement("div",{className:"flex-item first"},s.createElement("label",null,s.createElement(v.x6,null,"UI Permissions"))),s.createElement("div",{className:"flex-item centered"},s.createElement("label",null,s.createElement(v.x6,null,"Admin"))),s.createElement("div",{className:"flex-item centered"},s.createElement("label",null,s.createElement(v.x6,null,"User")))),this.isReady&&s.createElement(s.Fragment,null,s.createElement(ac,{label:this.props.t("Resources"),level:1},(this.canIUseImport||this.canIUseExport)&&s.createElement(ac,{label:this.props.t("Import/Export"),level:2},this.canIUseImport&&s.createElement(nc,{label:this.props.t("Can import"),actionName:"Resources.import",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}),this.canIUseExport&&s.createElement(nc,{label:this.props.t("Can export"),actionName:"Resources.export",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction})),s.createElement(ac,{label:this.props.t("Password"),level:2},this.canIUsePreviewPassword&&s.createElement(nc,{label:this.props.t("Can preview"),actionName:"Secrets.preview",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}),s.createElement(nc,{label:this.props.t("Can copy"),actionName:"Secrets.copy",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction})),s.createElement(ac,{label:this.props.t("Metadata"),level:2},s.createElement(nc,{label:this.props.t("Can see password activities"),actionName:"Resources.seeActivities",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}),s.createElement(nc,{label:this.props.t("Can see password comments"),actionName:"Resources.seeComments",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction})),(this.canIUseFolders||this.canIUseTags)&&s.createElement(ac,{label:this.props.t("Organization"),level:2},this.canIUseFolders&&s.createElement(nc,{label:this.props.t("Can use folders"),actionName:M,level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}),this.canIUseTags&&s.createElement(nc,{label:this.props.t("Can use tags"),actionName:"Tags.use",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction})),s.createElement(ac,{label:this.props.t("Sharing"),level:2},s.createElement(nc,{label:this.props.t("Can see with whom passwords are shared with"),actionName:"Share.viewList",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}),s.createElement(nc,{label:this.props.t("Can share folders"),actionName:"Folders.share",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}))),s.createElement(ac,{label:this.props.t("Users"),level:1},s.createElement(nc,{label:this.props.t("Can see users workspace"),actionName:F,level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction})),(this.canIUseMobile||this.canIUseDesktop)&&s.createElement(ac,{label:this.props.t("User settings"),level:1},this.canIUseMobile&&s.createElement(nc,{label:this.props.t("Can see mobile setup"),actionName:"Mobile.transfer",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction}),this.canIUseDesktop&&s.createElement(nc,{label:this.props.t("Can see desktop application setup"),actionName:"Desktop.transfer",level:3,rbacs:this.props.adminRbacContext.rbacs,rbacsUpdated:this.props.adminRbacContext.rbacsUpdated,roles:this.state.roles,onChange:this.updateRbacControlFunction})))))),e&&s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(ec,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"Check out the Role Based Access Control documentation.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/role-based-access-control/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read RBAC doc")))),document.getElementById("administration-help-panel")))}}oc.defaultProps={RoleService:$l,RbacService:Bl},oc.propTypes={context:r().object,administrationWorkspaceContext:r().object,adminRbacContext:r().object,RoleService:r().func,RbacService:r().func,t:r().func};const lc=I(Ql(Ee((0,v.CI)("common")(oc)))),cc=class{constructor(e={}){this.default_generator=e.provider,this.external_dictionary_check=e.policyPassphraseExternalServices,this.password_generator_settings={length:e.passwordLength,mask_upper:e.mask_upper,mask_lower:e.mask_lower,mask_digit:e.mask_digit,mask_parenthesis:e.mask_parenthesis,mask_char1:e.mask_char1,mask_char2:e.mask_char2,mask_char3:e.mask_char3,mask_char4:e.mask_char4,mask_char5:e.mask_char5,mask_emoji:e.mask_emoji,exclude_look_alike_chars:e.excludeLookAlikeCharacters},this.passphrase_generator_settings={words:e.wordsCount,word_separator:e.wordsSeparator,word_case:e.wordCase},this.source=e.source}},mc=class{constructor(e={}){this.provider="passphrase"===e?.default_generator?"passphrase":"password",this.policyPassphraseExternalServices=Boolean(e?.external_dictionary_check),this.source=e?.source??"default";const t=e?.password_generator_settings;this.passwordLength=t?.length??18,this.mask_upper=t?.mask_upper??!1,this.mask_lower=t?.mask_lower??!1,this.mask_digit=t?.mask_digit??!1,this.mask_parenthesis=t?.mask_parenthesis??!1,this.mask_char1=t?.mask_char1??!1,this.mask_char2=t?.mask_char2??!1,this.mask_char3=t?.mask_char3??!1,this.mask_char4=t?.mask_char4??!1,this.mask_char5=t?.mask_char5??!1,this.mask_emoji=t?.mask_emoji??!1,this.excludeLookAlikeCharacters=t?.exclude_look_alike_chars??!1;const a=e?.passphrase_generator_settings;this.wordsCount=a?.words??9,this.wordsSeparator=a?.word_separator??" ",this.wordCase=a?.word_case??"lowercase"}};function dc(){return dc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},dc.apply(null,arguments)}const pc=s.createContext({getSettings:()=>{},getSettingsErrors:()=>{},setSettings:()=>{},hasSettingsChanges:()=>{},findSettings:()=>{},setProcessing:()=>{},isProcessing:()=>{},isDataValid:()=>{},clearContext:()=>{},save:()=>{},validateData:()=>{},getPasswordGeneratorMasks:()=>{},getEntropyForPassphraseConfiguration:()=>{},getEntropyForPasswordConfiguration:()=>{},getMinimalRequiredEntropy:()=>{},getMinimalAdvisedEntropy:()=>{},isSourceChanging:()=>{}});class uc extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.hasDataBeenValidated=!1}get defaultState(){return{settings:new mc,errors:{},currentSettings:new mc,processing:!0,getSettings:this.getSettings.bind(this),getSettingsErrors:this.getSettingsErrors.bind(this),setSettings:this.setSettings.bind(this),findSettings:this.findSettings.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isProcessing:this.isProcessing.bind(this),setProcessing:this.setProcessing.bind(this),clearContext:this.clearContext.bind(this),save:this.save.bind(this),validateData:this.validateData.bind(this),getPasswordGeneratorMasks:this.getPasswordGeneratorMasks.bind(this),getEntropyForPassphraseConfiguration:this.getEntropyForPassphraseConfiguration.bind(this),getEntropyForPasswordConfiguration:this.getEntropyForPasswordConfiguration.bind(this),getMinimalRequiredEntropy:this.getMinimalRequiredEntropy.bind(this),getMinimalAdvisedEntropy:this.getMinimalAdvisedEntropy.bind(this),isSourceChanging:this.isSourceChanging.bind(this)}}async findSettings(e=()=>{}){this.setProcessing(!0);const t=await this.props.context.port.request("passbolt.password-policies.get-admin-settings"),a=new mc(t);this.setState({currentSettings:a,settings:a},e),this.setProcessing(!1)}validateData(){this.hasDataBeenValidated=!0;let e=!0;const t={},a=this.state.settings;a.mask_upper||a.mask_lower||a.mask_digit||a.mask_parenthesis||a.mask_char1||a.mask_char2||a.mask_char3||a.mask_char4||a.mask_char5||a.mask_emoji||(e=!1,t.masks=this.props.t("At least 1 set of characters must be selected")),a.passwordLength<8&&(e=!1,t.passwordLength=this.props.t("The password length must be set to 8 at least")),a.wordsCount<4&&(e=!1,t.wordsCount=this.props.t("The passphrase word count must be set to 4 at least")),a.wordsSeparator.length>10&&(e=!1,t.wordsSeparator=this.props.t("The words separator should be at a maximum of 10 characters long"));const s=this.getMinimalRequiredEntropy();return this.getEntropyForPassphraseConfiguration()<s&&(e=!1,t.passphraseMinimalRequiredEntropy=this.props.t("The passphrase generator will not generate strong enough passphrase. Minimum of {{minimum}}bits is required",{minimum:s})),this.getEntropyForPasswordConfiguration()<s&&(e=!1,t.passwordMinimalRequiredEntropy=this.props.t("The password generator will not generate strong enough password. Minimum of {{minimum}}bits is required",{minimum:s})),this.setState({errors:t}),e}getEntropyForPassphraseConfiguration(){const e=this.getSettings();return wi.entropyPassphrase(e.wordsCount,e.wordsSeparator)}getEntropyForPasswordConfiguration(){const e=new cc(this.getSettings()).password_generator_settings;return wi.evaluateMaxPasswordEntropy(e)}getPasswordGeneratorMasks(){return fi}getMinimalRequiredEntropy(){return 80}getMinimalAdvisedEntropy(){return 112}async save(){this.setProcessing(!0);try{const e=new cc(this.state.settings),t=await this.props.context.port.request("passbolt.password-policies.save",e),a=new mc(t);this.setState({currentSettings:a,settings:a})}finally{this.setProcessing(!1)}}getSettings(){return this.state.settings}getSettingsErrors(){return this.state.errors}setSettings(e,t){const a=Object.assign({},this.state.settings,{[e]:t});this.setState({settings:a},(()=>{this.hasDataBeenValidated&&this.validateData()}))}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}hasSettingsChanges(){return JSON.stringify(this.state.currentSettings)!==JSON.stringify(this.state.settings)}isSourceChanging(){return"db"!==this.state.currentSettings?.source&&"default"!==this.state.currentSettings?.source}clearContext(){const{currentSettings:e,settings:t,processing:a}=this.defaultState;this.setState({currentSettings:e,settings:t,processing:a})}render(){return s.createElement(pc.Provider,{value:this.state},this.props.children)}}function hc(e){return class extends s.Component{render(){return s.createElement(pc.Consumer,null,(t=>s.createElement(e,dc({adminPasswordPoliciesContext:t},this.props))))}}}uc.propTypes={context:r().any,children:r().any,t:r().any,actionFeedbackContext:r().object},I((0,v.CI)("common")(uc));class gc extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSave=this.handleSave.bind(this)}get isActionEnabled(){return!this.props.adminPasswordPoliciesContext.isProcessing()}async handleSave(){if(this.isActionEnabled&&this.props.adminPasswordPoliciesContext.validateData())try{await this.props.adminPasswordPoliciesContext.save(),await this.handleSaveSuccess()}catch(e){await this.handleSaveError(e)}}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The password policy settings were updated."))}async handleSaveError(e){console.error(e),await this.props.actionFeedbackContext.displayError(e.message)}render(){const e=!this.isActionEnabled;return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary form",disabled:e,id:"save-settings",onClick:this.handleSave},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}gc.propTypes={adminPasswordPoliciesContext:r().object,actionFeedbackContext:r().object,t:r().func};const bc=hc(d((0,v.CI)("common")(gc))),yc={COLOR_1:fc("#BA2809"),COLOR_2:fc("#FFA724"),COLOR_3:fc("#0EAA00")};function fc(e){const t=new RegExp("^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$","i").exec(e.trim());return t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16)}:null}class vc extends s.Component{get entropy(){return(this.props.entropy||0).toFixed(1)}get tooltipMessage(){return s.createElement(s.Fragment,null,s.createElement(v.x6,null,"Entropy:")," ",this.entropy," bits")}get passwordStrengthLabel(){if(!this.hasEntropy()&&!this.hasError())return s.createElement(v.x6,null,"Quality");const e=wi.strength(this.props.entropy);return s.createElement(s.Fragment,null,e.label)}hasEntropy(){return null!==this.props.entropy&&void 0!==this.props.entropy}hasError(){return this.props.error}getProgresseBarStyle(){const e=this.getRelativeEntropyPosition();return{width:`${e}%`,backgroundColor:this.colorGradient(e)}}colorGradient(e){let t,a,s=e/100*2;return s>=1?(s-=1,t=yc.COLOR_2,a=yc.COLOR_3):(t=yc.COLOR_1,a=yc.COLOR_2),`rgb(${Math.floor(t.red+(a.red-t.red)*s)},${Math.floor(t.green+(a.green-t.green)*s)},${Math.floor(t.blue+(a.blue-t.blue)*s)})`}getRelativeEntropyPosition(){return 100-99/(1+Math.pow(this.props.entropy/90,10))}render(){return s.createElement("div",{className:"password-complexity"},s.createElement("span",{className:"complexity-text"},s.createElement(bt,{message:this.tooltipMessage},this.passwordStrengthLabel," ",s.createElement(vt,null))),s.createElement("span",{className:"progress"},s.createElement("span",{className:"progress-bar background"}),s.createElement("span",{className:"progress-bar foreground "+(this.hasError()?"error":""),style:this.hasEntropy()?this.getProgresseBarStyle(this.props.entropy):null})))}}vc.defaultProps={entropy:null},vc.propTypes={entropy:r().number,error:r().bool};const Ec=(0,v.CI)("common")(vc);class wc extends s.Component{constructor(e){super(e),this.state={showPasswordSection:!1,showPassphraseSection:!1},this.bindCallbacks()}async componentDidMount(){await this.props.adminPasswordPoliciesContext.findSettings()}componentWillUnmount(){this.props.adminPasswordPoliciesContext.clearContext()}bindCallbacks(){this.handleCheckboxInputChange=this.handleCheckboxInputChange.bind(this),this.handleMaskToggled=this.handleMaskToggled.bind(this),this.handlePasswordSectionToggle=this.handlePasswordSectionToggle.bind(this),this.handlePassphraseSectionToggle=this.handlePassphraseSectionToggle.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleSliderInputChange=this.handleSliderInputChange.bind(this),this.handleLengthChange=this.handleLengthChange.bind(this)}handlePasswordSectionToggle(){this.setState({showPasswordSection:!this.state.showPasswordSection})}handlePassphraseSectionToggle(){this.setState({showPassphraseSection:!this.state.showPassphraseSection})}get wordCaseList(){return[{value:"lowercase",label:this.props.t("Lower case")},{value:"uppercase",label:this.props.t("Upper case")},{value:"camelcase",label:this.props.t("Camel case")}]}get providerList(){return[{value:"password",label:this.props.t("Password")},{value:"passphrase",label:this.props.t("Passphrase")}]}handleCheckboxInputChange(e){const t=e.target.name;this.props.adminPasswordPoliciesContext.setSettings(t,e.target.checked)}handleSliderInputChange(e){const t=parseInt(e.target.value,10),a=e.target.name;this.props.adminPasswordPoliciesContext.setSettings(a,t)}handleInputChange(e){const t=e.target,a=t.value,s=t.name;this.props.adminPasswordPoliciesContext.setSettings(s,a)}handleLengthChange(e){const t=e.target,a=parseInt(t.value,10),s=t.name;this.props.adminPasswordPoliciesContext.setSettings(s,a)}handleMaskToggled(e){const t=!this.props.adminPasswordPoliciesContext.getSettings()[e];this.props.adminPasswordPoliciesContext.setSettings(e,t)}hasAllInputDisabled(){return this.props.adminPasswordPoliciesContext.isProcessing()}get settingsSource(){return this.props.adminPasswordPoliciesContext?.getSettings()?.source}get configurationSource(){return{legacyEnv:this.props.t("environment variables (legacy)"),env:this.props.t("environment variables"),legacyFile:this.props.t("file (legacy)"),file:this.props.t("file"),db:this.props.t("database"),default:this.props.t("default configuration")}[this.settingsSource]||this.props.t("unknown")}render(){const e=this.props.adminPasswordPoliciesContext,t=e.getSettings(),a=e.getSettingsErrors(),n=e.getMinimalAdvisedEntropy(),i=e.getEntropyForPasswordConfiguration(),r=e.getEntropyForPassphraseConfiguration(),o=e.getPasswordGeneratorMasks(),l=i<n,c=r<n,m=e.isSourceChanging()||e.hasSettingsChanges()||l||c;return s.createElement("div",{className:"row"},s.createElement("div",{className:"password-policies-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{className:"title",id:"password-policies-settings-title"},s.createElement(v.x6,null,"Password Policy")),s.createElement("form",{className:"form"},s.createElement("h4",null,s.createElement(v.x6,null,"Password generator default settings")),s.createElement("p",null,s.createElement(v.x6,null,"You can modify the default settings of the passwords generator."),s.createElement(v.x6,null,"Note that this will not prevent a user from customizing the settings while generating a password.")),s.createElement("label",null,s.createElement(v.x6,null,"Default password type")),s.createElement("div",{className:"singleline"},s.createElement("span",null,s.createElement(v.x6,null,"The default type is")," "),s.createElement(Oa,{id:"configure-passphrase-default-generator",name:"provider",className:"inline",items:this.providerList,value:t.provider,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()})),s.createElement("div",{className:"accordion-header"},s.createElement("button",{id:"accordion-toggle-password",className:"link no-border",type:"button",onClick:this.handlePasswordSectionToggle},this.state.showPasswordSection?s.createElement(Ct,{className:"caret-down"}):s.createElement(Nt,{className:"caret-right"}),s.createElement(v.x6,null,"Passwords settings"))),this.state.showPasswordSection&&s.createElement("div",{className:"passwords-settings"},s.createElement("div",{className:"estimated-entropy input"},s.createElement("label",null,s.createElement(v.x6,null,"Estimated entropy")),s.createElement(Ec,{entropy:i}),a.passwordMinimalRequiredEntropy&&s.createElement("div",{className:"error-message"},a.passwordMinimalRequiredEntropy)),s.createElement("div",{className:"input text "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"configure-password-generator-form-length"},s.createElement(v.x6,null,"Length")),s.createElement("div",{className:"slider"},s.createElement("input",{name:"passwordLength",min:"8",max:"128",value:t.passwordLength,step:"1",type:"range",onChange:this.handleSliderInputChange,disabled:this.hasAllInputDisabled()}),s.createElement("input",{id:"configure-password-generator-form-length",type:"number",name:"passwordLength",min:"8",max:"128",value:t.passwordLength,onChange:this.handleLengthChange,disabled:this.hasAllInputDisabled()})),a.passwordLength&&s.createElement("div",{id:"passwordLength-error",className:"error-message"},a.passwordLength)),s.createElement("p",null,s.createElement(v.x6,null,"You can set the default length for the passwords that are generated randomly by passbolt in the password generator.")),s.createElement("div",{className:"input text "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"configure-password-generator-form-masks"},s.createElement(v.x6,null,"Selected set of characters")),s.createElement("div",{className:"button-group button-group--nowrap"},Object.entries(o).map((([e,a])=>s.createElement("button",{type:"button",key:e,className:"button button-toggle "+(t[e]?"selected":""),onClick:()=>this.handleMaskToggled(e),disabled:this.hasAllInputDisabled()},a.label)))),a.masks&&s.createElement("div",{id:"password-mask-error",className:"error-message"},a.masks),s.createElement("div",{className:"input checkbox"},s.createElement("input",{id:"configure-password-generator-form-exclude-look-alike",type:"checkbox",name:"excludeLookAlikeCharacters",checked:t.excludeLookAlikeCharacters,onChange:this.handleCheckboxInputChange,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"configure-password-generator-form-exclude-look-alike"},s.createElement(v.x6,null,"Exclude look-alike characters"))),s.createElement("p",null,s.createElement(v.x6,null,"You can select the set of characters used for the passwords that are generated randomly by passbolt in the password generator.")))),s.createElement("div",{className:"accordion-header"},s.createElement("button",{id:"accordion-toggle-passphrase",className:"link no-border",type:"button",onClick:this.handlePassphraseSectionToggle},this.state.showPassphraseSection?s.createElement(Ct,{className:"caret-down"}):s.createElement(Nt,{className:"caret-right"}),s.createElement(v.x6,null,"Passphrase settings"))),this.state.showPassphraseSection&&s.createElement("div",{className:"passphrase-settings"},s.createElement("div",{className:"estimated-entropy input"},s.createElement("label",null,s.createElement(v.x6,null,"Estimated entropy")),s.createElement(Ec,{entropy:r}),a.passphraseMinimalRequiredEntropy&&s.createElement("div",{className:"error-message"},a.passphraseMinimalRequiredEntropy)),s.createElement("div",{className:"input text "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"configure-passphrase-generator-form-word-count"},s.createElement(v.x6,null,"Number of words")),s.createElement("div",{className:"slider"},s.createElement("input",{name:"wordsCount",min:"4",max:"40",value:t.wordsCount,type:"range",onChange:this.handleSliderInputChange,disabled:this.hasAllInputDisabled()}),s.createElement("input",{type:"number",id:"configure-passphrase-generator-form-word-count",name:"wordsCount",min:"4",max:"40",value:t.wordsCount,onChange:this.handleLengthChange,disabled:this.hasAllInputDisabled()})),a.wordsCount&&s.createElement("div",{id:"wordsCount-error",className:"error-message"},a.wordsCount)),s.createElement("p",null,s.createElement(v.x6,null,"You can set the default length for the passphrases that are generated randomly by passbolt in the password generator.")),s.createElement("div",{className:"input text "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"configure-passphrase-generator-form-words-separator"},s.createElement(v.x6,null,"Words separator")),s.createElement("input",{type:"text",id:"configure-passphrase-generator-form-words-separator",name:"wordsSeparator",value:t.wordsSeparator,onChange:this.handleInputChange,placeholder:this.props.t("Type one or more characters"),disabled:this.hasAllInputDisabled()}),a.wordsSeparator&&s.createElement("div",{className:"error-message"},a.wordsSeparator)),s.createElement("div",{className:"select-wrapper input "+(this.hasAllInputDisabled()?"disabled":"")},s.createElement("label",{htmlFor:"configure-passphrase-generator-form-words-case"},s.createElement(v.x6,null,"Words case")),s.createElement(Oa,{id:"configure-passphrase-generator-form-words-case",name:"wordCase",items:this.wordCaseList,value:t.wordCase,onChange:this.handleInputChange,disabled:this.hasAllInputDisabled()}))),s.createElement("h4",{id:"password-policies-external-services-subtitle"},s.createElement("span",{className:"input toggle-switch form-element ready"},s.createElement("input",{id:"passphrase-policy-external-services-toggle-button",type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"policyPassphraseExternalServices",onChange:this.handleCheckboxInputChange,checked:t?.policyPassphraseExternalServices,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"passphrase-policy-external-services-toggle-button"},s.createElement(v.x6,null,"External services")))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement(v.x6,null,"Allow passbolt to access external services to check if a password has been compromised.")))),m&&s.createElement("div",{className:"warning message"},e.isSourceChanging()&&s.createElement("div",{id:"password-policies-setting-source-changing-banner"},s.createElement("p",null,s.createElement(v.x6,null,"The current configuration comes from a file or environment variables. If you save them, they will be overwritten and come from the database instead."))),e.hasSettingsChanges()&&s.createElement("div",{id:"password-policies-setting-banner"},s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))),l&&s.createElement("div",{id:"minimal-password-entropy-advised-banner"},s.createElement("p",null,s.createElement(v.x6,null,"The current password configuration generates passwords that are not strong enough."),s.createElement("br",null),s.createElement(v.x6,null,"Passbolt recommends a minimum of ",{minimalAdvisedEntropy:n}," bits to be safe."))),c&&s.createElement("div",{id:"minimal-passphrase-entropy-advised-banner"},s.createElement("p",null,s.createElement(v.x6,null,"The current passphrase configuration generates passphrases that are not strong enough."),s.createElement("br",null),s.createElement(v.x6,null,"Passbolt recommends a minimum of ",{minimalAdvisedEntropy:n}," bits to be safe."))))),s.createElement(bc,null),Ea(s.createElement(s.Fragment,null,s.createElement("div",{className:"sidebar-help-section",id:"password-policies-source"},s.createElement("h3",null,s.createElement(v.x6,null,"Configuration source")),s.createElement("p",null,s.createElement(v.x6,null,"This current configuration source is: "),this.configurationSource,".")),s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"What is password policy?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the password policy settings, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/password-configuration/password-policy/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ji,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation"))))),document.getElementById("administration-help-panel")))}}wc.propTypes={context:r().object,administrationWorkspaceContext:r().object,adminPasswordPoliciesContext:r().object,t:r().func};const kc=I(Ee(hc((0,v.CI)("common")(wc))));class xc extends te{constructor(e,t={}){super(X.validate(xc.ENTITY_NAME,e,xc.getSchema()),t)}static getSchema(){return{type:"object",required:["entropy_minimum","external_dictionary_check"],properties:{id:{type:"string",format:"uuid"},entropy_minimum:{type:"integer",minimum:50,maximum:224},external_dictionary_check:{type:"boolean"},created:{type:"string",format:"date-time"},created_by:{type:"string",format:"uuid"},modified:{type:"string",format:"date-time"},modified_by:{type:"string",format:"uuid"}}}}static get ENTITY_NAME(){return"UserPassphrasePolicies"}static createFromDefault(e={}){const t=Object.assign({entropy_minimum:50,external_dictionary_check:!0},e);return new xc(t)}}const Cc=xc;class Sc{constructor(e={}){this.external_dictionary_check=e?.external_dictionary_check,this.entropy_minimum=e?.entropy_minimum}static getSchema(){const e=Cc.getSchema();return{type:"object",required:["entropy_minimum","external_dictionary_check"],properties:{entropy_minimum:e.properties.entropy_minimum,external_dictionary_check:e.properties.external_dictionary_check}}}static fromEntityDto(e){const t={entropy_minimum:parseInt(e?.entropy_minimum,10)||50,external_dictionary_check:Boolean(e?.external_dictionary_check)};return new Sc(t)}static isDataDifferent(e,t){return["entropy_minimum","external_dictionary_check"].some((a=>e[a]!==t[a]))}toEntityDto(){return{entropy_minimum:this.entropy_minimum,external_dictionary_check:this.external_dictionary_check}}cloneWithMutation(e,t){const a={...this,[e]:t};return new Sc(a)}validate(){const e=Sc.getSchema();try{X.validate(this.constructor.name,this,e)}catch(e){return e}return new $}}const _c=Sc;function Nc(){return Nc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Nc.apply(null,arguments)}const Ic=s.createContext({getSettings:()=>{},setSettings:()=>{},findSettings:()=>{},isProcessing:()=>{},validateData:()=>{},save:()=>{},getErrors:()=>{},hasSettingsChanges:()=>{}});class Pc extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{processing:!1,errors:null,hasBeenValidated:!1,isDataModified:!1,settings:new _c,findSettings:this.findSettings.bind(this),getSettings:this.getSettings.bind(this),setSettings:this.setSettings.bind(this),isProcessing:this.isProcessing.bind(this),validateData:this.validateData.bind(this),save:this.save.bind(this),getErrors:this.getErrors.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this)}}async findSettings(){this.setState({processing:!0});const e=await this.props.context.port.request("passbolt.user-passphrase-policies.find"),t=_c.fromEntityDto(e);this.setState({settings:t,currentSettings:t,processing:!1})}getSettings(){return this.state.settings}setSettings(e,t){const a=this.state.settings.cloneWithMutation(e,t),s=_c.isDataDifferent(a,this.state.currentSettings);if(!this.state.hasBeenValidated)return void this.setState({settings:a,isDataModified:s});const n=a.validate();this.setState({errors:n,settings:a,isDataModified:s})}isProcessing(){return this.state.processing}validateData(){const e=this.state.settings.validate(),t=e.hasErrors(),a=t?e:null;return this.setState({errors:a,hasBeenValidated:!0}),!t}async save(){this.setState({processing:!0});try{const e=this.state.settings.toEntityDto(),t=await this.props.context.port.request("passbolt.user-passphrase-policies.save",e),a=_c.fromEntityDto(t);this.setState({settings:a,currentSettings:a,processing:!1,isDataModified:!1})}finally{this.setState({processing:!1})}}getErrors(){return this.state.errors}hasSettingsChanges(){return this.state.isDataModified}render(){return s.createElement(Ic.Provider,{value:this.state},this.props.children)}}function Ac(e){return class extends s.Component{render(){return s.createElement(Ic.Consumer,null,(t=>s.createElement(e,Nc({adminUserPassphrasePoliciesContext:t},this.props))))}}}Pc.propTypes={context:r().any,children:r().any,t:r().any},I((0,v.CI)("common")(Pc));class Tc extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSave=this.handleSave.bind(this)}get isActionEnabled(){return!this.props.adminUserPassphrasePoliciesContext.isProcessing()}async handleSave(){if(this.isActionEnabled&&this.props.adminUserPassphrasePoliciesContext.validateData())try{await this.props.adminUserPassphrasePoliciesContext.save(),await this.handleSaveSuccess()}catch(e){await this.handleSaveError(e)}}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The user passphrase policies were updated."))}async handleSaveError(e){console.error(e),await this.props.actionFeedbackContext.displayError(e.message),this.props.dialogContext.open(Pt,{error:e})}render(){const e=!this.isActionEnabled;return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary form",disabled:e,id:"save-settings",onClick:this.handleSave},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Tc.propTypes={adminUserPassphrasePoliciesContext:r().object,actionFeedbackContext:r().object,dialogContext:r().any,t:r().func};const Rc=Ac(d(g((0,v.CI)("common")(Tc))));class Dc extends s.PureComponent{constructor(e){super(e),this.bindHandlers()}bindHandlers(){this.handleRangeOptionClick=this.handleRangeOptionClick.bind(this),this.handleRangeChange=this.handleRangeChange.bind(this)}handleRangeOptionClick(e){this.props.disabled||this.props.onChange(this.props.id,e)}handleRangeChange(e){const t=e.target;this.props.onChange(t.name,this.values[t.value].value)}getComputedStyleForEntropyStep(e,t){return{left:e*(100/(t-1))+"%"}}getValueIndex(e){return this.values.findIndex((t=>t.value===e))}get values(){return[{label:"50 bits",value:50},{label:"64 bits",value:64},{label:"80 bits",value:80},{label:"96 bits",value:96},{label:"128 bits",value:128},{label:"160 bits",value:160},{label:"192 bits",value:192},{label:"224 bits",value:224}]}render(){const e=this.values,t=e.length,{id:a,value:n}=this.props;return s.createElement("div",{className:"range-wrapper"},s.createElement("div",{className:"range-labels"},s.createElement("label",{key:"min"},s.createElement(v.x6,null,"Weak")),s.createElement("label",{key:"max"},s.createElement(v.x6,null,"Secure"))),s.createElement("div",{className:"range-input-wrapper"},s.createElement("input",{type:"range",className:"range-input",id:a,name:a,min:0,max:e.length-1,value:this.getValueIndex(n),list:`${this.props.id}-values`,onChange:this.handleRangeChange,required:!0,disabled:this.props.disabled}),s.createElement("ul",{className:"range-options"},e.map(((e,a)=>s.createElement("li",{key:`li-${a}`,onClick:()=>this.handleRangeOptionClick(e.value),style:this.getComputedStyleForEntropyStep(a,t),className:"range-option "+(n===e.value?"range-option--active":""),disabled:this.props.disabled},e.label))))))}}Dc.propTypes={value:r().number.isRequired,id:r().string.isRequired,onChange:r().func,disabled:r().bool};const Oc=(0,v.CI)("common")(Dc);class Uc extends s.PureComponent{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isReady:!1}}async componentDidMount(){await this.props.adminUserPassphrasePoliciesContext.findSettings(),this.setState({isReady:!0})}bindCallbacks(){this.handleMinimumEntropyChange=this.handleMinimumEntropyChange.bind(this),this.handleCheckboxInputChange=this.handleCheckboxInputChange.bind(this)}hasAllInputDisabled(){return this.props.adminUserPassphrasePoliciesContext.isProcessing()}handleMinimumEntropyChange(e,t){const a=parseInt(t,10)||0;this.props.adminUserPassphrasePoliciesContext.setSettings(e,a)}handleCheckboxInputChange(e){const t=e.target,a=t.name,s=Boolean(t.checked);this.props.adminUserPassphrasePoliciesContext.setSettings(a,s)}isWeakSettings(e){return e.entropy_minimum<80}get hasWarnings(){const e=this.props.adminUserPassphrasePoliciesContext,t=e.getSettings();return e.hasSettingsChanges()||this.isWeakSettings(t)}render(){if(!this.state.isReady)return null;const e=this.hasAllInputDisabled(),t=this.props.adminUserPassphrasePoliciesContext,a=t.getSettings();return s.createElement("div",{className:"row"},s.createElement("div",{className:"password-policies-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{id:"user-passphrase-policies-title",className:"title"},s.createElement(v.x6,null,"User Passphrase Policies")),s.createElement("form",null,s.createElement("h4",{id:"user-passphrase-policies-entropy-minimum"},s.createElement(v.x6,null,"User passphrase minimal entropy")),s.createElement("div",{className:"input range"},s.createElement(Oc,{id:"entropy_minimum",onChange:this.handleMinimumEntropyChange,value:a.entropy_minimum,disabled:e})),s.createElement("div",null,s.createElement(v.x6,null,"You can set the minimal entropy for the users' private key passphrase.")," ",s.createElement(v.x6,null,"This is the passphrase that is asked during sign in or recover.")),s.createElement("h4",{id:"user-passphrase-policies-external-services-subtitle"},s.createElement("span",{className:"input toggle-switch form-element ready"},s.createElement("input",{id:"user-passphrase-policies-external-services-toggle-button",type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"external_dictionary_check",onChange:this.handleCheckboxInputChange,checked:a?.external_dictionary_check,disabled:e}),s.createElement("label",{htmlFor:"user-passphrase-policies-external-services-toggle-button"},s.createElement(v.x6,null,"External password dictionary check")))),s.createElement("span",{className:"input toggle-switch form-element"},s.createElement(v.x6,null,"Allow passbolt to access external services to check if the user passphrase has been compromised when the user creates it.")))),this.hasWarnings&&s.createElement("div",{className:"warning message"},t.hasSettingsChanges()&&s.createElement("div",{id:"user-passphrase-policies-save-banner"},s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))),this.isWeakSettings(a)&&s.createElement("div",{id:"user-passphrase-policies-weak-settings-banner"},s.createElement("p",null,s.createElement(v.x6,null,"Passbolt recommends passphrase strength to be at minimum of ",{MINIMAL_ADVISED_ENTROPY:80}," bits to be safe."))))),s.createElement(Rc,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"What is user passphrase policies?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the user passphrase policies, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/authentication/user-passphrase-policies/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ji,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}Uc.propTypes={context:r().object,administrationWorkspaceContext:r().object,adminUserPassphrasePoliciesContext:r().object,t:r().func};const Mc=I(Ee(Ac((0,v.CI)("common")(Uc))));class Fc extends te{constructor(e,t={}){super(X.validate(Fc.ENTITY_NAME,e,Fc.getSchema()),t)}static getSchema(){return{type:"object",required:["automatic_expiry","automatic_update"],properties:{id:{type:"string",format:"uuid"},default_expiry_period:{type:"null"},policy_override:{type:"boolean"},automatic_expiry:{type:"boolean"},automatic_update:{type:"boolean"},created:{type:"string",format:"date-time"},created_by:{type:"string",format:"uuid"},modified:{type:"string",format:"date-time"},modified_by:{type:"string",format:"uuid"}}}}static get ENTITY_NAME(){return"PasswordExpirySettings"}static createFromDefault(e={}){const t={default_expiry_period:null,policy_override:!1,automatic_expiry:!1,automatic_update:!1,...e};return new Fc(t)}}const jc=Fc;class zc extends te{constructor(e,t={}){super(X.validate(zc.ENTITY_NAME,e,zc.getSchema()),t)}static getSchema(){return{type:"object",required:["automatic_expiry","automatic_update","policy_override"],properties:{id:{type:"string",format:"uuid"},default_expiry_period:{type:"integer",minimum:1,maximum:999,nullable:!0},policy_override:{type:"boolean"},automatic_expiry:{type:"boolean"},automatic_update:{type:"boolean"},created:{type:"string",format:"date-time"},created_by:{type:"string",format:"uuid"},modified:{type:"string",format:"date-time"},modified_by:{type:"string",format:"uuid"}}}}static get ENTITY_NAME(){return"passwordExpiryProSettingsEntity"}static createFromDefault(e={}){const t={default_expiry_period:null,policy_override:!1,automatic_expiry:!0,automatic_update:!0,...e};return new zc(t)}}const Lc=zc;class qc{constructor(e={}){this.automatic_update=Boolean(e?.automatic_update),this.policy_override=Boolean(e?.policy_override),this.automatic_expiry=Boolean(e?.automatic_expiry);const t=parseInt(e?.default_expiry_period,10);this.default_expiry_period=isNaN(t)?null:t,this.default_expiry_period_toggle=void 0!==e?.default_expiry_period_toggle?Boolean(e.default_expiry_period_toggle):Boolean(this.default_expiry_period),e?.id&&(this.id=e?.id)}static getSchema(e=!1){const t=e?Lc.getSchema():jc.getSchema();return this.getDefaultSchema(t,e)}static getDefaultSchema(e,t=!1){const a={type:"object",required:["automatic_expiry","automatic_update"],properties:{id:e.properties.id,automatic_expiry:e.properties.automatic_expiry,automatic_update:e.properties.automatic_update,policy_override:e.properties.policy_override,default_expiry_period:e.properties.default_expiry_period}};return t&&a.required.push("policy_override"),a}static fromEntityDto(e){const t={automatic_expiry:Boolean(e?.automatic_expiry),automatic_update:Boolean(e?.automatic_update),policy_override:Boolean(e?.policy_override),default_expiry_period:null!==e?.default_expiry_period?parseInt(e?.default_expiry_period,10):null};return e?.id&&(t.id=e.id),new qc(t)}static isDataDifferent(e,t){return["automatic_expiry","automatic_update","policy_override","default_expiry_period"].some((a=>e[a]!==t[a]))}toEntityDto(){const e=this.default_expiry_period_toggle?this.default_expiry_period:null;return{automatic_expiry:this.automatic_expiry,automatic_update:this.automatic_update,policy_override:this.policy_override,default_expiry_period:e}}cloneWithMutation(e,t){const a={...this,[e]:t};return new qc(a)}validate(e=!1){const t=new $,a=qc.getSchema(e);try{X.validate(this.constructor.name,this,a),this.validateFormInput(t,e)}catch(t){if(!(t instanceof $))throw t;return this.validateFormInput(t,e),t}return t}validateFormInput(e,t){t&&this.default_expiry_period_toggle&&null===this.default_expiry_period&&e.addError("default_expiry_period","required","The default_expiry_period is required.")}get isSettingsDisabled(){return!this.id}}const Kc=qc;function Wc(){return Wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Wc.apply(null,arguments)}const Vc=s.createContext({getSettings:()=>{},get:()=>{},setSettingsBulk:()=>{},findSettings:()=>{},isProcessing:()=>{},validateData:()=>{},save:()=>{},getErrors:()=>{},isFeatureToggleEnabled:()=>{},setFeatureToggle:()=>{},hasSettingsChanges:()=>{},isSubmitted:()=>{},setSubmitted:()=>{},setDefaultExpiryToggle:()=>{}});class Bc extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{processing:!1,errors:null,hasBeenValidated:!1,isDataModified:!1,submitted:!1,currentSettings:new Kc,featureToggleEnabled:!1,settings:new Kc,findSettings:this.findSettings.bind(this),getSettings:this.getSettings.bind(this),setSettingsBulk:this.setSettingsBulk.bind(this),isProcessing:this.isProcessing.bind(this),validateData:this.validateData.bind(this),save:this.save.bind(this),getErrors:this.getErrors.bind(this),hasSettingsChanges:this.hasSettingsChanges.bind(this),isFeatureToggleEnabled:this.isFeatureToggleEnabled.bind(this),setFeatureToggle:this.setFeatureToggle.bind(this),setDefaultExpiryToggle:this.setDefaultExpiryToggle.bind(this),isSubmitted:this.isSubmitted.bind(this),setSubmitted:this.setSubmitted.bind(this)}}async findSettings(){this.setState({processing:!0}),this.setState({submitted:!1});const e=await this.props.context.port.request("passbolt.password-expiry.get-or-find",!0),t=Kc.fromEntityDto(e);this.setState({toggleEnabled:t?.id,settings:t,currentSettings:t,processing:!1})}setDefaultExpiryToggle(e){let t=this.state.settings.default_expiry_period;e&&null===this.state.settings.default_expiry_period&&(t=90),this.setSettingsBulk({default_expiry_period_toggle:e,default_expiry_period:t})}getSettings(){return this.state.settings}setSubmitted(e){this.setState({submitted:e})}isSubmitted(){return this.state.submitted}setSettingsBulk(e){let t=this.state.settings;const a=Object.keys(e);for(let s=0;s<a.length;s++){const n=a[s];t=t.cloneWithMutation(n,e[n])}const s=Kc.isDataDifferent(t,this.state.currentSettings);if(!this.state.hasBeenValidated)return void this.setState({settings:t,isDataModified:s});const n=this.props.context.siteSettings.canIUse("passwordExpiryPolicies"),i=t.validate(n);this.setState({errors:i,settings:t,isDataModified:s})}isProcessing(){return this.state.processing}isFeatureToggleEnabled(){return this.state.toggleEnabled}setFeatureToggle(e){this.props.context.siteSettings.canIUse("passwordExpiryPolicies")||this.setSettingsBulk({automatic_expiry:e,automatic_update:e}),this.setState({toggleEnabled:e})}validateData(){const e=this.props.context.siteSettings.canIUse("passwordExpiryPolicies"),t=this.state.settings.validate(e),a=t.hasErrors(),s=a?t:null;return this.setState({errors:s,hasBeenValidated:!0}),!a}async save(){if(!this.isFeatureToggleEnabled()&&!this.state.settings.id)return;this.setState({processing:!0});const e={processing:!1};try{const t=!this.isFeatureToggleEnabled()&&Boolean(this.state.settings.id)?await this.doDeleteSettings():await this.doSaveSettings();e.settings=t,e.currentSettings=t,e.isDataModified=!1,e.submitted=!1}finally{this.setState(e)}}async doDeleteSettings(){return this.props.context.port.request("passbolt.password-expiry.delete",this.state.settings.id),this.props.context.siteSettings.canIUse("passwordExpiryPolicies")?new Kc(Lc.createFromDefault().toDto()):new Kc}async doSaveSettings(){const e=this.props.context.siteSettings.canIUse("passwordExpiryPolicies"),t=this.state.settings.toEntityDto();e&&!this.state.settings.default_expiry_period_toggle&&(t.default_expiry_period=null);const a=await this.props.context.port.request("passbolt.password-expiry.save",t);return new Kc(a)}getErrors(){return this.state.errors}hasSettingsChanges(){return this.state.isDataModified}render(){return s.createElement(Vc.Provider,{value:this.state},this.props.children)}}function Gc(e){return class extends s.Component{render(){return s.createElement(Vc.Consumer,null,(t=>s.createElement(e,Wc({adminPasswordExpiryContext:t},this.props))))}}}Bc.propTypes={context:r().any,children:r().any,t:r().any},I((0,v.CI)("common")(Bc));class $c extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSave=this.handleSave.bind(this)}get isActionEnabled(){return!this.props.adminPasswordExpiryContext.isProcessing()}async handleSave(){if(this.props.adminPasswordExpiryContext.setSubmitted(!0),this.isActionEnabled&&this.props.adminPasswordExpiryContext.validateData())try{await this.props.adminPasswordExpiryContext.save(),await this.handleSaveSuccess()}catch(e){await this.handleSaveError(e)}}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The password expiry settings were updated."))}async handleSaveError(e){console.error(e),await this.props.actionFeedbackContext.displayError(e.message),this.props.dialogContext.open(Pt,{error:e})}render(){const e=!this.isActionEnabled;return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary form",disabled:e,id:"save-settings",onClick:this.handleSave},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}$c.propTypes={adminPasswordExpiryContext:r().object,actionFeedbackContext:r().object,dialogContext:r().any,t:r().func};const Hc=d(Gc(g((0,v.CI)("common")($c))));class Yc extends s.PureComponent{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleExpiryPeriodToggleClick=this.handleExpiryPeriodToggleClick.bind(this)}handleInputChange(e){const{type:t,checked:a,value:s,name:n}=e.target,i="checkbox"===t?a:parseInt(s,10);this.props.adminPasswordExpiryContext.setSettingsBulk({[n]:i})}handleExpiryPeriodToggleClick(e){const t=e.target.checked;this.props.adminPasswordExpiryContext.setDefaultExpiryToggle(t)}async handleFormSubmit(e){if(e.preventDefault(),this.props.adminPasswordExpiryContext.setSubmitted(!0),!this.props.adminPasswordExpiryContext.isProcessing()&&this.props.adminPasswordExpiryContext.validateData())try{await this.props.adminPasswordExpiryContext.save(),await this.handleSaveSuccess()}catch(e){await this.handleSaveError(e)}}async handleSaveSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The password expiry settings were updated."))}async handleSaveError(e){await this.props.actionFeedbackContext.displayError(e.message),this.props.dialogContext.open(Pt,{error:e})}hasAllInputDisabled(){return this.props.adminPasswordExpiryContext.isProcessing()}get settings(){return this.props.adminPasswordExpiryContext.getSettings()}get errors(){const e=this.props.adminPasswordExpiryContext.getErrors();return e?.details}render(){const e=this.props.adminPasswordExpiryContext.isSubmitted(),t=this.settings.default_expiry_period||"",a=Boolean(this.settings?.default_expiry_period_toggle);return s.createElement("div",{id:"password-expiry-form-advanced"},s.createElement("form",{className:"form",onSubmit:this.handleFormSubmit},s.createElement("h4",{className:"no-border",id:"expiry-policies-subtitle"},s.createElement(v.x6,null,"Expiry Policies")),s.createElement("p",{id:"expiry-policies-description"},s.createElement(v.x6,null,"In this section you can choose the default behaviour of password expiry policy for all users.")),s.createElement("div",{className:"togglelist-alt"},s.createElement("span",{id:"default-expiry-period",className:"input toggle-switch form-element "+(this.errors?.default_expiry_period&&e?"has-error":"")},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"defaultExpiryPeriodToggle",onChange:this.handleExpiryPeriodToggleClick,checked:a,disabled:this.hasAllInputDisabled(),id:"default-expiry-period-toggle"}),s.createElement("label",{htmlFor:"default-expiry-period-toggle"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Default password expiry period")),s.createElement("span",{className:"info-input"},s.createElement(v.x6,null,s.createElement("span",null,"When a user creates a resource, a default expiry date is set to "),s.createElement("input",{type:"text",className:"toggle-input",id:"default-expiry-period-input",name:"default_expiry_period",onChange:this.handleInputChange,maxLength:3,value:t,disabled:this.hasAllInputDisabled()||!a,placeholder:"90"}),s.createElement("span",null,"days"))))),this.errors?.default_expiry_period&&e&&s.createElement("div",{className:"input"},!this.errors.default_expiry_period.required&&s.createElement("div",{className:"default-expiry-period-gte error-message"},s.createElement(v.x6,null,"The default password expiry period should be a number between 1 and 999 days.")),this.errors?.default_expiry_period.required&&s.createElement("div",{className:"default-expiry-period-required  error-message"},s.createElement(v.x6,null,"The default password expiry period should be a valid number.")))),s.createElement("div",{className:"togglelist-alt"},s.createElement("span",{className:"input toggle-switch form-element",id:"policy-override"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"policy_override",onChange:this.handleInputChange,checked:this.settings.policy_override,disabled:this.hasAllInputDisabled(),id:"policy-override-toggle"}),s.createElement("label",{htmlFor:"policy-override-toggle"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Policy Override")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Allow users to override the default policy."))))),s.createElement("h4",{className:"no-border",id:"automatic-workflow-subtitle"},s.createElement(v.x6,null,"Automatic workflows")),s.createElement("p",{id:"automatic-workflow-description"},s.createElement(v.x6,null,"In this section you can choose automatic behaviours.")),s.createElement("div",{className:"togglelist-alt"},s.createElement("span",{className:"input toggle-switch form-element",id:"automatic-expiry"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"automatic_expiry",onChange:this.handleInputChange,checked:this.settings.automatic_expiry,disabled:this.hasAllInputDisabled(),id:"automatic-expiry-toggle"}),s.createElement("label",{htmlFor:"automatic-expiry-toggle"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Automatic Expiry")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Password automatically expires when a user or group with a user who has accessed the password is removed from the permission list."))))),s.createElement("div",{className:"togglelist-alt"},s.createElement("span",{className:"input toggle-switch form-element",id:"automatic-update"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"automatic_update",onChange:this.handleInputChange,checked:this.settings.automatic_update,disabled:this.hasAllInputDisabled(),id:"automatic-update-toggle"}),s.createElement("label",{htmlFor:"automatic-update-toggle"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Automatic Update")),s.createElement("span",{className:"info"},a?s.createElement(v.x6,null,"Password expiry date is renewed based on the default password expiry period whenever a password is updated."):s.createElement(v.x6,null,"Password is no longer marked as expired whenever the password is updated.")))))))}}Yc.propTypes={context:r().object,adminPasswordExpiryContext:r().object,actionFeedbackContext:r().object,dialogContext:r().object,t:r().func};const Jc=I(Gc(d(g((0,v.CI)("common")(Yc)))));class Zc extends s.PureComponent{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{isReady:!1}}async componentDidMount(){await this.props.adminPasswordExpiryContext.findSettings(),this.setState({isReady:!0})}hasAllInputDisabled(){return this.props.adminPasswordExpiryContext.isProcessing()}get canUseAdvancedSettings(){return this.props.context.siteSettings.canIUse("passwordExpiryPolicies")}render(){if(!this.state.isReady)return null;const e=this.props.adminPasswordExpiryContext,t=e.isFeatureToggleEnabled();return s.createElement("div",{className:"row"},s.createElement("div",{className:"password-expiry-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",{id:"password-expiry-settings-title",className:"title"},s.createElement("span",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"passwordExpirySettingsToggle",onChange:()=>e.setFeatureToggle(!t),checked:t,disabled:this.hasAllInputDisabled(),id:"passwordExpirySettingsToggle"}),s.createElement("label",{htmlFor:"passwordExpirySettingsToggle"},s.createElement(v.x6,null,"Password Expiry")))),!t&&s.createElement("p",{className:"description"},s.createElement(v.x6,null,"No Password Expiry is configured. Enable it to activate automatic password expiration and automatic password expiration reset workflows.")),t&&s.createElement(s.Fragment,null,this.canUseAdvancedSettings?s.createElement(Jc,null):s.createElement("div",{id:"password-expiry-settings-form"},s.createElement("h4",{id:"password-expiry-settings-automatic-workflows",className:"title title--required no-border"},s.createElement(v.x6,null,"Automatic workflows")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio"},s.createElement("label",{htmlFor:"passwordExpiryAutomaticExpiry"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Automatic expiry")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Password automatically expires when a user or group with a user who has accessed the password is removed from the permission list.")))),s.createElement("div",{className:"input radio"},s.createElement("label",{htmlFor:"passwordExpiryAutomatiUpdate"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Automatic update")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Password is no longer marked as expired whenever the password is updated.")))))))),e.hasSettingsChanges()&&s.createElement("div",{className:"warning message",id:"password-expiry-settings-save-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(Hc,null),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"About password expiry")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the password expiry, checkout the dedicated page on the help website.")),s.createElement("a",{className:"button",href:"https://passbolt.com/docs/admin/password-configuration/password-expiry",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ji,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}Zc.propTypes={context:r().object,administrationWorkspaceContext:r().object,adminPasswordExpiryContext:r().object,t:r().func};const Qc=I(Ee(Gc((0,v.CI)("common")(Zc))));class Xc extends s.Component{get errorTitle(){return{403:this.props.t("Whoops... access is denied"),404:this.props.t("Whoops... looks like you are lost.")}[this.props.errorCode]||""}get errorDescription(){return{403:this.props.t("Access is restricted to authorized users only."),404:this.props.t("We could not find the page you are looking for.")}[this.props.errorCode]||""}render(){return s.createElement("div",{className:"row"},s.createElement("div",{className:"http-error main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",null,this.props.errorCode),s.createElement("h4",null,this.errorTitle),s.createElement("div",null,s.createElement("p",null,this.errorDescription)))))}}Xc.propTypes={errorCode:r().number.isRequired,t:r().func};const em=(0,v.CI)("common")(Xc),tm=class{constructor(e){this.apiClientOptions=e,this.initClient()}async fetchHealthcheck(){this.initClient();const e=await this.apiClient.findAll();return e?.body}initClient(){this.apiClientOptions.setResourceName("healthcheck"),this.apiClient=new Qt(this.apiClientOptions)}};class am extends te{constructor(e,t={}){super(X.validate(am.ENTITY_NAME,e,am.getSchema()),t)}static getSchema(){return{type:"object",required:["peerValid","hostValid","notSelfSigned"],properties:{peerValid:{type:"boolean"},hostValid:{type:"boolean"},notSelfSigned:{type:"boolean"},info:{type:"string"}}}}get peerValid(){return this._props.peerValid}get hostValid(){return this._props.hostValid}get notSelfSigned(){return this._props.notSelfSigned}get info(){return this._props.info}static get ENTITY_NAME(){return"ssl"}}const sm=am;class nm extends te{constructor(e,t={}){super(X.validate(nm.ENTITY_NAME,e,nm.getSchema()),t)}static getSchema(){return{type:"object",required:["tablesCount","info","connect","supportedBackend","defaultContent"],properties:{tablesCount:{type:"boolean"},info:{type:"object",required:["tablesCount"],properties:{tablesCount:{type:"number"}}},connect:{type:"boolean"},supportedBackend:{type:"boolean"},defaultContent:{type:"boolean"}}}}get tablesCount(){return this._props.tablesCount}get info(){return this._props.info}get connect(){return this._props.connect}get supportedBackend(){return this._props.supportedBackend}get defaultContent(){return this._props.defaultContent}static get ENTITY_NAME(){return"database"}}const im=nm;class rm extends te{constructor(e,t={}){super(X.validate(rm.ENTITY_NAME,e,rm.getSchema()),t)}static getSchema(){return{type:"object",required:["info","latestVersion","schema","robotsIndexDisabled","sslForce","sslFullBaseUrl","seleniumDisabled","registrationClosed","configPath","hostAvailabilityCheckEnabled","jsProd","emailNotificationEnabled"],properties:{info:{type:"object",required:["remoteVersion","currentVersion"],properties:{remoteVersion:{type:"string",nullable:!0},currentVersion:{type:"string"}}},latestVersion:{type:"boolean",nullable:!0},schema:{type:"boolean"},robotsIndexDisabled:{type:"boolean"},sslForce:{type:"boolean"},sslFullBaseUrl:{type:"boolean"},seleniumDisabled:{type:"boolean"},configPath:{type:"string"},registrationClosed:{type:"object",required:["isSelfRegistrationPluginEnabled","selfRegistrationProvider","isRegistrationPublicRemovedFromPassbolt"],properties:{isSelfRegistrationPluginEnabled:{type:"boolean"},selfRegistrationProvider:{type:"string",nullable:!0},isRegistrationPublicRemovedFromPassbolt:{type:"boolean"}}},hostAvailabilityCheckEnabled:{type:"boolean"},jsProd:{type:"boolean"},emailNotificationEnabled:{type:"boolean"}}}}get info(){return this._props.info}get latestVersion(){return this._props.latestVersion}getSchema(){return this._props.getSchema}get robotsIndexDisabled(){return this._props.robotsIndexDisabled}get sslForce(){return this._props.sslForce}get sslFullBaseUrl(){return this._props.sslFullBaseUrl}get schema(){return this._props.schema}get currentVersion(){return this._props.currentVersion}get configPath(){return this._props.configPath}get seleniumDisabled(){return this._props.seleniumDisabled}get registrationClosed(){return this._props.registrationClosed}get hostAvailabilityCheckEnabled(){return this._props.hostAvailabilityCheckEnabled}get jsProd(){return this._props.jsProd}get emailNotificationEnabled(){return this._props.emailNotificationEnabled}static get ENTITY_NAME(){return"application"}}const om=rm;class lm extends te{constructor(e,t={}){super(X.validate(lm.ENTITY_NAME,e,lm.getSchema()),t)}static getSchema(){return{type:"object",required:["canDecryptVerify","canVerify","gpgKeyPublicInKeyring","canEncrypt","canDecrypt","canEncryptSign","canSign","gpgHome","gpgKeyPrivateFingerprint","gpgKeyPublicFingerprint","gpgKeyPublicEmail","gpgKeyPublicReadable","gpgKeyPrivateReadable","gpgKey","lib","gpgKeyNotDefault","info","gpgHomeWritable","gpgKeyPublic","gpgKeyPublicBlock","gpgKeyPrivate","gpgKeyPrivateBlock","isPublicServerKeyGopengpgCompatible","isPrivateServerKeyGopengpgCompatible"],properties:{canDecryptVerify:{type:"boolean"},canVerify:{type:"boolean"},gpgKeyPublicInKeyring:{type:"boolean"},canEncrypt:{type:"boolean"},canDecrypt:{type:"boolean"},canEncryptSign:{type:"boolean"},canSign:{type:"boolean"},gpgHome:{type:"boolean"},gpgKeyPrivateFingerprint:{type:"boolean"},gpgKeyPublicFingerprint:{type:"boolean"},gpgKeyPublicEmail:{type:"boolean"},gpgKeyPublicReadable:{type:"boolean"},gpgKeyPrivateReadable:{type:"boolean"},gpgKey:{type:"boolean"},lib:{type:"boolean"},gpgKeyNotDefault:{type:"boolean"},gpgHomeWritable:{type:"boolean"},gpgKeyPublic:{type:"boolean"},gpgKeyPublicBlock:{type:"boolean"},gpgKeyPrivate:{type:"boolean"},gpgKeyPrivateBlock:{type:"boolean"},isPublicServerKeyGopengpgCompatible:{type:"boolean"},isPrivateServerKeyGopengpgCompatible:{type:"boolean"},info:{type:"object",required:["gpgHome","gpgKeyPrivate"],properties:{gpgHome:{type:"string"},gpgKeyPrivate:{type:"string"}}}}}}get canDecryptVerify(){return this._props.canDecryptVerify}get canVerify(){return this._props.canVerify}get gpgKeyPublicInKeyring(){return this._props.gpgKeyPublicInKeyring}get canEncrypt(){return this._props.canEncrypt}get canDecrypt(){return this._props.canDecrypt}get canEncryptSign(){return this._props.canEncryptSign}get canSign(){return this._props.canSign}get gpgHome(){return this._props.gpgHome}get gpgKeyPrivateFingerprint(){return this._props.gpgKeyPrivateFingerprint}get gpgKeyPublicFingerprint(){return this._props.gpgKeyPublicFingerprint}get gpgKeyPublicEmail(){return this._props.gpgKeyPublicEmail}get gpgKeyPublicReadable(){return this._props.gpgKeyPublicReadable}get gpgKeyPrivateReadable(){return this._props.gpgKeyPrivateReadable}get gpgKey(){return this._props.gpgKey}get lib(){return this._props.lib}get gpgKeyNotDefault(){return this._props.gpgKeyNotDefault}get info(){return this._props.info}get gpgHomeWritable(){return this._props.gpgHomeWritable}get gpgKeyPublic(){return this._props.gpgKeyPublic}get gpgKeyPublicBlock(){return this._props.gpgKeyPublicBlock}get gpgKeyPrivate(){return this._props.gpgKeyPrivate}get gpgKeyPrivateBlock(){return this._props.gpgKeyPrivateBlock}get isPublicServerKeyGopengpgCompatible(){return this._props.isPublicServerKeyGopengpgCompatible}get isPrivateServerKeyGopengpgCompatible(){return this._props.isPrivateServerKeyGopengpgCompatible}static get ENTITY_NAME(){return"gpg"}}const cm=lm;class mm extends te{constructor(e,t={}){super(X.validate(mm.ENTITY_NAME,e,mm.getSchema()),t)}static getSchema(){return{type:"object",required:["phpVersion","nextMinPhpVersion","pcre","mbstring","gnupg","intl","image","tmpWritable","logWritable"],properties:{phpVersion:{type:"boolean"},nextMinPhpVersion:{type:"boolean"},pcre:{type:"boolean"},mbstring:{type:"boolean"},gnupg:{type:"boolean"},intl:{type:"boolean"},image:{type:"boolean"},tmpWritable:{type:"boolean"},logWritable:{type:"boolean"},info:{type:"object",required:["phpVersion"],properties:{serverPhpVersion:{"type:":"string"}}}}}}get phpVersion(){return this._props.phpVersion}get nextMinPhpVersion(){return this._props.nextMinPhpVersion}get pcre(){return this._props.pcre}get mbstring(){return this._props.mbstring}get gnupg(){return this._props.gnupg}get intl(){return this._props.intl}get image(){return this._props.image}get tmpWritable(){return this._props.tmpWritable}get logWritable(){return this._props.logWritable}get info(){return this._props.info}get serverPhpVersion(){return this._props.phpVersion}static get ENTITY_NAME(){return"environment"}}const dm=mm;class pm extends te{constructor(e,t={}){super(X.validate(pm.ENTITY_NAME,e,pm.getSchema()),t)}static getSchema(){return{type:"object",required:["app","passbolt"],properties:{app:{type:"boolean"},passbolt:{type:"boolean"}}}}get app(){return this._props.app}get passbolt(){return this._props.passbolt}static get ENTITY_NAME(){return"configFile"}}const um=pm;class hm extends te{constructor(e,t={}){super(X.validate(hm.ENTITY_NAME,e,hm.getSchema()),t)}static getSchema(){return{type:"object",required:["cache","debugDisabled","salt","fullBaseUrl","validFullBaseUrl","info","fullBaseUrlReachable"],properties:{cache:{type:"boolean"},debugDisabled:{type:"boolean"},salt:{type:"boolean"},fullBaseUrl:{type:"boolean"},validFullBaseUrl:{type:"boolean"},info:{type:"object",required:["fullBaseUrl"],properties:{fullBaseUrl:{type:"string",format:"uri"}}},fullBaseUrlReachable:{type:"boolean"}}}}get cache(){return this._props.cache}get debugDisabled(){return this._props.debugDisabled}get salt(){return this._props.salt}get fullBaseUrl(){return this._props.fullBaseUrl}get validFullBaseUrl(){return this._props.validFullBaseUrl}get info(){return this._props.info}get fullBaseUrlReachable(){return this._props.fullBaseUrlReachable}static get ENTITY_NAME(){return"core"}}const gm=hm;class bm extends te{constructor(e,t={}){super(X.validate(bm.ENTITY_NAME,e,bm.getSchema()),t)}static getSchema(){return{type:"object",required:["isEnabled","areEndpointsDisabled","errorMessage","source","isInDb"],properties:{isEnabled:{type:"boolean"},areEndpointsDisabled:{type:"boolean"},errorMessage:{anyOf:[{type:"boolean"},{type:"string"}]},source:{type:"string"},isInDb:{type:"boolean"}}}}get isEnabled(){return this._props.isEnabled}get areEndpointsDisabled(){return this._props.areEndpointsDisabled}get errorMessage(){return this._props.errorMessage}get source(){return this._props.source}get isInDb(){return this._props.isInDb}static get ENTITY_NAME(){return"smtpSettings"}}const ym=bm;class fm extends te{constructor(e,t={}){super(X.validate(fm.ENTITY_NAME,e,fm.getSchema()),t)}static getSchema(){return{type:"object",required:["endpointsDisabled"],properties:{endpointsDisabled:{type:"boolean"}}}}get endpointsDisabled(){return this._props.endpointsDisabled}static get ENTITY_NAME(){return"directorySync"}}const vm=fm;class Em extends te{constructor(e,t={}){super(X.validate(Em.ENTITY_NAME,e,Em.getSchema()),t)}static getSchema(){return{type:"object",required:["sslHostVerification"],properties:{sslHostVerification:{type:"boolean"}}}}get sslHostVerification(){return this._props.sslHostVerification}static get ENTITY_NAME(){return"sso"}}const wm=Em;class km extends te{constructor(e,t={}){super(X.validate(km.ENTITY_NAME,e,km.getSchema()),t),this._props.ssl&&(this._ssl=new sm(this._props.ssl,{clone:!1})),delete this._props.ssl,this._props.database&&(this._database=new im(this._props.database,{clone:!1})),delete this._props.database,this._props.application&&(this._application=new om(this._props.application,{clone:!1})),delete this._props.application,this._props.gpg&&(this._gpg=new cm(this._props.gpg,{clone:!1})),delete this._props.gpg,this._props.environment&&(this._environment=new dm(this._props.environment,{clone:!1})),delete this._props.environment,this._props.configFile&&(this._configFile=new um(this._props.configFile,{clone:!1})),delete this._props.configFile,this._props.core&&(this._core=new gm(this._props.core,{clone:!1})),delete this._props.core,this._props.smtpSettings&&(this._smtpSettings=new ym(this._props.smtpSettings,{clone:!1})),delete this._props.smtpSettings,this._props.directorySync&&(this._directorySync=new vm(this._props.directorySync,{clone:!1})),delete this._props.directorySync,this._props.sso&&(this._sso=new wm(this._props.sso,{clone:!1})),delete this._props.sso}static getSchema(){return{type:"object",required:["database","ssl","application","gpg","configFile","core","smtpSettings"],properties:{database:im.getSchema(),ssl:sm.getSchema(),application:om.getSchema(),gpg:cm.getSchema(),environment:dm.getSchema(),configFile:um.getSchema(),core:gm.getSchema(),smtpSettings:ym.getSchema(),directorySync:vm.getSchema(),sso:wm.getSchema()}}}isSSLValid(){const e=this._props.ssl;return e.peerValid&&e.hostValid&&!e.notSelfSigned}static get ENTITY_NAME(){return"healthcheck"}get ssl(){return this._ssl||null}get database(){return this._database||null}get application(){return this._application||null}get gpg(){return this._gpg||null}get environment(){return this._environment||null}get configFile(){return this._configFile||null}get core(){return this._core||null}get smtpSettings(){return this._smtpSettings||null}get directorySync(){return this._directorySync||null}get sso(){return this._sso||null}}const xm=km;function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Cm.apply(null,arguments)}const Sm=s.createContext({healthcheckData:null,endpointEnabled:!0,setProcessing:()=>{},isProcessing:()=>{},loadHealthcheckData:()=>{},clearContext:()=>{},isHealthcheckEndpointEnabled:()=>{}});class _m extends s.Component{constructor(e){super(e),this.state=this.defaultState;const t=e.context.getApiClientOptions();this.healthcheckService=new tm(t)}get defaultState(){return{healthcheckData:null,endpointEnabled:!0,processing:!1,isProcessing:this.isProcessing.bind(this),loadHealthcheckData:this.fetchHealthcheckData.bind(this),clearContext:this.clearContext.bind(this),isHealthcheckEndpointEnabled:this.isHealthcheckEndpointEnabled.bind(this)}}isHealthcheckEndpointEnabled(){return this.state.endpointEnabled}async fetchHealthcheckData(){if(this.isHealthcheckEndpointEnabled()){this.setProcessing(!0);try{const e=await this.healthcheckService.fetchHealthcheck();if(e){const t=new xm(e);this.setState({healthcheckData:t})}else this.props.actionFeedbackContext.displayError("No data received from the server")}catch(e){console.error(e),this.setState({endpointEnabled:!1}),this.props.actionFeedbackContext.displayError(e.message)}finally{this.setProcessing(!1)}}}clearContext(){this.setState(this.defaultState)}isProcessing(){return this.state.processing}setProcessing(e){this.setState({processing:e})}render(){return s.createElement(Sm.Provider,{value:this.state},this.props.children)}}_m.propTypes={context:r().any,actionFeedbackContext:r().any,children:r().any};const Nm=I(d(_m));function Im(e){return class extends s.Component{render(){return s.createElement(Sm.Consumer,null,(t=>s.createElement(e,Cm({adminHealthcheckContext:t},this.props))))}}}var Pm,Am,Tm;function Rm(){return Rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Rm.apply(null,arguments)}const Dm=function(e){return s.createElement("svg",Rm({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Pm||(Pm=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 9A6.75 6.75 0 0 1 9 2.25a7.31 7.31 0 0 1 5.055 2.055L15.75 6"})),Am||(Am=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15.75 2.25V6H12M15.75 9A6.75 6.75 0 0 1 9 15.75a7.3 7.3 0 0 1-5.055-2.055L2.25 12"})),Tm||(Tm=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 12H2.25v3.75"})))};class Om extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleRefresh=this.handleRefresh.bind(this)}isRefreshEnabled(){return this.props.adminHealthcheckContext.isHealthcheckEndpointEnabled()&&!this.props.adminHealthcheckContext.isProcessing()}async handleRefresh(){await this.props.adminHealthcheckContext.loadHealthcheckData(),this.handleRefreshSuccess()}async handleRefreshSuccess(){await this.props.actionFeedbackContext.displaySuccess(this.props.t("The healthcheck has been successfully refreshed"))}render(){return s.createElement("div",{className:"col2_3 actions-wrapper"},s.createElement("div",{className:"actions"},s.createElement("div",null,s.createElement("ul",null,s.createElement("li",null,s.createElement("button",{type:"button",disabled:!this.isRefreshEnabled(),id:"save-settings",onClick:this.handleRefresh},s.createElement(Dm,null),s.createElement("span",null,s.createElement(v.x6,null,"Refresh"))))))))}}Om.propTypes={adminHealthcheckContext:r().object,actionFeedbackContext:r().object,t:r().func};const Um=Im(d((0,v.CI)("common")(Om)));var Mm;function Fm(){return Fm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Fm.apply(null,arguments)}const jm=function(e){return s.createElement("svg",Fm({xmlns:"http://www.w3.org/2000/svg",width:14,height:11,fill:"none",viewBox:"0 0 14 11"},e),Mm||(Mm=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 1.5 4.75 9.75 1 6"})))};var zm;function Lm(){return Lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Lm.apply(null,arguments)}const qm=function(e){return s.createElement("svg",Lm({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),zm||(zm=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m13.5 4.5-9 9M4.5 4.5l9 9"})))};var Km;function Wm(){return Wm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Wm.apply(null,arguments)}const Vm=function(e){return s.createElement("svg",Wm({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Km||(Km=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#healthcheck_info_svg__clip0_2267_647012)"},s.createElement("path",{d:"M9 16.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15"}),s.createElement("path",{d:"M6.818 6.75a2.25 2.25 0 0 1 4.372.75c0 1.5-2.25 2.25-2.25 2.25M9 12.75h.008"}))))};var Bm;function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Gm.apply(null,arguments)}const $m=function(e){return s.createElement("svg",Gm({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Bm||(Bm=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m16.298 13.5-6-10.5a1.5 1.5 0 0 0-2.61 0l-6 10.5A1.5 1.5 0 0 0 3 15.75h12a1.5 1.5 0 0 0 1.297-2.25M9 6.75v3M9 12.75h.008"})))};class Hm extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{data:null}}async componentDidMount(){this.props.administrationWorkspaceContext.setDisplayAdministrationWorkspaceAction(Um),await this.props.adminHealthcheckContext.loadHealthcheckData()}componentWillUnmount(){this.props.administrationWorkspaceContext.resetDisplayAdministrationWorkspaceAction(),this.props.adminHealthcheckContext.clearContext()}get healthCheckData(){return this.props.adminHealthcheckContext.healthcheckData}canIUse(e){return Boolean(this.props.context.siteSettings?.canIUse(e))}get shouldDisplayUserDirectory(){return this.canIUse("directorySync")&&Boolean(this.healthCheckData.directorySync)}get shouldDisplaySSO(){return this.canIUse("sso")&&Boolean(this.healthCheckData.sso)}render(){const e=this.healthCheckData,t=()=>!0===e.database.connect&&!0===e.database.defaultContent?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Some default content is present")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"No default content found"),s.createElement(bt,{message:this.props.t("Run the install script to set the dafault content such as roles and permission types")},s.createElement(vt,{className:"baseline svg-icon"}))),a=()=>!0===e.core.cache?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Cache is working")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Cache is not working"),s.createElement(bt,{message:this.props.t("Check the settings in config/app.php")},s.createElement(vt,{className:"baseline svg-icon"}))),n=()=>!0===e.core.salt?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Unique value set for security.salt")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Default value found for security.salt"),s.createElement(bt,{message:this.props.t("Edit the security.salt in config/app.php")},s.createElement(vt,{className:"baseline svg-icon"}))),i=()=>!0===e.configFile.app?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The application config file is present")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"The application config file is missing"),s.createElement(bt,{message:this.props.t("Copy config/app.default.php to config/app.php")},s.createElement(vt,{className:"baseline svg-icon"}))),r=()=>!0===e.configFile.passbolt?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The passbolt config file is present")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"The passbolt config file is missing"),s.createElement(bt,{message:this.props.t("Copy config/passbolt.default.php to config/passbolt.php")},s.createElement(vt,{className:"baseline svg-icon"}))),o=()=>!0===e.environment.pcre?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"PCRE compiled with unicode support")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"PCRE has not been compiled with Unicode support"),s.createElement(bt,{message:this.props.t("Recompile PCRE with Unicode support by adding --enable-unicode-properties when configuring.")},s.createElement(vt,{className:"baseline svg-icon"}))),l=()=>!0===e.environment.tmpWritable?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The temporary directory and its content are writable and not executable")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The temporary directory and its content are not writable, or are executable"),s.createElement(bt,{message:this.props.t("Ensure the temporary directory and its content are writable by the webserver user.")},s.createElement(vt,{className:"baseline svg-icon"}))),c=()=>!0===e.environment.logWritable?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The logs directory and its content are writable")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The logs directory and its content are not writable"),s.createElement(bt,{message:this.props.t("Ensure the temporary directory and its content are writable by the webserver user.")},s.createElement(vt,{className:"baseline svg-icon"}))),m=()=>{const t=e.gpg.info.gpgHome.toString();return!0===e.gpg.gpgHome&&e.gpg.info.gpgHome?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The environment variable GNUPGHOME is set to ",t)):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The environment variable GNUPGHOME is set to ",t," but the directory does not exist"),s.createElement(bt,{message:this.props.t("Ensure the keyring location exists and is accessible by the webserver user.")},s.createElement(vt,{className:"baseline svg-icon"})))},d=()=>{const t=e.gpg.info.gpgHome.toString();return!0===e.gpg.gpgHomeWritable&&e.gpg.info.gpgHome?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The directory ",t," containing the keyring is writable by the webserver user")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The directory ",t," containing the keyring is not writable by the webserver user"),s.createElement(bt,{message:this.props.t("Ensure the keyring location exists and is accessible by the webserver user.")},s.createElement(vt,{className:"baseline svg-icon"})))},p=()=>{const t=e.application.configPath.toString();return!0===e.gpg.gpgKeyPrivateFingerprint&&!0===e.gpg.gpgKeyPublicFingerprint?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The server key fingerprint matches the one defined in ",t)):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The server key fingerprint doesn't matches the one defined in ",t),s.createElement(bt,{message:this.props.t("Double check the key fingerprint")},s.createElement(vt,{className:"baseline svg-icon"})))},u=()=>{const t=e.application.configPath.toString();return!0===e.gpg.gpgKeyPublicInKeyring?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The server public key defined in the ",t," (or environment variables) is in the keyring")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The server public key defined in the ",t," (or environment variables) is not in the keyring"),s.createElement(bt,{message:this.props.t("Import the private server key in the keyring of the webserver user.")},s.createElement(vt,{className:"baseline svg-icon"})))},h=()=>!0===e.gpg.gpgKeyPublicEmail?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"There is a valid email id defined for the server key")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The server key does not have a valid email id"),s.createElement(bt,{message:this.props.t("Edit or generate another key with a valid email id.")},s.createElement(vt,{className:"baseline svg-icon"}))),g=()=>!0===e.application.registrationClosed.isSelfRegistrationPluginEnabled?s.createElement("span",{className:"healthcheck-info"},s.createElement(Vm,null),s.createElement(v.x6,null,"The Self Registration plugin is enabled")):s.createElement("span",{className:"healthcheck-info"},s.createElement(Vm,null),s.createElement(v.x6,null,"The Self Registration plugin is disabled"),s.createElement(bt,{message:this.props.t("Enable the plugin in order to define self registration settings.")},s.createElement(vt,{className:"baseline svg-icon"}))),b=()=>{const t=e.application.configPath.toString();return!0===e.application.registrationClosed.isRegistrationPublicRemovedFromPassbolt?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The deprecated self registration public settings was not found in ",t)):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"The deprecated self registration public settings was found in ",t),s.createElement(bt,{message:this.props.t("You may remove the passbolt.registration.public setting")},s.createElement(vt,{className:"baseline svg-icon"})))},y=()=>!0===e.application.hostAvailabilityCheckEnabled?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Host availability will be checked")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"Host availability checking is disabled"),s.createElement(bt,{message:this.props.t("Make sure the instance is not publicly available on the internet.")},s.createElement(vt,{className:"baseline svg-icon"}))),f=()=>{if(e.smtpSettings.source){const t=e.smtpSettings.source.toString();return!0===e.smtpSettings.isInDb?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The SMTP Settings source is: ",{smtpSettingsSource:t})):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The SMTP Settings source is: ",{smtpSettingsSource:t}),s.createElement(bt,{message:this.props.t("It is recommended to set the SMTP Settings in the database through the administration section.")},s.createElement(vt,{className:"baseline svg-icon"})))}},E=()=>!0===e.smtpSettings.areEndpointsDisabled?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The SMTP Settings plugin endpoints are disabled")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"The SMTP Settings plugin endpoints are enabled"),s.createElement(bt,{message:this.props.t("It is recommended to disable the plugin endpoints.")},s.createElement(vt,{className:"baseline svg-icon"}))),w=()=>!0===e.directorySync.endpointsDisabled?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The endpoints for updating the users directory configurations are disabled.")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"The endpoints for updating the users directory configurations are enabled."),s.createElement(bt,{message:this.props.t("It is recommended to disable endpoints for updating the users directory configurations.")},s.createElement(vt,{className:"baseline svg-icon"}))),k=()=>!0===e.sso.sslHostVerification?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"SSL certification validation for SSO instance is enabled.")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"SSL certification validation for SSO instance is disabled."),s.createElement(bt,{message:this.props.t("Disabling the ssl verify check can lead to security attacks.")},s.createElement(vt,{className:"baseline svg-icon"}))),x=this.props.adminHealthcheckContext.isHealthcheckEndpointEnabled();return s.createElement("div",{className:"row"},s.createElement("div",{className:"healthcheck-settings main-column"},s.createElement("div",{className:"main-content"},s.createElement("h3",null,s.createElement(v.x6,null,"Passbolt API Status")),x?(()=>!e||this.props.adminHealthcheckContext.isProcessing()?s.createElement(La,null):s.createElement(s.Fragment,null,s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Environment")),s.createElement("div",{className:"healthcheck-environment-section"},s.createElement("div",null,(()=>{if(e.environment.info.phpVersion&&!0===e.environment.phpVersion){const t=e.environment.info.phpVersion.toString();return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"PHP version ",{phpVersion:t}))}return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"PHP version is too low, passbolt need PHP 7.4 or higher"))})()),s.createElement("div",null,o()),s.createElement("div",null,l()),s.createElement("div",null,c()),s.createElement("div",null,!0===e.environment.image?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"GD or Imagick extension is installed")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"You must enable the gd or imagick extensions to use Passbolt"),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"See ",s.createElement("a",{href:"https://secure.php.net/manual/en/book.image.php",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"})))),s.createElement("div",null,!0===e.environment.intl?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Intl extension is installed")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"You must enable the intl extension to use Passbolt"),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"See ",s.createElement("a",{href:"https://secure.php.net/manual/en/book.intl.php",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"})))),s.createElement("div",null,!0===e.environment.mbstring?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Mbstring extension is installed")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"You must enable the mbstring extension to use Passbolt"),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"See ",s.createElement("a",{href:"https://secure.php.net/manual/en/book.mbstring.php",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"}))))),s.createElement("h4",null,s.createElement(v.x6,null,"Config files")),s.createElement("div",{className:"healthcheck-configFiles-section"},s.createElement("div",null,i()),s.createElement("div",null,r())),s.createElement("h4",null,s.createElement(v.x6,null,"Core config")),s.createElement("div",{className:"healthcheck-core-section"},s.createElement("div",null,(()=>{if(!1===e.core.debugDisabled){const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Debug mode is on"),s.createElement(bt,{message:s.createElement(v.x6,null,"Set debug = false; in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,a()),s.createElement("div",null,n()),s.createElement("div",null,(()=>{if(!0===e.core.fullBaseUrl){const t=e.core.info.fullBaseUrl.toString();return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Full base url is set to ",t))}{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Full base url is not set"),s.createElement(bt,{message:s.createElement(v.x6,null,"Edit App.fullBaseUrl in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,(()=>{if(!0===e.core.validFullBaseUrl)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"App.fullBaseUrl validation OK"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"App.fullBaseUrl does not validate"),s.createElement(bt,{message:s.createElement(v.x6,null,"Edit App.fullBaseUrl in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,(()=>{if(!0===e.core.fullBaseUrlReachable)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"/healthcheck/status is reachable"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Could not reach the /healthcheck/status with the url specified in App.fullBaseUrl"),s.createElement(bt,{message:s.createElement(v.x6,null,"Check that the domain name is correct in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})())),s.createElement("h4",null,s.createElement(v.x6,null,"SSL Certificate")),s.createElement("div",{className:"healthcheck-ssl-section"},s.createElement("div",null,!0===e.ssl.peerValid?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"SSL peer certificate validates")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"SSL peer certificate does not validate"),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"Check ",s.createElement("a",{href:"https://help.passbolt.com/faq/hosting/troubleshoot-ssl",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"})))),s.createElement("div",null,!0===e.ssl.hostValid?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Hostname is matching SSL certificate")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Hostname does not match when validating certificates"),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"Check ",s.createElement("a",{href:"https://help.passbolt.com/faq/hosting/troubleshoot-ssl",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"})))),s.createElement("div",null,!0===e.ssl.notSelfSigned?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Not using a self-signed certificate")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"Using a self-signed certificate")))),s.createElement("h4",null,s.createElement(v.x6,null,"Database")),s.createElement("div",{className:"healthcheck-database-section"},s.createElement("div",null,(()=>{if(!0===e.database.connect)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The application is able to connect to the database"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The application is not able to connect to the database"),s.createElement(bt,{message:s.createElement(v.x6,null,"Double check the host, database name, username and password in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,(()=>{if(!0===e.database.connect&&e.database.tablesCount){const t=e.database.info.tablesCount.toString();return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,{count:t},{count:t}," tables found"))}})()),s.createElement("div",null,t())),s.createElement("h4",null,s.createElement(v.x6,null,"GPG Configuration")),s.createElement("div",{className:"healthcheck-gpg-section"},s.createElement("div",null,!0===e.gpg.lib?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"PHP GPG Module is installed and loaded")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"PHP GPG Module is not installed or loaded"),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"Install php-gnupg, see ",s.createElement("a",{href:"http://php.net/manual/en/gnupg.installation.php",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"})))),s.createElement("div",null,m()),s.createElement("div",null,d()),s.createElement("div",null,(()=>{const t=e.application.configPath.toString();return!0===e.gpg.gpgKeyPublic&&!0===e.gpg.gpgKeyPublicReadable&&e.gpg.gpgKeyPublicBlock?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The public key file is defined in ",t," and readable.")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The public key file is not defined in ",t," or not readable."),s.createElement(bt,{message:s.createElement(v.x6,null,"Ensure the public key file is defined by the variable passbolt.gpg.serverKey.public in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))})()),s.createElement("div",null,(()=>{const t=e.application.configPath.toString();return!0===e.gpg.gpgKeyPrivate&&!0===e.gpg.gpgKeyPrivateReadable&&e.gpg.gpgKeyPrivateBlock?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The private key file is defined in ",t," and readable.")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The private key file is not defined in ",t," or not readable."),s.createElement(bt,{message:s.createElement(v.x6,null,"Ensure the private key file is defined by the variable passbolt.gpg.serverKey.private in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))})()),s.createElement("div",null,p()),s.createElement("div",null,u()),s.createElement("div",null,h()),s.createElement("div",null,!0===e.gpg.canEncrypt?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The public key can be used to encrypt a message")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The public key cannot be used to encrypt a message"))),s.createElement("div",null,!0===e.gpg.canSign?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The public key can be used to sign a message")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The public key cannot be used to sign a message"))),s.createElement("div",null,!0===e.gpg.canEncryptSign?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The public and private keys can be used to encrypt and sign a message")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The public and private keys cannot be used to encrypt and sign a message"))),s.createElement("div",null,!0===e.gpg.canDecryptVerify?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The private key can be used to decrypt and verify a message")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The private key cannot be used to decrypt and verify a message"))),s.createElement("div",null,!0===e.gpg.canVerify?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The public key can be used to verify a signature")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The public key cannot be used to verify a signature"))),s.createElement("div",null,!0===e.gpg.isPublicServerKeyGopengpgCompatible?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The server public key format is Gopengpg compatible")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The server public key format is not Gopengpg compatible"))),s.createElement("div",null,!0===e.gpg.isPrivateServerKeyGopengpgCompatible?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The server private key format is Gopengpg compatible")):s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The server private key format is not Gopengpg compatible")))),s.createElement("h4",null,s.createElement(v.x6,null,"Application configuration")),s.createElement("div",{className:"healthcheck-app-section"},s.createElement("div",null,(()=>{if(!0===e.application.latestVersion&&e.application.info.remoteVersion){const t=e.application.info.remoteVersion.toString();return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Using latest passbolt version (",{version:t},")"))}if(!1===e.application.latestVersion&&e.application.info.remoteVersion){const t=e.application.info.currentVersion.toString(),a=e.application.info.remoteVersion.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"The installation is not up to date. Currently using ",{currentVersion:t}," and it should be ",{latestAvailableVersion:a}),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"See ",s.createElement("a",{href:"https://help.passbolt.com/hosting/update",target:"_blank",rel:"noopener noreferrer"},"this guide")))},s.createElement(vt,{className:"baseline svg-icon"})))}if(null===e.application.latestVersion&&"undefined"===e.application.info.remoteVersion)return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"It seems that the server is not able to reach internet."),s.createElement(bt,{message:s.createElement("span",null,s.createElement(v.x6,null,"To confirm that you are running the latest version, check ",s.createElement("a",{href:"https://help.passbolt.com/releases/",target:"_blank",rel:"noopener noreferrer"},"all the releases notes")))},s.createElement(vt,{className:"baseline svg-icon"})))})()),s.createElement("div",null,(()=>{if(!0===e.application.sslForce)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Passbolt is configured to force SSL use"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Passbolt is not configured to force SSL use"),s.createElement(bt,{message:s.createElement(v.x6,null,"Set passbolt.ssl.force to true in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,(()=>{if(!0===e.application.sslFullBaseUrl)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"App.fullBaseUrl is set to HTTPS"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"App.fullBaseUrl is not set to HTTPS"),s.createElement(bt,{message:s.createElement(v.x6,null,"Check App.fullBaseUrl url scheme in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,(()=>{if(!0===e.application.seleniumDisabled)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Selenium API endpoints are disabled"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Selenium API endpoints are active. This setting should be used for testing only"),s.createElement(bt,{message:s.createElement(v.x6,null,"Set passbolt.selenium.active to false in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,(()=>{if(!0===e.application.robotsIndexDisabled)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Search engine robots are told not to index content"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"Search engine robots are not told not to index content"),s.createElement(bt,{message:s.createElement(v.x6,null,"Set passbolt.meta.robots to false in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,g()),s.createElement("div",null,(()=>{if(null===e.application.registrationClosed.selfRegistrationProvider)return s.createElement("span",{className:"healthcheck-info"},s.createElement(Vm,null),s.createElement(v.x6,null,"Registration is closed, only administrators can add users"));{const t=e.application.registrationClosed.selfRegistrationProvider.toString();return s.createElement("span",{className:"healthcheck-info"},s.createElement(Vm,null),s.createElement(v.x6,null,"The Self Registration provider is: ",{selfRegistrationProvider:t}))}})()),s.createElement("div",null,b()),s.createElement("div",null,y()),s.createElement("div",null,(()=>{if(!0===e.application.jsProd)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"Serving the compiled version of the javascript app"));{const t=e.application.configPath.toString();return s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"Using non-compiled Javascript. Passbolt will be slower"),s.createElement(bt,{message:s.createElement(v.x6,null,"Set passbolt.js.build in ",t)},s.createElement(vt,{className:"baseline svg-icon"})))}})()),s.createElement("div",null,!0===e.application.emailNotificationEnabled?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"All email notifications will be sent")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"Some email notifications are disabled by the administrators")))),s.createElement("h4",null,s.createElement(v.x6,null,"SMTP Settings")),s.createElement("div",{className:"healthcheck-smtp-section"},s.createElement("div",null,!0===e.smtpSettings.isEnabled?s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"The SMTP Settings plugin is enabled")):s.createElement("span",{className:"healthcheck-warning"},s.createElement($m,null),s.createElement(v.x6,null,"The SMTP Settings plugin is disabled"))),s.createElement("div",null,(()=>{if(!1===e.smtpSettings.errorMessage)return s.createElement("span",{className:"healthcheck-success"},s.createElement(jm,null),s.createElement(v.x6,null,"SMTP Settings coherent. You may send a test email to validate them"));{const t=e.smtpSettings.errorMessage.toString();return s.createElement("span",{className:"healthcheck-fail"},s.createElement(qm,null),s.createElement(v.x6,null,"SMTP Settings errors: ",{errorMessage:t}))}})()),s.createElement("div",null,f()),s.createElement("div",null,E())),this.shouldDisplayUserDirectory&&s.createElement(s.Fragment,null,s.createElement("h4",null,s.createElement(v.x6,null,"Directory Sync")),s.createElement("div",{className:"healthcheck-directorySync-section"},s.createElement("div",null,w()))),this.shouldDisplaySSO&&s.createElement(s.Fragment,null,s.createElement("h4",null,s.createElement(v.x6,null,"SSO")),s.createElement("div",{className:"healthcheck-sso-section"},s.createElement("div",null,k())))))():s.createElement("div",null,s.createElement(v.x6,null,"The health check API endpoint has been disabled in the server configuration."))),Ea(s.createElement(s.Fragment,null,s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"What is this page?")),s.createElement("p",null,s.createElement(v.x6,null,"This page is available to help administrators diagnose if something is wrong with a passbolt installation and help keeping it secure.")),s.createElement("p",null,s.createElement(v.x6,null,"The color is really important here so it's easier for you to spot what's not running as expected")),s.createElement("div",{className:"healthcheck-color-legends"},s.createElement("div",{className:"healthcheck-success"},s.createElement(jm,null)," ",s.createElement(v.x6,null,"Everything is running as expected.")),s.createElement("div",{className:"healthcheck-warning"},s.createElement($m,null)," ",s.createElement(v.x6,null,"Something inside your configuration is not what we recommend, but you can skip it if it has been done on purpose.")),s.createElement("div",{className:"healthcheck-fail"},s.createElement(qm,null)," ",s.createElement(v.x6,null,"There is an error with the current configuration, you might want to resolve it.")),s.createElement("div",{className:"healthcheck-info"},s.createElement(Vm,null)," ",s.createElement(v.x6,null,"This is just an information shared, no action is required.")))),s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Something wrong?")),s.createElement("p",null,s.createElement(v.x6,null,"Hang in there! Depending your installation, you might need to check the documentation in order to run the healthcheck from the CLI")),s.createElement("a",{className:"button",href:"https://www.passbolt.com/docs/admin/server-maintenance/passbolt-api-status/",target:"_blank",rel:"noopener noreferrer"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation"))))),document.getElementById("administration-help-panel"))))}}Hm.propTypes={context:r().object,adminHealthcheckContext:r().any,children:r().any,administrationWorkspaceContext:r().object,t:r().func};const Ym=I(Ee(Im((0,v.CI)("common")(Hm))));var Jm=a(1811);const Zm="v4",Qm="v5";class Xm extends re{static getSchema(){return{type:"object",required:["default_resource_types","default_folder_type","default_tag_type","default_comment_type","allow_creation_of_v5_resources","allow_creation_of_v5_folders","allow_creation_of_v5_tags","allow_creation_of_v5_comments","allow_creation_of_v4_resources","allow_creation_of_v4_folders","allow_creation_of_v4_tags","allow_creation_of_v4_comments","allow_v4_v5_upgrade","allow_v5_v4_downgrade"],properties:{default_resource_types:{type:"string",enum:[Zm,Qm]},default_folder_type:{type:"string",enum:[Zm,Qm]},default_tag_type:{type:"string",enum:[Zm,Qm]},default_comment_type:{type:"string",enum:[Zm,Qm]},allow_creation_of_v5_resources:{type:"boolean"},allow_creation_of_v5_folders:{type:"boolean"},allow_creation_of_v5_tags:{type:"boolean"},allow_creation_of_v5_comments:{type:"boolean"},allow_creation_of_v4_resources:{type:"boolean"},allow_creation_of_v4_folders:{type:"boolean"},allow_creation_of_v4_tags:{type:"boolean"},allow_creation_of_v4_comments:{type:"boolean"},allow_v4_v5_upgrade:{type:"boolean"},allow_v5_v4_downgrade:{type:"boolean"}}}}static createFromV4Default(){return new Xm({default_resource_types:Zm,default_folder_type:Zm,default_tag_type:Zm,default_comment_type:Zm,allow_creation_of_v5_resources:!1,allow_creation_of_v5_folders:!1,allow_creation_of_v5_tags:!1,allow_creation_of_v5_comments:!1,allow_creation_of_v4_resources:!0,allow_creation_of_v4_folders:!0,allow_creation_of_v4_tags:!0,allow_creation_of_v4_comments:!0,allow_v4_v5_upgrade:!1,allow_v5_v4_downgrade:!1})}static createFromDefault(e={}){return new Xm({default_resource_types:Zm,default_folder_type:Zm,default_tag_type:Zm,default_comment_type:Zm,allow_creation_of_v5_resources:!1,allow_creation_of_v5_folders:!1,allow_creation_of_v5_tags:!1,allow_creation_of_v5_comments:!1,allow_creation_of_v4_resources:!0,allow_creation_of_v4_folders:!0,allow_creation_of_v4_tags:!0,allow_creation_of_v4_comments:!0,allow_v4_v5_upgrade:!1,allow_v5_v4_downgrade:!1,...e})}validateBuildRules(){let e;if(this.isDefaultResourceTypeV4&&!this.allowCreationOfV4Resources){e=e||new $;const t="Allow creation of v4 resources should be true when default resources is v4";e.addError("allow_creation_of_v4_resources","is_default",t),e.addError("default_resource_types","allow_create_v4",t)}else if(this.isDefaultResourceTypeV5&&!this.allowCreationOfV5Resources){e=e||new $;const t="Allow creation of v5 resources should be true when default resources is v5";e.addError("allow_creation_of_v5_resources","is_default",t),e.addError("default_resource_types","allow_create_v5",t)}if(e)throw e}get defaultResourceTypes(){return this._props.default_resource_types}get allowCreationOfV5Resources(){return this._props.allow_creation_of_v5_resources}get allowCreationOfV4Resources(){return this._props.allow_creation_of_v4_resources}get allowCreationOfV5Folders(){return this._props.allow_creation_of_v5_folders}get allowCreationOfV4Folders(){return this._props.allow_creation_of_v4_folders}get allowCreationOfV5Tags(){return this._props.allow_creation_of_v5_tags}get allowCreationOfV4Tags(){return this._props.allow_creation_of_v4_tags}get allowCreationOfV5Comments(){return this._props.allow_creation_of_v5_comments}get allowCreationOfV4Comments(){return this._props.allow_creation_of_v4_comments}get isDefaultResourceTypeV5(){return this._props.default_resource_types===Qm}get isDefaultResourceTypeV4(){return this._props.default_resource_types===Zm}get allowV5V4Downgrade(){return this._props.allow_v5_v4_downgrade}get allowV4V5Upgrade(){return this._props.allow_v4_v5_upgrade}}const ed=Xm,td=class extends Ll{static _cachedSchema={};get entityClass(){throw new Error("The collection class should declare the entity class that is handled.")}constructor(e=[],t={}){super(e,t),(t?.validate??!0)&&this.validateSchema(),this.pushMany(this._props,{...t,clone:!1}),this._props=null}validateSchema(){this._props=X.validate(this.constructor.name,this._props,this.cachedSchema)}get cachedSchema(){return this.constructor._cachedSchema[this.constructor.name]||(this.constructor._cachedSchema[this.constructor.name]=this.constructor.getSchema()),this.constructor._cachedSchema[this.constructor.name]}static getSchema(){throw new Error("The collection class should declare its schema.")}buildOrCloneEntity(e,t={}){if(!e||"object"!=typeof e)throw new TypeError(`${this.entityClass.name}::buildOrCloneEntity expects "data" to be an object.`);return e instanceof this.entityClass&&(e=e.toDto(this.entityClass?.ALL_CONTAIN_OPTIONS)),new this.entityClass(e,t)}validateBuildRules(e,t={}){}push(e,t={},a={}){const s=this.buildOrCloneEntity(e,t);this.validateBuildRules(s,a?.validateBuildRules),this._items.push(s),a?.onItemPushed?.(s)}pushOrReplace(e,t={},a={}){const s=a?.replacePropertyName||"id",n=this.items.findIndex((t=>t[s]===e[s]));if(-1!==n){this.items.splice(n,1);const s=this.buildOrCloneEntity(e,t);this.validateBuildRules(s,a?.validateBuildRules),this.items.splice(n,0,s)}else this.push(e,t,a)}pushMany(e,t={},a={}){if(!Array.isArray(e))throw new TypeError(`${this.constructor.name} pushMany expects "data" to be an array.`);e.forEach(((e,s)=>{try{this.push(e,t,a)}catch(e){this.handlePushItemError(s,e,t)}}))}handlePushItemError(e,t,a){if(!(t instanceof $||t instanceof Z||t instanceof jl))throw t;if(!a?.ignoreInvalidEntity){const a=new Z;throw a.addItemValidationError(e,t),a}console.debug(`${this.entityClass.name}::pushMany ignore item (${e}) due to validation error ${JSON.stringify(t?.details)}`)}},ad="password-string",sd="password-and-description",nd="password-description-totp",id="totp",rd="v5-default",od="v5-password-string",ld="v5-default-with-totp",cd="v5-totp-standalone",md={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},description:{maxLength:1e4,nullable:!0,type:"string"},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"string",maxLength:4096}},dd={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"object",required:["password"],properties:{password:{type:"string",maxLength:4096},description:{type:"string",maxLength:1e4,nullable:!0}}}},pd={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"object",required:["totp"],properties:{totp:{type:"object",required:["secret_key","digits","algorithm"],properties:{algorithm:{type:"string",minLength:4,maxLength:6},secret_key:{type:"string",maxLength:1024},digits:{type:"number",minimum:6,maximum:8},period:{type:"number"}}}}}},ud={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uri:{type:"string",maxLength:1024,nullable:!0}}},secret:{type:"object",required:["password","totp"],properties:{password:{type:"string",maxLength:4096},description:{type:"string",maxLength:1e4,nullable:!0},totp:pd.secret.properties.totp}}},hd={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"object",required:["password"],properties:{object_type:{type:"string",enum:["PASSBOLT_SECRET_DATA"]},password:{type:"string",maxLength:4096,nullable:!0},description:{type:"string",maxLength:1e4,nullable:!0}}}},gd={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"string",maxLength:4096}},bd={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},username:{type:"string",maxLength:255,nullable:!0},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"object",required:["password","totp"],properties:{object_type:{type:"string",enum:["PASSBOLT_SECRET_DATA"]},password:{type:"string",maxLength:4096,nullable:!0},description:{type:"string",maxLength:1e4,nullable:!0},totp:pd.secret.properties.totp}}},yd={resource:{type:"object",required:["name"],properties:{name:{type:"string",maxLength:255},uris:{type:"array",items:{type:"string",maxLength:1024,nullable:!0}},description:{type:"string",maxLength:1e4,nullable:!0}}},secret:{type:"object",required:["totp"],properties:{object_type:{type:"string",enum:["PASSBOLT_SECRET_DATA"]},totp:{type:"object",required:["secret_key","digits","algorithm"],properties:{algorithm:{type:"string",minLength:4,maxLength:6},secret_key:{type:"string",maxLength:1024},digits:{type:"number",minimum:6,maximum:8},period:{type:"number"}}}}}},fd={[ad]:od,[sd]:rd,[nd]:ld,[id]:cd},vd=new class{get SCHEMAS(){return{[ad]:md,[sd]:dd,[nd]:ud,[id]:pd,[rd]:hd,[od]:gd,[ld]:bd,[cd]:yd}}},Ed=[ad,sd,nd,rd,ld,od],wd=[nd,id,ld,cd],kd=[id,cd],xd=[ad,od],Cd=[sd,nd,rd,ld],Sd=[ad,rd,ld,od,cd];class _d extends re{marshall(){if("string"!=typeof this._props.slug||!(this._props.slug in vd.SCHEMAS))return void delete this._props.definition;const e=vd.SCHEMAS[this._props.slug],t=Object.assign({},e);this._props.definition=t}static getSchema(){return{type:"object",required:["id","name","slug","definition"],properties:{id:{type:"string",format:"uuid"},name:{type:"string",minLength:1,maxLength:255},slug:{type:"string",minLength:1,maxLength:64},definition:{type:"object"},description:{type:"string",maxLength:255,nullable:!0},resources_count:{type:"integer"},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"},deleted:{type:"string",format:"date-time",nullable:!0}}}}get id(){return this._props.id}get slug(){return this._props.slug}get definition(){return this._props.definition}get resourcesCount(){return this._props.resources_count||null}set deleted(e){const t=_d.getSchema().properties.deleted;t?.nullable&&null===e||X.validateProp("deleted",e,t),this._props.deleted=e}hasTotp(){return wd.includes(this.slug)}hasPassword(){return Ed.includes(this.slug)}isStandaloneTotp(){return kd.includes(this.slug)}isPasswordString(){return xd.includes(this.slug)}hasSecretDescription(){return Cd.includes(this.slug)}hasMetadataDescription(){return Sd.includes(this.slug)}get version(){return this.slug.startsWith("v5")?Qm:Zm}isV5(){return this.version===Qm}isV4(){return this.version===Zm}isDeleted(){return void 0!==this._props.deleted&&null!==this._props.deleted}}const Nd=_d,Id=[ad,sd,nd,id,rd,ld,od,cd],Pd=class extends td{get entityClass(){return Nd}constructor(e=[],t={}){super(e,t)}static getSchema(){return{type:"array",items:Nd.getSchema()}}validateBuildRules(e,t={}){this.assertNotExist("id",e._props.id,{haystackSet:t?.uniqueIdsSetCache}),this.assertNotExist("slug",e._props.slug,{haystackSet:t?.uniqueSlugsSetCache})}isResourceTypeIdPresent(e){return this._items.some((t=>t.id===e))}filterByPasswordResourceTypes(){this.filterByPropertyValueIn("slug",Ed)}filterByResourceTypeVersion(e){this.filterByCallback((t=>t.version===e))}getFirstById(e){return this.getFirst("id",e)}getFirstBySlug(e){return this.getFirst("slug",e)}hasOneWithSlug(e){return Boolean(this.getFirstBySlug(e))}hasSomePasswordResourceTypes(e=Zm){return this.items.some((t=>t.hasPassword()&&t.version===e))}hasSomeTotpResourceTypes(e=Zm){return this.items.some((t=>t.hasTotp()&&t.version===e))}hasSomeNoteResourceTypes(e=Zm){return this.items.some((t=>t.hasSecretDescription()&&t.version===e))}hasSomeMetadataDescriptionResourceTypes(e=Zm){return this.items.some((t=>t.hasMetadataDescription()&&t.version===e))}hasSomeOfVersion(e=Zm){return this.items.some((t=>t.version===e))}getResourceTypeMatchingResource(e,t=Zm){if((0,ae.A)(t),null==e?.secret||"object"!=typeof e.secret)throw new TypeError("The resource DTO is not an expected object");let a=null,s=null;const n=Object.keys(e.secret);for(const e of this.items){if(e.version!==t||e.isPasswordString())continue;const i=Object.keys(e.definition.secret.properties);if(n.every((e=>i.includes(e)))){const t=i.filter((e=>!n.includes(e))).length;if(0===t)return e;(!s||s>t)&&(s=t,a=e)}}return a}pushMany(e,t={},a={}){const s=new Set(this.extract("id")),n=new Set(this.extract("slug"));a={onItemPushed:e=>{s.add(e.id),n.add(e.slug)},validateBuildRules:{...a?.validateBuildRules,uniqueIdsSetCache:s,uniqueSlugsSetCache:n},...a},super.pushMany(e,t,a)}push(e,t={},a={}){Id.includes(e?.slug)&&super.push(e,t,a)}},Ad=class extends re{static getSchema(){return{type:"object",required:["user_id","armored_key"],properties:{id:{type:"string",format:"uuid"},user_id:{type:"string",format:"uuid"},fingerprint:{type:"string",minLength:40,maxLength:40},armored_key:{type:"string"},deleted:{type:"boolean"},type:{type:"string",nullable:!0},uid:{type:"string"},bits:{type:"integer",nullable:!0},key_id:{type:"string",minLength:8,maxLength:16},key_created:{type:"string",format:"date-time"},expires:{type:"string",format:"date-time",nullable:!0},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"}}}}get id(){return this._props.id||null}get userId(){return this._props.user_id}get armoredKey(){return this._props.armored_key}get fingerprint(){return this._props.fingerprint}get created(){return this._props.created||null}get modified(){return this._props.modified||null}get isDeleted(){return void 0===this._props.deleted?null:this._props.deleted}static get ENTITY_NAME(){return"gpgkey"}};class Td extends re{static getSchema(){return{type:"object",required:[Td.AVATAR_URL_SIZE_MEDIUM,Td.AVATAR_URL_SIZE_SMALL],properties:{medium:{type:"string"},small:{type:"string"}}}}get medium(){return this._props.medium}get small(){return this._props.small}static get ENTITY_NAME(){return"AvatarUrl"}static get AVATAR_URL_SIZE_MEDIUM(){return"medium"}static get AVATAR_URL_SIZE_SMALL(){return"small"}}const Rd=Td,Dd=class extends re{constructor(e={},t={}){super(e,t),this._props.url&&(this._url=new Rd(this._props.url,{...t,clone:!1}),delete this._props.url)}static getSchema(){return{type:"object",required:["url"],properties:{id:{type:"string",format:"uuid"},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"},url:Rd.getSchema()}}}get id(){return this._props.id||null}get urlMedium(){return this._url.medium}get urlSmall(){return this._url.small}get created(){return this._props.created||null}get modified(){return this._props.modified||null}toDto(e){const t=super.toDto(e);return t.url=this._url.toDto(),t}static get ENTITY_NAME(){return"Avatar"}static get AVATAR_URL_SIZE_MEDIUM(){return"medium"}static get AVATAR_URL_SIZE_SMALL(){return"small"}};class Od extends re{constructor(e={},t={}){super(e,t),this._props.avatar&&(this._avatar=new Dd(this._props.avatar,{...t,clone:!1}),delete this._props.avatar)}static getSchema(){return{type:"object",required:["first_name","last_name"],properties:{id:{type:"string",format:"uuid"},user_id:{type:"string",format:"uuid"},first_name:{type:"string",minLength:1,maxLength:255},last_name:{type:"string",minLength:1,maxLength:255},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"},avatar:Dd.getSchema()}}}toDto(e){const t=Object.assign({},this._props);return this.avatar&&e&&e.avatar&&(t.avatar=this.avatar.toDto()),t}toJSON(){return this.toDto(Od.ALL_CONTAIN_OPTIONS)}static get ENTITY_NAME(){return"Profile"}static get ALL_CONTAIN_OPTIONS(){return{avatar:!0}}get id(){return this._props.id||null}get name(){return`${this._props.first_name} ${this._props.last_name}`}get firstName(){return this._props.first_name}get lastName(){return this._props.last_name}get userId(){return this._props.user_id||null}get created(){return this._props.created||null}get modified(){return this._props.modified||null}get avatar(){return this._avatar||null}}const Ud=Od;class Md extends re{constructor(e,t={}){super(e,t),this._props.profile&&(this._profile=new Ud(this._props.profile,{...t,clone:!1}),delete this._props.profile),this._props.role&&(this._role=new le(this._props.role,{...t,clone:!1}),delete this._props.role),this._props.gpgkey&&(this._gpgkey=new Ad(this._props.gpgkey,{...t,clone:!1}),delete this._props.gpgkey)}marshall(){""===this._props.last_logged_in&&(this._props.last_logged_in=null),super.marshall()}static getSchema(){return{type:"object",required:["username"],properties:{id:{type:"string",format:"uuid"},role_id:{type:"string",format:"uuid"},username:{type:"string"},active:{type:"boolean"},deleted:{type:"boolean"},disabled:{type:"string",format:"date-time",nullable:!0},missing_metadata_key_ids:{type:"array",items:{type:"string",format:"uuid"}},created:{type:"string",format:"date-time"},modified:{type:"string",format:"date-time"},role:le.getSchema(),profile:Ud.getSchema(),gpgkey:Ad.getSchema()}}}toDto(e){const t=Object.assign({},this._props);return e?(this.role&&e.role&&(t.role=this.role.toDto()),this.profile&&e.profile&&(!0===e.profile?t.profile=this.profile.toDto():t.profile=this.profile.toDto(e.profile)),this.gpgkey&&e.gpgkey&&(t.gpgkey=this.gpgkey.toDto()),t):t}toJSON(){return this.toDto(Md.ALL_CONTAIN_OPTIONS)}get id(){return this._props.id||null}get roleId(){return this._props.role_id||null}get username(){return this._props.username}get isActive(){return void 0===this._props.active?null:this._props.active}get isDeleted(){return void 0===this._props.deleted?null:this._props.deleted}get missingMetadataKeysIds(){return this._props.missing_metadata_key_ids||[]}get created(){return this._props.created||null}get modified(){return this._props.modified||null}set missingMetadataKeysIds(e){this._props.missing_metadata_key_ids=e}static get ALL_CONTAIN_OPTIONS(){return{profile:Ud.ALL_CONTAIN_OPTIONS,role:!0,gpgkey:!0}}static get ENTITY_NAME(){return"User"}get profile(){return this._profile||null}get role(){return this._role||null}get gpgkey(){return this._gpgkey||null}}const Fd=Md,jd=class extends re{static getSchema(){return{type:"object",required:["object_type","domain","fingerprint","armored_key","passphrase"],properties:{object_type:{type:"string",enum:["PASSBOLT_METADATA_PRIVATE_KEY"]},domain:{type:"string",maxLength:1024},fingerprint:{type:"string",pattern:/^[a-f0-9]{40}$/im},armored_key:{type:"string",maxLength:1e4,pattern:/^-----BEGIN PGP PRIVATE KEY BLOCK-----([\r\n])([ -9;-~]{1,76}: [ -~]{1,76}([\r\n]))*\n([a-zA-Z0-9\/+=]{1,76}([\r\n]))*=[a-zA-Z0-9\/+=]{4}([\r\n])-----END PGP PRIVATE KEY BLOCK-----([\r\n]*)$/},passphrase:{type:"string",maxLength:1024}}}}get armoredKey(){return this._props.armored_key}get fingerprint(){return this._props.fingerprint}};class zd extends re{constructor(e,t={}){super(e,t),this._props.data&&"string"!=typeof this._props.data&&(this._data=new jd(this._props.data,{...t,clone:!1}),delete this._props.data)}static getSchema(){return{type:"object",required:["user_id","data"],properties:{id:{type:"string",format:"uuid",nullable:!0},metadata_key_id:{type:"string",format:"uuid",nullable:!0},user_id:{type:"string",format:"uuid",nullable:!0},data_signed_by_current_user:{type:"string",format:"date-time",nullable:!0},data:{anyOf:[{type:"string",maxLength:1e4,pattern:/^-----BEGIN PGP MESSAGE-----([\r\n])([ -9;-~]{1,76}: [ -~]{1,76}([\r\n]))*\n([a-zA-Z0-9\/+=]{1,76}([\r\n]))*=[a-zA-Z0-9\/+=]{4}([\r\n])-----END PGP MESSAGE-----([\r\n]*)$/},{type:"object"}]},created:{type:"string",format:"date-time"},created_by:{type:"string",format:"uuid",nullable:!0},modified:{type:"string",format:"date-time"},modified_by:{type:"string",format:"uuid",nullable:!0}}}}validateBuildRules(){if(Boolean(this._props.data)&&Boolean(this._data)){const e=new $,t="The property data and _data cannot be set at the same time";throw e.addError("data","only-one-defined",t),e}}toDto(e){const t=Object.assign({},this._props),a=this.data;return t.data=a instanceof jd?a.toDto():a,e?(this._creator&&e.creator&&(t.creator=this._creator.toDto(Fd.ALL_CONTAIN_OPTIONS)),t):t}toDataDto(){return{data:this.toDto().data}}toContentCodeConfirmTrustRequestDto(){const e=this.toDto();return delete e.data,e}toJSON(){return this.toDto(Fd.ALL_CONTAIN_OPTIONS)}cloneForSharing(e){const t={user_id:e,metadata_key_id:this.metadataKeyId,data:this.data};return new zd(t)}marshall(){}get data(){return this.isDecrypted?this._data:this._props.data}get id(){return this._props.id||null}get metadataKeyId(){return this._props.metadata_key_id||null}get isDecrypted(){return Boolean(this._data)}get userId(){return this._props.user_id}get dataSignedByCurrentUser(){return this._props.data_signed_by_current_user||null}get modifiedBy(){return this._props.modified_by}get modified(){return this._props.modified}set modified(e){this._props.modified=e}set modifiedBy(e){this._props.modifiedBy=e}set data(e){X.validateProp("data",e,this.cachedSchema.properties.data),"string"==typeof e?(this._props.data=e,delete this._data):(this._data=new jd(e.toDto(),{clone:!0,validate:!1}),delete this._props.data)}set dataSignedByCurrentUser(e){X.validateProp("data_signed_by_current_user",e,this.cachedSchema.properties.data_signed_by_current_user),this._props.data_signed_by_current_user=e}static get ALL_CONTAIN_OPTIONS(){return{creator:!0}}}const Ld=zd,qd=class extends td{get entityClass(){return Ld}constructor(e=[],t={}){super(e,t)}static getSchema(){return{type:"array",items:Ld.getSchema()}}validateBuildRules(e,t={}){this.assertNotExist("id",e._props.id,{haystackSet:t?.uniqueIdsSetCache}),this.assertNotExist("user_id",e._props.user_id,{haystackSet:t?.uniqueUserIdsSetCache}),this.assertSameMetadataKeyId(e)}assertSameMetadataKeyId(e){if(!e.metadataKeyId)return;const t=this._items.find((e=>Boolean(e.metadataKeyId)))?.metadataKeyId;if(!t)return;if(e.metadataKeyId===t)return;const a=new $;throw a.addError("metadata_key_id","same_metadata_key","The collection should not contain different metadata key ID."),a}hasDecryptedPrivateKeys(){return this._items.some((e=>e.isDecrypted))}hasEncryptedPrivateKeys(){return this._items.some((e=>!e.isDecrypted))}pushMany(e,t={},a={}){const s=new Set(this.extract("id")),n=new Set(this.extract("user_id"));a={onItemPushed:e=>{s.add(e._props.id),n.add(e._props.user_id)},validateBuildRules:{...a?.validateBuildRules,uniqueIdsSetCache:s,uniqueUserIdsSetCache:n},...a},super.pushMany(e,t,a)}},Kd=class extends re{constructor(e,t={}){super(e,t),this._props.metadata_private_keys&&(this._metadata_private_keys=new qd(this._props.metadata_private_keys,{...t,clone:!1}),delete this._props.metadata_private_keys,this.assertSameMetadataKeyId()),this._props.creator&&(this._creator=new Fd(this._props.creator,{...t,clone:!1}),delete this._props.creator)}static getSchema(){return{type:"object",required:["fingerprint","armored_key"],properties:{id:{type:"string",format:"uuid",nullable:!0},fingerprint:{type:"string",pattern:/^[a-f0-9]{40}$/im},armored_key:{type:"string",maxLength:1e4,pattern:/^-----BEGIN PGP PUBLIC KEY BLOCK-----([\r\n])([ -9;-~]{1,76}: [ -~]{1,76}([\r\n]))*\n([a-zA-Z0-9\/+=]{1,76}([\r\n]))*=[a-zA-Z0-9\/+=]{4}([\r\n])-----END PGP PUBLIC KEY BLOCK-----([\r\n]*)$/},created:{type:"string",format:"date-time",nullable:!0},created_by:{type:"string",format:"uuid",nullable:!0},modified:{type:"string",format:"date-time",nullable:!0},modified_by:{type:"string",format:"uuid",nullable:!0},deleted:{type:"string",format:"date-time",nullable:!0},expired:{type:"string",format:"date-time",nullable:!0},metadata_private_keys:qd.getSchema(),creator:Fd.getSchema()}}}validateBuildRules(){}assertSameMetadataKeyId(){if(0!==(this._metadata_private_keys?.length||0)&&this.id!==this._metadata_private_keys.items[0].metadataKeyId){const e=new $;throw e.addError("id:metadata_private_keys","same_id","`id` and the `metadata_private_keys.id` should be the same"),e}}assertFingerprintPublicAndPrivateKeysMatch(){0!==(this._metadata_private_keys?.length||0)&&this._metadata_private_keys.items.forEach(((e,t)=>{if(e.isDecrypted&&e.data.fingerprint!==this.fingerprint){const e=new $;throw e.addError(`metadata_private_keys.${t}.fingerprint`,"fingerprint_match","The fingerprint of the metadata private key does not match the fingerprint of the metadata public key"),e}}))}toDto(e){const t=Object.assign({},this._props);return e?(this._metadata_private_keys&&e.metadata_private_keys&&(t.metadata_private_keys=this._metadata_private_keys.toDto()),this._creator&&e.creator&&(t.creator=this._creator.toDto(Fd.ALL_CONTAIN_OPTIONS)),t):t}toContentCodeConfirmTrustRequestDto(){const e=this.toDto();return this._metadata_private_keys&&(e.metadata_private_keys=this._metadata_private_keys.items.map((e=>e.toContentCodeConfirmTrustRequestDto()))),this._creator&&(e.creator=this._creator.toDto(Fd.ALL_CONTAIN_OPTIONS)),e}get armoredKey(){return this._props.armored_key}get id(){return this._props.id||null}get metadataPrivateKeys(){return this._metadata_private_keys||null}get created(){return this._props.created||null}get fingerprint(){return this._props.fingerprint}get expired(){return this._props.expired||null}get creator(){return this._creator||null}static get ALL_CONTAIN_OPTIONS(){return{metadata_private_keys:!0}}},Wd=class extends td{get entityClass(){return Kd}constructor(e=[],t={}){super(e,t)}static getSchema(){return{type:"array",items:Kd.getSchema()}}validateBuildRules(e,t={}){this.assertNotExist("id",e._props.id,{haystackSet:t?.uniqueIdsSetCache}),this.assertNotExist("fingerprint",e._props.fingerprint,{haystackSet:t?.uniqueFingerprintsSetCache})}assertFingerprintsPublicAndPrivateKeysMatch(){this._items.forEach(((e,t)=>{try{e.assertFingerprintPublicAndPrivateKeysMatch(t)}catch(e){const a=new Z;throw a.addItemValidationError(t,e),a}}))}getFirstByLatestCreated(){return this.length?this._items.reduce(((e,t)=>e.created?t.created&&t.created>e.created?t:e:t)):null}toDto(e={}){return this._items.map((t=>t.toDto(e)))}hasDecryptedKeys(){return this._items.some((e=>e.metadataPrivateKeys?.hasDecryptedPrivateKeys()))}hasEncryptedKeys(){return this._items.some((e=>e.metadataPrivateKeys?.hasEncryptedPrivateKeys()))}pushMany(e,t={},a={}){const s=new Set(this.extract("id")),n=new Set(this.extract("fingerprint"));a={onItemPushed:e=>{s.add(e._props.id),n.add(e._props.fingerprint)},validateBuildRules:{...a?.validateBuildRules,uniqueIdsSetCache:s,uniqueFingerprintsSetCache:n},...a},super.pushMany(e,t,a)}},Vd=["default_resource_types","allow_creation_of_v5_resources","allow_creation_of_v4_resources","allow_v4_v5_upgrade","allow_v5_v4_downgrade"],Bd=class extends ed{toFormDto(){return Vd.reduce(((e,t)=>(void 0!==this._props[t]&&(e[t]=this._props[t]),e)),{})}verifyHealth(e,t){let a=null;if(void 0===e)return a;if(void 0===t)return a;if(!(e instanceof Pd))throw new TypeError("The parameter 'resourceTypes' is not a valid 'ResourceTypesCollection' type.");if(!(t instanceof Wd))throw new TypeError("The parameter 'metadataKeysCollection' is not a valid 'MetadataKeysCollection' type.");const s=e.hasSomeOfVersion(Zm),n=e.hasSomeOfVersion(Qm);return this.allowCreationOfV4Resources&&!s&&(a=a||new $,a.addError("allow_creation_of_v4_resources","resource_types_deleted","Resource types v4 are deleted.")),this.isDefaultResourceTypeV4&&!s&&(a=a||new $,a.addError("default_resource_types","resource_types_v4_deleted","Resource types v4 are deleted.")),this.allowCreationOfV5Resources&&!n&&(a=a||new $,a.addError("allow_creation_of_v5_resources","resource_types_deleted","Resource types v5 are deleted.")),this.isDefaultResourceTypeV5&&!n&&(a=a||new $,a.addError("default_resource_types","resource_types_v5_deleted","Resource types v5 are deleted.")),this.allowV5V4Downgrade&&!s&&(a=a||new $,a.addError("allow_v5_v4_downgrade","resource_types_deleted","Resource types v4 are deleted.")),this.allowV5V4Downgrade&&!this.allowCreationOfV4Resources&&(a=a||new $,a.addError("allow_v5_v4_downgrade","allow_creation","Resource types v4 creation is not allowed.")),this.allowV4V5Upgrade&&!n&&(a=a||new $,a.addError("allow_v4_v5_upgrade","resource_types_deleted","Resource types v5 are deleted.")),this.allowV4V5Upgrade&&!this.allowCreationOfV5Resources&&(a=a||new $,a.addError("allow_v4_v5_upgrade","allow_creation","Resource types v5 creation is not allowed.")),0===t.items.filter((e=>!e.expired)).length&&this.allowCreationOfV5Resources&&(a=a||new $,a.addError("allow_creation_of_v5_resources","active_metadata_key","No active metadata key defined.")),a}};class Gd extends re{static getSchema(){return{type:"object",required:["allow_usage_of_personal_keys","zero_knowledge_key_share"],properties:{allow_usage_of_personal_keys:{type:"boolean"},zero_knowledge_key_share:{type:"boolean"}}}}static createFromDefault(e={}){return new Gd({allow_usage_of_personal_keys:!0,zero_knowledge_key_share:!1,...e})}get allowUsageOfPersonalKeys(){return this._props.allow_usage_of_personal_keys}get zeroKnowledgeKeyShare(){return this._props.zero_knowledge_key_share}}const $d=Gd,Hd=class{constructor(e){this.port=e}async findKeysSettings(){const e=await this.port.request("passbolt.metadata.find-metadata-keys-settings");return new $d(e)}async findTypesSettings(){const e=await this.port.request("passbolt.metadata.find-metadata-types-settings");return new ed(e)}async saveTypesSettings(e){if(!(e instanceof ed))throw new TypeError("The 'settings' property should be of type 'MetadataTypesSettingsEntity'.");const t=await this.port.request("passbolt.metadata.save-metadata-types-settings",e.toDto());return new ed(t)}async saveKeysSettings(e){if(!(e instanceof $d))throw new TypeError("The 'settings' property should be of type 'MetadataKeysSettingsEntity'.");const t=await this.port.request("passbolt.metadata.save-metadata-keys-settings",e.toDto());return new $d(t)}};class Yd extends s.Component{render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary form",disabled:this.props.isProcessing,onClick:this.props.onSaveRequested},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}Yd.propTypes={isProcessing:r().bool,onSaveRequested:r().func,t:r().func};const Jd=(0,v.CI)("common")(Yd);function Zd(){return Zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Zd.apply(null,arguments)}const Qd=s.createContext({get:()=>{},resourceTypes:null,updateLocalStorage:()=>{}});class Xd extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.runningLocalStorageUpdatePromise=null,this.initEventHandlers()}get defaultState(){return{get:this.get.bind(this),resourceTypes:null,updateLocalStorage:this.updateLocalStorage.bind(this)}}initEventHandlers(){this.handleStorageChange=this.handleStorageChange.bind(this)}componentDidMount(){this.props.context.storage.onChanged.addListener(this.handleStorageChange)}componentWillUnmount(){this.props.context.storage.onChanged.removeListener(this.handleStorageChange)}handleStorageChange(e){e.resourceTypes&&this.set(e.resourceTypes.newValue)}set(e){const t=new Pd(e);this.setState({resourceTypes:t})}get(){return null===this.state.resourceTypes?(this.loadLocalStorage(),null):this.state.resourceTypes}async loadLocalStorage(){const e=await this.props.context.storage.local.get(["resourceTypes"]);e.resourceTypes?this.set(e.resourceTypes):this.updateLocalStorage()}async updateLocalStorage(){null===this.runningLocalStorageUpdatePromise?(this.runningLocalStorageUpdatePromise=this.props.context.port.request("passbolt.resource-type.get-or-find-all"),await this.runningLocalStorageUpdatePromise,this.runningLocalStorageUpdatePromise=null):await this.runningLocalStorageUpdatePromise}render(){return s.createElement(Qd.Provider,{value:this.state},this.props.children)}}function ep(e){return class extends s.Component{render(){return s.createElement(Qd.Consumer,null,(t=>s.createElement(e,Zd({resourceTypesLocalStorageContext:t,resourceTypes:t.get()},this.props))))}}}Xd.propTypes={context:r().any,children:r().any},I(Xd);class tp extends te{constructor(e,t={}){const a=tp.sanitizeDto(e);super(X.validate(tp.ENTITY_NAME,a,tp.getSchema()),t)}static getSchema(){return{type:"object",required:["armored_key"],properties:{armored_key:{type:"string",minLength:1},key_id:{type:"string",minLength:8,maxLength:16},user_ids:{type:"array"},fingerprint:{type:"string",minLength:40,maxLength:40},expires:{anyOf:[{type:"string",format:"date-time"},{type:"string",pattern:"^Infinity$"},{}],nullable:!0},created:{type:"string",format:"date-time"},algorithm:{type:"string"},length:{type:"integer",minimum:1},curve:{type:"string",nullable:!0},private:{type:"boolean"},revoked:{type:"boolean"}}}}static sanitizeDto(e){const t=JSON.parse(JSON.stringify(e));if(e.key&&(t.armored_key=e.key,delete t.key),e.keyId&&(t.key_id=e.keyId,delete t.keyId),e.userIds&&(t.user_ids=e.userIds,delete t.userIds),e.created)try{const e=new Date(t.created);t.created=e.toISOString()}catch(e){delete t.created}if("Never"===e.expires)t.expires="Infinity";else if(e.expires&&"Infinity"!==e.expires)try{const e=new Date(t.expires);t.expires=e.toISOString()}catch(a){delete t.expires,console.error(`ExternalGpgKeyEntity::sanitizeDto Unable to sanitize the key for the user ${e.user_id}`)}return t}get armoredKey(){return this._props.armored_key}get keyId(){return this._props.key_id}get userIds(){return this._props.user_ids}get fingerprint(){return this._props.fingerprint}get expires(){return this._props.expires}get isValid(){return null!==this.expires}get created(){return this._props.created}get algorithm(){return this._props.algorithm}get length(){return this._props.length}get curve(){return this._props.curve}get revoked(){return this._props.revoked}get private(){return this._props.private}get isExpired(){const e=this.expires;if(null===e)return null;if("Infinity"===e)return!1;const t=Date.now();return new Date(e)<t}static get ENTITY_NAME(){return"externalGpgKey"}}const ap=tp;class sp extends te{constructor(e,t={}){super(X.validate(sp.ENTITY_NAME,e,sp.getSchema()),t),this._props.private_key&&(this._private_key=new ap(this._props.private_key,{clone:!1}),delete this._props.private_key),this._props.public_key&&(this._public_key=new ap(this._props.public_key,{clone:!1}),delete this._props.public_key)}static getSchema(){return{type:"object",required:["public_key","private_key"],properties:{public_key:ap.getSchema(),private_key:ap.getSchema()}}}toDto(e){const t=Object.assign({},this._props);return e?(e.public_key&&this._public_key&&(t.public_key=this.publicKey.toDto()),e.private_key&&this._private_key&&(t.private_key=this.privateKey.toDto()),t):t}toJSON(){return this.toDto(sp.ALL_CONTAIN_OPTIONS)}get publicKey(){return this._public_key}get privateKey(){return this._private_key}static get ENTITY_NAME(){return"externalGpgKeyPairEntity"}static get ALL_CONTAIN_OPTIONS(){return{public_key:!0,private_key:!0}}}const np=sp,ip=class{constructor(e){this.port=e}async findAll(){const e=await this.port.request("passbolt.metadata.find-all-non-deleted-metadata-keys");return new Wd(e)}async generateKeyPair(){const e=await this.port.request("passbolt.metadata.generate-metadata-key");return new np(e)}async createKey(e){if(!(e instanceof np))throw new TypeError("The parameter `metadataKeyPair` should be of type ExternalGpgKeyPairEntity.");const t=await this.port.request("passbolt.metadata.create-key",e.toDto({public_key:!0,private_key:!0}));return new Kd(t)}async share(e){await this.port.request("passbolt.metadata.share-missing-metadata-private-keys-with-user",e)}};class rp extends s.Component{originalSettings=null;formSettings=null;metadataKeys=void 0;constructor(e){super(e),this.metadataSettingsServiceWorkerService=e.metadataSettingsServiceWorkerService??new Hd(e.context.port),this.metadataKeysServiceWorkerService=e.metadataKeysServiceWorkerService??new ip(e.context.port),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isProcessing:!0,hasAlreadyBeenValidated:!1,settings:{default_resource_types:"v4",allow_creation_of_v5_resources:!1,allow_creation_of_v4_resources:!1,allow_v4_v5_upgrade:!1,allow_v5_v4_downgrade:!1}}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.save=this.save.bind(this)}async componentDidMount(){this.originalSettings=await this.metadataSettingsServiceWorkerService.findTypesSettings(),this.formSettings=new Bd(this.originalSettings.toDto(),{validate:!1}),this.metadataKeys=await this.metadataKeysServiceWorkerService.findAll(),this.setState({settings:this.formSettings.toFormDto(),isProcessing:!1})}validateForm=(0,Jm.A)((e=>this.formSettings?.validate()));verifyDataHealth=(0,Jm.A)(((e,t,a)=>this.formSettings?.verifyHealth(t,a)));hasSettingsChanges=(0,Jm.A)(((e,t,a)=>this.originalSettings?.hasDiffProps(this.formSettings)));handleInputChange(e){if(this.hasAllInputDisabled())return;const{type:t,checked:a,value:s,name:n}=e.target,i="checkbox"===t?a:s;this.setFormPropertyValue(n,i)}setFormPropertyValue(e,t){this.formSettings.set(e,t,{validate:!1}),this.setState({settings:this.formSettings.toFormDto()})}hasAllInputDisabled(){return this.state.isProcessing}handleFormSubmit(e){e.preventDefault(),this.save()}async save(){if(this.state.isProcessing)return;const e=this.validateForm(this.state.settings);if(e?.hasErrors()){const e=!0;this.setState({hasAlreadyBeenValidated:e})}else{this.setState({isProcessing:!0});try{this.originalSettings=await this.metadataSettingsServiceWorkerService.saveTypesSettings(this.formSettings),this.formSettings=new Bd(this.originalSettings.toDto()),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The encrypted metadata settings were updated."))}catch(e){this.props.dialogContext.open(Pt,{error:e})}this.setState({hasAlreadyBeenValidated:!0,isProcessing:!1,settings:this.formSettings.toDto()})}}render(){const e=this.state.hasAlreadyBeenValidated?this.validateForm(this.state.settings):null,t=this.verifyDataHealth(this.state.settings,this.props.resourceTypes,this.metadataKeys),a=this.hasSettingsChanges(this.originalSettings,this.formSettings,this.state.settings);return s.createElement("div",{className:"row"},s.createElement("div",{id:"content-types-encrypted-metadata-settings",className:"main-column"},s.createElement("div",{className:"main-content"},s.createElement("form",{onSubmit:this.handleFormSubmit,"data-testid":"submit-form"},s.createElement("h3",{className:"title"},s.createElement("label",null,s.createElement(v.x6,null,"Encrypted metadata"))),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"Encrypted metadata for resources is available.")," ",s.createElement(v.x6,null,"Define the strategy to manage and migrate the legacy items.")),s.createElement("h4",null,s.createElement(v.x6,null,"Supported metadata types")),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"Define which metadata types are enabled for this instance.")),s.createElement("div",{className:`input toggle-switch form-element\n              ${e?.hasError("allow_creation_of_v5_resources")?"error":""}\n              ${t?.hasError("allow_creation_of_v5_resources")?"warning":""}`},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"allow_creation_of_v5_resources",id:"allowCreationOfV5ResourcesInput",onChange:this.handleInputChange,checked:this.state.settings.allow_creation_of_v5_resources,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"allowCreationOfV5ResourcesInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Enable encrypted metadata (recommended)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Enable encrypted metadata for resources.")),e?.hasError("allow_creation_of_v5_resources","is_default")&&s.createElement("div",{className:"name error-message"},s.createElement(v.x6,null,"Encrypted metadata must be enabled to set it as the default type.")),!e?.hasError("allow_creation_of_v5_resources")&&s.createElement(s.Fragment,null,t?.hasError("allow_creation_of_v5_resources","resource_types_deleted")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"All encrypted metadata resource types were previously disabled. Re-enable them if you want users to create resources of this type.")),t?.hasError("allow_creation_of_v5_resources","active_metadata_key")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"A metadata key should be enabled to allow users to create resources of this type."))))),s.createElement("div",{className:`input toggle-switch form-element\n              ${e?.hasError("allow_creation_of_v4_resources")?"error":""}\n              ${t?.hasError("allow_creation_of_v4_resources")?"warning":""}`},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"allow_creation_of_v4_resources",id:"allowCreationOfV4ResourcesInput",onChange:this.handleInputChange,checked:this.state.settings.allow_creation_of_v4_resources,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"allowCreationOfV4ResourcesInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Enable legacy cleartext metadata")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Enable legacy cleartext metadata for resources.")),e?.hasError("allow_creation_of_v4_resources","is_default")&&s.createElement("div",{className:"name error-message"},s.createElement(v.x6,null,"Legacy cleartext metadata must be enabled to set it as the default type.")),!e?.hasError("allow_creation_of_v4_resources")&&t?.hasError("allow_creation_of_v4_resources","resource_types_deleted")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"All legacy cleartext resource types were previously disabled. Re-enable them if you want users to create resources of this type.")))),s.createElement("h4",null,s.createElement(v.x6,null,"Default metadata type")),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"Define which metadata type is used by default.")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:`input radio\n                  ${"v5"===this.state.settings.default_resource_types?"checked":""}\n                  ${e?.hasError("default_resource_types","allow_create_v5")?"error":""}\n                  ${!e?.hasError("default_resource_types","allow_create_v5")&&t?.hasError("default_resource_types","resource_types_v5_deleted")?"warning":""}`},s.createElement("input",{type:"radio",value:"v5",onChange:this.handleInputChange,name:"default_resource_types",checked:"v5"===this.state.settings.default_resource_types,id:"defaultResourceTypesV5Input",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"defaultResourceTypesV5Input"},s.createElement("span",{className:"name bold"},s.createElement(v.x6,null,"Encrypted metadata (recommended)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Users can create resources with encrypted metadata by default."),s.createElement("br",null)),e?.hasError("default_resource_types","allow_create_v5")&&s.createElement("div",{className:"name error-message"},s.createElement(v.x6,null,"Encrypted metadata must be enabled to set it as the default type.")),!e?.hasError("default_resource_types","allow_create_v5")&&t?.hasError("default_resource_types","resource_types_v5_deleted")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"All encrypted metadata resource types were previously disabled. Re-enable them if you want users to create resources of this type.")))),s.createElement("div",{className:`input radio ${"v4"===this.state.settings.default_resource_types?"checked":""}\n                  ${e?.hasError("default_resource_types","allow_create_v4")?"error":""}\n                  ${!e?.hasError("default_resource_types","allow_create_v4")&&t?.hasError("default_resource_types","resource_types_v4_deleted")?"warning":""}`},s.createElement("input",{type:"radio",value:"v4",onChange:this.handleInputChange,name:"default_resource_types",checked:"v4"===this.state.settings.default_resource_types,id:"defaultResourceTypesV4Input",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"defaultResourceTypesV4Input"},s.createElement("span",{className:"name bold"},s.createElement(v.x6,null,"Legacy cleartext metadata")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Users can create legacy resources with cleartext metadata by default.")),e?.hasError("default_resource_types","allow_create_v4")&&s.createElement("div",{className:"name error-message"},s.createElement(v.x6,null,"Legacy cleartext metadata must be enabled to set it as the default type.")),!e?.hasError("default_resource_types","allow_create_v4")&&t?.hasError("default_resource_types","resource_types_v4_deleted")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"All legacy cleartext resource types were previously disabled. Re-enable them if you want users to create resources of this type."))))),s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Self served migration")),s.createElement("div",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"allow_v4_v5_upgrade",id:"allowV4V5UpgradeInput",onChange:this.handleInputChange,checked:this.state.settings.allow_v4_v5_upgrade,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"allowV4V5UpgradeInput",className:"text"},s.createElement(v.x6,null,"Allow users to upgrade their content from cleartext to encrypted metadata type."),t?.hasError("allow_v4_v5_upgrade","resource_types_deleted")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"All encrypted metadata resource types were previously disabled. Re-enable them if you want users to upgrade their resources.")),t?.hasError("allow_v4_v5_upgrade","allow_creation")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"Encrypted metadata should be enabled to allow users to upgrade their resources.")))),s.createElement("div",{className:"input toggle-switch form-element"},s.createElement("input",{type:"checkbox",className:"toggle-switch-checkbox checkbox",name:"allow_v5_v4_downgrade",id:"allowV5V4DowngradeInput",onChange:this.handleInputChange,checked:this.state.settings.allow_v5_v4_downgrade,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"allowV5V4DowngradeInput",className:"text"},s.createElement(v.x6,null,"Allow users to downgrade their content from encrypted to cleartext metadata type."),t?.hasError("allow_v5_v4_downgrade","resource_types_deleted")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"All legacy cleartext resource types were previously disabled. Re-enable them if you want users to downgrade their resources.")),t?.hasError("allow_v5_v4_downgrade","allow_creation")&&s.createElement("div",{className:"name warning-message"},s.createElement(v.x6,null,"Legacy cleartext metadata should be enabled to allow users to downgrade their resources.")))))),a&&s.createElement("div",{className:"warning message form-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification."))))),s.createElement(Jd,{onSaveRequested:this.save,isProcessing:this.state.isProcessing}),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the content type support and migration, checkout the dedicated page on the official website.")),s.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://passbolt.com/docs"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}rp.propTypes={context:r().object,actionFeedbackContext:r().object,dialogContext:r().object,createPortal:r().func,metadataSettingsServiceWorkerService:r().object,metadataKeysServiceWorkerService:r().object,resourceTypes:r().instanceOf(Pd),t:r().func};const op=I(d(g(ep((0,v.CI)("common")(rp)))));var lp;function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},cp.apply(null,arguments)}const mp=function(e){return s.createElement("svg",cp({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),lp||(lp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 14.25 3.75 9 9 3.75M14.25 9H3.75"})))};class dp extends s.Component{get privacyUrl(){return this.props.context.siteSettings.privacyLink}get creditsUrl(){return"https://www.passbolt.com/credits"}get unsafeUrl(){return"https://www.passbolt.com/docs/hosting/faq/why-I-see-unsafe-mode-banner/"}get termsUrl(){return this.props.context.siteSettings.termsLink}get versions(){const e=[],t=this.props.context.siteSettings.version;return t&&e.push(`${this.props.t("Server")} ${t}`),this.props.context.extensionVersion&&e.push(`${this.props.t("Client")} ${this.props.context.extensionVersion}`),e.join(" / ")}get isUnsafeMode(){if(!this.props.context.siteSettings)return!1;const e=this.props.context.siteSettings.debug,t=this.props.context.siteSettings.url.startsWith("http://");return e||t}render(){return s.createElement("footer",{className:"footer"},s.createElement("ul",{className:"footer-links"},this.isUnsafeMode&&s.createElement("li",{className:"error-message"},s.createElement("a",{href:this.unsafeUrl,target:"_blank",rel:"noopener noreferrer"},s.createElement(v.x6,null,"Unsafe mode"))),this.termsUrl&&s.createElement("li",null,s.createElement("a",{href:this.termsUrl,target:"_blank",rel:"noopener noreferrer"},s.createElement(v.x6,null,"Terms"))),this.privacyUrl&&s.createElement("li",null,s.createElement("a",{href:this.privacyUrl,target:"_blank",rel:"noopener noreferrer"},s.createElement(v.x6,null,"Privacy"))),s.createElement("li",null,s.createElement("a",{href:this.creditsUrl,target:"_blank",rel:"noopener noreferrer"},s.createElement(v.x6,null,"Credits"))),s.createElement("li",null,this.versions&&s.createElement(bt,{message:this.versions,direction:"left"},s.createElement("a",{className:"button button-transparent inline",href:this.creditsUrl,target:"_blank",rel:"noopener noreferrer"},s.createElement(Mn,null))),!this.versions&&s.createElement("a",{className:"button button-transparent inline",href:this.creditsUrl,target:"_blank",rel:"noopener noreferrer"},s.createElement(Mn,null)))))}}dp.propTypes={context:r().any,t:r().func};const pp=I((0,v.CI)("common")(dp));class up extends s.Component{render(){return s.createElement("div",{className:"fingerprint"},s.createElement("div",{className:"fingerprint-line"},this.props.fingerprint?.substring(0,20)?.replace(/.{4}/g,"$& ")),s.createElement("div",{className:"fingerprint-line"},this.props.fingerprint?.substring(20)?.replace(/.{4}/g,"$& ")))}}up.propTypes={fingerprint:r().string.isRequired};const hp=up;class gp extends Ll{constructor(e,t={}){super(X.validate(gp.ENTITY_NAME,e,gp.getSchema()),t),this._props.map((e=>e.id)).sort().sort(((e,t)=>{if(e===t)throw new jl(0,gp.RULE_UNIQUE_ID,`Gpgkey fingerprint ${e} already exists.`)})),this._props.forEach((e=>{this._items.push(new ap(e,{clone:!1}))})),this._props=null}static getSchema(){return{type:"array",items:ap.getSchema()}}static get ENTITY_NAME(){return"externalGpgKey"}static get RULE_UNIQUE_ID(){return"fingerprint"}}const bp=gp,yp=class{constructor(e){this.port=e}async keyInfo(e){const t=await this.port.request("passbolt.keyring.get-key-info",e);return new ap(t)}async keysInfo(e=[]){const t=[];for(const a of e){const e=await this.keyInfo(a);t.push(e)}return new bp(t)}},fp=class extends $d{constructor(e,t={}){super(e,t),this._props.generated_metadata_key&&(this._generated_metadata_key=new np(this._props.generated_metadata_key,{...t,clone:!1}),delete this._props.generated_metadata_key)}static getSchema(){return{type:"object",required:["allow_usage_of_personal_keys","zero_knowledge_key_share"],properties:{...$d.getSchema().properties,generated_metadata_key:np.getSchema()}}}toDto(){return{...this._props,generated_metadata_key:this.generatedMetadataKey?.toDto({public_key:!0,private_key:!0})||null}}get generatedMetadataKey(){return this._generated_metadata_key||null}set generatedMetadataKey(e){if(null!==e&&!(e instanceof np))throw new TypeError("The parameter `generatedMetadataKey` should be of type ExternalGpgKeyPairEntity.");this._generated_metadata_key=e}};class vp extends s.Component{render(){return s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary",disabled:this.props.isProcessing,onClick:this.props.onSaveRequested},s.createElement("span",null,s.createElement(v.x6,null,"Save"))))}}vp.propTypes={isProcessing:r().bool,onSaveRequested:r().func,t:r().func};const Ep=(0,v.CI)("common")(vp);class wp extends s.Component{originalSettings=null;formSettings=null;constructor(e){super(e),this.metadataSettingsServiceWorkerService=e.metadataSettingsServiceWorkerService??new Hd(e.context.port),this.metadataKeysServiceWorkerService=e.metadataKeysServiceWorkerService??new ip(e.context.port),this.gpgServiceWorkerService=e.gpgServiceWorkerService??new yp(e.context.port),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isProcessing:!0,hasAlreadyBeenValidated:!1,settings:{allow_usage_of_personal_keys:!0,zero_knowledge_key_share:!1,generated_metadata_key:null},activeMetadataKeys:null,expiredMetadataKeys:null}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.generateMetadataKey=this.generateMetadataKey.bind(this),this.save=this.save.bind(this)}async componentDidMount(){await this.loadKeysSettings(),await this.loadKeys(),this.setState({isProcessing:!1})}async loadKeysSettings(){try{const e=await this.metadataSettingsServiceWorkerService.findKeysSettings();this.originalSettings=new fp(e.toDto(),{validate:!1}),this.formSettings=new fp(e.toDto(),{validate:!1}),this.setState({settings:this.formSettings.toDto()})}catch(e){await this.handleUnexpectedError(e)}}handleUnexpectedError(e){if(console.error(e),"UserAbortsOperationError"!==e.name)return this.props.dialogContext.open(Pt,{error:e})}async loadKeys(){try{const e=await this.metadataKeysServiceWorkerService.findAll(),t=new Wd(e);t.filterByCallback((e=>!e.expired));const a=new Wd(e);a.filterByCallback((e=>e.expired));const s=e.items.map((e=>e.armoredKey)),n=await this.gpgServiceWorkerService.keysInfo(s);this.setState({activeMetadataKeys:t,expiredMetadataKeys:a,metadataKeysInfo:n})}catch(e){await this.handleUnexpectedError(e)}}hasSettingsChanges=(0,Jm.A)(((e,t,a)=>e?.hasDiffProps(t)||e?.generatedMetadataKey!==t?.generatedMetadataKey));handleInputChange(e){if(this.hasAllInputDisabled())return;const{type:t,checked:a,value:s,name:n}=e.target;let i=s;"checkbox"===t&&(i=a),"allow_usage_of_personal_keys"!==n&&"zero_knowledge_key_share"!==n||(i="true"===s),this.setFormPropertyValue(n,i)}setFormPropertyValue(e,t){this.formSettings.set(e,t,{validate:!1}),this.setState({settings:this.formSettings.toDto()})}hasAllInputDisabled(){return this.state.isProcessing}async generateMetadataKey(){const e=this.state.metadataKeysInfo,t=this.state.activeMetadataKeys;this.setState({isProcessing:!0});try{const a=await this.metadataKeysServiceWorkerService.generateKeyPair(),s=await this.gpgServiceWorkerService.keyInfo(a.publicKey.armoredKey);e.push(s);const n=new Kd({armored_key:a.publicKey.armoredKey,fingerprint:s.fingerprint});t.push(n),this.formSettings.generatedMetadataKey=a,this.setState({activeMetadataKeys:t,metadataKeysInfo:e,settings:this.formSettings.toDto()})}catch(e){await this.handleUnexpectedError(e)}this.setState({isProcessing:!1})}handleFormSubmit(e){e.preventDefault(),this.save()}async save(){if(this.state.isProcessing)return;this.setState({isProcessing:!0});const e=this.validateForm(this.state.settings);if(e?.hasErrors())this.setState({isProcessing:!1,hasAlreadyBeenValidated:!0});else{try{await this.saveMetadataKeysSettings(),await this.createMetadataKey(),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The metadata key settings were updated."))}catch(e){await this.handleUnexpectedError(e)}this.setState({isProcessing:!1,settings:this.formSettings.toDto()})}}validateForm=(0,Jm.A)((e=>{if(!this.formSettings)return null;let t=this.formSettings.validate();return this.state.activeMetadataKeys.length||(t=t||new $,t.addError("generated_metadata_key","required",this.props.t("A shared metadata key is required."))),t}));async saveMetadataKeysSettings(){const e=new $d(this.formSettings.toDto()),t=await this.metadataSettingsServiceWorkerService.saveKeysSettings(e);this.originalSettings=new fp({...this.originalSettings.toDto(),...t.toDto()}),this.formSettings=new fp({...this.formSettings.toDto(),...t.toDto()})}async createMetadataKey(){if(!this.formSettings.generatedMetadataKey)return;const e=await this.metadataKeysServiceWorkerService.createKey(this.formSettings.generatedMetadataKey);this.state.activeMetadataKeys.pushOrReplace(e,{},{replacePropertyName:"fingerprint"}),this.formSettings.generatedMetadataKey=null}render(){const e=this.state.hasAlreadyBeenValidated?this.validateForm(this.state.settings):null,t=this.hasSettingsChanges(this.originalSettings,this.formSettings,this.state.settings);return s.createElement("div",{className:"row"},s.createElement("div",{id:"content-types-metadata-key-settings",className:"main-column"},s.createElement("div",{className:"main-content"},s.createElement("form",{onSubmit:this.handleFormSubmit,"data-testid":"submit-form"},s.createElement("h3",{className:"title"},s.createElement("label",null,s.createElement(v.x6,null,"Metadata key"))),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"This section controls the layer of encryption that is used to protect metadata such as the name of a resource, URIs, etc.")),s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Metadata key policy")),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"It is possible for users to use their personal keys to encrypt resources metadata for more security. However you can elect to enforce the use of the shared metadata keys for all resources metadata for auditing purposes. Secrets such as passwords will always be encrypted using the user personal keys.")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio "+(!0===this.state.settings.allow_usage_of_personal_keys?"checked":"")},s.createElement("input",{type:"radio",value:"true",onChange:this.handleInputChange,name:"allow_usage_of_personal_keys",checked:!0===this.state.settings.allow_usage_of_personal_keys,id:"allowUsageOfPersonalKeysInput",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"allowUsageOfPersonalKeysInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Allow the use of personal keys. (Recommended)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Users can use shared and personal keys. By default personal resources that are not shared will be encrypted with the users personal keys."),s.createElement("br",null)))),s.createElement("div",{className:"input radio "+(!1===this.state.settings.allow_usage_of_personal_keys?"checked":"")},s.createElement("input",{type:"radio",value:"false",onChange:this.handleInputChange,name:"allow_usage_of_personal_keys",checked:!1===this.state.settings.allow_usage_of_personal_keys,id:"disallowUsageOfPersonalKeysInput",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"disallowUsageOfPersonalKeysInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Enforce the use of shared metadata keys.")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"By default, metadata wil be encrypted with the shared keys. It is not possible to use personal keys to encrypt metadata."),s.createElement("br",null))))),s.createElement("h4",null,s.createElement(v.x6,null,"Zero knowledge (Coming soon)")),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"This section defines how the shared metadata key is shared with users.")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:"input radio no-hover "+(!1===this.state.settings.zero_knowledge_key_share?"checked":"")},s.createElement("input",{type:"radio",value:"true",name:"zero_knowledge_key_share",checked:!1===this.state.settings.zero_knowledge_key_share,id:"disableZeroKnowledgeKeyShareInput",disabled:!0}),s.createElement("label",{htmlFor:"disableZeroKnowledgeKeyShareInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"User-friendly mode (Better on-boarding)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"The shared metadata key is accessible to the server and can be shared by the server when a user completes the setup. In practice, an attacker with full server access can see the shared metadata."),s.createElement("br",null)))),s.createElement("div",{className:"input radio no-hover "+(!0===this.state.settings.zero_knowledge_key_share?"checked":"")},s.createElement("input",{type:"radio",value:"true",name:"zero_knowledge_key_share",checked:!0===this.state.settings.zero_knowledge_key_share,id:"enableZeroKnowledgeKeyShareInput",disabled:!0}),s.createElement("label",{htmlFor:"enableZeroKnowledgeKeyShareInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Zero-knowledge mode (More secure)")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"The shared metadata key is not available to the server and must be shared with users by the admins. New users are not allowed to create or access shared content until they are provided the metadata key. It is recommended to rotate the key if you switch to that mode."),s.createElement("br",null))))),s.createElement("h4",null,s.createElement(v.x6,null,"Shared metadata keys")),s.createElement("div",{className:`metadata-key-info ${e?.hasError("generated_metadata_key","required")&&"error"}`},this.state.activeMetadataKeys?.length>0&&s.createElement("div",{id:"metadata-active-keys"},this.state.activeMetadataKeys?.items.map((e=>{const t=this.state.metadataKeysInfo?.getFirst("fingerprint",e.fingerprint);return s.createElement("table",{key:e.fingerprint,className:"table-info"},s.createElement("tbody",null,s.createElement("tr",{className:"fingerprint"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Fingerprint")),s.createElement("td",{className:"value"},s.createElement(hp,{fingerprint:e.fingerprint}))),s.createElement("tr",{className:"algorithm"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Algorithm")),s.createElement("td",{className:"value"},t?.algorithm," ",t?.curve)),s.createElement("tr",{className:"key-length"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Key length")),s.createElement("td",{className:"value"},t?.length)),s.createElement("tr",{className:"created"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Created")),e.created&&s.createElement("td",{className:"value"},s.createElement("span",{title:e.created},Nn(e.created,this.props.t,this.props.context.locale))),!e.created&&s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"Pending")))))}))),!this.state.activeMetadataKeys?.length&&s.createElement("div",{id:"no-metadata-active-keys"},s.createElement("table",{className:"table-info"},s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",{className:"empty-value"},s.createElement(v.x6,null,"You need to generate a new shared key to enable encrypted metadata.")),s.createElement("td",{className:"table-button"},s.createElement("button",{className:"button primary medium",type:"button",disabled:this.hasAllInputDisabled(),onClick:this.generateMetadataKey,"data-testid":"generate-key-buton"},s.createElement(v.x6,null,"Generate key")))),e?.hasError("generated_metadata_key","required")&&s.createElement("tr",{className:"error-message"},s.createElement(v.x6,null,"A shared metadata key is required."))))),this.state.expiredMetadataKeys?.length>0&&s.createElement(s.Fragment,null,s.createElement("h4",null,s.createElement(v.x6,null,"Previous keys")),s.createElement("div",{id:"metadata-expired-keys"},this.state.expiredMetadataKeys?.items.map((e=>{const t=this.state.metadataKeysInfo.getFirst("fingerprint",e.fingerprint);return s.createElement("table",{key:e.fingerprint,className:"table-info"},s.createElement("tbody",null,s.createElement("tr",{className:"fingerprint"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Fingerprint")),s.createElement("td",{className:"value"},s.createElement(hp,{fingerprint:e.fingerprint}))),s.createElement("tr",{className:"algorithm"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Algorithm")),s.createElement("td",{className:"value"},t?.algorithm," ",t?.curve)),s.createElement("tr",{className:"key-length"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Key length")),s.createElement("td",{className:"value"},t?.length)),s.createElement("tr",{className:"created"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Created")),s.createElement("td",{className:"value"},s.createElement("span",{title:e.created},Nn(e.created,this.props.t,this.props.context.locale)))),s.createElement("tr",{className:"expired"},s.createElement("td",{className:"label"},s.createElement(v.x6,null,"Expired")),s.createElement("td",{className:"value"},s.createElement("span",{title:e.expired},Nn(e.expired,this.props.t,this.props.context.locale))))))}))))))),t&&s.createElement("div",{className:"warning message form-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"Don't forget to save your settings to apply your modification.")))),e?.hasError("generated_metadata_key","required")&&s.createElement("div",{className:"warning message form-banner"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,"A shared metadata key is required to save the metadata keys settings."))))),s.createElement(Ep,{onSaveRequested:this.save,isProcessing:this.state.isProcessing}),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the content type support and migration, checkout the dedicated page on the official website.")),s.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://passbolt.com/docs"},s.createElement(Ts,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}wp.propTypes={context:r().object,actionFeedbackContext:r().object,dialogContext:r().object,createPortal:r().func,metadataSettingsServiceWorkerService:r().object,metadataKeysServiceWorkerService:r().object,gpgServiceWorkerService:r().object,t:r().func};const kp=I(g(d((0,v.CI)("common")(wp)))),xp=class extends re{static getSchema(){return{type:"object",required:["migrate_resources_to_v5","migrate_folders_to_v5","migrate_tags_to_v5","migrate_comments_to_v5","migrate_personal_content"],properties:{migrate_resources_to_v5:{type:"boolean"},migrate_folders_to_v5:{type:"boolean"},migrate_tags_to_v5:{type:"boolean"},migrate_comments_to_v5:{type:"boolean"},migrate_personal_content:{type:"boolean"}}}}marshall(){this._props.migrate_resources_to_v5=this._props.migrate_resources_to_v5??!0,this._props.migrate_folders_to_v5=this._props.migrate_folders_to_v5??!1,this._props.migrate_tags_to_v5=this._props.migrate_tags_to_v5??!1,this._props.migrate_comments_to_v5=this._props.migrate_comments_to_v5??!1,this._props.migrate_personal_content=this._props.migrate_personal_content??!1}get migrateResources(){return!this._props.migrate_resources_to_v5}get migrateFolders(){return!this._props.migrate_folders_to_v5}get migrateTags(){return!this._props.migrate_tags_to_v5}get migrateComments(){return!this._props.migrate_comments_to_v5}get sharedContentOnly(){return!this._props.migrate_personal_content}},Cp=class extends xp{verifyHealth(e,t,a){if(void 0===e)return null;if(void 0===t)return null;if(void 0===a)return null;if(!(e instanceof Pd))throw new TypeError("The parameter 'resourceTypesCollection' is not a valid 'ResourceTypesCollection' type.");if(!(t instanceof ed))throw new TypeError("The parameter 'metadataTypesSettings' is not a valid 'MetadataTypesSettingsEntity' type.");if(!(a instanceof Wd))throw new TypeError("The parameter 'metadataKeysCollection' is not a valid 'MetadataKeysCollection' type.");let s=this._verifyGlobalHealth(a);return s=this._verifyMigrateResourcesToV5Health(s,e,t,a),s=this._verifyMigrateFoldersToV5Health(s,t,a),s=this._verifyMigrateTagsToV5Health(s,t,a),s=this._verifyMigrateCommentsToV5Health(s,t,a),s}_verifyGlobalHealth(e){if(e.items.filter((e=>!e.expired)).length>0)return null;const t=new $;return t.addError("global_form","active_metadata_key","No active metadata key defined."),t}_verifyMigrateResourcesToV5Health(e,t,a){this._props.migrate_resources_to_v5&&!a.allowCreationOfV5Resources&&(e=e||new $).addError("migrate_resources_to_v5","allow_creation_of_v5_resources","Resource types v5 creation is not allowed.");const s=t.hasSomeOfVersion(Qm);if(this._props.migrate_resources_to_v5&&!s)return(e=e||new $).addError("migrate_resources_to_v5","resource_types_v5_deleted","Resource types v5 are deleted."),e;const n=t.items.filter((e=>e.version===Zm)).every((e=>t.hasOneWithSlug(fd[e.slug])));return this._props.migrate_resources_to_v5&&!n&&(e=e||new $).addError("migrate_resources_to_v5","resource_types_v5_partially_deleted","Some resource types v5 are missing."),e}_verifyMigrateFoldersToV5Health(e,t){return this._props.migrate_folders_to_v5&&!t.allowV4V5Upgrade&&(e=e||new $).addError("migrate_folders_to_v5","allow_v4_v5_upgrade","Folders v5 creation is not allowed."),this._props.migrate_folders_to_v5&&!t.allowCreationOfV5Folders&&(e=e||new $).addError("migrate_folders_to_v5","allow_creation_of_v5_folders","Folders v5 creation is not allowed."),e}_verifyMigrateTagsToV5Health(e,t){return this._props.migrate_tags_to_v5&&!t.allowV4V5Upgrade&&(e=e||new $).addError("migrate_tags_to_v5","allow_v4_v5_upgrade","Tags v5 creation is not allowed."),this._props.migrate_tags_to_v5&&!t.allowCreationOfV5Folders&&(e=e||new $).addError("migrate_tags_to_v5","allow_creation_of_v5_tags","Tags v5 creation is not allowed."),e}_verifyMigrateCommentsToV5Health(e,t){return this._props.migrate_comments_to_v5&&!t.allowV4V5Upgrade&&(e=e||new $).addError("migrate_comments_to_v5","allow_v4_v5_upgrade","Comments v5 creation is not allowed."),this._props.migrate_comments_to_v5&&!t.allowCreationOfV5Folders&&(e=e||new $).addError("migrate_comments_to_v5","allow_creation_of_v5_comments","Comments v5 creation is not allowed."),e}},Sp=class extends re{static getSchema(){return{type:"object",required:["count","limit","page"],properties:{count:{type:"integer",minimum:0},limit:{type:"integer",minimum:0,nullable:!0},page:{type:"integer",minimum:0}}}}get count(){return this._props.count}get limit(){return this._props.limit}get page(){return this._props.page}get pageCount(){const e=parseInt(this._props.count,10),t=parseInt(this._props.limit,10);return Math.ceil(e/t)}},_p=class{constructor(e){this.port=e}async findCountMetadataMigrateResources(e=!1){const t=await this.port.request("passbolt.metadata.find-metadata-migrate-resources-details",e);return new Sp(t)}async migrate(e,t){await this.port.request("passbolt.metadata.migrate-resources-metadata",e,t)}};class Np extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{processing:!1}}bindCallbacks(){this.handleConfirm=this.handleConfirm.bind(this),this.handleCancel=this.handleCancel.bind(this)}async handleConfirm(e){e.preventDefault(),this.props.confirm(),this.props.onClose()}async handleCancel(){this.props.cancel(),this.props.onClose()}hasAllInputDisabled(){return this.state.processing}render(){const e=this.hasAllInputDisabled();return s.createElement(wt,{className:"confirm-migrate-metadata-dialog",title:this.props.t("Please confirm"),onClose:this.handleCancel,disabled:e},s.createElement("div",{className:"form-content"},s.createElement("p",null,s.createElement("strong",null,s.createElement(v.x6,null,"Are you sure you want to migrate the selected items to use encrypted metadata?"))),s.createElement("p",null,s.createElement(v.x6,null,"If you have integrations, you will have to make sure they are updated before triggering the migration.")),s.createElement("p",null,s.createElement(v.x6,null,"The operation may take a few minutes."))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("button",{type:"button",className:"link cancel",onClick:this.handleCancel,disabled:e},s.createElement(v.x6,null,"Cancel")),s.createElement("button",{type:"button",className:"button primary form",onClick:this.handleConfirm,disabled:e},s.createElement(v.x6,null,"Migrate"))))}}Np.propTypes={cancel:r().func,confirm:r().func,onClose:r().func,t:r().func};const Ip=(0,v.CI)("common")(Np);class Pp extends s.Component{formSettings=void 0;metadataTypesSettings=void 0;metadataKeys=void 0;migrationCountDetails=void 0;migrationCountDetailsShared=void 0;constructor(e){super(e),this.formSettings=new Cp({}),this.metadataSettingsServiceWorkerService=e.metadataSettingsServiceWorkerService??new Hd(e.context.port),this.metadataKeysServiceWorkerService=e.metadataKeysServiceWorkerService??new ip(e.context.port),this.metadataMigrateContentServiceWorkerService=e.metadataMigrateContentServiceWorkerService??new _p(e.context.port),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isReady:!1,isProcessing:!1,hasAlreadyBeenValidated:!1,hasMigrationRunOnce:!1,settings:this.formSettings.toDto()}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleMigrateScopeInputChange=this.handleMigrateScopeInputChange.bind(this),this.runMigration=this.runMigration.bind(this),this.askForMigrationConfirmation=this.askForMigrationConfirmation.bind(this)}async componentDidMount(){await this.initData()}async initData(){this.metadataTypesSettings=await this.metadataSettingsServiceWorkerService.findTypesSettings(),this.metadataKeys=await this.metadataKeysServiceWorkerService.findAll(),this.migrationCountDetailsShared=await this.metadataMigrateContentServiceWorkerService.findCountMetadataMigrateResources(!0),this.migrationCountDetails=await this.metadataMigrateContentServiceWorkerService.findCountMetadataMigrateResources(),this.setState({settings:this.formSettings.toDto(),isProcessing:!1,isReady:!0})}validateForm=(0,Jm.A)((e=>this.formSettings?.validate()));verifyDataHealth=(0,Jm.A)(((e,t,a,s)=>this.formSettings?.verifyHealth(t,a,s)));handleInputChange(e){if(this.hasAllInputDisabled())return;const{type:t,checked:a,value:s,name:n}=e.target,i="checkbox"===t?a:s;this.setFormPropertyValue(n,i)}handleMigrateScopeInputChange(e){const{value:t,name:a}=e.target;this.setFormPropertyValue(a,"all-content"===t)}setFormPropertyValue(e,t){this.formSettings.set(e,t,{validate:!1}),this.setState({settings:this.formSettings.toDto()})}hasAllInputDisabled(){return this.state.isProcessing}handleFormSubmit(e){e.preventDefault(),this.askForMigrationConfirmation()}get hasPendingMigration(){return this.hasPendingResourcesMigration||this.hasPendingFoldersMigration||this.hasPendingCommentsMigration||this.hasPendingTagsMigration}get totalResources(){return this.totalSharedResources+this.totalPersonalResources}get totalSharedResources(){return this.migrationCountDetailsShared?.count}get totalPersonalResources(){return this.migrationCountDetailsPersonal?.count}get migrationCountDetailsPersonal(){return{...this.migrationCountDetails,count:this.migrationCountDetails?.count-this.migrationCountDetailsShared?.count}}get hasPendingResourcesMigration(){return this.totalResources>0}get hasPendingFoldersMigration(){return this.totalFolders>0}get hasPendingTagsMigration(){return this.totalTags>0}get hasPendingCommentsMigration(){return this.totalComments>0}get migrationStatus(){return this.hasPendingMigration?this.state.hasMigrationRunOnce?this.props.t("Pending"):this.props.t("Required"):this.props.t("Done")}hasElementsToMigrate(){return this.totalResources>0}hasGlobalError(e){return e?.hasError("global_form")||!1}askForMigrationConfirmation(){this.props.dialogContext.open(Ip,{confirm:this.runMigration,cancel:()=>{}})}async runMigration(){if(this.state.isProcessing)return;const e=this.validateForm(this.state.settings),t=this.verifyDataHealth(this.state.settings,this.props.resourceTypes,this.metadataTypesSettings,this.metadataKeys);if(e?.hasErrors()||this.hasGlobalError(t))this.setState({hasAlreadyBeenValidated:!0});else{this.setState({isProcessing:!0});try{const e=this.formSettings.sharedContentOnly?this.migrationCountDetailsShared:this.migrationCountDetails;await this.metadataMigrateContentServiceWorkerService.migrate(this.formSettings.toDto(),e),await this.initData(),this.hasElementsToMigrate()?this.props.actionFeedbackContext.displayWarning(this.props.t("Encrypted metadata were partially migrated.")):this.props.actionFeedbackContext.displaySuccess(this.props.t("The encrypted metadata were migrated."))}catch(e){this.props.dialogContext.open(Pt,{error:e})}this.setState({hasAlreadyBeenValidated:!0,hasMigrationRunOnce:!0})}}render(){const e=this.verifyDataHealth(this.state.settings,this.props.resourceTypes,this.metadataTypesSettings,this.metadataKeys),t=this.hasGlobalError(e);return s.createElement("div",{className:"row"},s.createElement("div",{id:"migrate-metadata-settings",className:"main-column"},s.createElement("div",{className:"main-content"},s.createElement("form",{onSubmit:this.handleFormSubmit,"data-testid":"submit-form"},s.createElement("h3",{className:"title"},s.createElement("label",null,s.createElement(v.x6,null,"Migrate metadata"))),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"Initiate a migration to convert cleartext metadata to encrypted metadata.")),s.createElement("h4",null,s.createElement(v.x6,null,"Summary")),s.createElement("div",{className:"feedback-card"},this.state.isReady&&this.hasPendingMigration&&s.createElement(gn,{name:"warning"}),this.state.isReady&&!this.hasPendingMigration&&s.createElement(gn,{name:"success"}),s.createElement("div",{className:"migration-status-information"},s.createElement("ul",null,s.createElement("li",{className:"migration-status"},s.createElement("span",{className:"label"},s.createElement(v.x6,null,"Migration status")),s.createElement("span",{className:"value"},this.migrationStatus)),s.createElement("li",{className:"migration-resources-count"},s.createElement("span",{className:"label"},s.createElement(v.x6,null,"Resources")),s.createElement("span",{className:"value"},this.hasPendingResourcesMigration?s.createElement(s.Fragment,null,this.props.t("{{count}} to be migrated",{count:this.totalResources})," (",this.props.t("{{count}} shared resources",{count:this.totalSharedResources}),", ",this.props.t("{{count}} personal resources",{count:this.totalPersonalResources}),")"):s.createElement(v.x6,null,"All migrated")))))),s.createElement("h4",null,s.createElement(v.x6,null,"Items to migrate")),s.createElement("div",{className:"togglelist"},s.createElement("span",{className:`input toggle-switch form-element ${!t&&e?.hasError("migrate_resources_to_v5")&&"warning"}`},s.createElement("input",{id:"migrateResourcesInput",type:"checkbox",name:"migrate_resources_to_v5",className:"toggle-switch-checkbox checkbox",onChange:this.handleInputChange,checked:this.state.settings.migrate_resources_to_v5,disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"migrateResourcesInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Resources:")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Name, Username, URI, Cleartext description.")),!t&&e?.hasError("migrate_resources_to_v5")&&s.createElement("div",{className:"warning"},e?.hasError("migrate_resources_to_v5","allow_creation_of_v5_resources")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Resource types v5 creation is not allowed.")),e?.hasError("migrate_resources_to_v5","resource_types_v5_deleted")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Resources will not be migrated as no content types with encrypted metadata is allowed.")),e?.hasError("migrate_resources_to_v5","resource_types_v5_partially_deleted")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Not all resources will be migrated, some corresponding content types are not active.")))))),s.createElement("h4",null,s.createElement(v.x6,null,"Migration scope")),s.createElement("div",{className:"radiolist-alt"},s.createElement("div",{className:`input radio ${this.state.settings.migrate_personal_content&&"checked"}`},s.createElement("input",{type:"radio",value:"all-content",onChange:this.handleMigrateScopeInputChange,name:"migrate_personal_content",checked:this.state.settings.migrate_personal_content,id:"migrateScopeAllContentInput",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"migrateScopeAllContentInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"All content")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"All resources including the private ones.")))),s.createElement("div",{className:`input radio ${!this.state.settings.migrate_personal_content&&"checked"}`},s.createElement("input",{type:"radio",value:"shared-only",onChange:this.handleMigrateScopeInputChange,name:"migrate_personal_content",checked:!this.state.settings.migrate_personal_content,id:"migrateScopeSharedContentInput",disabled:this.hasAllInputDisabled()}),s.createElement("label",{htmlFor:"migrateScopeSharedContentInput"},s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Shared content only")),s.createElement("span",{className:"info"},s.createElement(v.x6,null,"Only shared resources are migrated."))))))),t&&this.hasPendingMigration&&s.createElement("div",{className:"error message"},s.createElement("div",null,s.createElement(v.x6,null,"No active metadata keys available."))),!t&&this.hasPendingMigration&&s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement(v.x6,null,s.createElement("b",null,"Warning:")," If you have integrations, you will have to make sure they are updated before triggering the migration.")))),s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary",disabled:this.state.isProcessing||t,onClick:this.handleFormSubmit},s.createElement("span",null,s.createElement(v.x6,null,"Migrate")))),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the content type support and migration, checkout the dedicated page on the official website.")),s.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://passbolt.com/docs"},s.createElement(vt,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}Pp.propTypes={context:r().object,actionFeedbackContext:r().object,dialogContext:r().object,createPortal:r().func,metadataSettingsServiceWorkerService:r().object,metadataKeysServiceWorkerService:r().object,metadataMigrateContentServiceWorkerService:r().object,resourceTypes:r().instanceOf(Pd),t:r().func};const Ap=I(d(g(ep(g((0,v.CI)("common")(Pp)))))),Tp={passwordV4:[ad,sd],totpV4:[id],passwordV5:[rd,od],totpV5:[cd]},Rp={passwordV4:[ad,sd,nd],totpV4:[id,nd],passwordV5:[rd,od,ld],totpV5:[cd,ld]};class Dp extends re{constructor(e,t){super(e,t),this._props.resource_types&&(this._resource_types=new Pd(this._props.resource_types))}static getSchema(){return{type:"object",required:["password_v4","password_v5","totp_v4","totp_v5","password_v4_count","password_v5_count","totp_v4_count","totp_v5_count","resource_types","has_v4_resource_types","has_v5_resource_types"],properties:{password_v4:{type:"boolean"},password_v5:{type:"boolean"},totp_v4:{type:"boolean"},totp_v5:{type:"boolean"},password_v4_count:{type:"integer"},password_v5_count:{type:"integer"},totp_v4_count:{type:"integer"},totp_v5_count:{type:"integer"},has_v4_resource_types:{type:"boolean"},has_v5_resource_types:{type:"boolean"},resource_types:Pd.getSchema()}}}static createFormResourcesTypesCollection(e){if(!(e instanceof Pd))throw new TypeError("The parameter 'resource_types' is not a valid 'ResourceTypesCollection' type.");const t=e.items.filter((e=>!e.isDeleted())),a=new Pd(t),s=this._areAllResourceTypesAvailable(Tp.passwordV4,a),n=this._areAllResourceTypesAvailable(Tp.passwordV5,a),i=this._areAllResourceTypesAvailable(Tp.totpV4,a),r=this._areAllResourceTypesAvailable(Tp.totpV5,a),o=this._getResourcesCountForResourceTypeFamily(Rp.passwordV4,e),l=this._getResourcesCountForResourceTypeFamily(Rp.passwordV5,e),c=this._getResourcesCountForResourceTypeFamily(Rp.totpV4,e),m=this._getResourcesCountForResourceTypeFamily(Rp.totpV5,e),d=e.hasSomeOfVersion("v4"),p=e.hasSomeOfVersion("v5");return new Dp({password_v4:s,password_v5:n,totp_v4:i,totp_v5:r,password_v4_count:o,password_v5_count:l,totp_v4_count:c,totp_v5_count:m,has_v4_resource_types:d,has_v5_resource_types:p,resource_types:e})}static _getResourcesCountForResourceTypeFamily(e,t){let a=0;for(let s=0;s<e.length;s++)a+=t.getFirstBySlug(e[s])?.resourcesCount||0;return a}static _areAllResourceTypesAvailable(e,t){return e.every((e=>t.hasOneWithSlug(e)))}validateBuildRules(){let e=null;if(!this._props.password_v4&&this._props.password_v4_count>0&&(e=e||new $,e.addError("password_v4","has_content","One (or more) resource type v4 having a password is deleted but its resources_count is not 0.")),!this._props.totp_v4&&this._props.totp_v4_count>0&&(e=e||new $,e.addError("totp_v4","has_content","One (or more) resource type v4 having a totp is deleted but its resources_count is not 0.")),!this._props.password_v5&&this._props.password_v5_count>0&&(e=e||new $,e.addError("password_v5","has_content","One (or more) resource type v5 having a password is deleted but its resources_count is not 0.")),!this._props.totp_v5&&this._props.totp_v5_count>0&&(e=e||new $,e.addError("totp_v5","has_content","One (or more) resource type v5 having a totp is deleted but its resources_count is not 0.")),!(this._props.password_v4||this._props.totp_v4||this._props.password_v5||this._props.totp_v5)){const t="At least one content type should be allowed",a="minimum_requirement";e=e||new $,e.addError("password_v4",a,t),e.addError("totp_v4",a,t),e.addError("password_v5",a,t),e.addError("totp_v5",a,t)}if(e)throw e}verifyHealth(e,t){if(void 0===e)return null;if(void 0===t)return null;if(!(e instanceof ed))throw new TypeError("The parameter 'metadataTypesSettings' is not a valid 'MetadataTypesSettingsEntity' type.");if(!(t instanceof Wd))throw new TypeError("The parameter 'metadataKeysCollection' is not a valid 'MetadataKeysCollection' type.");let a=null;!e.allowCreationOfV4Resources||this._props.password_v4||this._props.totp_v4||(a=new $,a.addError("password_v4","is_creation_alowed","Creation of resource type v4 is allowed but all resource types having passwords are deleted."),a.addError("totp_v4","is_creation_alowed","Creation of resource type v4 is allowed but all resource types having totps are deleted.")),!e.allowCreationOfV4Resources&&this._props.password_v4&&(a=a||new $,a.addError("password_v4","is_creation_not_alowed","Creation of resource type v4 is not allowed.")),!e.allowCreationOfV4Resources&&this._props.totp_v4&&(a=a||new $,a.addError("totp_v4","is_creation_not_alowed","Creation of resource type v4 is not allowed.")),!e.allowCreationOfV5Resources||this._props.password_v5||this._props.totp_v5||(a=a||new $,a.addError("password_v5","is_creation_alowed","Creation of resource type v5 is allowed but all resource types having passwords are deleted."),a.addError("totp_v5","is_creation_alowed","Creation of resource type v5 is allowed but all resource types having totps are deleted.")),!e.allowCreationOfV5Resources&&this._props.password_v5&&(a=a||new $,a.addError("password_v5","is_creation_not_alowed","Creation of resource type v5 is not allowed.")),!e.allowCreationOfV5Resources&&this._props.totp_v5&&(a=a||new $,a.addError("totp_v5","is_creation_not_alowed","Creation of resource type v5 is not allowed."));const s=t.items.filter((e=>!e.expired));return 0===s.length&&this._props.password_v5&&(a=a||new $,a.addError("password_v5","active_metadata_key","No active metadata key defined.")),0===s.length&&this._props.totp_v5&&(a=a||new $,a.addError("totp_v5","active_metadata_key","No active metadata key defined.")),a}toFormDto(){return{password_v4:this._props.password_v4,password_v5:this._props.password_v5,totp_v4:this._props.totp_v4,totp_v5:this._props.totp_v5,password_v4_count:this._props.password_v4_count,password_v5_count:this._props.password_v5_count,totp_v4_count:this._props.totp_v4_count,totp_v5_count:this._props.totp_v5_count,has_v4_resource_types:this._props.has_v4_resource_types,has_v5_resource_types:this._props.has_v5_resource_types,resource_types:this._resource_types}}toResourceTypesCollection(){const e=this._resource_types.items.filter((e=>this._props.password_v4&&e.isV4()&&e.hasPassword()&&!e.hasTotp()||this._props.totp_v4&&e.isV4()&&!e.hasPassword()&&e.hasTotp()||this._props.totp_v4&&this._props.password_v4&&e.isV4()&&e.hasPassword()&&e.hasTotp()||this._props.password_v5&&e.isV5()&&e.hasPassword()&&!e.hasTotp()||this._props.totp_v5&&e.isV5()&&!e.hasPassword()&&e.hasTotp()||this._props.totp_v5&&this._props.password_v5&&e.isV5()&&e.hasPassword()&&e.hasTotp())),t=this._resource_types.items.filter((t=>!e.some((e=>t.id===e.id)))),a=e.filter((e=>e.isDeleted())),s=t.filter((e=>!e.isDeleted())),n=Hs.c9.now().toISO();for(let e=0;e<s.length;e++)s[e].deleted=n;for(let e=0;e<a.length;e++)a[e].deleted=null;return new Pd([...a,...s])}}const Op=Dp,Up=class{constructor(e){this.port=e}async findAllByDeletedAndNonDeleted(){const e=await this.port.request("passbolt.resource-type.find-all-by-deleted-and-non-deleted");return new Pd(e)}async updateAllDeletedStatus(e){await this.port.request("passbolt.resource-types.update-all-deleted-status",e)}};var Mp;function Fp(){return Fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Fp.apply(null,arguments)}const jp=function(e){return s.createElement("svg",Fp({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",viewBox:"0 0 17 16"},e),Mp||(Mp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"var(--icon-stroke-width, 1.5)",d:"M4.682 14.87a3.412 3.412 0 1 0 0-6.823 3.412 3.412 0 0 0 0 6.824M14.77 1.37 7.093 9.047M13.496 5.761l1.969-1.958"})))};var zp,Lp;function qp(){return qp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},qp.apply(null,arguments)}const Kp=function(e){return s.createElement("svg",qp({xmlns:"http://www.w3.org/2000/svg",width:16,height:20,fill:"none",viewBox:"0 0 16 20"},e),zp||(zp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"var(--icon-stroke-width, 1.5)",d:"M8 19A6.291 6.291 0 1 0 8 6.418 6.291 6.291 0 0 0 8 19"})),Lp||(Lp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"var(--icon-stroke-width, 1.5)",d:"M8 8.93v3.78l2.524 1.255M4.005 7.781V5.007a4.007 4.007 0 0 1 8.014 0V7.78"})))};class Wp extends s.Component{originalSettings=null;formSettings=null;metadataTypesSettings=void 0;metadataKeys=void 0;constructor(e){super(e),this.resourceTypesServiceWorkerService=e.resourceTypesServiceWorkerService??new Up(e.context.port),this.metadataSettingsServiceWorkerService=e.metadataSettingsServiceWorkerService??new Hd(e.context.port),this.metadataKeysServiceWorkerService=e.metadataKeysServiceWorkerService??new ip(e.context.port),this.state=this.defaultState,this.bindCallbacks()}get defaultState(){return{isProcessing:!0,hasAlreadyBeenValidated:!1,settings:{password_v4:!1,password_v5:!1,totp_v4:!1,totp_v5:!1,password_v4_count:0,password_v5_count:0,totp_v4_count:0,totp_v5_count:0,has_password_v4:!1,has_totp_v4:!1,has_password_v5:!1,has_totp_v5:!1,has_v4_resource_types:!1,has_v5_resource_types:!1}}}bindCallbacks(){this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.save=this.save.bind(this)}async componentDidMount(){const e=await this.resourceTypesServiceWorkerService.findAllByDeletedAndNonDeleted();this.metadataTypesSettings=await this.metadataSettingsServiceWorkerService.findTypesSettings(),this.metadataKeys=await this.metadataKeysServiceWorkerService.findAll(),this.originalSettings=Op.createFormResourcesTypesCollection(e),this.formSettings=new Op(this.originalSettings.toFormDto(),{validate:!1}),this.setState({settings:this.formSettings.toFormDto(),isProcessing:!1})}validateForm=(0,Jm.A)((e=>this.formSettings?.validate()));verifyDataHealth=(0,Jm.A)(((e,t,a)=>this.formSettings?.verifyHealth(t,a)));hasSettingsChanges=(0,Jm.A)(((e,t,a)=>this.originalSettings?.hasDiffProps(this.formSettings)));handleInputChange(e){if(this.hasAllInputDisabled())return;const{type:t,checked:a,value:s,name:n}=e.target,i="checkbox"===t?a:s;this.setFormPropertyValue(n,i)}setFormPropertyValue(e,t){this.formSettings.set(e,t,{validate:!1}),this.setState({settings:this.formSettings.toFormDto()})}hasAllInputDisabled(){return this.state.isProcessing}handleFormSubmit(e){e.preventDefault(),this.save()}isInputDisabled(e,t){return this.hasAllInputDisabled()||e>0&&t}async save(){if(this.state.isProcessing)return;const e=this.validateForm(this.state.settings);if(e?.hasErrors())this.setState({hasAlreadyBeenValidated:!0});else{this.setState({isProcessing:!0});try{const e=this.formSettings.toResourceTypesCollection();await this.resourceTypesServiceWorkerService.updateAllDeletedStatus(e);const t=await this.resourceTypesServiceWorkerService.findAllByDeletedAndNonDeleted();this.originalSettings=Op.createFormResourcesTypesCollection(t),this.formSettings=new Op(this.originalSettings.toFormDto()),await this.props.actionFeedbackContext.displaySuccess(this.props.t("The allowed content types were updated."))}catch(e){console.error(e),this.props.dialogContext.open(Pt,{error:e})}this.setState({hasAlreadyBeenValidated:!0,isProcessing:!1,settings:this.formSettings.toFormDto()})}}addTooltipOnDisabledElement(e,t){return t?s.createElement(bt,{message:"You cannot disable a content type that is in use.",direction:"right"},e):s.createElement(s.Fragment,null,e)}render(){const e=this.state.hasAlreadyBeenValidated?this.validateForm(this.state.settings):null,t=this.verifyDataHealth(this.state.settings,this.metadataTypesSettings,this.metadataKeys),a=this.hasSettingsChanges(this.originalSettings,this.formSettings,this.state.settings);return s.createElement("div",{className:"row"},s.createElement("div",{id:"allow-content-types",className:"main-column"},s.createElement("div",{className:"main-content"},s.createElement("form",{onSubmit:this.handleFormSubmit,"data-testid":"submit-form"},s.createElement("h3",{className:"title"},s.createElement("label",null,s.createElement(v.x6,null,"Allow content types"))),this.state.settings.has_v5_resource_types&&s.createElement(s.Fragment,null,s.createElement("h4",{className:"no-border"},s.createElement(v.x6,null,"Encrypted metadata")),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"Select which content type with encrypted metadata is available for your whole organisation.")),s.createElement("div",{className:"checkboxlist"},s.createElement("span",{className:`input checkbox form-element ${e?.hasError("password_v5")&&"error"} ${!e?.hasError("password_v5")&&t?.hasError("password_v5")&&"warning"}`},s.createElement("input",{type:"checkbox",id:"passwordV5Input",className:"checkbox",name:"password_v5",onChange:this.handleInputChange,checked:this.state.settings.password_v5,disabled:this.isInputDisabled(this.state.settings.password_v5_count,this.state.settings.password_v5)}),s.createElement("label",{htmlFor:"passwordV5Input"},this.addTooltipOnDisabledElement(s.createElement("div",{className:"allow-content-type-item"},s.createElement(jp,null),s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Password")),s.createElement("span",{className:"info"},this.props.t("({{count}} resources)",{count:this.state.settings.password_v5_count}))),this.isInputDisabled(this.state.settings.password_v5_count,this.state.settings.password_v5)),e?.hasError("password_v5","has_content")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"One (or more) content type v5 having a password is deleted but its resources count is not 0.")),e?.hasError("password_v5","minimum_requirement")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"At least one content type should be allowed")),!e?.hasError("password_v5")&&s.createElement(s.Fragment,null,t?.hasError("password_v5","is_creation_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v5 is allowed but all content types having passwords are deleted.")),t?.hasError("password_v5","active_metadata_key")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"No active metadata key defined.")),t?.hasError("password_v5","is_creation_not_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v5 is not allowed."))))),s.createElement("span",{className:`input checkbox form-element ${e?.hasError("totp_v5")&&"error"} ${!e?.hasError("totp_v5")&&t?.hasError("totp_v5")&&"warning"}`},s.createElement("input",{type:"checkbox",id:"totpV5Input",className:"checkbox",name:"totp_v5",onChange:this.handleInputChange,checked:this.state.settings.totp_v5,disabled:this.isInputDisabled(this.state.settings.totp_v5_count,this.state.settings.totp_v5)}),s.createElement("label",{htmlFor:"totpV5Input"},this.addTooltipOnDisabledElement(s.createElement("div",{className:"allow-content-type-item"},s.createElement(Kp,null),s.createElement("span",{className:"name"},s.createElement(v.x6,null,"TOTP")),s.createElement("span",{className:"info"},this.props.t("({{count}} resources)",{count:this.state.settings.totp_v5_count}))),this.isInputDisabled(this.state.settings.totp_v5_count,this.state.settings.totp_v5)),e?.hasError("totp_v5","has_content")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"One (or more) content type v5 having a totp is deleted but its resources count is not 0.")),e?.hasError("totp_v5","minimum_requirement")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"At least one content type should be allowed")),!e?.hasError("totp_v5")&&s.createElement(s.Fragment,null,t?.hasError("totp_v5","is_creation_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v5 is allowed but all content types having totp are deleted.")),t?.hasError("totp_v5","active_metadata_key")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"No active metadata key defined.")),t?.hasError("totp_v5","is_creation_not_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v5 is not allowed."))))))),this.state.settings.has_v4_resource_types&&s.createElement(s.Fragment,null,s.createElement("h4",{className:`${!this.state.settings.has_password_v5&&"no-border"}`},s.createElement(v.x6,null,"Legacy cleartext metadata")),s.createElement("p",{className:"description"},s.createElement(v.x6,null,"Select which content type with cleartext metadata is available for your whole organisation.")),s.createElement("div",{className:"checkboxlist"},s.createElement("span",{className:`input checkbox form-element ${e?.hasError("password_v4")&&"error"} ${!e?.hasError("password_v4")&&t?.hasError("password_v4")&&"warning"}`},s.createElement("input",{type:"checkbox",id:"passwordV4Input",className:"checkbox",name:"password_v4",onChange:this.handleInputChange,checked:this.state.settings.password_v4,disabled:this.isInputDisabled(this.state.settings.password_v4_count,this.state.settings.password_v4)}),s.createElement("label",{htmlFor:"passwordV4Input"},this.addTooltipOnDisabledElement(s.createElement("div",{className:"allow-content-type-item"},s.createElement(jp,null),s.createElement("span",{className:"name"},s.createElement(v.x6,null,"Password")),s.createElement("span",{className:"info"},this.props.t("({{count}} resources)",{count:this.state.settings.password_v4_count}))),this.isInputDisabled(this.state.settings.password_v4_count,this.state.settings.password_v4)),e?.hasError("password_v4","has_content")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"One (or more) content type v4 having a password is deleted but its resources count is not 0.")),e?.hasError("password_v4","minimum_requirement")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"At least one content type should be allowed")),!e?.hasError("password_v4")&&s.createElement(s.Fragment,null,t?.hasError("password_v4","is_creation_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v4 is allowed but all content types having passwords are deleted.")),t?.hasError("password_v4","is_creation_not_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v4 is not allowed."))))),s.createElement("span",{className:`input checkbox form-element ${e?.hasError("totp_v4")&&"error"} ${!e?.hasError("totp_v4")&&t?.hasError("totp_v4")&&"warning"}`},s.createElement("input",{type:"checkbox",id:"totpV4Input",className:"checkbox",name:"totp_v4",onChange:this.handleInputChange,checked:this.state.settings.totp_v4,disabled:this.isInputDisabled(this.state.settings.totp_v4_count,this.state.settings.totp_v4)}),s.createElement("label",{htmlFor:"totpV4Input"},this.addTooltipOnDisabledElement(s.createElement("div",{className:"allow-content-type-item"},s.createElement(Kp,null),s.createElement("span",{className:"name"},s.createElement(v.x6,null,"TOTP")),s.createElement("span",{className:"info"},this.props.t("({{count}} resources)",{count:this.state.settings.totp_v4_count}))),this.isInputDisabled(this.state.settings.totp_v4_count,this.state.settings.totp_v4)),e?.hasError("totp_v4","has_content")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"One (or more) content type v4 having a totp is deleted but its resources count is not 0.")),e?.hasError("totp_v4","minimum_requirement")&&s.createElement("div",{className:"error-message"},s.createElement(v.x6,null,"At least one content type should be allowed")),!e?.hasError("totp_v4")&&s.createElement(s.Fragment,null,t?.hasError("totp_v4","is_creation_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v4 is allowed but all content types having totp are deleted.")),t?.hasError("totp_v4","is_creation_not_alowed")&&s.createElement("div",{className:"warning-message"},s.createElement(v.x6,null,"Creation of content type v4 is not allowed."))))))))),a&&s.createElement("div",{className:"warning message"},s.createElement("div",null,s.createElement("p",null,s.createElement(v.x6,null,s.createElement("b",null,"Warning:")," Don't forget to save your settings to apply your modification."))))),s.createElement("div",{className:"actions-wrapper"},s.createElement("button",{type:"button",className:"button primary",disabled:this.state.isProcessing,onClick:this.handleFormSubmit},s.createElement("span",null,s.createElement(v.x6,null,"Save")))),Ea(s.createElement("div",{className:"sidebar-help-section"},s.createElement("h3",null,s.createElement(v.x6,null,"Need help?")),s.createElement("p",null,s.createElement(v.x6,null,"For more information about the content type support and migration, checkout the dedicated page on the official website.")),s.createElement("a",{className:"button",target:"_blank",rel:"noopener noreferrer",href:"https://passbolt.com/docs"},s.createElement(vt,null),s.createElement("span",null,s.createElement(v.x6,null,"Read the documentation")))),document.getElementById("administration-help-panel")))}}Wp.propTypes={context:r().object,dialogContext:r().object,actionFeedbackContext:r().object,createPortal:r().func,resourceTypesServiceWorkerService:r().object,metadataKeysServiceWorkerService:r().object,metadataSettingsServiceWorkerService:r().object,t:r().func};const Vp=I(d(g((0,v.CI)("common")(Wp))));class Bp extends s.PureComponent{render(){return s.createElement("button",{type:"button",className:"button-transparent card",onClick:this.props.onClick},this.props.icon,s.createElement("div",{className:"card-information"},s.createElement("span",{className:`title ${this.props.isBeta&&"is-beta"}`,title:this.props.title},this.props.title,this.props.isBeta&&s.createElement("span",{className:"chips beta"},"beta")),this.props.description&&s.createElement("span",{className:"info",title:this.props.description},this.props.description)))}}Bp.defaultProps={isBeta:!1},Bp.propTypes={icon:r().object.isRequired,title:r().string.isRequired,description:r().string,isBeta:r().bool.isRequired,onClick:r().func};const Gp=Bp;var $p;function Hp(){return Hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Hp.apply(null,arguments)}const Yp=function(e){return s.createElement("svg",Hp({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),$p||($p=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M42 28V12a4 4 0 0 0-4-4H10a4 4 0 0 0-4 4v28a4 4 0 0 0 4 4h16M32 4v8M16 4v8M6 20h36M32 40l4 4 8-8"})))};var Jp,Zp,Qp;function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Xp.apply(null,arguments)}const eu=function(e){return s.createElement("svg",Xp({xmlns:"http://www.w3.org/2000/svg",width:49,height:48,fill:"none",viewBox:"0 0 49 48"},e),Jp||(Jp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M42.597 12h-36M22.455 24H6.597M22.455 36H6.597"})),Zp||(Zp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinejoin:"round",strokeWidth:2,d:"M41.532 27.608H29.734c-.588 0-1.065.477-1.065 1.065v8.334c0 .588.477 1.065 1.065 1.065h11.798c.588 0 1.065-.477 1.065-1.065v-8.334c0-.588-.477-1.065-1.065-1.065Z"})),Qp||(Qp=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M30.884 27.608v-4.103a4.756 4.756 0 0 1 9.512 0v4.103"})))};var tu;function au(){return au=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},au.apply(null,arguments)}const su=function(e){return s.createElement("svg",au({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),tu||(tu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.75 14.25h4.5M6.75 11.25V9h-3L9 3.75 14.25 9h-3v2.25z"})))};var nu;function iu(){return iu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},iu.apply(null,arguments)}const ru=function(e){return s.createElement("svg",iu({xmlns:"http://www.w3.org/2000/svg",width:49,height:48,fill:"none",viewBox:"0 0 49 48"},e),nu||(nu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.197 20a1.4 1.4 0 0 1-1.252-2.158L23.397 6a1.4 1.4 0 0 1 2.396-.086L33.197 17.8a1.4 1.4 0 0 1-1.144 2.2zM18.597 28h-10a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V30a2 2 0 0 0-2-2M35.597 42a7 7 0 1 0 0-14 7 7 0 0 0 0 14"})))};var ou,lu;function cu(){return cu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},cu.apply(null,arguments)}const mu=function(e){return s.createElement("svg",cu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),ou||(ou=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 44h28a4 4 0 0 0 4-4V14L30 4H12a4 4 0 0 0-4 4v12"})),lu||(lu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M28 4v8a4 4 0 0 0 4 4h8M8 36a4 4 0 1 0 0-8 4 4 0 0 0 0 8M20 20l-9 9M18 22l2 2"})))};var du,pu;function uu(){return uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},uu.apply(null,arguments)}const hu=function(e){return s.createElement("svg",uu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),du||(du=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 4h8M24 28v-8M8 26a16 16 0 0 1 16-14 16.001 16.001 0 0 1 3.834 31.53A16 16 0 0 1 13.4 40L8 35.2"})),pu||(pu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 34H8v10"})))};var gu,bu;function yu(){return yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},yu.apply(null,arguments)}const fu=function(e){return s.createElement("svg",yu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),gu||(gu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.983 31.17v5.273c0 1.054.703 1.757 1.758 1.757h7.03v-5.272h5.272v-5.273h3.515l2.46-2.46a11.423 11.423 0 1 0-7.03-7.03z"})),bu||(bu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M28.466 13.595a.879.879 0 1 0 0-1.757.879.879 0 0 0 0 1.757M36 45a6 6 0 1 0 0-12 6 6 0 0 0 0 12M43.4 41.8l-1.8-.6M30.4 36.8l-1.8-.6M33.2 46.4l.6-1.8M38.2 33.4l.6-1.8M39.2 46.4l-.8-2M33.6 33.6l-.8-2M28.6 42.2l2-.8M41.4 36.6l2-.8"})))};var vu;function Eu(){return Eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Eu.apply(null,arguments)}const wu=function(e){return s.createElement("svg",Eu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),vu||(vu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.32 7.075h1.44a4.32 4.32 0 0 1 4.32 4.32 4.32 4.32 0 0 1 4.32-4.32h1.44M19.84 30.115H18.4a4.32 4.32 0 0 1-4.32-4.32 4.32 4.32 0 0 1-4.32 4.32H8.32M8.32 24.355H6.88A2.88 2.88 0 0 1 4 21.475v-5.76a2.88 2.88 0 0 1 2.88-2.88h1.44M19.84 12.835h23.107a2.88 2.88 0 0 1 2.88 2.88v5.76a2.88 2.88 0 0 1-2.88 2.88H19.84M14.08 11.395v14.4M36 44.878a6 6 0 1 0 0-12 6 6 0 0 0 0 12M43.4 41.677l-1.8-.6M30.4 36.677l-1.8-.6M33.2 46.278l.6-1.8M38.2 33.278l.6-1.8M39.2 46.277l-.8-2M33.6 33.478l-.8-2M28.6 42.077l2-.8M41.4 36.478l2-.8"})))};var ku,xu;function Cu(){return Cu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Cu.apply(null,arguments)}const Su=function(e){return s.createElement("svg",Cu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),ku||(ku=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20M9.86 9.86l8.48 8.48M29.66 18.34l8.48-8.48M29.66 29.66l8.48 8.48M18.34 29.66l-8.48 8.48"})),xu||(xu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M24 32a8 8 0 1 0 0-16 8 8 0 0 0 0 16"})))};var _u;function Nu(){return Nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Nu.apply(null,arguments)}const Iu=function(e){return s.createElement("svg",Nu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),_u||(_u=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M30 6h8a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4h-8M20 34l10-10-10-10M30 24H6"})))};var Pu,Au;function Tu(){return Tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Tu.apply(null,arguments)}const Ru=function(e){return s.createElement("svg",Tu({xmlns:"http://www.w3.org/2000/svg",width:49,height:48,fill:"none",viewBox:"0 0 49 48"},e),Pu||(Pu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.597 24c0-11 9-20 20-20a20 20 0 0 1 16 8"})),Au||(Au=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.597 39c1-3 2-9 2-15 0-1.4.24-2.74.68-4M35.177 42.04c.24-1.2.86-4.6 1-6.04M24.597 20a4 4 0 0 0-4 4c0 2.04-.2 5.02-.52 8M17.897 44c.42-1.32.9-2.64 1.14-4M28.597 26.24c0 4.76 0 12.76-2 17.76M4.597 32h.02M44.197 32c.4-4 .262-10.708 0-12M18.597 13.6a12 12 0 0 1 18 10.4c0 .94 0 2.34-.04 4"})))};var Du,Ou;function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Uu.apply(null,arguments)}const Mu=function(e){return s.createElement("svg",Uu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),Du||(Du=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M36 45a6 6 0 1 0 0-12 6 6 0 0 0 0 12M43.4 41.8l-1.8-.6M30.4 36.8l-1.8-.6M33.2 46.4l.6-1.8M38.2 33.4l.6-1.8M39.2 46.4l-.8-2M33.6 33.6l-.8-2M28.6 42.2l2-.8M41.4 36.6l2-.8M4 24C4 13 13 4 24 4a20 20 0 0 1 16 8"})),Ou||(Ou=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 39c1-3 2-9 2-15 0-1.4.24-2.74.68-4M24 20a4 4 0 0 0-4 4c0 2.04-.2 5.02-.52 8M17.3 44c.42-1.32.9-2.64 1.14-4M28 26.24c0 .877 0 1.864-.012 2.922M4 32h.02M43.6 20c.141.697.246 2.967.25 5.539M18 13.6A12 12 0 0 1 36 24"})))};var Fu;function ju(){return ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ju.apply(null,arguments)}const zu=function(e){return s.createElement("svg",ju({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),Fu||(Fu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M26 8h6a4 4 0 0 1 4 4v28M4 40h6M26 40h18M20 24v.02M26 9.124v32.314a2 2 0 0 1-2.484 1.94L10 40V11.124a4 4 0 0 1 3.03-3.88l8-2A4 4 0 0 1 26 9.124"})))};var Lu,qu,Ku,Wu;function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Vu.apply(null,arguments)}const Bu=function(e){return s.createElement("svg",Vu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),Lu||(Lu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 40H8a4 4 0 0 1-4-4V10a4 4 0 0 1 4-4h7.8a4 4 0 0 1 3.38 1.8l1.62 2.4a4 4 0 0 0 3.34 1.8H40a4 4 0 0 1 4 4v2"})),qu||(qu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M24 20v8h8"})),Ku||(Ku=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m24 28 3-3c1.8-1.8 4.4-3 7-3s5.2 1.2 7 3c.8.8 1.6 2 2 3M44 44v-8h-8"})),Wu||(Wu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m44 36-3 3c-1.8 1.8-4.2 3-7 3s-5.2-1.2-7-3c-.8-.8-1.6-2-2-3"})))};var Gu,$u;function Hu(){return Hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Hu.apply(null,arguments)}const Yu=function(e){return s.createElement("svg",Hu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),Gu||(Gu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M44 34a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V19c0-5 4-9 9-9h23c4.4 0 8 3.6 8 8z"})),$u||($u=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M30 18h6v4M13 10c5 0 9 4 9 9v15a4 4 0 0 1-4 4M12 20h2"})))};var Ju,Zu;function Qu(){return Qu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Qu.apply(null,arguments)}const Xu=function(e){return s.createElement("svg",Qu({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),Ju||(Ju=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.76 19.76a6 6 0 1 0 8.48 8.48M21.46 10.16q1.265-.157 2.54-.16c14 0 20 14 20 14a26.3 26.3 0 0 1-3.34 5.36"})),Zu||(Zu=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.22 13.22A27.05 27.05 0 0 0 4 24s6 14 20 14a19.5 19.5 0 0 0 10.78-3.22M4 4l40 40"})))};var eh;function th(){return th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},th.apply(null,arguments)}const ah=function(e){return s.createElement("svg",th({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),eh||(eh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m10 16 12 12M8 28l12-12 4-6M4 10h24M14 4h2M44 44 34 24 24 44M28 36h12"})))};var sh,nh;function ih(){return ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ih.apply(null,arguments)}const rh=function(e){return s.createElement("svg",ih({xmlns:"http://www.w3.org/2000/svg",width:49,height:48,fill:"none",viewBox:"0 0 49 48"},e),sh||(sh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M38.597 28c2.98-2.92 6-6.42 6-11a11 11 0 0 0-11-11c-3.52 0-6 1-9 4-3-3-5.48-4-9-4a11 11 0 0 0-11 11c0 4.6 3 8.1 6 11l14 14z"})),nh||(nh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7.037 24h12.56l1-2 4 9 4-14 3 7h10.54"})))};var oh,lh;function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ch.apply(null,arguments)}const mh=function(e){return s.createElement("svg",ch({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48"},e),oh||(oh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M44 21v-9a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v24c0 2.2 1.8 4 4 4h25"})),lh||(lh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M44 14 26.06 25.4a3.88 3.88 0 0 1-4.12 0L4 14M40 28v8M40 44v.02"})))};class dh extends s.PureComponent{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleClickOn=this.handleClickOn.bind(this),this.isFlagEnabled=this.isFlagEnabled.bind(this)}handleClickOn(e){e.redirectTo()}get cardItemsData(){return[{icon:s.createElement(Yp,null),title:this.props.t("Subscription"),description:this.props.t("Browse and update the subscription key details."),redirectTo:this.props.navigationContext.onGoToAdministrationSubscriptionRequested,flag:we.SUBSCRIPTION},{icon:s.createElement(eu,null),title:this.props.t("Encrypted metadata"),description:this.props.t("Choose between cleartext metadata and encrypted metadata."),redirectTo:this.props.navigationContext.onGoToAdministrationContentTypesEncryptedMetadataRequested,flag:we.CONTENT_TYPES_ENCRYPTED_METADATA,isBeta:!0},{icon:s.createElement(su,null),title:this.props.t("Migrate metadata"),description:this.props.t("Convert cleartext metadata into encrypted metadata."),redirectTo:this.props.navigationContext.onGoToAdministrationMigrateMetadataRequested,flag:we.MIGRATE_METADATA,isBeta:!0},{icon:s.createElement(ru,null),title:this.props.t("Allow content types"),description:this.props.t("Control the content types availability for all users."),redirectTo:this.props.navigationContext.onGoToAdministrationAllowContentTypesRequested,flag:we.ALLOW_CONTENT_TYPES,isBeta:!0},{icon:s.createElement(mu,null),title:this.props.t("Metadata key"),description:this.props.t("Control the layer of encryption that is used to protect metadata."),redirectTo:this.props.navigationContext.onGoToAdministrationContentTypesMetadataKeyRequested,flag:we.CONTENT_TYPES_METADATA_KEY,isBeta:!0},{icon:s.createElement(hu,null),title:this.props.t("Password expiry"),description:this.props.t("Control the default behaviour of password expiry policy for all users."),redirectTo:this.props.navigationContext.onGoToAdministrationPasswordExpirySettingsRequested,flag:we.PASSWORD_EXPIRY},{icon:s.createElement(fu,null),title:this.props.t("Password policy"),description:this.props.t("Modify the default settings of the passwords generator."),redirectTo:this.props.navigationContext.onGoToAdministrationPasswordPoliciesRequested,flag:we.PASSWORD_POLICIES},{icon:s.createElement(wu,null),title:this.props.t("User passphrase policies"),description:this.props.t("Define the minimal entropy for the users' private key passphrase."),redirectTo:this.props.navigationContext.onGoToAdministrationUserPassphrasePoliciesRequested,flag:we.USER_PASSPHRASE_POLICIES},{icon:s.createElement(Su,null),title:this.props.t("Account recovery"),description:this.props.t("Control the behavior for account recovery for all users."),redirectTo:this.props.navigationContext.onGoToAdministrationAccountRecoveryRequested,flag:we.ACCOUNT_RECOVERY},{icon:s.createElement(Iu,null),title:this.props.t("Single Sign-On"),description:this.props.t("Select which Single Sign-on provider can be use to login."),redirectTo:this.props.navigationContext.onGoToAdministrationSsoRequested,flag:we.SSO},{icon:s.createElement(Ru,null),title:this.props.t("Multi Factor Authentication"),description:this.props.t("Select which multi factor authentication provider can be use."),redirectTo:this.props.navigationContext.onGoToAdministrationMfaRequested,flag:we.MFA},{icon:s.createElement(Mu,null),title:this.props.t("MFA Policy"),description:this.props.t("Control the default behaviour of multi factor authentication."),redirectTo:this.props.navigationContext.onGoToAdministrationMfaPolicyRequested,flag:we.MFA_POLICY},{icon:s.createElement(Bu,null),title:this.props.t("Users directory"),description:this.props.t("Configure the synchronisation of users and groups with passbolt."),redirectTo:this.props.navigationContext.onGoToAdministrationUsersDirectoryRequested,flag:we.USER_DIRECTORY},{icon:s.createElement(zu,null),title:this.props.t("Self registration"),description:this.props.t("Enable users  to enrol without prior admin invitation."),redirectTo:this.props.navigationContext.onGoToAdministrationSelfRegistrationRequested,flag:we.SELF_REGISTRATION},{icon:s.createElement(Yu,null),title:this.props.t("Email server"),description:this.props.t("Control the SMTP server configuration used to send emails."),redirectTo:this.props.navigationContext.onGoToAdministrationSmtpSettingsRequested,flag:we.SMTP_SETTINGS},{icon:s.createElement(mh,null),title:this.props.t("Email notifications"),description:this.props.t("Define which email notifications will be sent."),redirectTo:this.props.navigationContext.onGoToAdministrationEmailNotificationsRequested,flag:null},{icon:s.createElement(Xu,null),title:this.props.t("Role-Based Access Control"),description:this.props.t("Define UI level access controls for the user role."),redirectTo:this.props.navigationContext.onGoToAdministrationRbacsRequested,flag:we.RBAC},{icon:s.createElement(ah,null),title:this.props.t("Internationalisation"),description:this.props.t("Define the default language of the organisation."),redirectTo:this.props.navigationContext.onGoToAdministrationInternationalizationRequested,flag:we.INTERNATIONALIZATION},{icon:s.createElement(rh,null),title:this.props.t("API Status"),description:this.props.t("Monitor the passbolt API's health and responsiveness."),redirectTo:this.props.navigationContext.onGoToAdministrationHealthcheckRequested,flag:we.HEALTHCHECK}].filter(this.isFlagEnabled)}isFlagEnabled(e){return null===e.flag||Boolean(this.props.context.siteSettings?.canIUse(ke[e.flag]))}render(){return s.createElement("div",{className:"row"},s.createElement("div",{id:"administration-home-page",className:"main-column"},s.createElement("div",{className:"main-content"},s.createElement("div",{className:"grid"},this.cardItemsData.map((e=>s.createElement(Gp,{key:e.title,icon:e.icon,title:e.title,description:e.description,onClick:()=>this.handleClickOn(e),isBeta:Boolean(e.isBeta)})))))))}}dh.propTypes={context:r().object,navigationContext:r().object,t:r().func};const ph=I(Oe((0,v.CI)("common")(dh)));var uh;function hh(){return hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},hh.apply(null,arguments)}const gh=function(e){return s.createElement("svg",hh({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),uh||(uh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M24.5 4.667h-8.167M11.667 4.667H3.5M24.5 14H14M9.333 14H3.5M24.5 23.333h-5.833M14 23.333H3.5M16.333 2.333V7M9.333 11.667v4.667M18.667 21v4.667"})))};var bh;function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},yh.apply(null,arguments)}const fh=function(e){return s.createElement("svg",yh({xmlns:"http://www.w3.org/2000/svg",width:18,height:16,fill:"none",viewBox:"0 0 18 16"},e),bh||(bh=s.createElement("path",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12.741 14.338V12.89a2.77 2.77 0 0 0-.826-2.04 2.82 2.82 0 0 0-2.04-.825H4.248a2.825 2.825 0 0 0-2.723 2.865v1.448M7.143 7.26a2.815 2.815 0 1 0-2.815-2.814 2.825 2.825 0 0 0 2.815 2.815M16.994 14.338V12.89a2.85 2.85 0 0 0-.592-1.724 2.8 2.8 0 0 0-1.52-1.02M12.068 1.724a2.74 2.74 0 0 1 1.52 1.02 2.804 2.804 0 0 1 0 3.446 2.74 2.74 0 0 1-1.52 1.02"})))};function vh(){return vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},vh.apply(null,arguments)}const Eh=s.createContext({dropdownOpen:!1,onOpen:()=>{},onClose:()=>{}});class wh extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.bindCallbacks(),this.createRefs()}get defaultState(){return{dropdownOpen:!1,onClose:this.handleCloseDropdown.bind(this),onOpen:this.handleOpenDropdown.bind(this)}}createRefs(){this.dropdownRef=s.createRef()}bindCallbacks(){this.handleDocumentClickEvent=this.handleDocumentClickEvent.bind(this),this.handleDocumentContextualMenuEvent=this.handleDocumentContextualMenuEvent.bind(this),this.handleDocumentDragStartEvent=this.handleDocumentDragStartEvent.bind(this),this.handleCloseDropdown=this.handleCloseDropdown.bind(this)}componentDidMount(){document.addEventListener("click",this.handleDocumentClickEvent,{capture:!0}),document.addEventListener("contextmenu",this.handleDocumentContextualMenuEvent,{capture:!0}),document.addEventListener("dragstart",this.handleDocumentDragStartEvent,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleDocumentClickEvent,{capture:!0}),document.removeEventListener("contextmenu",this.handleDocumentContextualMenuEvent,{capture:!0}),document.removeEventListener("dragstart",this.handleDocumentDragStartEvent,{capture:!0})}handleDocumentDragStartEvent(){this.handleCloseDropdown()}handleDocumentClickEvent(e){this.dropdownRef.current.contains(e.target)||this.handleCloseDropdown()}handleDocumentContextualMenuEvent(e){this.dropdownRef.current.contains(e.target)||this.handleCloseDropdown()}handleCloseDropdown(){this.setState({dropdownOpen:!1})}handleOpenDropdown(){const e=!this.state.dropdownOpen;this.setState({dropdownOpen:e})}render(){return s.createElement(Eh.Provider,{value:this.state},s.createElement("div",{className:"dropdown",ref:this.dropdownRef},this.props.children))}}function kh(e){return class extends s.Component{render(){return s.createElement(Eh.Consumer,null,(t=>s.createElement(e,vh({dropdownContext:t},this.props))))}}}wh.propTypes={children:r().any};class xh extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleDropdownMenuClickEvent=this.handleDropdownMenuClickEvent.bind(this)}handleDropdownMenuClickEvent(){this.props.dropdownContext.onOpen()}get dropdownOpen(){return this.props.dropdownContext.dropdownOpen}render(){return s.createElement("button",{type:"button",className:`${this.props.className} ${this.dropdownOpen?"open":""}`,disabled:this.props.disabled,onClick:this.handleDropdownMenuClickEvent},this.props.children)}}xh.defaultProps={disabled:!1,direction:"right",className:"button-dropdown"},xh.propTypes={className:r().string,disabled:r().bool,direction:r().string,dropdownContext:r().any,children:r().any};const Ch=kh(xh);class Sh extends s.Component{render(){return s.createElement(wh,null,this.props.children)}}Sh.propTypes={children:r().any.isRequired};const _h=Sh;class Nh extends s.Component{get dropdownMenuMustShow(){return this.props.dropdownContext.dropdownOpen}render(){return this.dropdownMenuMustShow&&s.createElement("ul",{className:`dropdown-content menu visible ${this.props.className} ${this.props.direction}`},this.props.children)}}Nh.defaultProps={direction:"right"},Nh.propTypes={direction:r().string,className:r().string,dropdownContext:r().any,children:r().any};const Ih=kh(Nh);class Ph extends s.Component{constructor(e){super(e),this.bindCallback()}bindCallback(){this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.keepOpenOnClick||this.props.dropdownContext.onClose()}render(){return s.createElement("li",{onClick:this.handleClick,className:this.props.separator?"separator-after":""},s.createElement("div",{className:"row"},s.createElement("div",{className:"main-cell-wrapper"},s.createElement("div",{className:"main-cell"},this.props.children))))}}Ph.defaultProps={keepOpenOnClick:!1},Ph.propTypes={separator:r().bool,keepOpenOnClick:r().bool,dropdownContext:r().any,children:r().any};const Ah=kh(Ph);var Th;function Rh(){return Rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Rh.apply(null,arguments)}const Dh=function(e){return s.createElement("svg",Rh({xmlns:"http://www.w3.org/2000/svg",width:19,height:18,fill:"none",viewBox:"0 0 19 18"},e),Th||(Th=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#cog_svg__clip0_93_844425)"},s.createElement("path",{d:"M9.83 15.51a6.51 6.51 0 1 0 0-13.019 6.51 6.51 0 0 0 0 13.019"}),s.createElement("path",{d:"M9.83 10.627a1.628 1.628 0 1 0 0-3.255 1.628 1.628 0 0 0 0 3.255M9.83.862V2.49M9.83 17.137V15.51M13.899 16.046l-.814-1.407M9.016 7.592 5.76 1.953M16.876 13.069l-1.407-.814M2.783 4.932l1.408.813M11.457 9h6.51M1.693 9H3.32M16.876 4.932l-1.407.813M2.783 13.069l1.408-.814M13.899 1.953l-.814 1.408M9.016 10.407l-3.255 5.64"}))))};var Oh;function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Uh.apply(null,arguments)}const Mh=function(e){return s.createElement("svg",Uh({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),Oh||(Oh=s.createElement("g",{stroke:"var(--icon-color)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#help_svg__clip0_93_844469)"},s.createElement("path",{d:"M9 16.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15"}),s.createElement("path",{d:"M6.818 6.75a2.25 2.25 0 0 1 4.372.75c0 1.5-2.25 2.25-2.25 2.25M9 12.75h.008"}))))},Fh="ORGANISATION_SETTINGS";class jh extends s.PureComponent{render(){return this.props.isUserAdmin||this.props.isUserWorkspaceVisible?s.createElement("div",{id:"workspace-switcher"},s.createElement(_h,null,s.createElement(Ch,{className:"button-transparent switcher"},s.createElement(Dh,{className:"cog"})),s.createElement(Ih,{direction:"left",className:"menu-switcher"},this.props.isUserAdmin&&s.createElement(Ah,null,s.createElement("button",{type:"button",className:"no-border "+(this.props.currentWorkspace===Fh?"active":""),onClick:this.props.navigationContext.onGoToAdministrationRequested},s.createElement(gh,null),s.createElement("span",null,s.createElement(v.x6,null,"Organisation Settings")))),s.createElement(Ah,null,s.createElement("button",{type:"button",className:"no-border "+("USER_AND_GROUPS"===this.props.currentWorkspace?"active":""),onClick:this.props.navigationContext.onGoToUsersRequested},s.createElement(fh,null),s.createElement("span",null,s.createElement(v.x6,null,"Manage Users & Groups")))),s.createElement(Ah,null,s.createElement("button",{type:"button",className:"no-border",onClick:this.props.navigationContext.onGoToHelpRequested},s.createElement(Mh,null),s.createElement("span",null,s.createElement(v.x6,null,"Help"))))))):null}}jh.propTypes={isUserAdmin:r().bool,isUserWorkspaceVisible:r().bool,currentWorkspace:r().string,navigationContext:r().object};const zh=Oe(jh);class Lh extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleGoBack=this.handleGoBack.bind(this)}isHomePageSelected(){return we.HOME===this.props.administrationWorkspaceContext.selectedAdministration||we.NONE===this.props.administrationWorkspaceContext.selectedAdministration}isMfaSelected(){return we.MFA===this.props.administrationWorkspaceContext.selectedAdministration}isMfaPolicySelected(){return we.MFA_POLICY===this.props.administrationWorkspaceContext.selectedAdministration}isPasswordPoliciesSelected(){return we.PASSWORD_POLICIES===this.props.administrationWorkspaceContext.selectedAdministration}isUserDirectorySelected(){return we.USER_DIRECTORY===this.props.administrationWorkspaceContext.selectedAdministration}isEmailNotificationsSelected(){return we.EMAIL_NOTIFICATION===this.props.administrationWorkspaceContext.selectedAdministration}isSubscriptionSelected(){return we.SUBSCRIPTION===this.props.administrationWorkspaceContext.selectedAdministration}isInternationalizationSelected(){return we.INTERNATIONALIZATION===this.props.administrationWorkspaceContext.selectedAdministration}isAccountRecoverySelected(){return we.ACCOUNT_RECOVERY===this.props.administrationWorkspaceContext.selectedAdministration}isSmtpSettingsSelected(){return we.SMTP_SETTINGS===this.props.administrationWorkspaceContext.selectedAdministration}isSelfRegistrationSelected(){return we.SELF_REGISTRATION===this.props.administrationWorkspaceContext.selectedAdministration}isSsoSelected(){return we.SSO===this.props.administrationWorkspaceContext.selectedAdministration}isRbacSelected(){return we.RBAC===this.props.administrationWorkspaceContext.selectedAdministration}isUserPassphrasePoliciesSelected(){return we.USER_PASSPHRASE_POLICIES===this.props.administrationWorkspaceContext.selectedAdministration}isPasswordExpirySelected(){return we.PASSWORD_EXPIRY===this.props.administrationWorkspaceContext.selectedAdministration}isContentTypesEncryptedMetadataSelected(){return we.CONTENT_TYPES_ENCRYPTED_METADATA===this.props.administrationWorkspaceContext.selectedAdministration}isContentTypesMetadataKeySelected(){return we.CONTENT_TYPES_METADATA_KEY===this.props.administrationWorkspaceContext.selectedAdministration}isMigrateMetadataSelected(){return we.MIGRATE_METADATA===this.props.administrationWorkspaceContext.selectedAdministration}isAllowContentTypesSelected(){return we.ALLOW_CONTENT_TYPES===this.props.administrationWorkspaceContext.selectedAdministration}handleGoBack(){this.props.navigationContext.onGoToPasswordsRequested()}get isHttpError403(){return we.HTTP_403_ACCESS_DENIED===this.props.administrationWorkspaceContext.selectedAdministration}get isHttpError404(){return we.HTTP_404_NOT_FOUND===this.props.administrationWorkspaceContext.selectedAdministration}isHealthcheckSelected(){return we.HEALTHCHECK===this.props.administrationWorkspaceContext.selectedAdministration}render(){return s.createElement("div",{id:"container",className:"page administration"},s.createElement("div",{id:"app",className:"app",tabIndex:"1000"},s.createElement("div",{className:"panel main"},s.createElement("div",{className:"panel left"},!this.isHttpError403&&s.createElement("div",{className:"sidebar-content"},s.createElement("div",{className:"top-bar-left-navigation"},s.createElement("div",{className:"navigation"},s.createElement("button",{type:"button",className:"button-transparent back",onClick:this.handleGoBack},s.createElement(mp,null)),s.createElement("span",{className:"title administration"},s.createElement(v.x6,null,"Organisation settings")))),s.createElement("div",{className:"sidebar-content-left"},s.createElement(Dt,null)))),s.createElement("div",{className:"panel middle"},s.createElement("div",{className:"header"},!this.isHttpError403&&s.createElement(s.Fragment,null,s.createElement("div",{className:"header-left"}),s.createElement("div",{className:"header-right"},s.createElement(zh,{isUserAdmin:!0,isUserWorkspaceVisible:!0,currentWorkspace:Fh}),s.createElement(Tt,{baseUrl:this.props.context.trustedDomain||this.props.context.userSettings.getTrustedDomain(),user:this.props.context.loggedInUser})))),s.createElement("div",{className:"middle-right"},s.createElement("div",{className:"breadcrumbs-and-grid"},s.createElement("div",{className:"top-bar"},s.createElement(Ia,null)),s.createElement("div",{className:"main-page"},this.isHttpError403&&s.createElement(em,{errorCode:403}),this.isHttpError404&&s.createElement(em,{errorCode:404}),this.isHomePageSelected()&&s.createElement(ph,null),this.isMfaSelected()&&s.createElement(ka,null),this.isMfaPolicySelected()&&s.createElement(Al,null),this.isPasswordPoliciesSelected()&&s.createElement(kc,null),this.isUserDirectorySelected()&&s.createElement(Ds,null),this.isEmailNotificationsSelected()&&s.createElement(Bs,null),this.isSubscriptionSelected()&&s.createElement(Dn,null),this.isInternationalizationSelected()&&s.createElement(Gn,null),this.isAccountRecoverySelected()&&s.createElement(Qi,null),this.isSmtpSettingsSelected()&&s.createElement(Gr,null),this.isSelfRegistrationSelected()&&s.createElement(ko,null),this.isSsoSelected()&&s.createElement(fl,null),this.isRbacSelected()&&s.createElement(lc,null),this.isUserPassphrasePoliciesSelected()&&s.createElement(Mc,null),this.isPasswordExpirySelected()&&s.createElement(Qc,null),this.isHealthcheckSelected()&&s.createElement(Ym,null),this.isContentTypesEncryptedMetadataSelected()&&s.createElement(op,null),this.isContentTypesMetadataKeySelected()&&s.createElement(kp,null),this.isMigrateMetadataSelected()&&s.createElement(Ap,null),this.isAllowContentTypesSelected()&&s.createElement(Vp,null))),s.createElement(S.dO,null,s.createElement(S.qh,{exact:!0,path:["/app/administration"]}),s.createElement(S.qh,null,s.createElement("div",{className:"help-panel"},s.createElement("div",{className:"sidebar-help",id:"administration-help-panel"}),s.createElement(pp,null)))))))))}}Lh.propTypes={context:r().any,administrationWorkspaceContext:r().object,navigationContext:r().any};const qh=I(Oe(Ee(Lh)));class Kh extends s.Component{constructor(e){super(e),this.initEventHandlers(),this.createReferences()}initEventHandlers(){this.handleCloseClick=this.handleCloseClick.bind(this)}createReferences(){this.loginLinkRef=s.createRef()}handleCloseClick(){this.goToLogin()}goToLogin(){this.loginLinkRef.current.click()}get loginUrl(){let e=this.props.context.userSettings&&this.props.context.userSettings.getTrustedDomain();return e=e||this.props.context.trustedDomain,`${e}/auth/login`}render(){return s.createElement(wt,{title:this.props.t("Session Expired"),onClose:this.handleCloseClick,className:"session-expired-dialog"},s.createElement("div",{className:"form-content"},s.createElement("p",null,s.createElement(v.x6,null,"Your session has expired, you need to sign in."))),s.createElement("div",{className:"submit-wrapper clearfix"},s.createElement("a",{ref:this.loginLinkRef,href:this.loginUrl,className:"primary button form",target:"_parent",role:"button",rel:"noopener noreferrer"},s.createElement(v.x6,null,"Sign in"))))}}Kh.propTypes={context:r().any,t:r().func};const Wh=I((0,S.y)((0,v.CI)("common")(Kh)));class Vh extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleSessionExpiredEvent=this.handleSessionExpiredEvent.bind(this)}componentDidMount(){this.props.context.onExpiredSession(this.handleSessionExpiredEvent)}handleSessionExpiredEvent(){this.props.dialogContext.closeAll(),this.props.dialogContext.open(Wh)}render(){return s.createElement(s.Fragment,null)}}Vh.propTypes={context:r().any,dialogContext:r().any};const Bh=I(g(Vh));function Gh(){return Gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Gh.apply(null,arguments)}const $h=s.createContext({announcements:[],show:()=>{},close:()=>{}});class Hh extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{announcements:[],show:(e,t)=>{const a=(0,o.A)();return this.setState({announcements:[...this.state.announcements,{key:a,Announcement:e,AnnouncementProps:t}]}),a},close:async e=>await this.setState({announcements:this.state.announcements.filter((t=>e!==t.key))})}}render(){return s.createElement($h.Provider,{value:this.state},this.props.children)}}function Yh(e){return class extends s.Component{render(){return s.createElement($h.Consumer,null,(t=>s.createElement(e,Gh({announcementContext:t},this.props))))}}}Hh.displayName="AnnouncementContextProvider",Hh.propTypes={children:r().any};class Jh extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleClose=this.handleClose.bind(this)}handleClose(){this.props.onClose()}render(){return s.createElement("div",{className:`${this.props.className} announcement`},s.createElement("div",{className:"announcement-content"},this.props.canClose&&s.createElement("button",{type:"button",className:"announcement-close dialog-close button-transparent",onClick:this.handleClose},s.createElement(pt,{className:"svg-icon"}),s.createElement("span",{className:"visually-hidden"},s.createElement(v.x6,null,"Close"))),this.props.children))}}Jh.propTypes={children:r().node,className:r().string,canClose:r().bool,onClose:r().func};const Zh=(0,v.CI)("common")(Jh);class Qh extends s.Component{render(){return s.createElement(Zh,{className:"subscription",onClose:this.props.onClose,canClose:!0},s.createElement("p",null,s.createElement(v.x6,null,"Warning:")," ",s.createElement(v.x6,null,"your subscription key will expire")," ",Nn(this.props.expiry,this.props.t,this.props.context.locale),".",s.createElement("button",{className:"link",type:"button",onClick:this.props.navigationContext.onGoToAdministrationSubscriptionRequested},s.createElement(v.x6,null,"Manage Subscription"))))}}Qh.propTypes={context:r().any,expiry:r().string,navigationContext:r().any,onClose:r().func,t:r().func};const Xh=I(Oe(Yh((0,v.CI)("common")(Qh))));class eg extends s.Component{render(){return s.createElement(Zh,{className:"subscription",onClose:this.props.onClose,canClose:!1},s.createElement("p",null,s.createElement(v.x6,null,"Warning:")," ",s.createElement(v.x6,null,"your subscription requires your attention. The stability of the application is at risk."),s.createElement("button",{className:"link",type:"button",onClick:this.props.navigationContext.onGoToAdministrationSubscriptionRequested},s.createElement(v.x6,null,"Manage Subscription"))))}}eg.propTypes={navigationContext:r().any,onClose:r().func,i18n:r().any};const tg=Oe(Yh((0,v.CI)("common")(eg)));class ag extends s.Component{render(){return s.createElement(Zh,{className:"subscription",onClose:this.props.onClose,canClose:!1},s.createElement("p",null,s.createElement(v.x6,null,"Warning:")," ",s.createElement(v.x6,null,"your subscription key is not valid. The stability of the application is at risk."),s.createElement("button",{className:"link",type:"button",onClick:this.props.navigationContext.onGoToAdministrationSubscriptionRequested},s.createElement(v.x6,null,"Manage Subscription"))))}}ag.propTypes={navigationContext:r().any,onClose:r().func,i18n:r().any};const sg=Oe(Yh((0,v.CI)("common")(ag)));class ng extends s.Component{constructor(e){super(e),this.bindCallbacks()}bindCallbacks(){this.handleAnnouncementSubscriptionEvent=this.handleAnnouncementSubscriptionEvent.bind(this)}componentDidMount(){this.handleAnnouncementSubscriptionEvent()}componentDidUpdate(e){this.handleRefreshSubscriptionAnnouncement(e.context.refreshSubscriptionAnnouncement)}async handleRefreshSubscriptionAnnouncement(e){this.props.context.refreshSubscriptionAnnouncement!==e&&this.props.context.refreshSubscriptionAnnouncement&&(await this.handleAnnouncementSubscriptionEvent(),this.props.context.setContext({refreshSubscriptionAnnouncement:null}))}async handleAnnouncementSubscriptionEvent(){this.hideSubscriptionAnnouncement();try{const e=await this.props.context.onGetSubscriptionKeyRequested();this.isSubscriptionGoingToExpire(e.expiry)&&this.props.announcementContext.show(Xh,{expiry:e.expiry})}catch(e){"PassboltSubscriptionError"===e.name?this.props.announcementContext.show(tg):this.props.announcementContext.show(sg)}}hideSubscriptionAnnouncement(){const e=[Xh,tg,sg];this.props.announcementContext.announcements.forEach((t=>{e.some((e=>e===t.Announcement))&&this.props.announcementContext.close(t.key)}))}isSubscriptionGoingToExpire(e){return Hs.c9.fromISO(e)<Hs.c9.now().plus({days:30})}render(){return s.createElement(s.Fragment,null)}}ng.propTypes={context:r().any,announcementContext:r().any};const ig=I(Yh(ng));function rg(){return rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},rg.apply(null,arguments)}class og extends s.Component{constructor(e){super(e),this.bindCallback()}bindCallback(){this.close=this.close.bind(this)}async close(e){this.props.announcementContext.close(e)}render(){return s.createElement(s.Fragment,null,this.props.announcementContext.announcements.map((({key:e,Announcement:t,AnnouncementProps:a})=>s.createElement(t,rg({key:e,onClose:()=>this.close(e)},a)))),this.props.children)}}og.propTypes={announcementContext:r().any,children:r().any};const lg=Yh(og);class cg{setBaseUrl(e){if(!e)throw new TypeError("ApiClientOption baseUrl is required.");if("string"==typeof e)try{this.baseUrl=new URL(e)}catch(e){throw new TypeError("ApiClientOption baseUrl is invalid.")}else{if(!(e instanceof URL))throw new TypeError("ApiClientOptions baseurl should be a string or URL");this.baseUrl=e}return this}setResourceName(e){if(!e)throw new TypeError("ApiClientOptions.setResourceName resourceName is required.");if("string"!=typeof e)throw new TypeError("ApiClientOptions.setResourceName resourceName should be a valid string.");return this.resourceName=e,this}getBaseUrl(){return this.baseUrl}getResourceName(){return this.resourceName}async getHeaders(){const e=await this.getCsrfToken();if(e)return{"X-CSRF-Token":e}}async getCsrfToken(){if("undefined"==typeof browser||void 0===browser.cookies){const e=document?.cookie?.split("; ")?.find((e=>e.startsWith("csrfToken")))?.split("=");return e&&2===e.length?e[1]:null}const e=this.baseUrl.toString(),t="/"===e.slice(-1)?e:`${e}/`,a=await browser.cookies.get({name:"csrfToken",url:t});return a?.value||null}}class mg extends Error{constructor(e,t={}){super(e),this.name="PassboltSubscriptionError",this.subscription=t}}const dg=mg;class pg extends Wl{constructor(e){super(e,pg.RESOURCE_NAME)}static get RESOURCE_NAME(){return"/rbacs/me"}static getSupportedContainOptions(){return["action","ui_action"]}async findMe(e){const t=e?this.formatContainOptions(e,pg.getSupportedContainOptions()):null;return(await this.apiClient.findAll(t)).body}}const ug=pg,hg=class{constructor(e){e.setResourceName("auth"),this.apiClient=new Qt(e)}async logout(){const e=this.apiClient.buildUrl(`${this.apiClient.baseUrl}/logout`,{}),t=await this.apiClient.sendRequest("POST",e,null,{redirect:"manual"});if(!t.ok&&0!==t.status)return this._logoutLegacy()}async _logoutLegacy(){const e=this.apiClient.buildUrl(`${this.apiClient.baseUrl}/logout`,{}),t=await this.apiClient.sendRequest("GET",e,null,{redirect:"manual"});if(!t.ok&&0!==t.status)throw new Gt("An unexpected error happened during the legacy logout process",{code:t.status})}};class gg extends s.Component{constructor(e){super(e),this.state=this.defaultState,this.authLogoutService=new hg(this.getApiClientOptions())}async componentDidMount(){await this.getLoggedInUser(),await this.getSiteSettings(),await this.getRbacs(),this.initLocale(),this.removeSplashScreen();const e=document.querySelector(".temporary.skeleton");e&&e.remove()}componentWillUnmount(){clearTimeout(this.state.onExpiredSession)}get defaultState(){return{name:"api",loggedInUser:null,rbacs:null,siteSettings:null,trustedDomain:this.baseUrl,basename:new URL(this.baseUrl).pathname,getApiClientOptions:this.getApiClientOptions.bind(this),locale:null,displayTestUserDirectoryDialogProps:{userDirectoryTestResult:null},setContext:e=>{this.setState(e)},onLogoutRequested:()=>this.onLogoutRequested(),onCheckIsAuthenticatedRequested:()=>this.onCheckIsAuthenticatedRequested(),onExpiredSession:this.onExpiredSession.bind(this),onGetSubscriptionKeyRequested:()=>this.onGetSubscriptionKeyRequested(),onRefreshLocaleRequested:this.onRefreshLocaleRequested.bind(this)}}get isReady(){return null!==this.state.loggedInUser&&null!==this.state.rbacs&&null!==this.state.siteSettings&&null!==this.state.locale}get baseUrl(){const e=document.getElementsByTagName("base")&&document.getElementsByTagName("base")[0];return e?e.attributes.href.value.replace(/\/*$/g,""):(console.error("Unable to retrieve the page base tag"),"")}getApiClientOptions(){return(new cg).setBaseUrl(this.state.trustedDomain)}async getLoggedInUser(){const e=this.getApiClientOptions().setResourceName("users"),t=new Qt(e),a=(await t.get("me")).body;this.setState({loggedInUser:a})}async getRbacs(){let e=[];if(this.state.siteSettings.canIUse("rbacs")){const t=this.getApiClientOptions(),a=new ug(t);e=await a.findMe({ui_action:!0})}const t=new Kl(e,!0);this.setState({rbacs:t})}async getSiteSettings(){const e=this.getApiClientOptions().setResourceName("settings"),t=new Qt(e),a=await t.findAll();await this.setState({siteSettings:new Ri(a.body)})}async initLocale(){const e=await this.getUserLocale();if(e)return this.setState({locale:e.locale});const t=this.state.siteSettings.locale;return this.setState({locale:t})}async getUserLocale(){const e=(await this.getUserSettings()).find((e=>"locale"===e.property));if(e)return this.state.siteSettings.supportedLocales.find((t=>t.locale===e.value))}async getUserSettings(){const e=this.getApiClientOptions().setResourceName("account/settings"),t=new Qt(e);return(await t.findAll()).body}removeSplashScreen(){document.getElementsByTagName("html")[0].classList.remove("launching")}async onLogoutRequested(){await this.authLogoutService.logout(),window.location.href=this.state.trustedDomain}async onCheckIsAuthenticatedRequested(){try{const e=this.getApiClientOptions().setResourceName("auth"),t=new Qt(e);return await t.get("is-authenticated"),!0}catch(e){if(e instanceof Gt&&401===e.data.code)return!1;throw e}}onExpiredSession(e){this.scheduledCheckIsAuthenticatedTimeout=setTimeout((async()=>{await this.onCheckIsAuthenticatedRequested()?this.onExpiredSession(e):e()}),6e4)}async onGetSubscriptionKeyRequested(){try{const e=this.getApiClientOptions().setResourceName("ee/subscription"),t=new Qt(e);return(await t.get("key")).body}catch(e){if(e instanceof Gt&&e.data&&402===e.data.code){const t=e.data.body;throw new dg(e.message,t)}throw e}}onRefreshLocaleRequested(e){this.state.siteSettings.setLocale(e),this.initLocale()}render(){return s.createElement(P.Provider,{value:this.state},this.isReady&&this.props.children)}}gg.propTypes={children:r().any};const bg=gg;var yg=a(2635),fg=a(1347);class vg extends s.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{ready:!1}}async componentDidMount(){await yg.Ay.use(v.r9).use(fg.A).init({lng:this.locale,load:"currentOnly",interpolation:{escapeValue:!1},react:{useSuspense:!1},backend:{loadPath:this.props.loadingPath||"/locales/{{lng}}/{{ns}}.json"},supportedLngs:this.supportedLocales,fallbackLng:!1,ns:["common"],defaultNS:"common",keySeparator:!1,nsSeparator:!1,debug:!1}),this.setState({ready:!0})}get supportedLocales(){return this.props.context.siteSettings?.supportedLocales?this.props.context.siteSettings?.supportedLocales.map((e=>e.locale)):[this.locale]}get locale(){return this.props.context.locale}async componentDidUpdate(e){await this.handleLocaleChange(e.context.locale)}async handleLocaleChange(e){this.locale!==e&&await yg.Ay.changeLanguage(this.locale)}get isReady(){return this.state.ready}render(){return s.createElement(s.Fragment,null,this.isReady&&this.props.children)}}vg.propTypes={context:r().any,loadingPath:r().any,children:r().any};const Eg=I(vg);class wg{constructor(){this.baseUrl=this.getBaseUrl()}async getOrganizationAccountRecoverySettings(){const e=this.getApiClientOptions().setResourceName("account-recovery/organization-policies"),t=new Qt(e);return(await t.findAll()).body}getBaseUrl(){const e=document.getElementsByTagName("base")&&document.getElementsByTagName("base")[0];return e?e.attributes.href.value.replace(/\/*$/g,""):(console.error("Unable to retrieve the page base tag"),"")}getApiClientOptions(){return(new cg).setBaseUrl(this.baseUrl)}getCsrfToken(){const e=document.cookie;if(!e)return;const t=e.split("; ");if(!t)return;const a=t.find((e=>e.startsWith("csrfToken")));if(!a)return;const s=a.split("=");return s&&2===s.length?s[1]:void 0}}class kg extends s.Component{render(){const e=new wg;return s.createElement(bg,null,s.createElement(P.Consumer,null,(t=>s.createElement(Eg,{loadingPath:`${t.trustedDomain}/locales/{{lng}}/{{ns}}.json`},s.createElement(ue,null,s.createElement(je,{accountRecoveryUserService:e},s.createElement(tt,null,s.createElement(m,null,s.createElement(h,null,s.createElement(Hh,null,s.createElement(f,null,s.createElement(x,null),s.createElement(Bh,null),t.loggedInUser&&"admin"===t.loggedInUser.role.name&&t.siteSettings.canIUse("ee")&&s.createElement(ig,null),s.createElement(C.Kd,{basename:t.basename},s.createElement(De,null,s.createElement(S.dO,null,s.createElement(S.qh,{exact:!0,path:["/app/administration/subscription","/app/administration/account-recovery","/app/administration/password-policies","/app/administration/user-passphrase-policies","/app/administration/password-expiry","/app/administration/content-types/metadata","/app/administration/content-types/metadata-key"]}),s.createElement(S.qh,{path:"/app/administration"},s.createElement(fe,null,s.createElement(_r,null,s.createElement(Pe,null),s.createElement(lg,null),s.createElement(ts,null,s.createElement(io,null,s.createElement(_e,null),s.createElement(sa,null,s.createElement(Sl,null,s.createElement(Ls,null,s.createElement(qn,null,s.createElement(Zl,null,s.createElement(Nm,null,s.createElement(qh,null))))))))))))))))))))))))))}}const xg=kg,Cg=document.createElement("div");document.body.appendChild(Cg),n.render(s.createElement(xg,null),Cg)}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return s[e].call(a.exports,a,a.exports,i),a.exports}i.m=s,e=[],i.O=(t,a,s,n)=>{if(!a){var r=1/0;for(m=0;m<e.length;m++){for(var[a,s,n]=e[m],o=!0,l=0;l<a.length;l++)(!1&n||r>=n)&&Object.keys(i.O).every((e=>i.O[e](a[l])))?a.splice(l--,1):(o=!1,n<r&&(r=n));if(o){e.splice(m--,1);var c=s();void 0!==c&&(t=c)}}return t}n=n||0;for(var m=e.length;m>0&&e[m-1][2]>n;m--)e[m]=e[m-1];e[m]=[a,s,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,s){if(1&s&&(e=this(e)),8&s)return e;if("object"==typeof e&&e){if(4&s&&e.__esModule)return e;if(16&s&&"function"==typeof e.then)return e}var n=Object.create(null);i.r(n);var r={};t=t||[null,a({}),a([]),a(a)];for(var o=2&s&&e;"object"==typeof o&&!~t.indexOf(o);o=a(o))Object.getOwnPropertyNames(o).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,i.d(n,r),n},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=815,(()=>{var e={815:0};i.O.j=t=>0===e[t];var t=(t,a)=>{var s,n,[r,o,l]=a,c=0;if(r.some((t=>0!==e[t]))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)var m=l(i)}for(t&&t(a);c<r.length;c++)n=r[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(m)},a=self.webpackChunkpassbolt_styleguide=self.webpackChunkpassbolt_styleguide||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=i.O(void 0,[847],(()=>i(566)));r=i.O(r)})();